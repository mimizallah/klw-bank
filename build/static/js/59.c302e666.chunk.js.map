{"version":3,"sources":["../node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js","../node_modules/@arcgis/core/layers/support/ElevationTileData.js","../node_modules/@arcgis/core/core/workers/WorkerHandle.js","../node_modules/@arcgis/core/layers/support/LercDecoder.js","../node_modules/@arcgis/core/layers/ElevationLayer.js","../node_modules/@arcgis/core/layers/support/Tilemap.js","../node_modules/@arcgis/core/layers/support/TilemapCache.js","../node_modules/@arcgis/core/geometry/support/UintArray.js","../node_modules/@arcgis/core/layers/support/TileInfoTilemapCache.js"],"names":["p","n","_p","_inherits","_super","_createSuper","_this","_classCallCheck","apply","arguments","copyright","minScale","maxScale","spatialReference","tileInfo","tilemapCache","_createClass","key","value","_this$tilemapCache","_this$tilemapCache$de","this","destroy","call","e","o","minLOD","maxLOD","get","version","r","_o$capabilities","t","capabilities","includes","a","c","Math","round","lods","scale","length","_step","_iterator","_createForOfIteratorHelper","s","done","level","err","f","layer","l","read","i","json","source","prototype","type","readOnly","_hasNoDataValues","_minValue","_maxValue","values","pixelData","width","height","noDataValue","_ensureBounds","u","h","undefined","_mainMethod","_transferLists","_listeners","_promise","_objectSpread","schedule","then","_thread","hasInitialize","broadcast","_connectListener","close","catch","getLogger","error","concat","_this2","removed","eventName","callback","threadHandle","push","remove","invokeMethod","_this3","invoke","transferList","signal","Promise","reject","_this4","all","on","_e","_decode","buffer","strategy","ref","byteLength","options","resolve","forEach","delete","Map","S","_y","_len","Array","_key","operations","supportsTileMap","heightModelInfo","path","opacity","operationalLayerType","sourceJSON","url","_lercDecoder","immediate","set","j","split","map","toLowerCase","trim","currentVersion","addResolvingPromise","loadFromPortal","supportedTypes","supportsData","validateItem","typeKeywords","expectedType","_fetchImageService","AbortController","responseType","returnFileInfo","load","_fetchTileAvailability","getTileUrl","decode","data","g","supportsBlankTile","parsedUrl","query","blankTile","_queryElevation","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$import","wrap","_context","prev","next","sent","ElevationQuery","abrupt","stop","_x","_x2","_createElevationSampler","_callee2","_yield$import2","_context2","createSampler","_x3","_x4","fetchAvailability","_fetchImageService2","_callee3","_this$url","_context3","ssl","replace","origin","_x5","fetchTile","w","y","m","v","d","String","origins","write","service","Symbol","T","_validateJSON","location","Object","freeze","fill","Uint32Array","ceil","_availability","byteSize","top","left","valid","isArray","request","row","col","_t$service$tileServer","tileServers","details","httpStatus","response","definition","fromJSON","_i","_pendingTilemapRequests","size","_prefetchingEnabled","_tilemapCache","MEGABYTES","addHandles","apiKey","customParameters","_initializeTilemapDefinition","_this$minLOD","_this$maxLOD","lodAt","effectiveMinLOD","effectiveMaxLOD","_tmpTilemapDefinition","_tilemapFromCache","b","fromDefinition","put","getAvailability","fetchTilemap","updateTileInfo","upsampleTile","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","id","_fetchAvailabilityUpsamplePrefetch2","_loop","_this5","hasHandles","abort","removeHandles","_","_prefetches","removeUnordered","_maxPrefetch","delegateYield","_x6","_e$query","_this$layer","clear","token","prefetchingEnabled","hasTilemap","initialSize","constructOnly","_this$tileInfo","cols","rows","_fetchAvailability","_fetchAvailabilityUpsample","_x7","_x8","_x9"],"mappings":"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","file":"static/js/59.c302e666.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{reader as r}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import l from\"../support/TileInfo.js\";import i from\"../support/TileInfoTilemapCache.js\";import{TilemapCache as s}from\"../support/TilemapCache.js\";import a from\"../../geometry/SpatialReference.js\";const p=p=>{let n=class extends p{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,o){return null!=o.minLOD&&null!=o.maxLOD?e:0}readMaxScale(e,o){return null!=o.minLOD&&null!=o.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,o,r){const t=o.capabilities?.includes(\"Tilemap\");let{minLOD:a,maxLOD:p,minScale:n,maxScale:c}=o;if(null==a&&null==p&&0!==n&&0!==c){const e=e=>Math.round(1e4*e)/1e4;n=e(n||o.tileInfo.lods[0].scale),c=e(c||o.tileInfo.lods[o.tileInfo.lods.length-1].scale);for(const r of o.tileInfo.lods){const o=e(r.scale);a=o>=n?r.level:a,p=o>=c?r.level:p}}if(t)return new s({layer:this,minLOD:a,maxLOD:p});if(o.tileInfo){const e=new l;return e.read(o.tileInfo,r),new i(e,a,p)}return null}};return e([o({json:{read:{source:\"copyrightText\"}}})],n.prototype,\"copyright\",void 0),e([o()],n.prototype,\"minScale\",void 0),e([r(\"service\",\"minScale\")],n.prototype,\"readMinScale\",null),e([o()],n.prototype,\"maxScale\",void 0),e([r(\"service\",\"maxScale\")],n.prototype,\"readMaxScale\",null),e([o({type:a})],n.prototype,\"spatialReference\",void 0),e([o({readOnly:!0})],n.prototype,\"supportsBlankTile\",null),e([o({type:l})],n.prototype,\"tileInfo\",void 0),e([o()],n.prototype,\"tilemapCache\",void 0),e([r(\"service\",\"tilemapCache\",[\"capabilities\",\"tileInfo\"])],n.prototype,\"readTilemapCache\",null),e([o()],n.prototype,\"version\",void 0),n=e([t(\"esri.layers.mixins.ArcGISCachedService\")],n),n};export{p as ArcGISCachedService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nclass a{constructor(a,t,s,e){this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,\"pixelData\"in a?(this.values=a.pixelData,this.width=a.width,this.height=a.height,this.noDataValue=a.noDataValue):(this.values=a,this.width=t,this.height=s,this.noDataValue=e)}get hasNoDataValues(){if(null==this._hasNoDataValues){const a=this.noDataValue;this._hasNoDataValues=this.values.includes(a)}return this._hasNoDataValues}get minValue(){return this._ensureBounds(),this._minValue}get maxValue(){return this._ensureBounds(),this._maxValue}_ensureBounds(){if(null!=this._minValue)return;const{noDataValue:a,values:t}=this;let s=1/0,e=-1/0,i=!0;for(const u of t)u===a?this._hasNoDataValues=!0:(s=u<s?u:s,e=u>e?u:e,i=!1);i?(this._minValue=0,this._maxValue=0):(this._minValue=s,this._maxValue=e>-3e38?e:0)}}export{a as ElevationTileData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{remove as e}from\"../arrayUtils.js\";import{makeHandle as t}from\"../handleUtils.js\";import s from\"../Logger.js\";import{throwIfAborted as r}from\"../promiseUtils.js\";import{open as i}from\"./workers.js\";class h{constructor(e,t,r,h,o={}){this._mainMethod=t,this._transferLists=r,this._listeners=[],this._promise=i(e,{...o,schedule:h}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,o.hasInitialize&&this.broadcast({},\"initialize\");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>s.getLogger(\"esri.core.workers.WorkerHandle\").error(`Failed to initialize ${e} worker: ${t}`)))}on(s,r){const i={removed:!1,eventName:s,callback:r,threadHandle:null};return this._listeners.push(i),this._connectListener(i),t((()=>{i.removed=!0,e(this._listeners,i),this._thread&&null!=i.threadHandle&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,s){if(this._thread){const r=this._transferLists[e],i=r?r(t):[];return this._thread.invoke(e,t,{transferList:i,signal:s})}return this._promise?this._promise.then((()=>(r(s),this.invokeMethod(e,t,s)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}export{h as WorkerHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{WorkerHandle as e}from\"../../core/workers/WorkerHandle.js\";class r extends e{constructor(e=null){super(\"LercWorker\",\"_decode\",{_decode:e=>[e.buffer]},e,{strategy:\"dedicated\"}),this.schedule=e,this.ref=0}decode(e,r,t){return e&&0!==e.byteLength?this.invoke({buffer:e,options:r},t):Promise.resolve(null)}release(){--this.ref<=0&&(t.forEach(((e,r)=>{e===this&&t.delete(r)})),this.destroy())}}const t=new Map;function s(e=null){let s=t.get(e);return s||(null!=e?(s=new r((r=>e.immediate.schedule(r))),t.set(e,s)):(s=new r,t.set(null,s))),++s.ref,s}export{s as acquireDecoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../request.js\";import t from\"../core/Error.js\";import{releaseMaybe as i}from\"../core/maybe.js\";import{MultiOriginJSONMixin as o}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as s,throwIfAborted as a}from\"../core/promiseUtils.js\";import{objectToQuery as p}from\"../core/urlUtils.js\";import{property as l}from\"../core/accessorSupport/decorators/property.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/arrayUtils.js\";import\"../core/has.js\";import{reader as n}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as c}from\"../core/accessorSupport/decorators/subclass.js\";import d from\"../geometry/HeightModelInfo.js\";import u from\"./Layer.js\";import{ArcGISCachedService as y}from\"./mixins/ArcGISCachedService.js\";import{ArcGISService as m}from\"./mixins/ArcGISService.js\";import{OperationalLayer as h}from\"./mixins/OperationalLayer.js\";import{PortalLayer as v}from\"./mixins/PortalLayer.js\";import{url as f}from\"./support/commonProperties.js\";import{ElevationTileData as g}from\"./support/ElevationTileData.js\";import{acquireDecoder as j}from\"./support/LercDecoder.js\";let S=class extends(y(m(h(v(o(u)))))){constructor(...e){super(...e),this.capabilities={operations:{supportsTileMap:!1}},this.copyright=null,this.heightModelInfo=null,this.path=null,this.minScale=void 0,this.maxScale=void 0,this.opacity=1,this.operationalLayerType=\"ArcGISTiledElevationServiceLayer\",this.sourceJSON=null,this.type=\"elevation\",this.url=null,this.version=null,this._lercDecoder=j()}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}destroy(){this._lercDecoder=i(this._lercDecoder)}readCapabilities(e,r){const t=r.capabilities&&r.capabilities.split(\",\").map((e=>e.toLowerCase().trim()));if(!t)return{operations:{supportsTileMap:!1}};return{operations:{supportsTileMap:t.includes(\"tilemap\")}}}readVersion(e,r){let t=r.currentVersion;return t||(t=9.3),t}load(e){const r=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Image Service\"],supportsData:!1,validateItem:e=>{for(let r=0;r<e.typeKeywords.length;r++)if(\"elevation 3d layer\"===e.typeKeywords[r].toLowerCase())return!0;throw new t(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}' \",{type:\"Image Service\",expectedType:\"Image Service Elevation 3D Layer\"})}},e).catch(s).then((()=>this._fetchImageService(r)))),Promise.resolve(this)}fetchTile(e,t,i,o){const s=null!=(o=o||{signal:null}).signal?o.signal:o.signal=(new AbortController).signal,a={responseType:\"array-buffer\",signal:s},p={noDataValue:o.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,i,o))).then((()=>r(this.getTileUrl(e,t,i),a))).then((e=>this._lercDecoder.decode(e.data,p,s))).then((e=>new g(e)))}getTileUrl(e,r,t){const i=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,o=p({...this.parsedUrl.query,blankTile:!i&&null});return`${this.parsedUrl.path}/tile/${e}/${r}/${t}${o?\"?\"+o:\"\"}`}async queryElevation(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");a(r);return(new t).query(this,e,r)}async createElevationSampler(e,r){const{ElevationQuery:t}=await import(\"./support/ElevationQuery.js\");a(r);return(new t).createSampler(this,e,r)}_fetchTileAvailability(e,r,t,i){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,r,t,i):Promise.resolve(\"unknown\")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const t={query:{f:\"json\",...this.parsedUrl.query},responseType:\"json\",signal:e},i=await r(this.parsedUrl.path,t);i.ssl&&(this.url=this.url?.replace(/^http:/i,\"https:\")),this.sourceJSON=i.data,this.read(i.data,{origin:\"service\",url:this.parsedUrl})}get hasOverriddenFetchTile(){return!this.fetchTile[w]}};e([l({readOnly:!0})],S.prototype,\"capabilities\",void 0),e([n(\"service\",\"capabilities\",[\"capabilities\"])],S.prototype,\"readCapabilities\",null),e([l({json:{read:{source:\"copyrightText\"}}})],S.prototype,\"copyright\",void 0),e([l({readOnly:!0,type:d})],S.prototype,\"heightModelInfo\",void 0),e([l({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],S.prototype,\"path\",void 0),e([l({type:[\"show\",\"hide\"]})],S.prototype,\"listMode\",void 0),e([l({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}},readOnly:!0})],S.prototype,\"minScale\",void 0),e([l({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},\"portal-item\":{read:!1,write:!1},\"web-document\":{read:!1,write:!1}}},readOnly:!0})],S.prototype,\"maxScale\",void 0),e([l({json:{read:!1,write:!1,origins:{\"web-document\":{read:!1,write:!1}}}})],S.prototype,\"opacity\",void 0),e([l({type:[\"ArcGISTiledElevationServiceLayer\"]})],S.prototype,\"operationalLayerType\",void 0),e([l()],S.prototype,\"sourceJSON\",void 0),e([l({json:{read:!1},value:\"elevation\",readOnly:!0})],S.prototype,\"type\",void 0),e([l(f)],S.prototype,\"url\",void 0),e([l()],S.prototype,\"version\",void 0),e([n(\"version\",[\"currentVersion\"])],S.prototype,\"readVersion\",null),S=e([c(\"esri.layers.ElevationLayer\")],S);const w=Symbol(\"default-fetch-tile\");S.prototype.fetchTile[w]=!0;const T=S;export{T as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import{constant as i}from\"../../core/arrayUtils.js\";import e from\"../../core/Error.js\";import{clone as a}from\"../../core/lang.js\";import{estimateSize as o}from\"../../core/typedArrayUtil.js\";import{newUintArray as l}from\"../../geometry/support/UintArray.js\";class r{constructor(t){this._validateJSON(t);const{location:i,data:e}=t;this.location=Object.freeze(a(i));const r=this.location.width,n=this.location.height;let s=!0,h=!0;const c=Math.ceil(r*n/32),m=l(c);let f=0;for(let a=0;a<e.length;a++){const t=a%32;e[a]?(h=!1,m[f]|=1<<t):s=!1,31===t&&++f}h?(this._availability=\"unavailable\",this.byteSize=40):s?(this._availability=\"available\",this.byteSize=40):(this._availability=m,this.byteSize=40+o(m))}getAvailability(t,i){if(\"unavailable\"===this._availability||\"available\"===this._availability)return this._availability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%32,o=e>>5,l=this._availability;return o<0||o>l.length?\"unknown\":l[o]&1<<a?\"available\":\"unavailable\"}static fromDefinition(a,o){const l=a.service.request||t,{row:n,col:h,width:c,height:m}=a,f={query:{f:\"json\"}};return o=o?{...f,...o}:f,l(s(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:n,left:h,width:c,height:m},valid:!0,data:i(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==n||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new e(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:n,left:h,width:c,height:m}});return r.fromJSON(t)}))}static fromJSON(t){return Object.freeze(new r(t))}_validateJSON(t){if(!t||!t.location)throw new e(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new e(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new e(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new e(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new e(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function n(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function s(t){let i;if(t.service.tileServers?.length){const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;const e=t.service.query;return e&&(i=`${i}?${e}`),i}export{r as Tilemap,n as tilemapDefinitionId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import i from\"../../core/Accessor.js\";import{ByteSizeUnit as r}from\"../../core/ByteSizeUnit.js\";import s from\"../../core/Error.js\";import{makeHandle as l}from\"../../core/handleUtils.js\";import{LRUCache as o}from\"../../core/LRUCache.js\";import a from\"../../core/PooledArray.js\";import{onAbort as n,createAbortError as c,isAbortError as h,isAborted as p}from\"../../core/promiseUtils.js\";import{watch as m,initial as f}from\"../../core/reactiveUtils.js\";import{waitTicks as u}from\"../../core/scheduling.js\";import{objectToQuery as v}from\"../../core/urlUtils.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{TileKey as _}from\"./TileKey.js\";import{tilemapDefinitionId as b,Tilemap as g}from\"./Tilemap.js\";var w;let T=w=class extends i{constructor(e){super(e),this._pendingTilemapRequests={},this.request=t,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new o(2*r.MEGABYTES),this.addHandles([m((()=>{const{layer:e}=this;return[e?.parsedUrl,e?.tileServers,e?.apiKey,e?.customParameters]}),(()=>this._initializeTilemapDefinition()),f)])}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(e,t,i,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new s(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const l=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,i,l);if(o)return Promise.resolve(o);const a=r&&r.signal;return r={...r,signal:null},new Promise(((e,t)=>{n(a,(()=>t(c())));const i=b(l);let s=this._pendingTilemapRequests[i];if(!s){s=g.fromDefinition(l,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=s,s.then(e,e)}s.then(e,t)}))}getAvailability(e,t,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return\"unavailable\";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):\"unknown\"}fetchAvailability(e,t,i,r){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new s(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):this.fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof g){const l=r.getAvailability(t,i);if(\"unavailable\"===l)throw new s(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i});return l}if(h(r))throw r;return\"unknown\"}))}fetchAvailabilityUpsample(e,t,i,r,s){r.level=e,r.row=t,r.col=i;const l=this.layer.tileInfo;l.updateTileInfo(r);const o=this.fetchAvailability(e,t,i,s).catch((e=>{if(h(e))throw e;if(l.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r,s);throw e}));return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,s,o),o}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,s,o){if(!this._prefetchingEnabled||null==e)return;const a=`prefetch-${e}`;if(this.hasHandles(a))return;const n=new AbortController;o.then((()=>n.abort()),(()=>n.abort()));let c=!1;const h=l((()=>{c||(c=!0,n.abort())}));if(this.addHandles(h,a),await u(10,n.signal).catch((()=>{})),c||(c=!0,this.removeHandles(a)),p(n))return;const m=new _(e,t,i,r),f={...s,signal:n.signal},v=this.layer.tileInfo;for(let l=0;w._prefetches.length<w._maxPrefetch&&v.upsampleTile(m);++l){const e=this.fetchAvailability(m.level,m.row,m.col,f);w._prefetches.push(e);const t=()=>{w._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:v({...e.query,...i,token:t??e.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const s=b(r);return this._tilemapCache.get(s)}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,r)=>!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}};T._maxPrefetch=4,T._prefetches=new a({initialSize:w._maxPrefetch}),e([y({constructOnly:!0})],T.prototype,\"layer\",void 0),e([y({constructOnly:!0})],T.prototype,\"minLOD\",void 0),e([y({constructOnly:!0})],T.prototype,\"maxLOD\",void 0),e([y({constructOnly:!0})],T.prototype,\"request\",void 0),e([y({constructOnly:!0})],T.prototype,\"size\",void 0),T=w=e([d(\"esri.layers.support.TilemapCache\")],T);export{T as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{NATIVE_ARRAY_MAX_SIZE as r,isArray as n}from\"../../core/typedArrayUtil.js\";function t(n,t=!1){return n<=r?t?new Array(n).fill(0):new Array(n):new Uint32Array(n)}function e(t){return(n(t)?t.length:t.byteLength/8)<=r?Array.from(t):new Uint32Array(t)}function y(r,n,t){return Array.isArray(r)?r.slice(n,n+t):r.subarray(n,n+t)}export{t as newUintArray,e as uintArrayFrom,y as uintSubArray};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport l from\"../../core/Error.js\";import{waitTick as t,isAbortError as i}from\"../../core/promiseUtils.js\";class e{constructor(l,t=0,i=l.lods[l.lods.length-1].level){this.tileInfo=l,this.minLOD=t,this.maxLOD=i,l.lodAt(t)||(this.minLOD=l.lods[0].level),l.lodAt(i)||(this.maxLOD=l.lods[l.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(l,t,i){const e=this.tileInfo?.lodAt(l);return!e||l<this.minLOD||l>this.maxLOD?\"unavailable\":e.cols&&e.rows?i>=e.cols[0]&&i<=e.cols[1]&&t>=e.rows[0]&&t<=e.rows[1]?\"unknown\":\"unavailable\":\"unknown\"}async fetchAvailability(i,e,o,s){await t(s);const a=this.getAvailability(i,e,o);if(\"unavailable\"===a)throw new l(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:i,row:e,col:o});return a}async fetchAvailabilityUpsample(l,e,o,s,a){await t(a),s.level=l,s.row=e,s.col=o;const n=this.tileInfo;return n.updateTileInfo(s),this.fetchAvailability(l,e,o,a).catch((l=>{if(i(l))throw l;if(n.upsampleTile(s))return this.fetchAvailabilityUpsample(s.level,s.row,s.col,s,a);throw l}))}}export{e as default};\n"],"sourceRoot":""}
{"version":3,"sources":["../node_modules/@arcgis/core/layers/mixins/ArcGISCachedService.js","../node_modules/@arcgis/core/layers/TileLayer.js","../node_modules/@arcgis/core/layers/support/Tilemap.js","../node_modules/@arcgis/core/layers/support/TilemapCache.js","../node_modules/@arcgis/core/geometry/support/UintArray.js","../node_modules/@arcgis/core/layers/support/TileInfoTilemapCache.js"],"names":["p","n","_p","_inherits","_super","_createSuper","_this","_classCallCheck","apply","arguments","copyright","minScale","maxScale","spatialReference","tileInfo","tilemapCache","_createClass","key","value","_this$tilemapCache","_this$tilemapCache$de","this","destroy","call","e","o","minLOD","maxLOD","get","version","r","_o$capabilities","t","capabilities","includes","a","c","Math","round","lods","scale","length","_step","_iterator","_createForOfIteratorHelper","s","done","level","err","f","layer","l","read","i","json","source","prototype","type","readOnly","W","B","C","_j","_len","Array","_key","concat","listMode","isReference","operationalLayerType","resampling","sourceJSON","path","sublayers","url","_objectSpread","_this2","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","_this$parsedUrl","parsedUrl","toLowerCase","_getDefaultAttribution","_getMapName","y","fromJSON","loaded","slice","reverse","flatten","_ref","toArray","writeSublayerStructure","forEach","write","push","some","Object","keys","layers","_this$parsedUrl2","_getDefaultTileServers","isArray","map","undefined","getTileUrl","responseType","query","refreshParameters","data","_fetchImageBitmapTile","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_r","_yield$r","_args","wrap","_context","prev","next","fetchTile","sent","abrupt","M","stop","_x","_x2","_x3","_this$parsedUrl3","_this$parsedUrl4","operations","supportsTileMap","supportsBlankTile","blankTile","customParameters","token","apiKey","tileServers","_this3","allSublayers","_this4","bandCount","pixelSizeX","U","serverType","ssl","replace","origin","P","_fetchServerVersion","currentVersion","x","reject","match","search","N","j","L","R","g","S","b","w","_","O","v","T","Boolean","enabled","overridePolicy","m","String","origins","d","I","u","A","h","Symbol","k","_validateJSON","location","freeze","width","height","fill","Uint32Array","ceil","_availability","byteSize","top","left","valid","service","request","row","col","_t$service$tileServer","details","httpStatus","response","definition","_i","_pendingTilemapRequests","size","_prefetchingEnabled","_tilemapCache","MEGABYTES","addHandles","_initializeTilemapDefinition","_this$minLOD","_this$maxLOD","lodAt","effectiveMinLOD","effectiveMaxLOD","_tmpTilemapDefinition","_tilemapFromCache","fromDefinition","put","getAvailability","fetchTilemap","updateTileInfo","fetchAvailability","upsampleTile","fetchAvailabilityUpsample","_fetchAvailabilityUpsamplePrefetch","id","_fetchAvailabilityUpsamplePrefetch2","_loop","_this5","_context2","hasHandles","AbortController","abort","removeHandles","_prefetches","removeUnordered","_maxPrefetch","delegateYield","_x4","_x5","_x6","_e$query","_this$layer","clear","prefetchingEnabled","hasTilemap","initialSize","constructOnly","_this$tileInfo","cols","rows","_fetchAvailability","_fetchAvailabilityUpsample","_callee2","_x7","_x8","_x9"],"mappings":"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","file":"static/js/224.42ce7792.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{reader as r}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import l from\"../support/TileInfo.js\";import i from\"../support/TileInfoTilemapCache.js\";import{TilemapCache as s}from\"../support/TilemapCache.js\";import a from\"../../geometry/SpatialReference.js\";const p=p=>{let n=class extends p{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,o){return null!=o.minLOD&&null!=o.maxLOD?e:0}readMaxScale(e,o){return null!=o.minLOD&&null!=o.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,o,r){const t=o.capabilities?.includes(\"Tilemap\");let{minLOD:a,maxLOD:p,minScale:n,maxScale:c}=o;if(null==a&&null==p&&0!==n&&0!==c){const e=e=>Math.round(1e4*e)/1e4;n=e(n||o.tileInfo.lods[0].scale),c=e(c||o.tileInfo.lods[o.tileInfo.lods.length-1].scale);for(const r of o.tileInfo.lods){const o=e(r.scale);a=o>=n?r.level:a,p=o>=c?r.level:p}}if(t)return new s({layer:this,minLOD:a,maxLOD:p});if(o.tileInfo){const e=new l;return e.read(o.tileInfo,r),new i(e,a,p)}return null}};return e([o({json:{read:{source:\"copyrightText\"}}})],n.prototype,\"copyright\",void 0),e([o()],n.prototype,\"minScale\",void 0),e([r(\"service\",\"minScale\")],n.prototype,\"readMinScale\",null),e([o()],n.prototype,\"maxScale\",void 0),e([r(\"service\",\"maxScale\")],n.prototype,\"readMaxScale\",null),e([o({type:a})],n.prototype,\"spatialReference\",void 0),e([o({readOnly:!0})],n.prototype,\"supportsBlankTile\",null),e([o({type:l})],n.prototype,\"tileInfo\",void 0),e([o()],n.prototype,\"tilemapCache\",void 0),e([r(\"service\",\"tilemapCache\",[\"capabilities\",\"tileInfo\"])],n.prototype,\"readTilemapCache\",null),e([o()],n.prototype,\"version\",void 0),n=e([t(\"esri.layers.mixins.ArcGISCachedService\")],n),n};export{p as ArcGISCachedService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../request.js\";import t from\"../core/Error.js\";import{HandleOwnerMixin as s}from\"../core/HandleOwner.js\";import{loadAll as i}from\"../core/loadAll.js\";import{MultiOriginJSONMixin as o}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as a}from\"../core/promiseUtils.js\";import{urlToObject as l,objectToQuery as n,makeAbsolute as p}from\"../core/urlUtils.js\";import{property as c}from\"../core/accessorSupport/decorators/property.js\";import{cast as u}from\"../core/accessorSupport/decorators/cast.js\";import\"../core/arrayUtils.js\";import\"../core/has.js\";import{reader as m}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as h}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as d}from\"../core/accessorSupport/decorators/writer.js\";import y from\"../geometry/SpatialReference.js\";import f from\"./Layer.js\";import{APIKeyMixin as v}from\"./mixins/APIKeyMixin.js\";import{ArcGISCachedService as g}from\"./mixins/ArcGISCachedService.js\";import{ArcGISMapService as S}from\"./mixins/ArcGISMapService.js\";import{ArcGISService as _}from\"./mixins/ArcGISService.js\";import{BlendLayer as j}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as T}from\"./mixins/CustomParametersMixin.js\";import{OperationalLayer as b}from\"./mixins/OperationalLayer.js\";import{PortalLayer as w}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as O}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as L}from\"./mixins/ScaleRangeLayer.js\";import{SublayersOwner as R}from\"./mixins/SublayersOwner.js\";import{parse as U,isHostedAgolService as P,isArcGISUrl as x}from\"./support/arcgisLayerUrl.js\";import{url as A}from\"./support/commonProperties.js\";import{createTileBitmap as M}from\"./support/imageBitmapUtils.js\";import I from\"./support/Sublayer.js\";var W;const B=[\"Canvas/World_Dark_Gray_Base\",\"Canvas/World_Dark_Gray_Reference\",\"Canvas/World_Light_Gray_Base\",\"Canvas/World_Light_Gray_Reference\",\"Elevation/World_Hillshade\",\"Elevation/World_Hillshade_Dark\",\"Ocean/World_Ocean_Base\",\"Ocean/World_Ocean_Reference\",\"Ocean_Basemap\",\"Reference/World_Boundaries_and_Places\",\"Reference/World_Boundaries_and_Places_Alternate\",\"Reference/World_Transportation\",\"World_Imagery\",\"World_Street_Map\",\"World_Topo_Map\"];let C=W=class extends(j(L(R(g(S(b(w(_(o(s(O(v(T(f)))))))))))))){constructor(...e){super(...e),this.listMode=\"show\",this.isReference=null,this.operationalLayerType=\"ArcGISTiledMapServiceLayer\",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type=\"tile\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).catch(a).then((()=>this._fetchService(r)))),Promise.resolve(this)}get attributionDataUrl(){const e=this.parsedUrl?.path.toLowerCase();return e?this._getDefaultAttribution(this._getMapName(e)):null}readSpatialReference(e,r){return(e=e||r.tileInfo&&r.tileInfo.spatialReference)&&y.fromJSON(e)}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),o=[],a={writeSublayerStructure:!1,...s};i.forEach((e=>{const r=e.write({},a);o.push(r)}));o.some((e=>Object.keys(e).length>1))&&(r.layers=o)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl?.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>l(e).path)):null}fetchTile(e,t,s,i={}){const{signal:o}=i,a=this.getTileUrl(e,t,s),l={responseType:\"image\",signal:o,query:{...this.refreshParameters}};return r(a,l).then((e=>e.data))}async fetchImageBitmapTile(e,t,s,i={}){const{signal:o}=i;if(this.fetchTile!==W.prototype.fetchTile){const r=await this.fetchTile(e,t,s,i);return M(r,e,t,s,o)}const a=this.getTileUrl(e,t,s),l={responseType:\"blob\",signal:o,query:{...this.refreshParameters}},{data:n}=await r(a,l);return M(n,e,t,s,o)}getTileUrl(e,r,t){const s=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,i=n({...this.parsedUrl?.query,blankTile:!s&&null,...this.customParameters,token:this.apiKey}),o=this.tileServers;return`${o&&o.length?o[r%o.length]:this.parsedUrl?.path}/tile/${e}/${r}/${t}${i?\"?\"+i:\"\"}`}loadAll(){return i(this,(e=>{e(this.allSublayers)}))}_fetchService(e){return new Promise(((s,i)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new t(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");return void s({data:this.sourceJSON})}if(!this.parsedUrl)throw new t(\"tile-layer:undefined-url\",\"layer's url is not defined\");const o=U(this.parsedUrl.path);if(null!=o&&\"ImageServer\"===o.serverType)throw new t(\"tile-layer:unsupported-url\",\"use ImageryTileLayer to open a tiled image service\");r(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},responseType:\"json\",signal:e}).then(s,i)})).then((r=>{let t=this.url;if(r.ssl&&(t=this.url=t.replace(/^http:/i,\"https:\")),this.sourceJSON=r.data,this.read(r.data,{origin:\"service\",url:this.parsedUrl}),10.1===this.version&&!P(t))return this._fetchServerVersion(t,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,s){if(!x(e))return Promise.reject();const i=e.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";return r(i,{query:{f:\"json\",...this.customParameters,token:this.apiKey},responseType:\"json\",signal:s}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new t(\"tile-layer:version-not-available\")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\\/\\/(server\\.arcgisonline\\.com|services\\.arcgisonline\\.com|ibasemaps-api\\.arcgis\\.com)\\/arcgis\\/rest\\/services\\/([^\\/]+(\\/[^\\/]+)*)\\/mapserver/i);return r?r[2]:void 0}_getDefaultAttribution(e){if(null==e)return null;let r;e=e.toLowerCase();for(let t=0,s=B.length;t<s;t++)if(r=B[t],r.toLowerCase().includes(e))return p(\"//static.arcgis.com/attribution/\"+r);return null}_getDefaultTileServers(e){if(null==e)return[];const r=-1!==e.search(/^(?:https?:)?\\/\\/server\\.arcgisonline\\.com/i),t=-1!==e.search(/^(?:https?:)?\\/\\/services\\.arcgisonline\\.com/i);return r||t?[e,e.replace(r?/server\\.arcgisonline/i:/services\\.arcgisonline/i,r?\"services.arcgisonline\":\"server.arcgisonline\")]:[]}get hasOverriddenFetchTile(){return!this.fetchTile[N]}};e([c({readOnly:!0})],C.prototype,\"attributionDataUrl\",null),e([c({type:[\"show\",\"hide\",\"hide-children\"]})],C.prototype,\"listMode\",void 0),e([c({json:{read:!0,write:!0}})],C.prototype,\"blendMode\",void 0),e([c({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],C.prototype,\"isReference\",void 0),e([c({readOnly:!0,type:[\"ArcGISTiledMapServiceLayer\"]})],C.prototype,\"operationalLayerType\",void 0),e([c({type:Boolean})],C.prototype,\"resampling\",void 0),e([c()],C.prototype,\"sourceJSON\",void 0),e([c({type:y})],C.prototype,\"spatialReference\",void 0),e([m(\"spatialReference\",[\"spatialReference\",\"tileInfo\"])],C.prototype,\"readSpatialReference\",null),e([c({type:String,json:{origins:{\"web-scene\":{read:!0,write:!0}},read:!1}})],C.prototype,\"path\",void 0),e([c({readOnly:!0})],C.prototype,\"sublayers\",void 0),e([d(\"sublayers\",{layers:{type:[I]}})],C.prototype,\"writeSublayers\",null),e([c({json:{read:!1,write:!1}})],C.prototype,\"popupEnabled\",void 0),e([c()],C.prototype,\"tileServers\",null),e([u(\"tileServers\")],C.prototype,\"castTileServers\",null),e([c({readOnly:!0,json:{read:!1}})],C.prototype,\"type\",void 0),e([c(A)],C.prototype,\"url\",void 0),C=W=e([h(\"esri.layers.TileLayer\")],C);const N=Symbol(\"default-fetch-tile\");C.prototype.fetchTile[N]=!0;const k=C;export{k as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport t from\"../../request.js\";import{constant as i}from\"../../core/arrayUtils.js\";import e from\"../../core/Error.js\";import{clone as a}from\"../../core/lang.js\";import{estimateSize as o}from\"../../core/typedArrayUtil.js\";import{newUintArray as l}from\"../../geometry/support/UintArray.js\";class r{constructor(t){this._validateJSON(t);const{location:i,data:e}=t;this.location=Object.freeze(a(i));const r=this.location.width,n=this.location.height;let s=!0,h=!0;const c=Math.ceil(r*n/32),m=l(c);let f=0;for(let a=0;a<e.length;a++){const t=a%32;e[a]?(h=!1,m[f]|=1<<t):s=!1,31===t&&++f}h?(this._availability=\"unavailable\",this.byteSize=40):s?(this._availability=\"available\",this.byteSize=40):(this._availability=m,this.byteSize=40+o(m))}getAvailability(t,i){if(\"unavailable\"===this._availability||\"available\"===this._availability)return this._availability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%32,o=e>>5,l=this._availability;return o<0||o>l.length?\"unknown\":l[o]&1<<a?\"available\":\"unavailable\"}static fromDefinition(a,o){const l=a.service.request||t,{row:n,col:h,width:c,height:m}=a,f={query:{f:\"json\"}};return o=o?{...f,...o}:f,l(s(a),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return{location:{top:n,left:h,width:c,height:m},valid:!0,data:i(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==n||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new e(\"tilemap:location-mismatch\",\"Tilemap response for different location than requested\",{response:t,definition:{top:n,left:h,width:c,height:m}});return r.fromJSON(t)}))}static fromJSON(t){return Object.freeze(new r(t))}_validateJSON(t){if(!t||!t.location)throw new e(\"tilemap:missing-location\",\"Location missing from tilemap response\");if(!1===t.valid)throw new e(\"tilemap:invalid\",\"Tilemap response was marked as invalid\");if(!t.data)throw new e(\"tilemap:missing-data\",\"Data missing from tilemap response\");if(!Array.isArray(t.data))throw new e(\"tilemap:data-mismatch\",\"Data must be an array of numbers\");if(t.data.length!==t.location.width*t.location.height)throw new e(\"tilemap:data-mismatch\",\"Number of data items does not match width/height of tilemap\")}}function n(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function s(t){let i;if(t.service.tileServers?.length){const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;const e=t.service.query;return e&&(i=`${i}?${e}`),i}export{r as Tilemap,n as tilemapDefinitionId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../request.js\";import i from\"../../core/Accessor.js\";import{ByteSizeUnit as r}from\"../../core/ByteSizeUnit.js\";import s from\"../../core/Error.js\";import{makeHandle as l}from\"../../core/handleUtils.js\";import{LRUCache as o}from\"../../core/LRUCache.js\";import a from\"../../core/PooledArray.js\";import{onAbort as n,createAbortError as c,isAbortError as h,isAborted as p}from\"../../core/promiseUtils.js\";import{watch as m,initial as f}from\"../../core/reactiveUtils.js\";import{waitTicks as u}from\"../../core/scheduling.js\";import{objectToQuery as v}from\"../../core/urlUtils.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{TileKey as _}from\"./TileKey.js\";import{tilemapDefinitionId as b,Tilemap as g}from\"./Tilemap.js\";var w;let T=w=class extends i{constructor(e){super(e),this._pendingTilemapRequests={},this.request=t,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new o(2*r.MEGABYTES),this.addHandles([m((()=>{const{layer:e}=this;return[e?.parsedUrl,e?.tileServers,e?.apiKey,e?.customParameters]}),(()=>this._initializeTilemapDefinition()),f)])}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(e,t,i,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new s(\"tilemap-cache:level-unavailable\",`Level ${e} is unavailable in the service`));const l=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,i,l);if(o)return Promise.resolve(o);const a=r&&r.signal;return r={...r,signal:null},new Promise(((e,t)=>{n(a,(()=>t(c())));const i=b(l);let s=this._pendingTilemapRequests[i];if(!s){s=g.fromDefinition(l,r).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=s,s.then(e,e)}s.then(e,t)}))}getAvailability(e,t,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return\"unavailable\";const r=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return r?r.getAvailability(t,i):\"unknown\"}fetchAvailability(e,t,i,r){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new s(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i})):this.fetchTilemap(e,t,i,r).catch((e=>e)).then((r=>{if(r instanceof g){const l=r.getAvailability(t,i);if(\"unavailable\"===l)throw new s(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:e,row:t,col:i});return l}if(h(r))throw r;return\"unknown\"}))}fetchAvailabilityUpsample(e,t,i,r,s){r.level=e,r.row=t,r.col=i;const l=this.layer.tileInfo;l.updateTileInfo(r);const o=this.fetchAvailability(e,t,i,s).catch((e=>{if(h(e))throw e;if(l.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r,s);throw e}));return this._fetchAvailabilityUpsamplePrefetch(r.id,e,t,i,s,o),o}async _fetchAvailabilityUpsamplePrefetch(e,t,i,r,s,o){if(!this._prefetchingEnabled||null==e)return;const a=`prefetch-${e}`;if(this.hasHandles(a))return;const n=new AbortController;o.then((()=>n.abort()),(()=>n.abort()));let c=!1;const h=l((()=>{c||(c=!0,n.abort())}));if(this.addHandles(h,a),await u(10,n.signal).catch((()=>{})),c||(c=!0,this.removeHandles(a)),p(n))return;const m=new _(e,t,i,r),f={...s,signal:n.signal},v=this.layer.tileInfo;for(let l=0;w._prefetches.length<w._maxPrefetch&&v.upsampleTile(m);++l){const e=this.fetchAvailability(m.level,m.row,m.col,f);w._prefetches.push(e);const t=()=>{w._prefetches.removeUnordered(e)};e.then(t,t)}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:v({...e.query,...i,token:t??e.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,i,r){r.level=e,r.row=t-t%this.size,r.col=i-i%this.size;const s=b(r);return this._tilemapCache.get(s)}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,i,r)=>!!e._tilemapFromCache(t,i,r,e._tmpTilemapDefinition)}}};T._maxPrefetch=4,T._prefetches=new a({initialSize:w._maxPrefetch}),e([y({constructOnly:!0})],T.prototype,\"layer\",void 0),e([y({constructOnly:!0})],T.prototype,\"minLOD\",void 0),e([y({constructOnly:!0})],T.prototype,\"maxLOD\",void 0),e([y({constructOnly:!0})],T.prototype,\"request\",void 0),e([y({constructOnly:!0})],T.prototype,\"size\",void 0),T=w=e([d(\"esri.layers.support.TilemapCache\")],T);export{T as TilemapCache};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{NATIVE_ARRAY_MAX_SIZE as r,isArray as n}from\"../../core/typedArrayUtil.js\";function t(n,t=!1){return n<=r?t?new Array(n).fill(0):new Array(n):new Uint32Array(n)}function e(t){return(n(t)?t.length:t.byteLength/8)<=r?Array.from(t):new Uint32Array(t)}function y(r,n,t){return Array.isArray(r)?r.slice(n,n+t):r.subarray(n,n+t)}export{t as newUintArray,e as uintArrayFrom,y as uintSubArray};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport l from\"../../core/Error.js\";import{waitTick as t,isAbortError as i}from\"../../core/promiseUtils.js\";class e{constructor(l,t=0,i=l.lods[l.lods.length-1].level){this.tileInfo=l,this.minLOD=t,this.maxLOD=i,l.lodAt(t)||(this.minLOD=l.lods[0].level),l.lodAt(i)||(this.maxLOD=l.lods[l.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(l,t,i){const e=this.tileInfo?.lodAt(l);return!e||l<this.minLOD||l>this.maxLOD?\"unavailable\":e.cols&&e.rows?i>=e.cols[0]&&i<=e.cols[1]&&t>=e.rows[0]&&t<=e.rows[1]?\"unknown\":\"unavailable\":\"unknown\"}async fetchAvailability(i,e,o,s){await t(s);const a=this.getAvailability(i,e,o);if(\"unavailable\"===a)throw new l(\"tile-map:tile-unavailable\",\"Tile is not available\",{level:i,row:e,col:o});return a}async fetchAvailabilityUpsample(l,e,o,s,a){await t(a),s.level=l,s.row=e,s.col=o;const n=this.tileInfo;return n.updateTileInfo(s),this.fetchAvailability(l,e,o,a).catch((l=>{if(i(l))throw l;if(n.upsampleTile(s))return this.fetchAvailabilityUpsample(s.level,s.row,s.col,s,a);throw l}))}}export{e as default};\n"],"sourceRoot":""}
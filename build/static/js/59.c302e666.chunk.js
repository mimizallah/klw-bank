(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[59],{1018:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var a=i(92),n=i(89),r=i(88),l=i(90),o=i(91),c=i(94),s=(i(119),i(97)),u=(i(96),i(98),i(93),i(136)),h=i(95),v=i(323),p=i(808),f=i(708),b=i(125),d=function(e){var t=function(e){Object(l.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).copyright=null,e.minScale=0,e.maxScale=0,e.spatialReference=null,e.tileInfo=null,e.tilemapCache=null,e}return Object(r.a)(i,[{key:"destroy",value:function(){var e,t;null===(e=this.tilemapCache)||void 0===e||null===(t=e.destroy)||void 0===t||t.call(e)}},{key:"readMinScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"readMaxScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"supportsBlankTile",get:function(){return this.version>=10.2}},{key:"readTilemapCache",value:function(e,t,i){var n,r=null===(n=t.capabilities)||void 0===n?void 0:n.includes("Tilemap"),l=t.minLOD,o=t.maxLOD,c=t.minScale,s=t.maxScale;if(null==l&&null==o&&0!==c&&0!==s){var u=function(e){return Math.round(1e4*e)/1e4};c=u(c||t.tileInfo.lods[0].scale),s=u(s||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);var h,b=Object(a.a)(t.tileInfo.lods);try{for(b.s();!(h=b.n()).done;){var d=h.value,y=u(d.scale);l=y>=c?d.level:l,o=y>=s?d.level:o}}catch(m){b.e(m)}finally{b.f()}}if(r)return new f.a({layer:this,minLOD:l,maxLOD:o});if(t.tileInfo){var O=new v.a;return O.read(t.tileInfo,i),new p.a(O,l,o)}return null}}]),i}(e);return Object(c.a)([Object(s.b)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),Object(c.a)([Object(s.b)()],t.prototype,"minScale",void 0),Object(c.a)([Object(u.a)("service","minScale")],t.prototype,"readMinScale",null),Object(c.a)([Object(s.b)()],t.prototype,"maxScale",void 0),Object(c.a)([Object(u.a)("service","maxScale")],t.prototype,"readMaxScale",null),Object(c.a)([Object(s.b)({type:b.a})],t.prototype,"spatialReference",void 0),Object(c.a)([Object(s.b)({readOnly:!0})],t.prototype,"supportsBlankTile",null),Object(c.a)([Object(s.b)({type:v.a})],t.prototype,"tileInfo",void 0),Object(c.a)([Object(s.b)()],t.prototype,"tilemapCache",void 0),Object(c.a)([Object(u.a)("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),Object(c.a)([Object(s.b)()],t.prototype,"version",void 0),t=Object(c.a)([Object(h.a)("esri.layers.mixins.ArcGISCachedService")],t)}},1779:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return N}));var a=i(4),n=i(12),r=i(1),l=i(89),o=i(88),c=i(90),s=i(91),u=i(94),h=i(129),v=i(101),p=i(111),f=i(281),b=i(110),d=i(128),y=i(97),O=(i(96),i(98)),m=(i(93),i(136)),j=i(95),w=i(668),g=i(259),_=i(1018),k=i(485),D=i(311),x=i(326),T=i(244),S=i(92),L=function(){function e(t,i,a,n){Object(l.a)(this,e),this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,"pixelData"in t?(this.values=t.pixelData,this.width=t.width,this.height=t.height,this.noDataValue=t.noDataValue):(this.values=t,this.width=i,this.height=a,this.noDataValue=n)}return Object(o.a)(e,[{key:"hasNoDataValues",get:function(){if(null==this._hasNoDataValues){var e=this.noDataValue;this._hasNoDataValues=this.values.includes(e)}return this._hasNoDataValues}},{key:"minValue",get:function(){return this._ensureBounds(),this._minValue}},{key:"maxValue",get:function(){return this._ensureBounds(),this._maxValue}},{key:"_ensureBounds",value:function(){if(null==this._minValue){var e,t=this.noDataValue,i=this.values,a=1/0,n=-1/0,r=!0,l=Object(S.a)(i);try{for(l.s();!(e=l.n()).done;){var o=e.value;o===t?this._hasNoDataValues=!0:(a=o<a?o:a,n=o>n?o:n,r=!1)}}catch(c){l.e(c)}finally{l.f()}r?(this._minValue=0,this._maxValue=0):(this._minValue=a,this._maxValue=n>-3e38?n:0)}}}]),e}(),I=i(287),A=i(102),M=i(452),V=function(){function e(t,i,a,n){var o=this,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};Object(l.a)(this,e),this._mainMethod=i,this._transferLists=a,this._listeners=[],this._promise=Object(M.b)(t,Object(r.a)(Object(r.a)({},c),{},{schedule:n})).then((function(e){if(void 0===o._thread){o._thread=e,o._promise=null,c.hasInitialize&&o.broadcast({},"initialize");var t,i=Object(S.a)(o._listeners);try{for(i.s();!(t=i.n()).done;){var a=t.value;o._connectListener(a)}}catch(n){i.e(n)}finally{i.f()}}else e.close()})),this._promise.catch((function(e){return A.a.getLogger("esri.core.workers.WorkerHandle").error("Failed to initialize ".concat(t," worker: ").concat(e))}))}return Object(o.a)(e,[{key:"on",value:function(e,t){var i=this,a={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(a),this._connectListener(a),Object(I.b)((function(){a.removed=!0,Object(O.k)(i._listeners,a),i._thread&&null!=a.threadHandle&&a.threadHandle.remove()}))}},{key:"destroy",value:function(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}},{key:"invoke",value:function(e,t){return this.invokeMethod(this._mainMethod,e,t)}},{key:"invokeMethod",value:function(e,t,i){var a=this;if(this._thread){var n=this._transferLists[e],r=n?n(t):[];return this._thread.invoke(e,t,{transferList:r,signal:i})}return this._promise?this._promise.then((function(){return Object(b.n)(i),a.invokeMethod(e,t,i)})):Promise.reject(null)}},{key:"broadcast",value:function(e,t){var i=this;return this._thread?Promise.all(this._thread.broadcast(t,e)).then((function(){})):this._promise?this._promise.then((function(){return i.broadcast(e,t)})):Promise.reject()}},{key:"promise",get:function(){return this._promise}},{key:"_connectListener",value:function(e){this._thread&&this._thread.on(e.eventName,e.callback).then((function(t){e.removed||(e.threadHandle=t)}))}}]),e}(),C=function(e){Object(c.a)(i,e);var t=Object(s.a)(i);function i(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(l.a)(this,i),(e=t.call(this,"LercWorker","_decode",{_decode:function(e){return[e.buffer]}},a,{strategy:"dedicated"})).schedule=a,e.ref=0,e}return Object(o.a)(i,[{key:"decode",value:function(e,t,i){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},i):Promise.resolve(null)}},{key:"release",value:function(){var e=this;--this.ref<=0&&(q.forEach((function(t,i){t===e&&q.delete(i)})),this.destroy())}}]),i}(V),q=new Map;var z=function(e){Object(c.a)(u,e);var t=Object(s.a)(u);function u(){var e;Object(l.a)(this,u);for(var i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))).capabilities={operations:{supportsTileMap:!1}},e.copyright=null,e.heightModelInfo=null,e.path=null,e.minScale=void 0,e.maxScale=void 0,e.opacity=1,e.operationalLayerType="ArcGISTiledElevationServiceLayer",e.sourceJSON=null,e.type="elevation",e.url=null,e.version=null,e._lercDecoder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=q.get(e);return t||(null!=e?(t=new C((function(t){return e.immediate.schedule(t)})),q.set(e,t)):(t=new C,q.set(null,t))),++t.ref,t}(),e}return Object(o.a)(u,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(r.a)({url:e},t):e}},{key:"destroy",value:function(){this._lercDecoder=Object(p.k)(this._lercDecoder)}},{key:"readCapabilities",value:function(e,t){var i=t.capabilities&&t.capabilities.split(",").map((function(e){return e.toLowerCase().trim()}));return i?{operations:{supportsTileMap:i.includes("tilemap")}}:{operations:{supportsTileMap:!1}}}},{key:"readVersion",value:function(e,t){var i=t.currentVersion;return i||(i=9.3),i}},{key:"load",value:function(e){var t=this,i=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new v.a("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).catch(b.m).then((function(){return t._fetchImageService(i)}))),Promise.resolve(this)}},{key:"fetchTile",value:function(e,t,i,a){var n=this,r=null!=(a=a||{signal:null}).signal?a.signal:a.signal=(new AbortController).signal,l={responseType:"array-buffer",signal:r},o={noDataValue:a.noDataValue,returnFileInfo:!0};return this.load().then((function(){return n._fetchTileAvailability(e,t,i,a)})).then((function(){return Object(h.default)(n.getTileUrl(e,t,i),l)})).then((function(e){return n._lercDecoder.decode(e.data,o,r)})).then((function(e){return new L(e)}))}},{key:"getTileUrl",value:function(e,t,i){var a=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,n=Object(d.I)(Object(r.a)(Object(r.a)({},this.parsedUrl.query),{},{blankTile:!a&&null}));return"".concat(this.parsedUrl.path,"/tile/").concat(e,"/").concat(t,"/").concat(i).concat(n?"?"+n:"")}},{key:"queryElevation",value:function(){var e=Object(n.a)(Object(a.a)().mark((function e(t,n){var r,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(29).then(i.bind(null,2265));case 2:return r=e.sent,l=r.ElevationQuery,Object(b.n)(n),e.abrupt("return",(new l).query(this,t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"createElevationSampler",value:function(){var e=Object(n.a)(Object(a.a)().mark((function e(t,n){var r,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(29).then(i.bind(null,2265));case 2:return r=e.sent,l=r.ElevationQuery,Object(b.n)(n),e.abrupt("return",(new l).createSampler(this,t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_fetchTileAvailability",value:function(e,t,i,a){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,i,a):Promise.resolve("unknown")}},{key:"_fetchImageService",value:function(){var e=Object(n.a)(Object(a.a)().mark((function e(t){var i,n,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sourceJSON){e.next=2;break}return e.abrupt("return",this.sourceJSON);case 2:return n={query:Object(r.a)({f:"json"},this.parsedUrl.query),responseType:"json",signal:t},e.next=5,Object(h.default)(this.parsedUrl.path,n);case 5:(l=e.sent).ssl&&(this.url=null===(i=this.url)||void 0===i?void 0:i.replace(/^http:/i,"https:")),this.sourceJSON=l.data,this.read(l.data,{origin:"service",url:this.parsedUrl});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasOverriddenFetchTile",get:function(){return!this.fetchTile[P]}}]),u}(Object(_.a)(Object(k.a)(Object(D.a)(Object(x.a)(Object(f.a)(g.a))))));Object(u.a)([Object(y.b)({readOnly:!0})],z.prototype,"capabilities",void 0),Object(u.a)([Object(m.a)("service","capabilities",["capabilities"])],z.prototype,"readCapabilities",null),Object(u.a)([Object(y.b)({json:{read:{source:"copyrightText"}}})],z.prototype,"copyright",void 0),Object(u.a)([Object(y.b)({readOnly:!0,type:w.a})],z.prototype,"heightModelInfo",void 0),Object(u.a)([Object(y.b)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],z.prototype,"path",void 0),Object(u.a)([Object(y.b)({type:["show","hide"]})],z.prototype,"listMode",void 0),Object(u.a)([Object(y.b)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],z.prototype,"minScale",void 0),Object(u.a)([Object(y.b)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],z.prototype,"maxScale",void 0),Object(u.a)([Object(y.b)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],z.prototype,"opacity",void 0),Object(u.a)([Object(y.b)({type:["ArcGISTiledElevationServiceLayer"]})],z.prototype,"operationalLayerType",void 0),Object(u.a)([Object(y.b)()],z.prototype,"sourceJSON",void 0),Object(u.a)([Object(y.b)({json:{read:!1},value:"elevation",readOnly:!0})],z.prototype,"type",void 0),Object(u.a)([Object(y.b)(T.o)],z.prototype,"url",void 0),Object(u.a)([Object(y.b)()],z.prototype,"version",void 0),Object(u.a)([Object(m.a)("version",["currentVersion"])],z.prototype,"readVersion",null),z=Object(u.a)([Object(j.a)("esri.layers.ElevationLayer")],z);var P=Symbol("default-fetch-tile");z.prototype.fetchTile[P]=!0;var N=z},708:function(e,t,i){"use strict";i.d(t,"a",(function(){return A}));var a=i(4),n=i(12),r=i(1),l=i(89),o=i(88),c=i(90),s=i(91),u=i(94),h=i(129),v=i(126),p=i(676),f=i(101),b=i(287),d=i(381),y=i(440),O=i(110),m=i(127),j=i(313),w=i(128),g=i(97),_=(i(96),i(98)),k=(i(93),i(95)),D=i(630),x=i(116),T=i(312);var S,L=function(){function e(t){Object(l.a)(this,e),this._validateJSON(t);var i=t.location,a=t.data;this.location=Object.freeze(Object(x.a)(i));for(var n=this.location.width,r=this.location.height,o=!0,c=!0,s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e<=T.a?t?new Array(e).fill(0):new Array(e):new Uint32Array(e)}(Math.ceil(n*r/32)),u=0,h=0;h<a.length;h++){var v=h%32;a[h]?(c=!1,s[u]|=1<<v):o=!1,31===v&&++u}c?(this._availability="unavailable",this.byteSize=40):o?(this._availability="available",this.byteSize=40):(this._availability=s,this.byteSize=40+Object(T.b)(s))}return Object(o.a)(e,[{key:"getAvailability",value:function(e,t){if("unavailable"===this._availability||"available"===this._availability)return this._availability;var i=(e-this.location.top)*this.location.width+(t-this.location.left),a=i%32,n=i>>5,r=this._availability;return n<0||n>r.length?"unknown":r[n]&1<<a?"available":"unavailable"}},{key:"_validateJSON",value:function(e){if(!e||!e.location)throw new f.a("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new f.a("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new f.a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new f.a("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new f.a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}],[{key:"fromDefinition",value:function(t,i){var a=t.service.request||h.default,n=t.row,l=t.col,o=t.width,c=t.height,s={query:{f:"json"}};return i=i?Object(r.a)(Object(r.a)({},s),i):s,a(function(e){var t,i;if(null!==(t=e.service.tileServers)&&void 0!==t&&t.length){var a=e.service.tileServers;i="".concat(a&&a.length?a[e.row%a.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}else i="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);var n=e.service.query;return n&&(i="".concat(i,"?").concat(n)),i}(t),i).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:n,left:l,width:o,height:c},valid:!0,data:Object(_.d)(o*c,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==n||t.location.left!==l||t.location.width!==o||t.location.height!==c))throw new f.a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:n,left:l,width:o,height:c}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){return Object.freeze(new e(t))}}]),e}();function I(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var A=S=function(e){Object(c.a)(i,e);var t=Object(s.a)(i);function i(e){var a;return Object(l.a)(this,i),(a=t.call(this,e))._pendingTilemapRequests={},a.request=h.default,a.size=32,a._prefetchingEnabled=!0,a}return Object(o.a)(i,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new d.a(2*p.a.MEGABYTES),this.addHandles([Object(m.e)((function(){var t=e.layer;return[null===t||void 0===t?void 0:t.parsedUrl,null===t||void 0===t?void 0:t.tileServers,null===t||void 0===t?void 0:t.apiKey,null===t||void 0===t?void 0:t.customParameters]}),(function(){return e._initializeTilemapDefinition()}),m.a)])}},{key:"effectiveMinLOD",get:function(){var e;return null!==(e=this.minLOD)&&void 0!==e?e:this.layer.tileInfo.lods[0].level}},{key:"effectiveMaxLOD",get:function(){var e;return null!==(e=this.maxLOD)&&void 0!==e?e:this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}},{key:"fetchTilemap",value:function(e,t,i,a){var n=this;if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new f.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var l=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,i,l);if(o)return Promise.resolve(o);var c=a&&a.signal;return a=Object(r.a)(Object(r.a)({},a),{},{signal:null}),new Promise((function(e,t){Object(O.k)(c,(function(){return t(Object(O.b)())}));var i=I(l),r=n._pendingTilemapRequests[i];if(!r){r=L.fromDefinition(l,a).then((function(e){return n._tilemapCache.put(i,e,e.byteSize),e}));var o=function(){return delete n._pendingTilemapRequests[i]};n._pendingTilemapRequests[i]=r,r.then(o,o)}r.then(e,t)}))}},{key:"getAvailability",value:function(e,t,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";var a=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return a?a.getAvailability(t,i):"unknown"}},{key:"fetchAvailability",value:function(e,t,i,a){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new f.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i})):this.fetchTilemap(e,t,i,a).catch((function(e){return e})).then((function(a){if(a instanceof L){var n=a.getAvailability(t,i);if("unavailable"===n)throw new f.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i});return n}if(Object(O.h)(a))throw a;return"unknown"}))}},{key:"fetchAvailabilityUpsample",value:function(e,t,i,a,n){var r=this;a.level=e,a.row=t,a.col=i;var l=this.layer.tileInfo;l.updateTileInfo(a);var o=this.fetchAvailability(e,t,i,n).catch((function(e){if(Object(O.h)(e))throw e;if(l.upsampleTile(a))return r.fetchAvailabilityUpsample(a.level,a.row,a.col,a,n);throw e}));return this._fetchAvailabilityUpsamplePrefetch(a.id,e,t,i,n,o),o}},{key:"_fetchAvailabilityUpsamplePrefetch",value:function(){var e=Object(n.a)(Object(a.a)().mark((function e(t,i,n,l,o,c){var s,u,h,v,p,f,d,y,m=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled&&null!=t){e.next=2;break}return e.abrupt("return");case 2:if(s="prefetch-".concat(t),!this.hasHandles(s)){e.next=5;break}return e.abrupt("return");case 5:return u=new AbortController,c.then((function(){return u.abort()}),(function(){return u.abort()})),h=!1,v=Object(b.b)((function(){h||(h=!0,u.abort())})),this.addHandles(v,s),e.next=12,Object(j.c)(10,u.signal).catch((function(){}));case 12:if(h||(h=!0,this.removeHandles(s)),!Object(O.i)(u)){e.next=15;break}return e.abrupt("return");case 15:p=new D.a(t,i,n,l),f=Object(r.a)(Object(r.a)({},o),{},{signal:u.signal}),d=this.layer.tileInfo,y=Object(a.a)().mark((function e(){var t,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=m.fetchAvailability(p.level,p.row,p.col,f),S._prefetches.push(t),i=function(){S._prefetches.removeUnordered(t)},t.then(i,i);case 4:case"end":return e.stop()}}),e)})),0;case 18:if(!(S._prefetches.length<S._maxPrefetch&&d.upsampleTile(p))){e.next=23;break}return e.delegateYield(y(),"t0",20);case 20:e.next=18;break;case 23:case"end":return e.stop()}}),e,this)})));return function(t,i,a,n,r,l){return e.apply(this,arguments)}}()},{key:"_initializeTilemapDefinition",value:function(){var e;if(this.layer.parsedUrl){var t=this.layer,i=t.parsedUrl,a=t.apiKey,n=t.customParameters;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:i.path,query:Object(w.I)(Object(r.a)(Object(r.a)(Object(r.a)({},i.query),n),{},{token:null!==a&&void 0!==a?a:null===(e=i.query)||void 0===e?void 0:e.token})),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,i,a){a.level=e,a.row=t-t%this.size,a.col=i-i%this.size;var n=I(a);return this._tilemapCache.get(n)}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,i,a){return!!e._tilemapFromCache(t,i,a,e._tmpTilemapDefinition)}}}}]),i}(v.a);A._maxPrefetch=4,A._prefetches=new y.a({initialSize:S._maxPrefetch}),Object(u.a)([Object(g.b)({constructOnly:!0})],A.prototype,"layer",void 0),Object(u.a)([Object(g.b)({constructOnly:!0})],A.prototype,"minLOD",void 0),Object(u.a)([Object(g.b)({constructOnly:!0})],A.prototype,"maxLOD",void 0),Object(u.a)([Object(g.b)({constructOnly:!0})],A.prototype,"request",void 0),Object(u.a)([Object(g.b)({constructOnly:!0})],A.prototype,"size",void 0),A=S=Object(u.a)([Object(k.a)("esri.layers.support.TilemapCache")],A)},808:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i(4),n=i(12),r=i(89),l=i(88),o=i(101),c=i(110),s=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.lods[t.lods.length-1].level;Object(r.a)(this,e),this.tileInfo=t,this.minLOD=i,this.maxLOD=a,t.lodAt(i)||(this.minLOD=t.lods[0].level),t.lodAt(a)||(this.maxLOD=t.lods[t.lods.length-1].level)}return Object(l.a)(e,[{key:"effectiveMinLOD",get:function(){var e;return null!==(e=this.minLOD)&&void 0!==e?e:this.tileInfo.lods[0].level}},{key:"effectiveMaxLOD",get:function(){var e;return null!==(e=this.maxLOD)&&void 0!==e?e:this.tileInfo.lods[this.tileInfo.lods.length-1].level}},{key:"getAvailability",value:function(e,t,i){var a,n=null===(a=this.tileInfo)||void 0===a?void 0:a.lodAt(e);return!n||e<this.minLOD||e>this.maxLOD?"unavailable":n.cols&&n.rows?i>=n.cols[0]&&i<=n.cols[1]&&t>=n.rows[0]&&t<=n.rows[1]?"unknown":"unavailable":"unknown"}},{key:"fetchAvailability",value:function(){var e=Object(n.a)(Object(a.a)().mark((function e(t,i,n,r){var l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.p)(r);case 2:if("unavailable"!==(l=this.getAvailability(t,i,n))){e.next=5;break}throw new o.a("tile-map:tile-unavailable","Tile is not available",{level:t,row:i,col:n});case 5:return e.abrupt("return",l);case 6:case"end":return e.stop()}}),e,this)})));return function(t,i,a,n){return e.apply(this,arguments)}}()},{key:"fetchAvailabilityUpsample",value:function(){var e=Object(n.a)(Object(a.a)().mark((function e(t,i,n,r,l){var o,s=this;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.p)(l);case 2:return r.level=t,r.row=i,r.col=n,o=this.tileInfo,e.abrupt("return",(o.updateTileInfo(r),this.fetchAvailability(t,i,n,l).catch((function(e){if(Object(c.h)(e))throw e;if(o.upsampleTile(r))return s.fetchAvailabilityUpsample(r.level,r.row,r.col,r,l);throw e}))));case 7:case"end":return e.stop()}}),e,this)})));return function(t,i,a,n,r){return e.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=59.c302e666.chunk.js.map
(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[240],{1324:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(92),a=1;function i(e,t){var n,a=0,i=Object(r.a)(t);try{for(i.s();!(n=i.n()).done;){var s,u=null===(s=n.value.attributes)||void 0===s?void 0:s[e];"number"==typeof u&&isFinite(u)&&(a=Math.max(a,u))}}catch(c){i.e(c)}finally{i.f()}return a}},2199:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var r=n(4),a=n(1),i=n(92),s=n(12),u=n(89),c=n(88),l=n(101),o=n(122),d=n(132),p=n(168),f=n(1324),y=n(710),b=n(309),h=n(858),m=n(449),g=n(1323),v=n(227),j=n(782),O=n(195),I=d.b,F={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:d.b},x={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};function _(e){return Object(o.f)(e)?null!=e.z:!!e.hasZ}function E(e){return Object(o.f)(e)?null!=e.m:!!e.hasM}var k=function(){function e(){Object(u.a)(this,e),this._queryEngine=null,this._nextObjectId=null}return Object(c.a)(e,[{key:"destroy",value:function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=this._fieldsIndex=this._createDefaultAttributes=null}},{key:"load",value:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var n,s,u,c,o,d,p,g,_,E,k,T,R,q,w,D,A,S,M,Q,C,Z,P,G,U,B,z;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],s=t.features,u=this._inferLayerProperties(s,t.fields),c=t.fields||[],o=null!=t.hasM?t.hasM:!!u.hasM,d=null!=t.hasZ?t.hasZ:!!u.hasZ,p=!t.spatialReference&&!u.spatialReference,g=p?I:t.spatialReference||u.spatialReference,_=p?F:null,E=t.geometryType||u.geometryType,k=!E,T=t.objectIdField||u.objectIdField,R=t.timeInfo,k||(p&&n.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),E)){e.next=4;break}throw new l.a("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");case 4:if(T){e.next=6;break}throw new l.a("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");case 6:u.objectIdField&&T!==u.objectIdField&&(n.push({name:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'.concat(T,'" doesn\'t match the field name "').concat(u.objectIdField,'", found in the provided fields')}),T=u.objectIdField),T&&!u.objectIdField&&(q=null,c.some((function(e){return e.name===T&&(q=e,!0)}))?(q.type="esriFieldTypeOID",q.editable=!1,q.nullable=!1):c.unshift({alias:T,name:T,type:"esriFieldTypeOID",editable:!1,nullable:!1})),w=Object(i.a)(c),e.prev=8,w.s();case 10:if((D=w.n()).done){e.next=18;break}if(null==(A=D.value).name&&(A.name=A.alias),null==A.alias&&(A.alias=A.name),A.name){e.next=14;break}throw new l.a("feature-layer:invalid-field-name","field name is missing",{field:A});case 14:if(A.name===T&&(A.type="esriFieldTypeOID"),j.a.jsonValues.includes(A.type)){e.next=16;break}throw new l.a("feature-layer:invalid-field-type",'invalid type for field "'.concat(A.name,'"'),{field:A});case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),w.e(e.t0);case 23:return e.prev=23,w.f(),e.finish(23);case 26:S={},M=Object(i.a)(c);try{for(M.s();!(Q=M.n()).done;)"esriFieldTypeOID"!==(C=Q.value).type&&"esriFieldTypeGlobalID"!==C.type&&void 0!==(Z=Object(O.q)(C))&&(S[C.name]=Z)}catch(r){M.e(r)}finally{M.f()}if(this._fieldsIndex=new v.a(c),this._createDefaultAttributes=Object(m.b)(S,T),R&&(R.startTimeField&&((P=this._fieldsIndex.get(R.startTimeField))?(R.startTimeField=P.name,P.type="esriFieldTypeDate"):R.startTimeField=null),R.endTimeField&&((G=this._fieldsIndex.get(R.endTimeField))?(R.endTimeField=G.name,G.type="esriFieldTypeDate"):R.endTimeField=null),R.trackIdField&&((U=this._fieldsIndex.get(R.trackIdField))?R.trackIdField=U.name:(R.trackIdField=null,n.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:R}}))),R.startTimeField||R.endTimeField||(n.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:R}}),R=null)),B={warnings:n,featureErrors:[],layerDefinition:Object(a.a)(Object(a.a)({},x),{},{drawingInfo:Object(m.d)(E),templates:Object(m.c)(S),extent:_,geometryType:E,objectIdField:T,fields:c,hasZ:d,hasM:o,timeInfo:R}),assignedObjectIds:{}},this._queryEngine=new h.a({fields:c,geometryType:E,hasM:o,hasZ:d,objectIdField:T,spatialReference:g,featureStore:new y.a({geometryType:E,hasM:o,hasZ:d}),timeInfo:R,cacheSpatialQueries:!0}),s&&s.length){e.next=33;break}return e.abrupt("return",(this._nextObjectId=f.b,B));case 33:return z=Object(f.a)(T,s),this._nextObjectId=z+1,e.next=37,Object(b.a)(s,g);case 37:return e.abrupt("return",this._loadInitialFeatures(B,s));case 38:case"end":return e.stop()}}),e,this,[[8,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var n,a,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._queryEngine,a=n.spatialReference,i=n.geometryType,e.next=3,Promise.all([Object(g.c)(a,i),Object(b.a)(t.adds,a),Object(b.a)(t.updates,a)]);case 3:return e.abrupt("return",this._applyEdits(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._queryEngine.executeQuery(e,t.signal)}},{key:"queryFeatureCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._queryEngine.executeQueryForCount(e,t.signal)}},{key:"queryObjectIds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._queryEngine.executeQueryForIds(e,t.signal)}},{key:"queryExtent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._queryEngine.executeQueryForExtent(e,t.signal)}},{key:"querySnapping",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._queryEngine.executeQueryForSnapping(e,t.signal)}},{key:"_inferLayerProperties",value:function(e,t){var n,r,a,s=null,u=null,c=null,l=Object(i.a)(e);try{for(l.s();!(a=l.n()).done;){var d=a.value.geometry;if(null!=d&&(s||(s=Object(o.c)(d)),u||(u=d.spatialReference),null==n&&(n=_(d)),null==r&&(r=E(d)),s&&u&&null!=n&&null!=r))break}}catch(f){l.e(f)}finally{l.f()}if(t&&t.length){var p=null;t.some((function(e){var t="esriFieldTypeOID"===e.type,n=!e.type&&e.name&&"objectid"===e.name.toLowerCase();return p=e,t||n}))&&(c=p.name)}return{geometryType:s,spatialReference:u,objectIdField:c,hasM:r,hasZ:n}}},{key:"_loadInitialFeatures",value:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t,n){var a,s,u,c,l,d,f,y,h,m,v,j,O,I,F,x,_,E;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this._queryEngine,s=a.geometryType,u=a.hasM,c=a.hasZ,l=a.objectIdField,d=a.spatialReference,f=a.featureStore,y=[],h=Object(i.a)(n),e.prev=2,h.s();case 4:if((m=h.n()).done){e.next=13;break}if(null!=(v=m.value).uid&&(t.assignedObjectIds[v.uid]=-1),!v.geometry||s===Object(o.c)(v.geometry)){e.next=9;break}return t.featureErrors.push(Object(g.a)("Incorrect geometry type.")),e.abrupt("continue",11);case 9:j=this._createDefaultAttributes(),(O=Object(g.d)(this._fieldsIndex,j,v.attributes,!0,t.warnings))?t.featureErrors.push(O):(this._assignObjectId(j,v.attributes,!0),v.attributes=j,null!=v.uid&&(t.assignedObjectIds[v.uid]=v.attributes[l]),null!=v.geometry&&(v.geometry=Object(b.b)(v.geometry,v.geometry.spatialReference,d)),y.push(v));case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),h.e(e.t0);case 18:return e.prev=18,h.f(),e.finish(18);case 21:return f.addMany(Object(p.c)([],y,s,c,u,l)),e.next=24,this._queryEngine.fetchRecomputedExtents();case 24:return I=e.sent,F=I.fullExtent,x=I.timeExtent,t.layerDefinition.extent=F,x&&(_=x.start,E=x.end,t.layerDefinition.timeInfo.timeExtent=[_,E]),e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyEdits",value:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var n,a,s,u,c,l,o,d,p,f;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.adds,a=t.updates,s=t.deletes,u={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}},n&&n.length&&this._applyAddEdits(u,n),a&&a.length&&this._applyUpdateEdits(u,a),s&&s.length){c=Object(i.a)(s);try{for(c.s();!(l=c.n()).done;)o=l.value,u.deleteResults.push(Object(g.b)(o))}catch(r){c.e(r)}finally{c.f()}this._queryEngine.featureStore.removeManyById(s)}return e.next=4,this._queryEngine.fetchRecomputedExtents();case 4:return d=e.sent,p=d.fullExtent,f=d.timeExtent,e.abrupt("return",{extent:p,timeExtent:f,featureEditResults:u});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_applyAddEdits",value:function(e,t){var n,r=e.addResults,a=this._queryEngine,s=a.geometryType,u=a.hasM,c=a.hasZ,l=a.objectIdField,d=a.spatialReference,f=a.featureStore,y=[],h=Object(i.a)(t);try{for(h.s();!(n=h.n()).done;){var m=n.value;if(m.geometry&&s!==Object(o.c)(m.geometry))r.push(Object(g.a)("Incorrect geometry type."));else{var v=this._createDefaultAttributes(),j=Object(g.d)(this._fieldsIndex,v,m.attributes);if(j)r.push(j);else{if(this._assignObjectId(v,m.attributes),m.attributes=v,null!=m.uid){var O=m.attributes[l];e.uidToObjectId[m.uid]=O}if(null!=m.geometry){var I,F=null!==(I=m.geometry.spatialReference)&&void 0!==I?I:d;m.geometry=Object(b.b)(Object(g.e)(m.geometry,F),F,d)}y.push(m),r.push(Object(g.b)(m.attributes[l]))}}}}catch(x){h.e(x)}finally{h.f()}f.addMany(Object(p.c)([],y,s,c,u,l))}},{key:"_applyUpdateEdits",value:function(e,t){var n,r=e.updateResults,a=this._queryEngine,s=a.geometryType,u=a.hasM,c=a.hasZ,l=a.objectIdField,d=a.spatialReference,f=a.featureStore,y=Object(i.a)(t);try{for(y.s();!(n=y.n()).done;){var h=n.value,m=h.attributes,v=h.geometry,j=m&&m[l];if(null!=j)if(f.has(j)){var O=Object(p.j)(f.getFeature(j),s,c,u);if(null!=v){var I;if(s!==Object(o.c)(v)){r.push(Object(g.a)("Incorrect geometry type."));continue}var F=null!==(I=v.spatialReference)&&void 0!==I?I:d;O.geometry=Object(b.b)(Object(g.e)(v,F),F,d)}if(m){var x=Object(g.d)(this._fieldsIndex,O.attributes,m);if(x){r.push(x);continue}}f.add(Object(p.a)(O,s,c,u,l)),r.push(Object(g.b)(j))}else r.push(Object(g.a)("Feature with object id ".concat(j," missing")));else r.push(Object(g.a)("Identifier field ".concat(l," missing")))}}catch(_){y.e(_)}finally{y.f()}}},{key:"_assignObjectId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._queryEngine.objectIdField;n&&t&&isFinite(t[r])?e[r]=t[r]:e[r]=this._nextObjectId++}}]),e}()},449:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return l}));var r=n(34),a=n(1),i=n(93),s=n(116),u=n(488),c=n(382);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?c.a:"esriGeometryPolyline"===e?c.c:c.b}}}var o=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,d=1;function p(e,t){if(Object(i.a)("esri-csp-restrictions"))return function(){return Object(a.a)(Object(r.a)({},t,null),e)};try{var n="this.".concat(t," = null;");for(var s in e)n+="this".concat(o.test(s)?".".concat(s):'["'.concat(s,'"]')," = ").concat(JSON.stringify(e[s]),";");var u=new Function("\n      return class AttributesClass$".concat(d++," {\n        constructor() {\n          ").concat(n,";\n        }\n      }\n    "))();return function(){return new u}}catch(c){return function(){return Object(a.a)(Object(r.a)({},t,null),e)}}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:Object(s.a)(e)}}]}function y(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:u.a,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1}}}}}]);
//# sourceMappingURL=240.942f5026.chunk.js.map
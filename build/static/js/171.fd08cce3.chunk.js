(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[171],{1085:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return p}));var n=r(1),a=r(390),i=r(347),o=r(850),s=r(864),l=r(851),u=r(852),c=r(350),f=r(853),d={key:"type",base:null,typeMap:{"unique-value":c.a,"class-breaks":i.a,"raster-colormap":s.a,"raster-stretch":u.a,"vector-field":f.a,"raster-shaded-relief":l.a,flow:o.a}},p=Object(n.a)(Object(n.a)({},d),{},{typeMap:Object(n.a)({},d.typeMap)});delete p.typeMap["vector-field"],delete p.typeMap.flow;var h={uniqueValue:c.a,classBreaks:i.a,rasterStretch:u.a,rasterColormap:s.a,vectorField:f.a,rasterShadedRelief:l.a,flowRenderer:o.a};function b(e,t){if(!e)return null;if("classBreaks"===e.type&&e.classificationMethod){var r=e.authoringInfo||{classificationMethod:""};r.classificationMethod=e.classificationMethod,e.authoringInfo=r}"vectorField"===e.type&&e.visualVariables&&!Array.isArray(e.visualVariables)&&(e.visualVariables=[e.visualVariables]);var n,i=(n=e)&&h[n.type]||null;if(i){var o=new i;return o.read(e,t),o}return t&&t.messages&&e&&t.messages.push(new a.a("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t})),null}},1552:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,a=r(112),i=r(92),o=r(89),s=r(88),l=r(90),u=r(91),c=r(94),f=(r(119),r(105)),d=r(97),p=(r(96),r(98),r(93),r(95)),h=r(130),b=r(164),m=r(122),v=r(573),y={base:r(214).a,key:"type",typeMap:{extent:h.a,polygon:b.a}},g=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).areaOfInterest=null,n.subsetDefinitions=null,n}return Object(s.a)(r,[{key:"dimensions",get:function(){var e=this.subsetDefinitions;if(null==e||0===e.length)return[];var t=new Map;e.forEach((function(e){if(e.dimensionName){var r,n;if(Array.isArray(e.values[0])){var a=e.values;r=a[0][0],n=a[e.values.length-1][1]}else{var i=e.values;r=i[0],n=i[e.values.length-1]}if(t.has(e.dimensionName)){var o=t.get(e.dimensionName);o[0]=Math.min(r,o[0]),o[1]=Math.max(n,o[1])}else t.set(e.dimensionName,[r,n])}}));var r,n=[],a=Object(i.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;n.push({name:o[0],extent:o[1]})}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"variables",get:function(){var e=this.subsetDefinitions;if(null==e||0===e.length)return[];var t=new Set;return e.forEach((function(e){e.variableName&&t.add(e.variableName)})),Object(a.a)(t)}},{key:"clone",value:function(){var e,t=null===(e=this.subsetDefinitions)||void 0===e?void 0:e.map((function(e){return e.clone()})),r=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new n({areaOfInterest:r,subsetDefinitions:t})}}]),r}(f.a);Object(c.a)([Object(d.b)({types:y,json:{read:m.a,write:!0}})],g.prototype,"areaOfInterest",void 0),Object(c.a)([Object(d.b)({readOnly:!0})],g.prototype,"dimensions",null),Object(c.a)([Object(d.b)({readOnly:!0})],g.prototype,"variables",null),Object(c.a)([Object(d.b)({type:[v.a],json:{write:!0}})],g.prototype,"subsetDefinitions",void 0);var j=g=n=Object(c.a)([Object(p.a)("esri.layers.support.MultidimensionalSubset")],g)},1553:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(1),a=r(4),i=r(12),o=r(89),s=r(88),l=r(101),u=r(452),c=r(414),f=function(){function e(){Object(o.a)(this,e),this._workerThread=null,this._destroyed=!1}return Object(s.a)(e,[{key:"initialize",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.b)("RasterWorker");case 2:t=e.sent,this._destroyed?t.close():this._workerThread=t;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)}},{key:"convertVectorFieldData",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,this._workerThread.invoke("convertVectorFieldData",{pixelBlock:t.pixelBlock.toJSON(),type:t.dataType},r);case 4:return n=e.sent,e.abrupt("return",n?new c.a(n):null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"computeStatisticsHistograms",value:function(e,t){if(!this._workerThread)throw new l.a("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:e.pixelBlock.toJSON()},t)}},{key:"decode",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,this._workerThread.invoke("decode",t,r);case 4:return n=e.sent,e.abrupt("return",n?new c.a(n):null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"symbolize",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return n={extent:t.extent&&t.extent.toJSON(),pixelBlock:null!=t.pixelBlock&&t.pixelBlock.toJSON(),simpleStretchParams:t.simpleStretchParams,bandIds:t.bandIds},e.next=5,this._workerThread.invoke("symbolize",n,r);case 5:return i=e.sent,e.abrupt("return",i?new c.a(i):null);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateSymbolizer",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return i=null===t||void 0===t||null===(n=t.rendererJSON)||void 0===n?void 0:n.histograms,e.next=5,Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:t.toJSON(),histograms:i},r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateRasterFunction",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:t.toJSON()},r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"process",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,this._workerThread.invoke("process",{extent:null===(n=t.extent)||void 0===n?void 0:n.toJSON(),primaryPixelSizes:null===(i=t.primaryPixelSizes)||void 0===i?void 0:i.map((function(e){return null!=e?e.toJSON():null})),primaryPixelBlocks:t.primaryPixelBlocks.map((function(e){return null!=e?e.toJSON():null})),primaryRasterIds:t.primaryRasterIds},r);case 4:return o=e.sent,e.abrupt("return",o?new c.a(o):null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"stretch",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!==t&&void 0!==t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return n={srcPixelBlock:t.pixelBlock.toJSON(),stretchParams:t.stretchParams},e.next=7,this._workerThread.invoke("stretch",n,r);case 7:return i=e.sent,e.abrupt("return",i?new c.a(i):null);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"split",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!==t&&void 0!==t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return n={srcPixelBlock:t.pixelBlock.toJSON(),tileSize:t.tileSize,maximumPyramidLevel:t.maximumPyramidLevel},e.next=7,this._workerThread.invoke("split",n,r);case 7:return i=e.sent,e.abrupt("return",(i&&i.forEach((function(e,t){i.set(t,e?c.a.fromJSON(e):null)})),i));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"estimateStatisticsHistograms",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!==t&&void 0!==t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return n={srcPixelBlock:t.pixelBlock.toJSON()},e.next=7,this._workerThread.invoke("estimateStatisticsHistograms",n,r);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"mosaicAndTransform",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var i,o,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!==t&&void 0!==t&&null!==(i=t.srcPixelBlocks)&&void 0!==i&&i.length){e.next=4;break}return e.abrupt("return",{pixelBlock:null});case 4:return o=Object(n.a)(Object(n.a)({},t),{},{srcPixelBlocks:t.srcPixelBlocks.map((function(e){return null!=e?e.toJSON():null}))}),e.next=7,this._workerThread.invoke("mosaicAndTransform",o,r);case 7:return s=e.sent,e.abrupt("return",{pixelBlock:s.pixelBlock?new c.a(s.pixelBlock):null,localNorthDirections:s.localNorthDirections});case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createFlowMesh",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var i,o,s,u;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new l.a("raster-jobhandler:no-connection","no available worker connection");case 2:return i={buffer:t.flowData.data.buffer,maskBuffer:t.flowData.mask.buffer,width:t.flowData.width,height:t.flowData.height},o=t.meshType,s=t.simulationSettings,e.next=7,this._workerThread.invoke("createFlowMesh",{meshType:o,flowData:i,simulationSettings:s},Object(n.a)(Object(n.a)({},r),{},{transferList:[i.buffer,i.maskBuffer]}));case 7:return u=e.sent,e.abrupt("return",{vertexData:new Float32Array(u.vertexBuffer),indexData:new Uint32Array(u.indexBuffer)});case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getProjectionOffsetGrid",value:function(e,t){if(!this._workerThread)throw new l.a("raster-jobhandler:no-connection","no available worker connection");var r=null!=e.datumTransformation?e.datumTransformation.steps.map((function(e){return{wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}})):null,n=null!=e.rasterTransform?e.rasterTransform.toJSON():null,a={projectedExtent:e.projectedExtent.toJSON(),srcBufferExtent:e.srcBufferExtent.toJSON(),pixelSize:e.pixelSize,hasWrapAround:e.hasWrapAround,spacing:e.spacing,datumTransformationSteps:r,rasterTransform:n,isAdaptive:e.isAdaptive,includeGCSGrid:e.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",a,t)}}]),e}()},1554:function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return M})),r.d(t,"c",(function(){return w})),r.d(t,"d",(function(){return x})),r.d(t,"e",(function(){return I})),r.d(t,"f",(function(){return D}));var n=r(112),a=r(1),i=r(143),o=(r(1085),r(194),r(325)),s=r(557),l=(r(850),r(611)),u=(r(781),r(685)),c=r(1022),f=r(984),d=(r(809),r(810),r(979)),p=r(852),h=r(350),b=r(864),m=(r(851),r(347),r(853)),v=.25,y=d.a.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),g=d.a.fromJSON(u.a[0]),j=new Set(["scientific","standard-time","vector-uv","vector-magdir","vector-u","vector-v","vector-magnitude","vector-direction"]);function O(e,t){var r=e.attributeTable,a=e.colormap;if(Object(c.f)(e)){var o=function(e){if(!Object(c.f)(e))return null;var t;if(null!=e.statistics&&e.statistics.length&&("vector-magdir"===e.dataType||"vector-uv"===e.dataType)){var r=C(e.dataType,e.statistics);t=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:r.minMagnitude,maxDataValue:r.maxMagnitude}]}var a=null!=e.multidimensionalInfo?T.get(e.multidimensionalInfo.variables[0].unit):null,i=new m.a({visualVariables:t,inputUnit:a,rotationType:"geographic"});return i.visualVariables=[].concat(Object(n.a)(i.sizeVariables),Object(n.a)(i.rotationVariables)),i}(e);if(null!=o)return o}if(null!=a){var s=function(e){if(!Object(c.b)(e))return null;var t,r=e.attributeTable,n=e.colormap;if(null!=r){var a=S(r,"value"),i=k(r,null,!0);"string"===i.type&&(t={},r.features.forEach((function(e){var r=e.attributes;t[r[a.name]]=i?r[i.name]:r[a.name]})))}return b.a.createFromColormap(n,t)}(e);if(null!=s)return s}if(null!=r){var d=function(e,t,r,n){if(!Object(c.e)(e,t))return null;var a=e.attributeTable,o=e.statistics,s=k(a,t),d=S(a,"red"),p=S(a,"green"),b=S(a,"blue"),m=new l.a,v=[],y=new Set,j=!!(d&&p&&b);if(null!=a)a.features.forEach((function(e){var t=e.attributes[s.name];if(!y.has(e.attributes[s.name])&&null!=t){y.add(t);var r=j&&("single"===d.type||"double"===d.type)&&("single"===p.type||"double"===p.type)&&("single"===b.type||"double"===b.type)&&!a.features.some((function(e){return e.attributes[d.name]>1||e.attributes[p.name]>1||e.attributes[b.name]>1})),n=r?255:1;v.push(new f.a({value:e.attributes[s.name],label:e.attributes[s.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:new i.a(j?[e.attributes[d.name]*n,e.attributes[p.name]*n,e.attributes[b.name]*n,1]:[0,0,0,0])}}))}}));else if(null!==o&&void 0!==o&&o[0])for(var O=o[0].min;O<=o[0].max;O++)v.push(new f.a({value:O,label:O.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new i.a([0,0,0,0])}}));if(v.sort((function(e,t){return e.value&&"string"==typeof e.value.valueOf()?0:e.value>t.value?1:-1})),!j){var x=Object(u.c)(g,{numColors:v.length});v.forEach((function(e,t){return e.symbol.color=new i.a(x[t].slice(1,4))})),m.colorRamp=g}if(r||n){var w=r||Object(u.c)(n,{numColors:v.length}).map((function(e){return e.slice(1)}));v.forEach((function(e,t){return e.symbol.color=new i.a(w[t])})),m.colorRamp=n}return new h.a({field:s.name,uniqueValueInfos:v,authoringInfo:m})}(e);if(null!=d)return d}return function(e,t){var r,n,a,i,o,s,l,u;e=I(e,null===t||void 0===t?void 0:t.variableName);var c=e,f=c.bandCount,d=t||{},h=d.bandIds,b=d.stretchType;(null===(r=h)||void 0===r?void 0:r.some((function(e){return e>=f})))&&(h=null);var m=e.statistics,g=e.histograms;f>1?(h=null!==(n=h)&&void 0!==n&&n.length?h:M(e),m=null==m?null:null===(a=h)||void 0===a?void 0:a.map((function(e){return m[e]})),g=null==g?null:null===(i=h)||void 0===i?void 0:i.map((function(e){return g[e]}))):h=[0],null==b&&(b=function(e){var t="percent-clip",r=e.pixelType,n=e.dataType,a=e.histograms,i=e.statistics,o=e.multidimensionalInfo,s=j.has(n)||"generic"===n&&null!=o;return"u8"!==r||"processed"!==n&&null!=a&&null!=i?"u8"===r||"elevation"===n||s?t="min-max":null!=a?t="percent-clip":null!=i&&(t="min-max"):t="none",t}(e));var O=!1;switch(b){case"none":O=!1;break;case"percent-clip":O=!(null!==(o=g)&&void 0!==o&&o.length);break;default:O=!(null!==(s=m)&&void 0!==s&&s.length)}var x=e,w=x.dataType,k=1===(null===(l=h)||void 0===l?void 0:l.length)&&j.has(w)?y:null,S=new p.a({stretchType:b,dynamicRangeAdjustment:O,colorRamp:k,outputMin:0,outputMax:255,gamma:1===(null===(u=h)||void 0===u?void 0:u.length)?[1]:[1,1,1],useGamma:!1});return"percent-clip"===b?S.maxPercent=S.minPercent=v:"standard-deviation"===b&&(S.numberOfStandardDeviations=2),O||null==e.multidimensionalInfo&&!(null!==t&&void 0!==t&&t.includeStatisticsInStretch)||("percent-clip"===b?S.histograms=g:"min-max"!==b&&"standard-deviation"!==b||(S.statistics=m)),S}(e,t)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=["raster-stretch"];return Object(c.b)(e,t)&&r.push("raster-colormap"),Object(c.e)(e)&&r.push("unique-value"),Object(c.a)(e,t)&&r.push("class-breaks"),Object(c.d)(e)&&r.push("raster-shaded-relief"),Object(c.f)(e)&&r.push("vector-field"),Object(c.c)(e)&&r.push("flow"),r}function w(e,t,r){var n=["nearest","bilinear","cubic","majority"].find((function(e){return e===(null===r||void 0===r?void 0:r.toLowerCase())}));return"Map"===t?null!==n&&void 0!==n?n:"bilinear":"standard-time"===e.dataType?null!==n&&void 0!==n?n:"nearest":"thematic"===e.dataType||e.attributeTable||e.colormap?"nearest"===n||"majority"===n?n:"nearest":null!==n&&void 0!==n?n:"bilinear"}function I(e,t){if(!t)return e;var r=e.statistics,n=e.histograms,i=e.multidimensionalInfo;if(t&&null!=i){var o=i.variables.find((function(e){return e.name===t}));if(o){var l=o.statistics,u=o.histograms;null!==l&&void 0!==l&&l.length&&(r=l),(null===u||void 0===u?void 0:u.length)&&(n=u)}}return s.a.fromJSON(Object(a.a)(Object(a.a)({},e.toJSON()),{},{statistics:r,histograms:n}))}function M(e){var t=e.bandCount;if(1===t)return null;if(2===t)return[0];var r,n=e.bandInfos;if(n.length===t){var a=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],a=n.name.toLowerCase();if("red"===a)t.red=r;else if("green"===a)t.green=r;else if("blue"===a)t.blue=r;else if("nearinfrared"===a||"nearinfrared_1"===a||"nir"===a)t.nir=r;else if(n.maxWavelength&&n.minWavelength){var i=n.minWavelength,o=n.maxWavelength;null==t.blue&&i>=410&&i<=480&&o>=480&&o<=540?t.blue=r:null==t.green&&i>=490&&i<=560&&o>=560&&o<=610?t.green=r:null==t.red&&i>=595&&i<=670&&o>=660&&o<=730?t.red=r:null==t.nir&&i>=700&&i<=860&&o>=800&&o<=950&&(t.nir=r)}}return t}(n),i=a.red,o=a.green,s=a.blue,l=a.nir;null!=i&&null!=o&&null!=s?r=[i,o,s]:null!=l&&null!=i&&null!=o&&(r=[l,i,o])}return!r&&t>=3&&(r=[0,1,2]),r}function k(e,t,r){var n;return null!=e?(n=t?e.fields.find((function(e){return t.toLowerCase()===e.name.toLowerCase()})):function(e){for(var t,r=0;r<e.length;r++){var n=e[r].name.toLowerCase();if("string"===e[r].type){if(n.startsWith("class")){t=e[r];break}null==t&&(n.endsWith("name")||n.endsWith("type"))&&(t=e[r])}}return t}(e.fields),n||(r||(n=e.fields.find((function(e){return"string"===e.type}))),n||(n=S(e,"value")))):n=new o.a({name:"value"}),n}function S(e,t){return null==e?null:e.fields.find((function(e){return e.name.toLowerCase()===t}))}var T=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);function A(e){var t;return{color:null===(t=e.symbolLayers[0].material)||void 0===t?void 0:t.color,type:"esriSFS",style:"esriSFSSolid"}}function D(e){if("uniqueValue"===e.type){var t,r=e.uniqueValueInfos,n=null===r||void 0===r?void 0:r[0].symbol;return null!==n&&void 0!==n&&null!==(t=n.symbolLayers)&&void 0!==t&&t.length&&(e.uniqueValueInfos=null===r||void 0===r?void 0:r.map((function(e){return{value:e.value,label:e.label,symbol:e.symbol?A(e.symbol):null}}))),e}if("classBreaks"===e.type){var a,i=e.classBreakInfos,o=i[0].symbol;return null!==o&&void 0!==o&&null!==(a=o.symbolLayers)&&void 0!==a&&a.length&&(e.classBreakInfos=i.map((function(e){return{classMinValue:e.classMinValue,classMaxValue:e.classMaxValue,label:e.label,symbol:e.symbol?A(e.symbol):null}}))),e}return e}function C(e,t){var r,n;if("vector-magdir"===e)r=t[0].min,n=t[0].max;else{var a=t[0].min,i=t[0].max,o=t[1].min,s=t[1].max;r=0,n=Math.max(Math.abs(a),Math.abs(o),Math.abs(i),Math.abs(s))}return{minMagnitude:r,maxMagnitude:n}}},1555:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return m}));var n=r(4),a=r(1),i=r(12),o=r(129),s=r(130),l=r(135),u=r(125),c=r(557),f=r(221),d=r(235);function p(e,t,r){return h.apply(this,arguments)}function h(){return h=Object(i.a)(Object(n.a)().mark((function e(t,r,i){var p,h,b,m,v,y,g,j,O,x,w,I,M,k,S,T,A,D,C,R,N,L,B,z,_,P,H,F,E,U,J,Z,V,W,G;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j=Object(f.c)(t),x=(O=r||{}).rasterFunction,w=O.sourceJSON,I=x?JSON.stringify(x.rasterFunctionDefinition||x):null,M=Object(f.b)(Object(a.a)(Object(a.a)({},j.query),{},{renderingRule:I,f:"json"})),k=Object(f.a)(M,i),t=j.path,e.t0=w,e.t0){e.next=7;break}return e.next=6,Object(o.default)(t,k).then((function(e){return e.data}));case 6:e.t0=e.sent;case 7:return S=e.t0,T=S.hasRasterAttributeTable?Object(o.default)("".concat(t,"/rasterAttributeTable"),k):null,A=S.hasColormap?Object(o.default)("".concat(t,"/colormap"),k):null,D=S.hasHistograms?Object(o.default)("".concat(t,"/histograms"),k):null,C=S.currentVersion>=10.3?Object(o.default)("".concat(t,"/keyProperties"),k):null,R=S.hasMultidimensions?Object(o.default)("".concat(t,"/multidimensionalInfo"),k):null,e.next=15,Promise.allSettled([T,A,D,C,R]);case 15:if(N=e.sent,L=null,S.minValues&&S.minValues.length===S.bandCount)for(L=[],B=0;B<S.minValues.length;B++)L.push({min:S.minValues[B],max:S.maxValues[B],avg:S.meanValues[B],stddev:S.stdvValues[B]});return z=s.a.fromJSON(S.extent),_=Math.ceil(z.width/S.pixelSizeX-.1),P=Math.ceil(z.height/S.pixelSizeY-.1),H=u.a.fromJSON(S.spatialReference||S.extent.spatialReference),F="fulfilled"===N[0].status&&N[0].value?d.a.fromJSON(N[0].value.data):null,E="fulfilled"===N[1].status?null===(p=N[1].value)||void 0===p?void 0:p.data.colormap:null,U="fulfilled"===N[2].status?null===(h=N[2].value)||void 0===h?void 0:h.data.histograms:null,J="fulfilled"===N[3].status&&null!==(b=null===(m=N[3].value)||void 0===m?void 0:m.data)&&void 0!==b?b:{},(null===(Z="fulfilled"===N[4].status?null===(v=N[4].value)||void 0===v?void 0:v.data.multidimensionalInfo:null)||void 0===Z||null===(y=Z.variables)||void 0===y?void 0:y.length)&&Z.variables.forEach((function(e){var t;(null===(t=e.statistics)||void 0===t?void 0:t.length)&&e.statistics.forEach((function(e){e.avg=e.mean,e.stddev=e.standardDeviation}))})),V=S.defaultVariable,W=S.serviceDataType,V&&V!==J.DefaultVariable&&(J.DefaultVariable=V),W&&W.includes("esriImageServiceDataTypeVector")&&!W.includes(J.DataType)&&(J.DataType=W.replace("esriImageServiceDataType","")),G=S.noDataValue,e.abrupt("return",(null!==(g=S.noDataValues)&&void 0!==g&&g.length&&S.noDataValues.some((function(e){return e!==G}))&&(G=S.noDataValues),new c.a({width:_,height:P,bandCount:S.bandCount,extent:s.a.fromJSON(S.extent),spatialReference:H,pixelSize:new l.a({x:S.pixelSizeX,y:S.pixelSizeY,spatialReference:H}),pixelType:S.pixelType.toLowerCase(),statistics:L,attributeTable:F,colormap:E,histograms:U,keyProperties:J,noDataValue:G,multidimensionalInfo:Z})));case 24:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function b(e,t,r){return p(e,{sourceJSON:t},r)}function m(e,t,r){return p(e,{rasterFunction:t},r)}},1556:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(119),c=r(365),f=r(481),d=r(105),p=r(116),h=r(102),b=r(97),m=(r(96),r(95)),v=r(137),y=r(122),g=r(747),j=r(610),O=r(135),x=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).geometry=null,e.mosaicRule=null,e.rasterFunction=null,e.pixelSize=null,e.raster=void 0,e.timeExtent=null,e}return Object(i.a)(r,[{key:"writeGeometry",value:function(e,t,r){null!=e&&(t.geometryType=Object(y.c)(e),t[r]=e.toJSON())}},{key:"renderingRule",get:function(){return Object(f.b)(h.a.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._get("rasterFunction")},set:function(e){Object(f.b)(h.a.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",e)}},{key:"clone",value:function(){return new n(Object(p.a)({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,raster:this.raster,timeExtent:this.timeExtent}))}}]),r}(d.a);Object(l.a)([Object(b.b)({types:u.a,json:{read:y.a}})],x.prototype,"geometry",void 0),Object(l.a)([Object(v.a)("geometry")],x.prototype,"writeGeometry",null),Object(l.a)([Object(b.b)({type:g.a,json:{write:!0}})],x.prototype,"mosaicRule",void 0),Object(l.a)([Object(b.b)({type:j.a})],x.prototype,"renderingRule",null),Object(l.a)([Object(b.b)({type:j.a,json:{write:!0,name:"renderingRule"}})],x.prototype,"rasterFunction",void 0),Object(l.a)([Object(b.b)({type:O.a,json:{write:!0}})],x.prototype,"pixelSize",void 0),Object(l.a)([Object(b.b)({json:{write:!0}})],x.prototype,"raster",void 0),Object(l.a)([Object(b.b)({type:c.a,json:{read:{source:"time"},write:{target:"time"}}})],x.prototype,"timeExtent",void 0);var w=x=n=Object(l.a)([Object(m.a)("esri.rest.support.ImageHistogramParameters")],x)},1598:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return v}));r(119);var n=r(89),a=r(88),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;Object(n.a)(this,e),this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=t,this._interval=Math.min(t,r)}return Object(a.a)(e,[{key:"decreaseRefCount",value:function(e,t){var r=e+"/"+t,n=this._cachedBlocks;if(n.has(r)){var a=n.get(r);return a.refCount--,a.refCount<=0&&(n.delete(r),a.controller&&a.controller.abort()),a.refCount}return 0}},{key:"getBlock",value:function(e,t){var r=e+"/"+t,n=this._cachedBlocks;if(n.has(r)){var a=n.get(r);return a.ts=Date.now(),a.refCount++,n.delete(r),n.set(r,a),a.block}return null}},{key:"putBlock",value:function(e,t,r,n){var a=this._cachedBlocks,i=e+"/"+t;if(a.has(i)){var o=a.get(i);o.ts=Date.now(),o.refCount++}else a.set(i,{block:r,ts:Date.now(),refCount:1,controller:n});this._trim(),this._updateTimer()}},{key:"deleteBlock",value:function(e,t){var r=this._cachedBlocks,n=e+"/"+t;r.has(n)&&r.delete(n)}},{key:"updateMaxSize",value:function(e){this._size=e,this._trim()}},{key:"empty",value:function(){this._cachedBlocks.clear(),this._clearTimer()}},{key:"getCurrentSize",value:function(){return this._cachedBlocks.size}},{key:"_updateTimer",value:function(){var e=this;if(null==this._timer){var t=this._cachedBlocks;this._timer=setInterval((function(){for(var r=Array.from(t),n=Date.now(),a=0;a<r.length&&r[a][1].ts<=n-e._duration;a++)t.delete(r[a][0]);0===t.size&&e._clearTimer()}),this._interval)}}},{key:"_trim",value:function(){var e=this._cachedBlocks;if(!(-1===this._size||this._size>=e.size))for(var t=Array.from(e),r=0;r<t.length-this._size;r++)e.delete(t[r][0])}},{key:"_clearTimer",value:function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}]),e}(),o=r(570),s=r(135),l=new Map,u=new i;function c(e,t){return null==t?e:"".concat(e,"?sliceId=").concat(t)}function f(e,t){var r={extent:null,rasterInfo:t,cache:new Map},n=l.get(e);return n?(n.push(r),n.length-1):(l.set(e,[r]),0)}function d(e,t){var r=l.get(e);r&&(r[t]=null,r.some((function(e){return null!=e}))||l.delete(e))}function p(e,t,r){var n,a=l.get(e);if(!a)return null==t?u.decreaseRefCount(e,r):0;if(null==t||null==a[t])return u.decreaseRefCount(e,r);var i=null===(n=a[t])||void 0===n?void 0:n.cache,o=null===i||void 0===i?void 0:i.get(r);if(i&&o){if(o.refCount--,0===o.refCount){i.delete(r);for(var s=0;s<a.length;s++){var c;null===(c=a[s])||void 0===c||c.cache.delete(r)}o.controller&&o.controller.abort()}return o.refCount}return 0}function h(e,t,r){var n,a=l.get(e);if(!a)return null==t?u.getBlock(e,r):null;if(null==t||null==a[t]){for(var i=0;i<a.length;i++){var o,s=null===(o=a[i])||void 0===o?void 0:o.cache.get(r);if(s)return s.refCount++,s.block}return u.getBlock(e,r)}var c=null===(n=a[t])||void 0===n?void 0:n.cache.get(r);if(c)return c.refCount++,c.block;for(var f=0;f<a.length;f++){var d;if(f!==t&&a[f]){var p=null===(d=a[f])||void 0===d?void 0:d.cache,h=null===p||void 0===p?void 0:p.get(r);if(p&&h)return h.refCount++,p.set(r,h),h.block}}return null}function b(e,t,r,n){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=l.get(e);if(o)if(null!=t&&null!=o[t]){var s={refCount:1,block:n,isResolved:!1,isRejected:!1,controller:i};n.then((function(){return s.isResolved=!0})).catch((function(){return s.isRejected=!0})),null===(a=o[t])||void 0===a||a.cache.set(r,s)}else u.putBlock(e,r,n,i);else null==t&&u.putBlock(e,r,n,i)}function m(e,t,r){var n,a=l.get(e);a?null!=t&&null!=a[t]?null===(n=a[t])||void 0===n||n.cache.delete(r):u.deleteBlock(e,r):null==t&&u.deleteBlock(e,r)}function v(e,t,r,n,a,i){var u,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=function(e,t){var r,n=l.get(e);return n&&null!==(r=n[t])&&void 0!==r?r:null}(e,t);if(f){var d=f.extent,p=f.cache,h=f.rasterInfo;if(!d||d.xmin!==r.xmin||d.xmax!==r.xmax||d.ymin!==r.ymin||d.ymax!==r.ymax){n=null!==(u=n)&&void 0!==u?u:0;for(var b=r.clone().normalize(),m=h.spatialReference,v=h.transform,y=new Set,g=0;g<b.length;g++){var j=b[g];if(!(j.xmax-j.xmin<=n||j.ymax-j.ymin<=n)){var O=Object(o.h)(j,m,c);null!=v&&(O=v.inverseTransform(O));var x=new s.a({x:n,y:n,spatialReference:j.spatialReference});if(null==a&&!(a=Object(o.k)(x,m,j,c)))return;var w=Object(o.n)(a,h,i||"closest"),I=w.pyramidLevel,M=w.pyramidResolution;if(w.excessiveReading)return;for(var k=h.storageInfo,S=k.origin,T={x:Math.max(0,Math.floor((O.xmin-S.x)/M.x)),y:Math.max(0,Math.floor((S.y-O.ymax)/M.y))},A=Math.ceil((O.xmax-O.xmin)/M.x-.1),D=Math.ceil((O.ymax-O.ymin)/M.y-.1),C=I>0?k.pyramidBlockWidth:k.blockWidth,R=I>0?k.pyramidBlockHeight:k.blockHeight,N=Math.max(0,Math.floor(T.x/C)-1),L=Math.max(0,Math.floor(T.y/R)-1),B=Math.floor((T.x+A-1)/C)+1,z=Math.floor((T.y+D-1)/R)+1,_=L;_<=z;_++)for(var P=N;P<=B;P++)y.add("".concat(I,"/").concat(_,"/").concat(P))}}p.forEach((function(e,t){if(!y.has(t)){var r=p.get(t);(null==r||r.isResolved||r.isRejected)&&p.delete(t)}})),f.extent={xmin:r.xmin,ymin:r.ymin,xmax:r.xmax,ymax:r.ymax}}}}},1767:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Ot}));var n=r(4),a=r(12),i=r(112),o=r(1),s=r(89),l=r(88),u=r(107),c=r(106),f=r(90),d=r(91),p=r(94),h=r(258),b=r(101),m=r(102),v=r(281),y=r(110),g=r(127),j=r(97),O=r(96),x=r(98),w=r(93),I=r(138),M=r(95),k=r(259),S=r(485),T=r(330),A=r(542),D=r(99),C=(r(119),r(1085)),R=r(129),N=r(136),L=r(132),B=r(324),z=r(244),_=r(573),P=r(1552),H=r(610),F=r(1553),E=r(323),U=r(105),J=r(111),Z=r(266),V=r(520),W=r(815),G=r(911),q=r(1598),K=r(470),X=r(1245),Q=r(420),Y=r(570),$=r(571),ee=r(130),te=r(135),re=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).datasetName=null,e.datasetFormat=null,e.hasUniqueSourceStorageInfo=!0,e.rasterInfo=null,e.ioConfig={sampling:"closest"},e}return Object(l.a)(r,[{key:"init",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(Y.g)(),this.addResolvingPromise(t),e.next=4,this.when();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"normalizeCtorArgs",value:function(e){return e&&e.ioConfig&&(e=Object(o.a)(Object(o.a)({},e),{},{ioConfig:Object(o.a)({resolution:null,bandIds:null,sampling:"closest",tileInfo:E.a.create()},e.ioConfig)})),e}},{key:"_isGlobalWrappableSource",get:function(){var e=this.rasterInfo,t=Object(Y.e)(e.spatialReference);return null!=t&&e.extent.width>=t/2}},{key:"_hasNoneOrGCSShiftTransform",get:function(){var e=this.rasterInfo.transform;return null==e||"gcs-shift"===e.type}},{key:"rasterJobHandler",set:function(e){var t;this._set("rasterJobHandler",e),"Function"===this.datasetFormat&&(null===(t=this.primaryRasters)||void 0===t||null===(t=t.rasters)||void 0===t||t.forEach((function(t){return t.rasterJobHandler=e})))}},{key:"url",set:function(e){this._set("url",Object(B.g)(e,m.a.getLogger(this)))}},{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new b.a("BaseRaster:open-not-implemented","open() is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(i=l.length>3&&void 0!==l[3]?l[3]:{}).tileInfo||this.rasterInfo.storageInfo.tileInfo,s=this.getTileExtentFromTileInfo(t,r,a,o),e.abrupt("return",this.fetchPixels(s,o.size[0],o.size[1],i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"identify",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,s,l,u,c,f,d,p,h,b,m,v,y,g,j,x,w,I,M,k,S,T,A,D,C,R,N,L,B,z,_,P,H,F,E,U,J,Z,V,W,K,X,Q,$=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=$.length>1&&void 0!==$[1]?$[1]:{},t=Object(O.d)(te.a,t).clone().normalize(),l=(s=i).multidimensionalDefinition,u=s.timeExtent,c=this.rasterInfo,f=c.hasMultidimensionalTranspose,d=c.multidimensionalInfo,p=i.transposedVariableName,(h=null!=d&&f&&(null!=u||Object(G.i)(l)))&&!p&&(p=null!=l&&l.length>0?null!==(b=l[0].variableName)&&void 0!==b?b:void 0:d.variables[0].name,i=Object(o.a)(Object(o.a)({},i),{},{transposedVariableName:p})),i=this._getRequestOptionsWithSliceId(i),m=c.spatialReference,v=c.extent,y=i.datumTransformation,g=Object(Y.i)(t,m,y),v.intersects(g)){e.next=11;break}return e.abrupt("return",{location:g,value:null});case 11:if(null==c.transform){e.next=16;break}if(j=c.transform.inverseTransform(g),c.nativeExtent.intersects(j)){e.next=15;break}return e.abrupt("return",{location:j,value:null});case 15:g=j;case 16:if(x=0,w=null!=p&&null!=d&&c.hasMultidimensionalTranspose,"Function"!==this.datasetFormat){e.next=40;break}if(I=this.primaryRasters.rasters[0],!w){e.next=22;break}return e.abrupt("return",I.identify(g,i));case 22:return M=c.pixelSize,k=3,S=M.x*k/2,T=M.y*k/2,A=new ee.a({xmin:g.x-S,xmax:g.x+S,ymin:g.y-T,ymax:g.y+T,spatialReference:m}),D={interpolation:"nearest"},e.next=30,I.fetchPixels(A,k,k,D);case 30:return C=e.sent,R=C.pixelBlock,e.next=34,this.fetchPixels(A,k,k,D);case 34:if(N=e.sent,L=N.pixelBlock,null!=R){e.next=38;break}return e.abrupt("return",{location:g,value:null});case 38:return B=Math.floor(k*k*.5),z=!R.mask||R.mask[B]?R.pixels.map((function(e){return e[B]})):null,e.abrupt("return",(null!=L&&(_=!L.mask||L.mask[B]?L.pixels.map((function(e){return e[B]})):void 0),{location:g,value:z,processedValue:_,pyramidLevel:0}));case 40:if(w){e.next=50;break}if(!i.srcResolution){e.next=45;break}x=Object(Y.n)(i.srcResolution,c,this.ioConfig.sampling).pyramidLevel,e.next=50;break;case 45:return e.next=47,this.computeBestPyramidLevelForLocation(t,i);case 47:if(null!=(x=e.sent)){e.next=50;break}return e.abrupt("return",{location:g,value:null});case 50:if(null!==(P=this.identifyPixelLocation(g,x,null,w))){e.next=53;break}return e.abrupt("return",{location:g,value:null});case 53:return H=P.row,F=P.col,E=P.rowOffset,U=P.colOffset,J=P.blockWidth,Z=null!==(r=p)&&void 0!==r?r:i.sliceId,V=Object(q.d)(this.url,Z),W="".concat(x,"/").concat(H,"/").concat(F),null==(K=Object(q.c)(V,null,W))&&(K=this.fetchRawTile(x,H,F,i),Object(q.e)(V,null,W,K)),e.next=58,K;case 58:if(null!=(X=e.sent)&&null!==(a=X.pixels)&&void 0!==a&&a.length){e.next=61;break}return e.abrupt("return",{location:g,value:null});case 61:return Q=E*J+U,e.abrupt("return",this._processIdentifyResult(X,{srcLocation:g,position:Q,pyramidLevel:x,useTransposedTile:!!w,requestSomeSlices:h,identifyOptions:i}));case 63:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=I.length>3&&void 0!==I[3]?I[3]:{},t=Object(Y.m)(t),i=this._getRequestOptionsWithSliceId(i),o=this._hasNoneOrGCSShiftTransform,!i.requestRawData||!o){e.next=5;break}return e.abrupt("return",this._fetchPixels(t,r,a,i));case 5:if(s=Object(Y.e)(t.spatialReference),l=Object(Y.f)(t),!(null==s||0===l||1===l&&this._isGlobalWrappableSource&&o)){e.next=8;break}return e.abrupt("return",this._fetchPixels(t,r,a,i));case 8:if(!(l>=3)){e.next=10;break}return e.abrupt("return",{extent:t,pixelBlock:null});case 10:for(u=[],f=(c=t).xmin,d=c.xmax,p=Math.round(s/(d-f)*r),h=p-Math.round((s/2-f)/(d-f)*r),b=0,m=[],v=0;v<=l;v++)y=new ee.a({xmin:0===v?f:-s/2,xmax:v===l?d-s*v:s/2,ymin:t.ymin,ymax:t.ymax,spatialReference:t.spatialReference}),b+=g=0===v?p-h:v===l?r-b:p,m.push(g),j=i.disableWrapAround&&v>0?null:this._fetchPixels(y,g,a,i),u.push(j);return e.next=16,Promise.all(u);case 16:if(O=e.sent.map((function(e){return null===e||void 0===e?void 0:e.pixelBlock})),x=null,w={width:r,height:a},!this.rasterJobHandler){e.next=25;break}return e.next=22,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:O,srcMosaicSize:w,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:m},i);case 22:x=e.sent.pixelBlock,e.next=26;break;case 25:x=Object(Q.o)(O,w,{blockWidths:m});case 26:return e.abrupt("return",{extent:t,srcExtent:Object(Y.h)(t,this.rasterInfo.spatialReference,i.datumTransformation),pixelBlock:x});case 27:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchRawPixels",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=O.length>3&&void 0!==O[3]?O[3]:{},r={x:Math.floor(r.x),y:Math.floor(r.y)},e.next=4,this._fetchRawTiles(t,r,a,i);case 4:if(o=e.sent,s=this.rasterInfo,l=s.nativeExtent,u=s.nativePixelSize,c=s.storageInfo,f=Math.pow(2,t),d=u.x*f,p=u.y*f,h=new ee.a({xmin:l.xmin+d*r.x,xmax:l.xmin+d*(r.x+a.width-1),ymin:l.ymax-p*(r.y+a.height-1),ymax:l.ymax-p*r.y,spatialReference:l.spatialReference}),o){e.next=15;break}return e.abrupt("return",{extent:h,srcExtent:h,pixelBlock:null});case 15:if(b=o.pixelBlocks,m=o.mosaicSize,1!==b.length||null==b[0]||b[0].width!==a.width||b[0].height!==a.height){e.next=18;break}return e.abrupt("return",{extent:h,srcExtent:h,pixelBlock:o.pixelBlocks[0]});case 18:if(v=t>0?c.pyramidBlockWidth:c.blockWidth,y=t>0?c.pyramidBlockHeight:c.blockHeight,g={x:r.x%v,y:r.y%y},!this.rasterJobHandler){e.next=25;break}return e.next=22,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:b,srcMosaicSize:m,destDimension:a,clipOffset:g,clipSize:a,coefs:null,sampleSpacing:null,interpolation:i.interpolation,alignmentInfo:null,blockWidths:null},i);case 22:j=e.sent.pixelBlock,e.next=26;break;case 25:j=Object(Q.o)(b,m,{clipOffset:g,clipSize:a});case 26:return e.abrupt("return",{extent:h,srcExtent:h,pixelBlock:j});case 27:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r,n){throw new b.a("BaseRaster:read-not-implemented","fetchRawTile() is not implemented")}},{key:"computeExtent",value:function(e){return Object(Y.h)(this.rasterInfo.extent,e)}},{key:"decodePixelBlock",value:function(e,t){return!this.rasterJobHandler||t.useCanvas?Object(X.a)(e,t):this.rasterJobHandler.decode({data:e,options:t})}},{key:"request",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a,i,s,l,u,c,f,d,p=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=p.length>2&&void 0!==p[2]?p[2]:0,l=this.ioConfig.customFetchParameters,u=r.range,c=r.query,f=r.headers,s=null!==(a=null!==(i=s)&&void 0!==i?i:r.retryCount)&&void 0!==a?a:this.ioConfig.retryCount,d=u?{Range:"bytes=".concat(u.from,"-").concat(u.to)}:null,e.prev=4,e.next=7,Object(R.default)(t,Object(o.a)(Object(o.a)({},r),{},{query:Object(o.a)(Object(o.a)({},c),l),headers:Object(o.a)(Object(o.a)({},f),d)}));case 7:return e.abrupt("return",e.sent);case 10:if(e.prev=10,e.t0=e.catch(4),!(s>0)){e.next=14;break}return e.abrupt("return",(s--,this.request(t,r,s)));case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSliceIndex",value:function(e){var t=this.rasterInfo.multidimensionalInfo;return null==t||null==e||0===e.length?null:Object(G.e)(e,t)}},{key:"getTileExtentFromTileInfo",value:function(e,t,r,n){var a=Object(J.m)(n.lodAt(e));return this.getTileExtent({x:a.resolution,y:a.resolution},t,r,n.origin,n.spatialReference,n.size)}},{key:"updateTileInfo",value:function(){var e=this.rasterInfo,t=e.storageInfo,r=e.spatialReference,n=e.extent,a=e.pixelSize;if(!t.tileInfo){for(var i=[],o=t.maximumPyramidLevel||0,s=Math.max(a.x,a.y),l=1/.0254*96*s,u=0;u<=o;u++)i.push(new V.a({level:o-u,resolution:s,scale:l})),s*=2,l*=2;var c=new te.a({x:n.xmin,y:n.ymax,spatialReference:r});t.tileInfo=new E.a({origin:c,size:[t.blockWidth,t.blockHeight],spatialReference:r,lods:i}),t.isVirtualTileInfo=!0}}},{key:"createRemoteDatasetStorageInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,n=arguments.length>3?arguments[3]:void 0,a=e.width,i=e.height,o=e.nativeExtent,s=e.pixelSize,l=e.spatialReference,u=new te.a({x:o.xmin,y:o.ymax,spatialReference:l});null==n&&(n=Math.max(0,Math.round(Math.log(Math.max(a,i))/Math.LN2-8)));var c=this.computeBlockBoundary(o,512,512,{x:o.xmin,y:o.ymax},[s],n);e.storageInfo=new W.a({blockWidth:t,blockHeight:r,pyramidBlockWidth:t,pyramidBlockHeight:r,origin:u,firstPyramidLevel:1,maximumPyramidLevel:n,blockBoundary:c})}},{key:"computeBestPyramidLevelForLocation",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"computeBlockBoundary",value:function(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2;if(1===a.length&&o>0)for(var l=(a=Object(i.a)(a))[0],u=l.x,c=l.y,f=0;f<o;f++)u*=s,c*=s,a.push({x:u,y:c});for(var d=[],p=n.x,h=n.y,b=0;b<a.length;b++){var m=a[b],v=m.x,y=m.y;d.push({minCol:Math.floor((e.xmin-p+.1*v)/t/v),maxCol:Math.floor((e.xmax-p-.1*v)/t/v),minRow:Math.floor((h-e.ymax+.1*y)/r/y),maxRow:Math.floor((h-e.ymin-.1*y)/r/y)})}return d}},{key:"getPyramidPixelSize",value:function(e){var t=this.rasterInfo.nativePixelSize,r=this.rasterInfo.storageInfo,n=r.pyramidResolutions,a=r.pyramidScalingFactor;if(0===e)return t;if(null!=n&&n.length)return n[e-1];var i=Math.pow(a,e);return{x:t.x*i,y:t.y*i}}},{key:"identifyPixelLocation",value:function(e,t,r,n){var a=this.rasterInfo,i=a.spatialReference,o=a.nativeExtent,s=a.storageInfo,l=s.maximumPyramidLevel,u=s.origin,c=s.transposeInfo,f=n&&null!=c?c.tileSize[0]:s.blockWidth,d=n&&null!=c?c.tileSize[1]:s.blockHeight,p=Object(Y.i)(e,i,r);if(!o.intersects(p))return null;if(t<0||t>l)return null;var h=this.getPyramidPixelSize(t),b=h.x,m=h.y,v=(u.y-p.y)/m/d,y=(p.x-u.x)/b/f,g=Math.min(d-1,Math.floor((v-Math.floor(v))*d)),j=Math.min(f-1,Math.floor((y-Math.floor(y))*f));return{pyramidLevel:t,row:Math.floor(v),col:Math.floor(y),rowOffset:g,colOffset:j,blockWidth:f,srcLocation:p}}},{key:"getTileExtent",value:function(e,t,r,n,a,i){var o=Object(D.a)(i,2),s=o[0],l=o[1],u=n.x+r*s*e.x,c=u+s*e.x,f=n.y-t*l*e.y,d=f-l*e.y;return new ee.a({xmin:u,xmax:c,ymin:d,ymax:f,spatialReference:a})}},{key:"getBlockWidthHeight",value:function(e){return{blockWidth:e>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:e>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}},{key:"isBlockOutside",value:function(e,t,r){var n=this.rasterInfo.storageInfo.blockBoundary[e];return!n||n.maxRow<t||n.maxCol<r||n.minRow>t||n.minCol>r}},{key:"_fetchPixels",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I,M,k,S,T,A,D,C,R,N,L,B,z,_,P,H,F,E,U,J,Z,V,W,G,q,K=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=K.length>3&&void 0!==K[3]?K[3]:{},!((o=Object(Y.f)(t))>=2)){e.next=4;break}return e.abrupt("return",{extent:t,pixelBlock:null});case 4:if(s=this._getSourceDataInfo(t,r,a,i),l=s.pyramidLevel,u=s.srcResolution,c=s.srcExtent,f=s.srcWidth,d=s.srcHeight,p=s.ul,0!==f&&0!==d){e.next=7;break}return e.abrupt("return",{extent:t,srcExtent:c,pixelBlock:null});case 7:return h=this.rasterInfo,b=h.transform,m="gcs-shift"===(null===b||void 0===b?void 0:b.type),v=null!=Object(Y.e)(t.spatialReference),!m&&v||(o=Object(Y.f)(s.srcExtent,m)),e.next=11,this._fetchRawTiles(l,p,{width:f,height:d,wrapCount:o},i);case 11:if(y=e.sent){e.next=14;break}return e.abrupt("return",{extent:t,srcExtent:c,pixelBlock:null});case 14:if(g=h.storageInfo,j=l>0?g.pyramidBlockWidth:g.blockWidth,O=l>0?g.pyramidBlockHeight:g.blockHeight,x=h.pixelSize,w=x.x,I=x.y,l>0&&(M=g.pyramidResolutions,k=g.pyramidScalingFactor,null!=M&&M[l-1]?(S=M[l-1],w=S.x,I=S.y):(T=Math.pow(k,l),w*=T,I*=T)),A=h.spatialReference,D=new te.a({x:w,y:I,spatialReference:A}),C=j===f&&O===d&&p.x%j==0&&p.y%O==0,R=new te.a({x:(t.xmax-t.xmin)/r,y:(t.ymax-t.ymin)/a,spatialReference:t.spatialReference}),N=!t.spatialReference.equals(A),L=A.isGeographic?1e-9:1e-4,B=i.datumTransformation,N||!C||1!==y.pixelBlocks.length||j!==r||O!==a||!this._isSameResolution(u,R,L)){e.next=20;break}return e.abrupt("return",{extent:t,srcExtent:c,srcTilePixelSize:D,pixelBlock:y.pixelBlocks[0]});case 20:if(z=v&&null!=Object(Y.e)(c.spatialReference)&&this._hasNoneOrGCSShiftTransform,_=i.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector"),e.t0=_&&!this.rasterJobHandler,!e.t0){e.next=25;break}return e.next=25,Object(Y.g)();case 25:if(!this.rasterJobHandler){e.next=31;break}return e.next=28,this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:t,srcBufferExtent:y.extent,pixelSize:R.toJSON(),datumTransformation:B,rasterTransform:b,hasWrapAround:o>0||z,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:_},i);case 28:e.t1=e.sent,e.next=32;break;case 31:e.t1=Object(Y.c)({projectedExtent:t,srcBufferExtent:y.extent,pixelSize:R,datumTransformation:B,rasterTransform:b,hasWrapAround:o>0||z,isAdaptive:!1,includeGCSGrid:_});case 32:if(P=e.t1,F=!i.requestRawData,E={rows:P.spacing[0],cols:P.spacing[1]},U=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(l,y.extent.xmin):void 0,J=y.pixelBlocks,Z=y.mosaicSize,V=y.isPartiallyFilled,W=null,!this.rasterJobHandler){e.next=43;break}return e.next=38,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:J,srcMosaicSize:Z,destDimension:F?{width:r,height:a}:null,coefs:F?P.coefficients:null,sampleSpacing:F?E:null,projectDirections:_,gcsGrid:_?P.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:i.interpolation,alignmentInfo:U,blockWidths:null},i);case 38:G=e.sent,H=G.pixelBlock,W=G.localNorthDirections,e.next=45;break;case 43:q=Object(Q.o)(J,Z,{alignmentInfo:U}),H=F?Object(Q.d)(q,{width:r,height:a},P.coefficients,E,i.interpolation):q,_&&P.gcsGrid&&(W=Object(Q.j)({width:r,height:a},P.gcsGrid),H=Object($.a)(H,this.rasterInfo.dataType,W));case 45:return e.abrupt("return",i.requestRawData||_?{extent:t,srcExtent:c,srcTilePixelSize:D,pixelBlock:H,transformGrid:P,localNorthDirections:W,isPartiallyFilled:V}:{extent:t,srcExtent:c,srcTilePixelSize:D,pixelBlock:H});case 46:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_fetchRawTiles",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a,i){var o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I,M,k,S,T,A,D,C,R,N,L,B,z,_,P,H,F,E,U=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.rasterInfo.storageInfo,s=o.origin,l=o.blockBoundary,u=this.getBlockWidthHeight(t),c=u.blockWidth,f=u.blockHeight,d=r.x,p=r.y,h=a.width,b=a.height,m=a.wrapCount,v=this._getRasterTileAlignmentInfo(t,0),i.buffer&&(d-=i.buffer.cols,p-=i.buffer.rows,h+=2*i.buffer.cols,b+=2*i.buffer.rows),y=0,g=0,j=0,m&&null!=v&&(g=v.worldColumnCountFromOrigin,j=v.originColumnOffset,y=v.rightPadding,g*v.blockWidth-y>=d+h&&(y=0)),O=Math.floor(d/c),x=Math.floor(p/f),w=Math.floor((d+h+y-1)/c),I=Math.floor((p+b+y-1)/f),M=l[t]){e.next=9;break}return e.abrupt("return",null);case 9:if(k=M.minRow,S=M.minCol,T=M.maxCol,A=M.maxRow,0!==m||!(I<k||w<S||x>A||O>T)){e.next=12;break}return e.abrupt("return",null);case 12:D=new Array,C=!1,R=null==this.ioConfig.allowPartialFill?i.allowPartialFill:this.ioConfig.allowPartialFill,N=x;case 16:if(!(N<=I)){e.next=27;break}L=Object(n.a)().mark((function e(){var r,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=B,!i.disableWrapAround&&m&&null!=v&&g<=B&&(r=B-g-j),N>=k&&r>=S&&A>=N&&T>=r?(a=U._fetchRawTile(t,N,r,i),R?D.push(new Promise((function(e){a.then((function(t){return e(t)})).catch((function(){C=!0,e(null)}))}))):D.push(a)):D.push(Promise.resolve(null));case 2:case"end":return e.stop()}}),e)})),B=O;case 19:if(!(B<=w)){e.next=24;break}return e.delegateYield(L(),"t0",21);case 21:B++,e.next=19;break;case 24:N++,e.next=16;break;case 27:if(0!==D.length){e.next=29;break}return e.abrupt("return",null);case 29:return e.next=31,Promise.all(D);case 31:return z=e.sent,_={height:(I-x+1)*f,width:(w-O+1)*c},P=this.rasterInfo.spatialReference,H=this.getPyramidPixelSize(t),F=H.x,E=H.y,e.abrupt("return",{extent:new ee.a({xmin:s.x+O*c*F,xmax:s.x+(w+1)*c*F,ymin:s.y-(I+1)*f*E,ymax:s.y-x*f*E,spatialReference:P}),pixelBlocks:z,mosaicSize:_,isPartiallyFilled:C});case 38:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_isSameResolution",value:function(e,t,r){return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r}},{key:"_fetchRawTile",value:function(e,t,r,n){var a=this.rasterInfo.storageInfo.blockBoundary[e];if(!a)return Promise.resolve(null);var i=a.minRow,s=a.minCol,l=a.maxCol,u=a.maxRow;if(t<i||r<s||t>u||r>l)return Promise.resolve(null);var c=Object(q.d)(this.url,n.sliceId),f="".concat(e,"/").concat(t,"/").concat(r),d=Object(q.c)(c,n.registryId,f);if(null==d){var p=new AbortController;d=this.fetchRawTile(e,t,r,Object(o.a)(Object(o.a)({},n),{},{signal:p.signal})),Object(q.e)(c,n.registryId,f,d,p),d.catch((function(){return Object(q.b)(c,n.registryId,f)}))}return n.signal&&Object(y.k)(n,(function(){Object(q.a)(c,n.registryId,f)})),d}},{key:"_computeMagDirValues",value:function(e){var t,r=this.rasterInfo,n=r.bandCount,a=r.dataType;if((2!==n||"vector-magdir"!==a)&&"vector-uv"!==a||2!==(null===e||void 0===e?void 0:e.length)||null===(t=e[0])||void 0===t||!t.length)return null;var i=e[0].length;if("vector-magdir"===a){var o=e[1].map((function(e){return(e+360)%360}));return[e[0],o]}for(var s=Object(D.a)(e,2),l=s[0],u=s[1],c=[],f=[],d=0;d<i;d++){var p=Object($.j)([l[d],u[d]]),h=Object(D.a)(p,2),b=h[0],m=h[1];c.push(b),f.push(m)}return[c,f]}},{key:"_getRasterTileAlignmentInfo",value:function(e,t){return null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=Object(Y.d)(this.rasterInfo)),null==this._rasterTileAlighmentInfo.pyramidsInfo?null:Object(o.a)({startX:t,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform},this._rasterTileAlighmentInfo.pyramidsInfo[e])}},{key:"_getSourceDataInfo",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a={datumTransformation:n.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};n.srcResolution&&(a.srcResolution=n.srcResolution,this._updateSourceDataInfo(e,a));var i=this.rasterInfo.storageInfo.maximumPyramidLevel||0,o=a.srcWidth,s=a.srcHeight,l=a.pyramidLevel,u=o/t,c=s/r,f=l<i&&u*c>=16,d=l===i&&this._requireTooManySrcTiles(o,s,t,r);if(f||d||0===o||0===s){var p=new te.a({x:(e.xmax-e.xmin)/t,y:(e.ymax-e.ymin)/r,spatialReference:e.spatialReference}),h=Object(Y.k)(p,this.rasterInfo.spatialReference,e,a.datumTransformation),b=!h||n.srcResolution&&h.x+h.y<n.srcResolution.x+n.srcResolution.y;if(f&&n.srcResolution&&b){var m=Math.round(Math.log(Math.max(u,c))/Math.LN2)-1;if(i-l+3>=m){var v=Math.pow(2,m);h={x:n.srcResolution.x*v,y:n.srcResolution.y*v}}}h&&(a.srcResolution=h,this._updateSourceDataInfo(e,a))}return this._requireTooManySrcTiles(a.srcWidth,a.srcHeight,t,r)&&(a.srcWidth=0,a.srcHeight=0),a}},{key:"_requireTooManySrcTiles",value:function(e,t,r,n){var a=this.rasterInfo.storageInfo.tileInfo;return Math.ceil(e/a.size[0])*Math.ceil(t/a.size[1])>=256||e/r>8||t/n>8}},{key:"_updateSourceDataInfo",value:function(e,t){t.srcWidth=0,t.srcHeight=0;var r=this.rasterInfo,n=r.spatialReference,a=t.srcResolution,i=t.datumTransformation,o=Object(Y.n)(a,r,this.ioConfig.sampling),s=o.pyramidLevel,l=o.pyramidResolution;if(!o.excessiveReading){var u=t.srcExtent||Object(Y.h)(e,n,i);if(null!=u){var c=r.transform;c&&(u=c.inverseTransform(u)),t.srcExtent=u;var f=r.storageInfo.origin,d=f.x,p=f.y,h=Math.floor((u.xmin-d)/l.x+.1),b=Math.floor((p-u.ymax)/l.y+.1),m=Math.floor((u.xmax-d)/l.x-.1),v=Math.floor((p-u.ymin)/l.y-.1),y=u.width<.1*l.x?0:m-h+1,g=u.height<.1*l.y?0:v-b+1;t.pyramidLevel=s,t.pyramidResolution=l,t.srcWidth=y,t.srcHeight=g,t.ul={x:h,y:b}}}}},{key:"_getRequestOptionsWithSliceId",value:function(e){return null!=this.rasterInfo.multidimensionalInfo&&null==e.sliceId&&(e=Object(o.a)(Object(o.a)({},e),{},{sliceId:this.getSliceIndex(e.multidimensionalDefinition)})),e}},{key:"_processIdentifyResult",value:function(e,t){var r=t.srcLocation,n=t.position,a=t.pyramidLevel,i=t.useTransposedTile,s=e.pixels[0].length/e.width/e.height;if(e.mask&&!e.mask[n])return{location:r,value:null};var l=this.rasterInfo.multidimensionalInfo;if(null==l||!i){var u=e.pixels.map((function(e){return e[n]})),c={location:r,value:u,pyramidLevel:a},f=this._computeMagDirValues(u.map((function(e){return[e]})));return null!==f&&void 0!==f&&f.length&&(c.magdirValue=f.map((function(e){return e[0]}))),c}var d=e.pixels.map((function(e){return e.slice(n*s,n*s+s)})),p=this._computeMagDirValues(d),h=t.requestSomeSlices,b=t.identifyOptions,m=Object(G.a)(l,b.transposedVariableName);if(h){var v,y=Object(G.d)(m,b.multidimensionalDefinition,b.timeExtent);d=d.map((function(e){return y.map((function(t){return e[t]}))})),p=null===(v=p)||void 0===v?void 0:v.map((function(e){return y.map((function(t){return e[t]}))})),m=y.map((function(e){return m[e]}))}var g,j=e.noDataValues||this.rasterInfo.noDataValue,O={pixels:d,pixelType:e.pixelType};return null!=j&&(Object(K.a)(O,j),g=O.mask),{location:r,value:null,dataSeries:m.map((function(e,t){var r,n,a={value:0===(null===(r=g)||void 0===r?void 0:r[t])?null:d.map((function(e){return e[t]})),multidimensionalDefinition:e.multidimensionalDefinition.map((function(e){return new _.a(Object(o.a)(Object(o.a)({},e),{},{isSlice:!0}))}))};return null!==(n=p)&&void 0!==n&&n.length&&(a.magdirValue=[p[0][t],p[1][t]]),a})),pyramidLevel:a}}}]),r}(Object(Z.b)(U.a));Object(p.a)([Object(j.b)()],re.prototype,"_rasterTileAlighmentInfo",void 0),Object(p.a)([Object(j.b)({readOnly:!0})],re.prototype,"_isGlobalWrappableSource",null),Object(p.a)([Object(j.b)({readOnly:!0})],re.prototype,"_hasNoneOrGCSShiftTransform",null),Object(p.a)([Object(j.b)()],re.prototype,"rasterJobHandler",null),Object(p.a)([Object(j.b)(z.o)],re.prototype,"url",null),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],re.prototype,"datasetName",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],re.prototype,"datasetFormat",void 0),Object(p.a)([Object(j.b)()],re.prototype,"hasUniqueSourceStorageInfo",void 0),Object(p.a)([Object(j.b)()],re.prototype,"rasterInfo",void 0),Object(p.a)([Object(j.b)()],re.prototype,"ioConfig",void 0),Object(p.a)([Object(j.b)()],re.prototype,"sourceJSON",void 0);var ne=re=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.BaseRaster")],re),ae=r(235),ie=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).datasetFormat="Function",e.tileType="Raster",e.rasterFunction=null,e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d,p,h,m,v=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return s=this.rasterFunction,null!==(r=this.primaryRasters)&&void 0!==r&&null!==(r=r.rasters)&&void 0!==r&&r.length?s.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=s.getPrimaryRasters(),this.rasterJobHandler&&(null===(a=this.primaryRasters.rasters)||void 0===a||a.forEach((function(e){return e.rasterJobHandler=v.rasterJobHandler})))),l=this.primaryRasters,u=l.rasters,c=l.rasterIds,f=u.map((function(e){return e.rasterInfo?void 0:e.open(t)})),e.next=7,Promise.all(f);case 7:if(d=u.map((function(e){return e.rasterInfo})),(p=s.bind({rasterInfos:d,rasterIds:c})).success&&0!==d.length){e.next=10;break}throw new b.a("raster-function:open","cannot bind the function: ".concat(null!==(i=p.error)&&void 0!==i?i:""));case 10:return"Table"===(null===(h="Table"===s.functionName?s:null===(o=s.functionArguments)||void 0===o?void 0:o.raster)||void 0===h?void 0:h.functionName)&&(s.rasterInfo.attributeTable=ae.a.fromJSON(h.functionArguments.attributeTableAsRecordSet)),e.next=14,this.syncJobHandler();case 14:m=d[0],this.hasUniqueSourceStorageInfo=1===d.length||d.slice(1).every((function(e){return v._hasSameStorageInfo(e,m)})),this.set("sourceJSON",u[0].sourceJSON),this.set("rasterInfo",s.rasterInfo);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"syncJobHandler",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.rasterJobHandler)||void 0===t?void 0:t.updateRasterFunction(this.rasterFunction));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I,M=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=M.length>3&&void 0!==M[3]?M[3]:{},c=this.primaryRasters,f=c.rasters,d=c.rasterIds,p=!1,h=u.interpolation,b=null===(i=this.rasterFunction.flatWebGLFunctionChain)||void 0===i?void 0:i.hasSurfaceFunction,!u.requestRawData&&"bilinear"!==h&&b&&(p=1===f.length&&!u.skipRasterFunction,u=Object(o.a)(Object(o.a)({},u),{},{interpolation:"bilinear",requestRawData:p})),m=f.map((function(e){return e.fetchPixels(t,r,a,u)})),e.next=8,Promise.all(m);case 8:if(v=e.sent,y=v.map((function(e){return e.pixelBlock})),g=p||u.requestRawData?v.map((function(e){return e.srcTilePixelSize})):null,!u.skipRasterFunction&&!y.every((function(e){return null==e}))){e.next=13;break}return e.abrupt("return",v[0]);case 13:if(j=null!==(s=null===(l=v.find((function(e){return null!=e.pixelBlock})))||void 0===l?void 0:l.extent)&&void 0!==s?s:t,!this.rasterJobHandler){e.next=20;break}return e.next=17,this.rasterJobHandler.process({extent:j,primaryPixelBlocks:y,primaryPixelSizes:g,primaryRasterIds:d});case 17:e.t0=e.sent,e.next=21;break;case 20:e.t0=this.rasterFunction.process({extent:j,primaryPixelBlocks:y,primaryPixelSizes:g,primaryRasterIds:d});case 21:if(O=e.t0,x=v[0].transformGrid,p&&null!=O&&null!=x){e.next=25;break}return e.abrupt("return",Object(o.a)(Object(o.a)({},v[0]),{},{pixelBlock:O}));case 25:if(w={rows:x.spacing[0],cols:x.spacing[1]},!this.rasterJobHandler){e.next=32;break}return e.next=29,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[O],srcMosaicSize:{width:O.width,height:O.height},destDimension:{width:r,height:a},coefs:x.coefficients,sampleSpacing:w,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:h,alignmentInfo:void 0,blockWidths:null},u);case 29:I=e.sent.pixelBlock,e.next=33;break;case 32:I=Object(Q.d)(O,{width:r,height:a},x.coefficients,w,h);case 33:return e.abrupt("return",{extent:t,srcExtent:v[0].srcExtent,pixelBlock:I});case 34:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_hasSameStorageInfo",value:function(e,t){var r=e.storageInfo,n=e.pixelSize,a=e.spatialReference,i=e.extent,o=t.storageInfo,s=t.pixelSize,l=t.spatialReference,u=t.extent;return n.x===s.x&&n.y===s.y&&a.equals(l)&&i.equals(u)&&r.blockHeight===o.blockHeight&&r.blockWidth===o.blockWidth&&r.maximumPyramidLevel===o.maximumPyramidLevel}}]),r}(ne);Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],ie.prototype,"datasetFormat",void 0),Object(p.a)([Object(j.b)()],ie.prototype,"tileType",void 0),Object(p.a)([Object(j.b)()],ie.prototype,"rasterFunction",void 0),Object(p.a)([Object(j.b)()],ie.prototype,"primaryRasters",void 0);var oe=ie=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.FunctionRaster")],ie),se=r(194),le=r(414);function ue(e,t,r){return ce.apply(this,arguments)}function ce(){return(ce=Object(a.a)(Object(n.a)().mark((function e(t,a,o){var s,l,u,c,f,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("extent"!==o.type){e.next=2;break}return e.abrupt("return",de(t,a,o));case 2:return s=t.width,l=t.height,u=new Uint8Array(s*l),e.next=7,Promise.all([r.e(7),r.e(64)]).then(r.bind(null,2218));case 7:return c=e.sent,f=c.contains,d=c.intersects,e.abrupt("return",d(a,o)?"polyline"===o.type?pe(t,a,o):f(o,a)?t:fe(t,a,o):new le.a({pixelType:t.pixelType,width:s,height:l,mask:u,maskIsAlpha:!1,pixels:Object(i.a)(t.pixels)}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t,r){if(!e)return e;var n,a=e.width,o=e.height,s=t.width/a,l=t.height/o,u=t.xmin,c=t.ymax;if("extent"===r.type){var f=(r.xmin-u)/s,d=(r.xmax-u)/s,p=(c-r.ymax)/l,h=(c-r.ymin)/l;n=[[[f,p],[f,h],[d,h],[d,p],[f,p]]]}else n=r.rings.map((function(e){return e.map((function(e){var t=Object(D.a)(e,2),r=t[0],n=t[1];return[(r-u)/s,(c-n)/l]}))}));var b=document.createElement("canvas");b.width=a,b.height=o;var m=b.getContext("2d");m.fillStyle="#f00",n.forEach((function(e){m.beginPath(),m.moveTo(e[0][0],e[0][1]);for(var t=0;t<e.length;t++)m.lineTo(e[t][0],e[t][1]);m.closePath(),m.fill()}));for(var v=m.getImageData(0,0,a,o).data,y=e.mask,g=a*o,j=new Uint8Array(g),O=0;O<g;O++)y&&!y[O]||(j[O]=v[4*O+3]>127?255:0);return new le.a({pixelType:e.pixelType,width:a,height:o,mask:j,maskIsAlpha:!1,pixels:Object(i.a)(e.pixels)})}function de(e,t,r){var n=e.width,a=e.height,o=new Uint8Array(n*a),s=t.width/n,l=t.height/a;if(r.width/s<.5||r.height/l<.5)return new le.a({pixelType:e.pixelType,width:n,height:a,mask:o,pixels:Object(i.a)(e.pixels)});var u=t.xmin,c=t.xmax,f=t.ymin,d=t.ymax,p=r.xmin,h=r.xmax,b=r.ymin,m=r.ymax,v=Math.max(u,p),y=Math.min(c,h),g=Math.max(f,b),j=Math.min(d,m),O=.5*s,x=.5*l;if(y-v<O||j-g<x||y<u+O||v>c-O||g>d-x||j<f+x)return new le.a({pixelType:e.pixelType,width:n,height:a,mask:o,pixels:Object(i.a)(e.pixels)});var w=Math.max(0,(v-u)/s),I=Math.min(n,Math.max(0,(y-u)/s)),M=Math.max(0,(d-j)/l),k=Math.min(a,Math.max(0,(d-g)/l)),S=Math.round(w),T=Math.round(I)-1,A=Math.round(M),D=Math.round(k)-1;if(S===T&&w%1>.5&&I%1<.5||A===D&&M%1>.5&&k%1<.5)return new le.a({pixelType:e.pixelType,width:n,height:a,mask:o,pixels:Object(i.a)(e.pixels)});if(0===S&&0===A&&T===n&&D===a)return e;for(var C=e.mask,R=A;R<=D;R++)for(var N=S;N<=T;N++){var L=R*n+N;o[L]=C?C[L]:255}return new le.a({pixelType:e.pixelType,width:n,height:a,mask:o,pixels:Object(i.a)(e.pixels)})}function pe(e,t,r){for(var n=e.width,a=e.height,o=new Uint8Array(n*a),s=t.width/n,l=t.height/a,u=t.xmin,c=t.ymax,f=r.paths,d=e.mask,p=0;p<f.length;p++)for(var h=f[p],b=0;b<h.length-1;b++){var m=Object(D.a)(h[b],2),v=m[0],y=m[1],g=Object(D.a)(h[b+1],2),j=g[0],O=g[1],x=Math.floor((c-y)/l),w=Math.floor((c-O)/l);if(w<x){var I=x;x=w,w=I}x=Math.max(0,x),w=Math.min(a-1,w);for(var M=(j-v)/(O-y),k=x;k<=w;k++){var S=k===x?Math.max(y,O):(a+1-k)*l,T=k===w?Math.min(y,O):S-l,A=O===y?Math.floor((v-u)/s):Math.floor((M*(S-y)+v-u)/s),C=O===y?Math.floor((j-u)/s):Math.floor((M*(T-y)+v-u)/s);if(C<A){var R=A;A=C,C=R}var N=k*n;A=Math.max(0,A),C=Math.min(n-1,C);for(var L=N+A;L<=N+C;L++)o[L]=d?d[L]:255}}return new le.a({pixelType:e.pixelType,width:n,height:a,mask:o,pixels:Object(i.a)(e.pixels)})}function he(e,t,r){var n,a,i,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=e.spatialReference,l=function(e,t){if(e.spatialReference.equals(t))return e;var r=Object(se.e)(e.spatialReference),n=Object(se.e)(t);if(r===n)return e;var a=r/n;return{x:e.x*a,y:e.y*a}}(r,s),u=l.x,c=l.y,f="extent"===t.type?t:t.extent,d=f.xmin,p=f.xmax,h=f.ymax,b=f.ymin,m=e.extent,v=m.xmin,y=m.ymax;return o?(d=v+(d>v?u*Math.round((d-v)/u):0),h=y-(h<y?c*Math.round((y-h)/c):0),p=v+(p>v?u*Math.round((p-v)/u):0),b=y-(b<y?c*Math.round((y-b)/c):0),n=new ee.a({xmin:d,ymax:h,xmax:p,ymin:b,spatialReference:s}),a=Math.round(n.width/u),i=Math.round(n.height/c)):(a=Math.floor((p-d)/u+.8),i=Math.floor((h-b)/c+.8),p=(d=v+(d>v?u*Math.floor((d-v)/u+.1):0))+a*u,b=(h=y-(h<y?c*Math.floor((y-h)/c+.1):0))-i*c,n=new ee.a({xmin:d,ymax:h,xmax:p,ymin:b,spatialReference:s})),{extent:n,width:a,height:i}}var be=r(1574),me=r(738),ve=r(1554),ye=r(1330),ge=r(1556),je=r(816),Oe=r(125),xe=m.a.getLogger("esri.layers.mixins.ImageryTileMixin"),we=r(311),Ie=r(326),Me=r(425),ke=r(302),Se=r(566),Te=r(325),Ae=r(854),De=r(557),Ce=r(1661);function Re(e){var t=e.fields,r=e.records,n=t.some((function(e){return"oid"===e.name.toLowerCase()}))?"OBJECTID":"OID",a=[{name:n,type:"esriFieldTypeOID",alias:"OID"}].concat(t.map((function(e){return{name:e.name,type:"esriFieldType"+e.typeName,alias:e.name}}))),i=a.map((function(e){return e.name})),o=[],s=0,l=0;return r.forEach((function(e){var t={};for(t[n]=s++,l=1;l<i.length;l++)t[i[l]]=e[l-1];o.push({attributes:t})})),{displayFieldName:"",fields:a,features:o}}var Ne=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"supportedVersions",get:function(){return[5]}},{key:"parse",value:function(e){var t=new DataView(e),r=3&t.getUint8(0);if(3!==r)return{header:{version:r},recordSet:null};var n,a=t.getUint32(4,!0),i=t.getUint16(8,!0),o=t.getUint16(10,!0),s={version:r,recordCount:a,headerByteCount:i,recordByteCount:o},l=32,u=[],c=[];if(3===r){for(;13!==t.getUint8(l);)n=String.fromCharCode(t.getUint8(l+11)).trim(),u.push({name:Object(Ce.a)(new Uint8Array(e,l,11)),type:n,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(n)],length:t.getUint8(l+16)}),l+=32;if(l+=1,u.length>0)for(var f=function(){var r=[];32===t.getUint8(l)?(l+=1,u.forEach((function(t){if("C"===t.type)r.push(Object(Ce.a)(new Uint8Array(e,l,t.length)).trim());else if("N"===t.type)r.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim(),10));else if("F"===t.type)r.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim()));else if("D"===t.type){var n=String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim();r.push(new Date(parseInt(n.substring(0,4),10),parseInt(n.substring(4,6),10)-1,parseInt(n.substring(6,8),10)))}l+=t.length})),c.push(r)):l+=o};c.length<a&&e.byteLength-l>o;)f()}return{header:s,fields:u,records:c,recordSet:Re({fields:u,records:c})}}}]),e}(),Le=r(1797),Be=new Map;Be.set("int16","esriFieldTypeSmallInteger"),Be.set("int32","esriFieldTypeInteger"),Be.set("int64","esriFieldTypeInteger"),Be.set("float32","esriFieldTypeSingle"),Be.set("float64","esriFieldTypeDouble"),Be.set("text","esriFieldTypeString");var ze=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).storageInfo=null,e.datasetFormat="CRF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this.request(this.url+"/conf.json",{signal:null===t||void 0===t?void 0:t.signal});case 4:if(r=e.sent,a=r.data,this._validateHeader(a)){e.next=8;break}throw new b.a("cloudraster:open","Invalid or unsupported conf.json.");case 8:if(this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),i=this._parseHeader(a),o=i.storageInfo,"thematic"!==(s=i.rasterInfo).dataType){e.next=15;break}return e.next=13,this._fetchAuxiliaryInformation();case 13:l=e.sent,s.attributeTable=l;case 15:this._set("storageInfo",o),this._set("rasterInfo",s),this.ioConfig.retryCount=this.ioConfig.retryCount||0;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=j.length>3&&void 0!==j[3]?j[3]:{},o=this.rasterInfo.storageInfo.transposeInfo,s=i.transposedVariableName,!((u=(l=!(!o||!s))?0:this.rasterInfo.storageInfo.maximumPyramidLevel-t)<0)){e.next=4;break}return e.abrupt("return",null);case 4:return c=this._buildCacheFilePath(u,r,a,i.multidimensionalDefinition,s),f=this._getIndexRecordFromBundle(r,a,l),e.next=8,this.request(c,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:i.signal});case 8:if(d=e.sent){e.next=11;break}return e.abrupt("return",null);case 11:if(p=new Uint8Array(d.data),0!==(h=this._getTileEndAndContentType(p,f)).recordSize){e.next=14;break}return e.abrupt("return",null);case 14:return e.next=16,this.request(c,{range:{from:h.position,to:h.position+h.recordSize},responseType:"array-buffer",signal:i.signal});case 16:if(b=e.sent){e.next=19;break}return e.abrupt("return",null);case 19:return m=this._getTileSize(l),v=Object(D.a)(m,2),y=v[0],g=v[1],e.abrupt("return",this.decodePixelBlock(b.data,{width:y,height:g,planes:null,pixelType:null,returnInterleaved:l}));case 21:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_validateHeader",value:function(e){return e&&"RasterInfo"===e.type&&!["origin","extent","geodataXform","LODInfos","blockWidth","blockHeight","bandCount","pixelType","pixelSizeX","pixelSizeY","format","packetSize"].some((function(t){return!e[t]}))}},{key:"_parseHeader",value:function(e){var t,r,n=["u1","u2","u4","u8","s8","u16","s16","u32","s32","f32","f64"][e.pixelType],a=e.bandCount,i=e.histograms,o=e.colormap,s=e.blockWidth,l=e.blockHeight,u=e.firstPyramidLevel,c=e.maximumPyramidLevel,f=e.statistics&&e.statistics.map((function(e){return{min:e.min,max:e.max,avg:e.mean,stddev:e.standardDeviation,median:e.median,mode:e.mode}})),d=e.extent.spatialReference,p=null===(t=e.geodataXform)||void 0===t?void 0:t.spatialReference,h=new Oe.a(null!==d&&void 0!==d&&d.wkid||null!==d&&void 0!==d&&d.wkt?d:p),b=new ee.a({xmin:e.extent.xmin,ymin:e.extent.ymin,xmax:e.extent.xmax,ymax:e.extent.ymax,spatialReference:h}),m=new te.a({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:h}),v=Math.round((b.xmax-b.xmin)/m.x),y=Math.round((b.ymax-b.ymin)/m.y),g=this._parseTransform(e.geodataXform),j=g?b:null;g&&(b=g.forwardTransform(b),m.x=(b.xmax-b.xmin)/v,m.y=(b.ymax-b.ymin)/y);var O,x,w,I,M=null!==(r=e.properties)&&void 0!==r?r:{},k=e.format.toLowerCase().replace("cache/",""),S=new te.a(e.origin.x,e.origin.y,h);if(o&&o.colors)for(O=[],x=0;x<o.colors.length;x++)w=o.colors[x],I=o.values?o.values[x]:x,O.push([I,255&w,w<<16>>>24,w<<8>>>24,w>>>24]);var T=e.LODInfos,A=[];for(x=0;x<T.levels.length;x++)A.push(new V.a({level:T.levels[x],resolution:T.resolutions[x],scale:96/.0254*T.resolutions[x]}));var D=new E.a({dpi:96,lods:A,format:k,origin:S,size:[s,l],spatialReference:h}),C={recordSize:8,packetSize:e.packetSize,headerSize:e.packetSize*e.packetSize*8+64},R=[{maxCol:Math.ceil(v/s)-1,maxRow:Math.ceil(y/l)-1,minCol:0,minRow:0}],N=2;if(c>0)for(x=0;x<c;x++)R.push({maxCol:Math.ceil(v/N/s)-1,maxRow:Math.ceil(y/N/l)-1,minCol:0,minRow:0}),N*=2;var L=e.mdInfo,B=null;if(L&&M._yxs){var z=M._yxs;B={packetSize:z.PacketSize,tileSize:[z.TileXSize,z.TileYSize]}}return{storageInfo:C,rasterInfo:new De.a({width:v,height:y,pixelType:n,bandCount:a,extent:b,nativeExtent:j,transform:g,spatialReference:h,pixelSize:m,keyProperties:M,statistics:f,histograms:i,multidimensionalInfo:L,colormap:O,storageInfo:new W.a({blockWidth:s,blockHeight:l,pyramidBlockWidth:s,pyramidBlockHeight:l,origin:S,tileInfo:D,transposeInfo:B,firstPyramidLevel:u,maximumPyramidLevel:c,blockBoundary:R})})}}},{key:"_parseTransform",value:function(e){var t,r;if(!Object(Le.a)(e))throw new b.a("cloudraster:open","the data contains unsupported geodata transform types");var n=Object(Le.b)(e);if("identity"===n.type)return null;if("polynomial"!==n.type||null===(t=n.forwardCoefficients)||void 0===t||!t.length||null===(r=n.inverseCoefficients)||void 0===r||!r.length)throw new b.a("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return n}},{key:"_fetchAuxiliaryInformation",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.request(this.url+"/conf.vat.json",{signal:t}).then((function(e){return e.data})).catch((function(){return null})),a=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:t}).then((function(e){return e.data})).catch((function(){return null})),e.next=4,Promise.all([r,a]);case 4:return(i=e.sent)[0]&&(s=i[0].fields,l=i[0].values,s&&l&&(s=s.map((function(e){return{type:"OID"===e.name?"esriFieldTypeOID":Be.get(e.type),name:e.name,alias:e.alias||e.name}})),u=l.map((function(e){return{attributes:e}})),s&&l&&(o={fields:s,features:u}))),!o&&i[1]&&(o=Ne.parse(i[1]).recordSet),e.abrupt("return",ae.a.fromJSON(o));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_buildCacheFilePath",value:function(e,t,r,n,a){var i=this._getPackageSize(!!a),o=Math.floor(t/i)*i,s=Math.floor(r/i)*i,l="R"+this._toHexString4(o)+"C"+this._toHexString4(s),u="L";u+=e>=10?e.toString():"0"+e.toString();var c=this.rasterInfo.multidimensionalInfo,f=null===n||void 0===n?void 0:n[0];if(null==c||!f)return"".concat(this.url,"/_alllayers/").concat(u,"/").concat(l,".bundle");var d="_yxs";if(!a){d=c.variables.find((function(e){return e.name===f.variableName})).dimensions[0].values.indexOf(f.values[0]).toString(16);for(var p=4-d.length,h=0;h<p;h++)d="0"+d;d="S"+d}var b=this._getVariableFolderName(a||f.variableName);return"".concat(this.url,"/_alllayers/").concat(b,"/").concat(d,"/").concat(u,"/").concat(l,".bundle")}},{key:"_getPackageSize",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.rasterInfo.storageInfo.transposeInfo;return t&&null!=r?null!==(e=r.packetSize)&&void 0!==e?e:0:this.storageInfo.packetSize}},{key:"_getTileSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.rasterInfo.storageInfo,r=t.transposeInfo;return e&&null!=r?r.tileSize:t.tileInfo.size}},{key:"_getVariableFolderName",value:function(e){return""===(e=e.trim())?"_v":e.replaceAll(/[\{|\}\-]/g,"_").replace("\\*","_v")}},{key:"_getIndexRecordFromBundle",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._getPackageSize(r),a=n*(e%n)+t%n;if(a<0)throw new Error("Invalid level / row / col");return 20+a*this.storageInfo.recordSize+44}},{key:"_getTileEndAndContentType",value:function(e,t){var r,n=e.subarray(t,t+8),a=0;for(r=0;r<5;r++)a|=(255&n[r])<<8*r;var i=0xffffffffff&a;for(a=0,r=5;r<8;r++)a|=(255&n[r])<<8*(r-5);return{position:i,recordSize:0xffffffffff&a}}},{key:"_toHexString4",value:function(e){var t=e.toString(16);if(4!==t.length)for(var r=4-t.length;r-- >0;)t="0"+t;return t}}]),r}(ne);Object(p.a)([Object(j.b)({readOnly:!0})],ze.prototype,"storageInfo",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],ze.prototype,"datasetFormat",void 0);var _e=ze=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.CloudRaster")],ze),Pe=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).datasetFormat="MEMORY",e.data=null,e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return i=this.data,o=this.data,s=o.pixelBlock,l=o.statistics,u=o.histograms,c=o.name,f=o.keyProperties,d=o.nativeExtent,p=o.transform,h=s.width,b=s.height,m=s.pixelType,v=null!==(r=i.extent)&&void 0!==r?r:new ee.a({xmin:-.5,ymin:.5,xmax:h-.5,ymax:b-.5,spatialReference:new Oe.a({wkid:3857})}),y=null!==(a=i.isPseudoSpatialReference)&&void 0!==a?a:!i.extent,g={x:v.width/h,y:v.height/b},j=new De.a({width:h,height:b,pixelType:m,extent:v,nativeExtent:d,transform:p,pixelSize:g,spatialReference:v.spatialReference,bandCount:s.pixels.length,keyProperties:f||{},statistics:l,isPseudoSpatialReference:y,histograms:u}),this.createRemoteDatasetStorageInfo(j,512,512),this._set("rasterInfo",j),this.updateTileInfo(),e.next=8,this._buildInMemoryRaster(s,{width:512,height:512},t);case 8:this.datasetName=c,this.url="/InMemory/"+c;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r){var n=this._pixelBlockTiles.get("".concat(e,"/").concat(t,"/").concat(r));return Promise.resolve(n)}},{key:"_buildInMemoryRaster",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.rasterInfo.storageInfo.maximumPyramidLevel,l=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:t,tileSize:r,maximumPyramidLevel:s},a):Promise.resolve(Object(Q.t)(t,r,s)),u=null!=this.rasterInfo.statistics,c=null!=this.rasterInfo.histograms,f=u?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:t},a):Promise.resolve(Object(me.g)(t)),e.next=7,Object(y.e)([l,f]);case 7:if((d=e.sent)[0].value||!d[1].value){e.next=10;break}throw new b.a("inmemory-raster:open","failed to build in memory raster");case 10:this._pixelBlockTiles=d[0].value,u||(this.rasterInfo.statistics=null===(i=d[1].value)||void 0===i?void 0:i.statistics),c||(this.rasterInfo.histograms=null===(o=d[1].value)||void 0===o?void 0:o.histograms);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(ne);Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],Pe.prototype,"datasetFormat",void 0),Object(p.a)([Object(j.b)()],Pe.prototype,"data",void 0);var He=Pe=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.InMemoryRaster")],Pe);function Fe(e,t){if(!e||!t)return[];var r=t;t.includes("/")?(r=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";var n=[];if(t){for(var a=Fe(e,r),i=0;i<a.length;i++)Fe(a[i],t).forEach((function(e){return n.push(e)}));return n}var o=e.getElementsByTagNameNS("*",r);if(!o||0===o.length)return[];for(var s=0;s<o.length;s++)n.push(o[s]||o.item(s));return n}function Ee(e,t){if(!e||!t)return null;var r=t;t.includes("/")?(r=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";var n=Fe(e,r);return n.length>0?t?Ee(n[0],t):n[0]:null}function Ue(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r?Ee(e,r):e;return n?(t=n.textContent||n.nodeValue)?t.trim():null:null}function Je(e,t){return function(e,t){for(var r,n=Fe(e,t),a=[],i=0;i<n.length;i++)(r=n[i].textContent||n[i].nodeValue)&&""!==(r=r.trim())&&a.push(r);return a}(e,t).map((function(e){return Number(e)}))}function Ze(e,t){var r=Ue(e,t);return Number(r)}function Ve(e,t){var r,n=null===e||void 0===e||null===(r=e.nodeName)||void 0===r?void 0:r.toLowerCase(),a=t.toLowerCase();return n.slice(n.lastIndexOf(":")+1)===a}var We=r(1176);function Ge(e,t){if(!e||!t)return null;for(var r=[],n=0;n<e.length;n++)r.push(e[n]),r.push(t[n]);return r}function qe(e){if(!e)return null;var t=Number(e);if(!isNaN(t)&&0!==t)return new Oe.a({wkid:t});if((e=String(e)).startsWith("COMPD_CS")){if(!e.includes("VERTCS")||!e.includes("GEOGCS")&&!e.startsWith("PROJCS"))return null;var r=e.indexOf("VERTCS"),n=e.indexOf("PROJCS"),a=n>-1?n:e.indexOf("GEOGCS");if(-1===a)return null;var i=e.slice(a,e.lastIndexOf("]",r)+1).trim(),o=e.slice(r,e.lastIndexOf("]")).trim();t=Ke(i);var s=new Oe.a(t?{wkid:t}:{wkt:i}),l=Ke(o);return l&&(s.vcsWkid=l),s}return e.startsWith("GEOGCS")||e.startsWith("PROJCS")?(t=Ke(e),new Oe.a(0!==t?{wkid:t}:{wkt:e})):null}function Ke(e){var t,r=e.replaceAll("]","[").replaceAll('"',"").split("[").map((function(e){return e.trim()})).filter((function(e){return""!==e})),n=r[r.length-1].split(","),a=null===(t=n[0])||void 0===t?void 0:t.toLowerCase();if(("epsg"===a||"esri"===a)&&e.endsWith('"]]')){var i=Number(n[1]);if(!isNaN(i)&&0!==i)return i}return 0}function Xe(e){var t;if("pamdataset"!==(null===e||void 0===e||null===(t=e.documentElement.tagName)||void 0===t?void 0:t.toLowerCase()))return{};var r={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};e.documentElement.childNodes.forEach((function(e){if(1===e.nodeType)if(Ve(e,"SRS")){if(!r.spatialReference){var t=Ue(e);r.spatialReference=qe(t)}}else if(Ve(e,"Metadata"))if("xml:ESRI"===e.getAttribute("domain")){var n=function(e){var t,r=Ee(e,"GeodataXform"),n=qe(Ze(r,"SpatialReference/WKID")||Ue(r,"SpatialReference/WKT"));if("typens:PolynomialXform"!==r.getAttribute("xsi:type"))return{spatialReference:n,transform:null};var a=null!==(t=Ze(r,"PolynomialOrder"))&&void 0!==t?t:1,i=Je(r,"CoeffX/Double"),o=Je(r,"CoeffY/Double"),s=Je(r,"InverseCoeffX/Double"),l=Je(r,"InverseCoeffY/Double"),u=Ge(i,o),c=Ge(s,l);return{spatialReference:n,transform:u&&c&&u.length&&c.length?new We.a({spatialReference:n,polynomialOrder:a,forwardCoefficients:u,inverseCoefficients:c}):null}}(e),a=n.spatialReference,i=n.transform;r.transform=i,r.spatialReference||(r.spatialReference=a)}else Fe(e,"MDI").forEach((function(e){return r.metadata[e.getAttribute("key")]=Ue(e)}));else if(Ve(e,"PAMRasterBand")){var o=function(e){var t,r,n,a,i,o=Ze(e,"NoDataValue"),s=Ee(e,"Histograms/HistItem"),l=Ze(s,"HistMin"),u=Ze(s,"HistMax"),c=Ze(s,"BucketCount"),f=null===(t=Ue(s,"HistCounts"))||void 0===t?void 0:t.split("|").map((function(e){return Number(e)}));Fe(e,"Metadata/MDI").forEach((function(e){var t,o=Number(null!==(t=e.textContent)&&void 0!==t?t:e.nodeValue);switch(e.getAttribute("key").toUpperCase()){case"STATISTICS_MINIMUM":r=o;break;case"STATISTICS_MAXIMUM":n=o;break;case"STATISTICS_MEAN":a=o;break;case"STATISTICS_STDDEV":i=o}}));var d=Ze(e,"Metadata/SourceBandIndex");return{noDataValue:o,histogram:null!==f&&void 0!==f&&f.length&&null!=l&&null!=u?{min:l,max:u,size:c||f.length,counts:f}:null,sourceBandIndex:d,statistics:null!=r&&null!=n?{min:r,max:n,avg:a,stddev:i}:null}}(e);null!=o.sourceBandIndex&&null==r.rasterBands[o.sourceBandIndex]?r.rasterBands[o.sourceBandIndex]=o:r.rasterBands.push(o)}}));var n=r.rasterBands;if(n.length){var a=!!n[0].statistics;r.statistics=a?n.map((function(e){return e.statistics})).filter(x.i):null;var i=!!n[0].histogram;r.histograms=i?n.map((function(e){return e.histogram})).filter(x.i):null}return r}var Qe=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){return Object(s.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d,p,h,b;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this._fetchData(t);case 4:return r=e.sent,e.next=7,this._fetchAuxiliaryData(t);case 7:return a=e.sent,i=a.spatialReference,o=a.statistics,s=a.histograms,l=a.transform,(u=!i)&&(i=new Oe.a({wkid:3857})),(null===s||void 0===s?void 0:s.length)&&null==o&&(o=Object(me.f)(s)),c=r.width,f=r.height,d=new ee.a({xmin:-.5,ymin:.5-f,xmax:c-.5,ymax:.5,spatialReference:i}),p=l?l.forwardTransform(d):d,!0,l&&(h=l.forwardCoefficients,h&&0===h[1]&&0===h[2]&&(l=null,d=p)),b=new He({data:{extent:p,nativeExtent:d,transform:l,pixelBlock:r,statistics:o,histograms:s,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:u}}),e.next=22,b.open();case 22:b.data=null,this._set("rasterInfo",b.rasterInfo),this._inMemoryRaster=b;case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._inMemoryRaster.fetchRawTile(e,t,r,n)}},{key:"_fetchData",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(this.url,{responseType:"array-buffer",signal:null===t||void 0===t?void 0:t.signal});case 2:if(r=e.sent,a=r.data,"JPG"===(i=Object(X.b)(a).toUpperCase())||"PNG"===i||"GIF"===i||"BMP"===i){e.next=7;break}throw new b.a("image-aux-raster:open","the data is not a supported format");case 7:return this._set("datasetFormat",i),o=i.toLowerCase(),s="gif"===o||"bmp"===o||!Object(w.a)("ios"),e.next=12,this.decodePixelBlock(a,{format:o,useCanvas:s,hasNoZlibMask:!0});case 12:if(null!=(l=e.sent)){e.next=15;break}throw new b.a("image-aux-raster:open","the data cannot be decoded");case 15:return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchAuxiliaryData",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d,p;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null===t||void 0===t?void 0:t.signal,o=null!==(r=this.ioConfig.skipExtensions)&&void 0!==r?r:[],s=o.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:i}),l=this.datasetFormat,c=(u="JPG"===l?"jgw":"PNG"===l?"pgw":"BMP"===l?"bpw":null)&&o.includes(u)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+u,{responseType:"text",signal:i}),e.next=8,Object(y.e)([s,c]);case 8:if(f=e.sent,null===i||void 0===i||!i.aborted){e.next=11;break}throw Object(y.b)();case 11:return(d=Xe(null===(a=f[0].value)||void 0===a?void 0:a.data)).transform||(p=f[1].value?f[1].value.data.split("\n").slice(0,6).map((function(e){return Number(e)})):null,d.transform=6===(null===p||void 0===p?void 0:p.length)?new We.a({forwardCoefficients:[p[4],p[5],p[0],-p[1],p[2],-p[3]]}):null),e.abrupt("return",d);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(ne);Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],Qe.prototype,"datasetFormat",void 0);var Ye=Qe=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.ImageAuxRaster")],Qe),$e=r(128),et=r(708),tt=r(1663),rt=r(1555),nt=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._levelOffset=0,e._tilemapCache=null,e._slices=null,e.datasetFormat="RasterTileServer",e.tileType=null,e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d,p,h,m,v,y,g,j,O,x,w,I,M,k,S,T,A,C,R,N,L,B;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:if(l=t&&t.signal,!this.sourceJSON){e.next=7;break}e.t0={data:this.sourceJSON},e.next=10;break;case 7:return e.next=9,this.request(this.url,{query:{f:"json"},signal:l});case 9:e.t0=e.sent;case 10:if((u=e.t0).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),c=u.data,this.sourceJSON=c,c){e.next=15;break}throw new b.a("imageserverraster:open","cannot initialize tiled image service, missing service info");case 15:if(c.tileInfo){e.next=17;break}throw new b.a("imageserverraster:open","use ImageryLayer to open non-tiled image services");case 17:return this._fixScaleInServiceInfo(),f=["jpg","jpeg","png","png8","png24","png32","mixed"],this.tileType=c.cacheType,null==this.tileType&&(f.includes(c.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===c.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster"),this.datasetName=null!==(r=null===(a=c.name)||void 0===a?void 0:a.slice(c.name.indexOf("/")+1))&&void 0!==r?r:"",e.next=22,this._fetchRasterInfo({signal:l});case 22:if(null!=(d=e.sent)){e.next=25;break}throw new b.a("image-server-raster:open","cannot initialize image service");case 25:p="Map"===this.tileType?at(c.tileInfo,c):E.a.fromJSON(c.tileInfo),Object(J.c)(p),h=this._computeMinMaxLOD(d,p),m=Object(D.a)(h,2),v=m[0],y=m[1],g=d.extent,j=d.pixelSize,O=.5/d.width*j.x,x=Math.max(j.x,j.y),w=p.lods,("Map"!==this.tileType&&0!==c.maxScale||Math.abs(j.x-j.y)>O||!w.some((function(e){return Math.abs(e.resolution-x)<O})))&&(j.x=j.y=v.resolution,d.width=Math.ceil((g.xmax-g.xmin)/j.x-.1),d.height=Math.ceil((g.ymax-g.ymin)/j.y-.1)),I=v.level-y.level,M=Object(D.a)(p.size,2),k=M[0],S=M[1],T=[],A=[],w.forEach((function(e,t){e.level>=y.level&&e.level<=v.level&&T.push({x:e.resolution,y:e.resolution}),t<w.length-1&&A.push(Math.round(10*e.resolution/w[t+1].resolution)/10)})),T.sort((function(e,t){return e.x-t.x})),C=this.computeBlockBoundary(g,k,S,p.origin,T,I),R=T.length>1?T.slice(1):null,c.transposeInfo&&(N={tileSize:[c.transposeInfo.rows,c.transposeInfo.cols],packetSize:null!==(i=null===(o=d.keyProperties)||void 0===o?void 0:o._yxs.PacketSize)&&void 0!==i?i:0}),L=A.length<=1||A.length>=3&&A.slice(0,A.length-1).every((function(e){return e===A[0]}))?null!==(s=A[0])&&void 0!==s?s:2:Math.round(10/Math.pow(y.resolution/v.resolution,-1/I))/10,d.storageInfo=new W.a({blockWidth:p.size[0],blockHeight:p.size[1],pyramidBlockWidth:p.size[0],pyramidBlockHeight:p.size[1],pyramidResolutions:R,pyramidScalingFactor:L,compression:p.format,origin:p.origin,firstPyramidLevel:1,maximumPyramidLevel:I,tileInfo:p,transposeInfo:N,blockBoundary:C}),this._fixGCSShift(d),this._set("rasterInfo",d),c.capabilities.toLowerCase().includes("tilemap")&&(B={tileInfo:d.storageInfo.tileInfo,parsedUrl:Object($e.Q)(this.url),url:this.url,tileServers:[]},this._tilemapCache=new et.a({layer:B}));case 35:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I,M,k,S,T,A,D,C,R,N=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=N.length>3&&void 0!==N[3]?N[3]:{},o=this.rasterInfo,s=o.storageInfo,l=o.extent,u=s.transposeInfo,c=null!=u&&!!i.transposedVariableName,!this._slices||c||null!=i.sliceId){e.next=4;break}return e.abrupt("return",null);case 4:return f=c?0:s.maximumPyramidLevel-t+this._levelOffset,d="".concat(this.url,"/tile/").concat(f,"/").concat(r,"/").concat(a),p=this._slices?c?{variable:i.transposedVariableName}:{sliceId:i.sliceId||0}:null,e.next=9,this.request(d,{query:p,responseType:"array-buffer",signal:i.signal});case 9:if(h=e.sent,b=h.data){e.next=13;break}return e.abrupt("return",null);case 13:return m=c?u.tileSize:s.tileInfo.size,e.next=16,this.decodePixelBlock(b,{width:m[0],height:m[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:c,noDataValue:this.rasterInfo.noDataValue});case 16:if(null!=(v=e.sent)){e.next=19;break}return e.abrupt("return",null);case 19:if(y=s.blockBoundary[t],!("jpg"!==s.compression||a>y.minCol&&a<y.maxCol&&r>y.minRow&&r<y.maxRow)){e.next=22;break}return e.abrupt("return",v);case 22:return g=s.origin,j=s.blockWidth,O=s.blockHeight,x=this.getPyramidPixelSize(t),w=x.x,I=x.y,M=Math.round((l.xmin-g.x)/w)%j,k=Math.round((l.xmax-g.x)/w)%j||j,S=Math.round((g.y-l.ymax)/I)%O,T=Math.round((g.y-l.ymin)/I)%O||O,A=a===y.minCol?M:0,D=r===y.minRow?S:0,C=a===y.maxCol?k:j,R=r===y.maxRow?T:O,e.abrupt("return",(Object(Q.s)(v,{x:A,y:D},{width:C-A,height:R-D}),v));case 24:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getSliceIndex",value:function(e){if(!this._slices||null==e||0===e.length)return null;for(var t=e,r=0;r<this._slices.length;r++){var n=this._slices[r].multidimensionalDefinition;if(n.length===t.length&&!n.some((function(e){var r=t.find((function(t){return e.variableName===t.variableName&&t.dimensionName===e.dimensionName}));return!r||(Array.isArray(e.values[0])?"".concat(e.values[0][0],"-").concat(e.values[0][1]):e.values[0])!==(Array.isArray(r.values[0])?"".concat(r.values[0][0],"-").concat(r.values[0][1]):r.values[0])})))return r}return null}},{key:"fetchVariableStatisticsHistograms",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a,i,o;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.request(this.url+"/statistics",{query:{variable:t,f:"json"},signal:r}).then((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.statistics})),i=this.request(this.url+"/histograms",{query:{variable:t,f:"json"},signal:r}).then((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.histograms})),e.next=4,Promise.all([a,i]);case 4:return o=e.sent,e.abrupt("return",(o[0]&&o[0].forEach((function(e){e.avg=e.mean,e.stddev=e.standardDeviation})),{statistics:o[0]||null,histograms:o[1]||null}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"computeBestPyramidLevelForLocation",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:{},this._tilemapCache){e.next=3;break}return e.abrupt("return",0);case 3:if(null!==(a=this.identifyPixelLocation(t,0,r.datumTransformation))){e.next=6;break}return e.abrupt("return",null);case 6:i=0,o=this.rasterInfo.storageInfo.maximumPyramidLevel,s=o-i+this._levelOffset,l=a.srcLocation;case 10:if(!(s>=0)){e.next=25;break}return e.prev=11,e.next=14,this._tilemapCache.fetchAvailability(s,a.row,a.col,r);case 14:if(e.t0=e.sent,"available"!==e.t0){e.next=17;break}return e.abrupt("break",25);case 17:e.next=21;break;case 19:e.prev=19,e.t1=e.catch(11);case 21:if(s--,i++,null!==(a=this.identifyPixelLocation(l,i,r.datumTransformation))){e.next=23;break}return e.abrupt("return",null);case 23:e.next=10;break;case 25:return e.abrupt("return",-1===s||null==a?null:i);case 26:case"end":return e.stop()}}),e,this,[[11,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchRasterInfo",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.sourceJSON,"Map"!==this.tileType){e.next=4;break}return a=r.fullExtent||r.extent,i=Math.ceil((a.xmax-a.xmin)/r.pixelSizeX-.1),o=Math.ceil((a.ymax-a.ymin)/r.pixelSizeY-.1),s=Oe.a.fromJSON(r.spatialReference||a.spatialReference),l=new te.a({x:r.pixelSizeX,y:r.pixelSizeY,spatialReference:s}),e.abrupt("return",new De.a({width:i,height:o,bandCount:3,extent:ee.a.fromJSON(a),spatialReference:s,pixelSize:l,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}}));case 4:return u=t.signal,c=Object(rt.a)(this.url,this.sourceJSON,{signal:u,query:this.ioConfig.customFetchParameters}),f=r.hasMultidimensions?this.request("".concat(this.url,"/slices"),{query:{f:"json"},signal:u}).then((function(e){return e.data&&e.data.slices})).catch((function(){return null})):null,e.next=9,Promise.all([c,f]);case 9:return d=e.sent,e.abrupt("return",(this._slices=d[1],d[0]));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fixScaleInServiceInfo",value:function(){var e=this.sourceJSON;e.minScale&&e.minScale<0&&(e.minScale=0),e.maxScale&&e.maxScale<0&&(e.maxScale=0)}},{key:"_fixGCSShift",value:function(e){var t=e.extent,r=e.spatialReference;t.xmin>-1&&t.xmax>181&&(null===r||void 0===r?void 0:r.wkid)&&r.isGeographic&&(e.nativeExtent=e.extent,e.transform=new tt.a,e.extent=e.transform.forwardTransform(t))}},{key:"_computeMinMaxLOD",value:function(e,t){var r,n,a,i=e.pixelSize,o=.5/e.width*i.x,s=t.lods,l=t.lodAt(Math.max.apply(null,s.map((function(e){return e.level})))),u=t.lodAt(Math.min.apply(null,s.map((function(e){return e.level})))),c=this.tileType;if("Map"===c)return this._levelOffset=s[0].level,[l,u];if("Raster"===c)return[null!==(a=s.find((function(e){return e.resolution===i.x})))&&void 0!==a?a:l,u];var f=this.sourceJSON,d=f.minScale,p=f.maxScale,h=l;p>0&&(h=s.find((function(e){return Math.abs(e.scale-p)<o})),h||(h=null!==(r=s.filter((function(e){return e.scale>p})).sort((function(e,t){return e.scale>t.scale?1:-1}))[0])&&void 0!==r?r:l));var b=u;return d>0&&(b=null!==(n=s.find((function(e){return Math.abs(e.scale-d)<o})))&&void 0!==n?n:u,this._levelOffset=b.level-u.level),[h,b]}}]),r}(ne);function at(e,t){if(!e)return null;var r=t.minScale,n=t.maxScale,a=t.minLOD,i=t.maxLOD;if(null!=a&&null!=i)return E.a.fromJSON(Object(o.a)(Object(o.a)({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=a&&t<=i}))}));if(0!==r&&0!==n){var s=function(e){return Math.round(1e4*e)/1e4},l=r?s(r):1/0,u=n?s(n):-1/0;return E.a.fromJSON(Object(o.a)(Object(o.a)({},e),{},{lods:e.lods.filter((function(e){var t=s(e.scale);return t<=l&&t>=u}))}))}return E.a.fromJSON(e)}Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],nt.prototype,"datasetFormat",void 0),Object(p.a)([Object(j.b)()],nt.prototype,"tileType",void 0);var it=nt=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.ImageServerRaster")],nt),ot=r(1328),st=new Map;st.set("Int8","s8"),st.set("UInt8","u8"),st.set("Int16","s16"),st.set("UInt16","u16"),st.set("Int32","s32"),st.set("UInt32","u32"),st.set("Float32","f32"),st.set("Float64","f32"),st.set("Double64","f32");var lt=new Map;lt.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"}),lt.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"}),lt.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"}),lt.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});var ut=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._files=null,e._storageIndex=null,e.datasetFormat="MRF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),a=t?t.signal:null,e.next=6,this.request(this.url,{responseType:"xml",signal:a});case 6:if(i=e.sent,o=this._parseHeader(i.data),s=o.rasterInfo,l=o.files,-1!==(null===(r=this.ioConfig.skipExtensions)||void 0===r?void 0:r.indexOf("aux.xml"))){e.next=15;break}return e.next=13,this._fetchAuxiliaryData(t);case 13:null!=(c=e.sent)&&(s.statistics=null!==(u=c.statistics)&&void 0!==u?u:s.statistics,s.histograms=c.histograms,c.histograms&&null==s.statistics&&(s.statistics=Object(me.f)(c.histograms)));case 15:return this._set("rasterInfo",s),this._files=l,e.next=18,this.request(l.index,{responseType:"array-buffer",signal:a});case 18:for(f=e.sent,this._storageIndex=this._parseIndex(f.data),d=this.rasterInfo.storageInfo,p=d.blockWidth,h=d.blockHeight,b=this.rasterInfo.storageInfo.pyramidScalingFactor,m=this.rasterInfo,v=m.width,y=m.height,g=[],j=this._getBandSegmentCount(),O=0,x=-1;O<this._storageIndex.length;)x++,w=Math.ceil(v/p/Math.pow(b,x))-1,I=Math.ceil(y/h/Math.pow(b,x))-1,O+=(w+1)*(I+1)*j*4,g.push({maxRow:I,maxCol:w,minCol:0,minRow:0});this.rasterInfo.storageInfo.blockBoundary=g,x>0&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=x),this.updateTileInfo();case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I,M,k,S,T,A,D,C,R,N,L,B=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=B.length>3&&void 0!==B[3]?B[3]:{},o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,u=o.blockBoundary,!(!(c=u[t])||c.maxRow<r||c.maxCol<a||c.minRow>r||c.minCol>a)){e.next=4;break}return e.abrupt("return",null);case 4:if(f=this.rasterInfo,d=f.bandCount,p=f.pixelType,h=this._getTileLocation(t,r,a),b=h.ranges,m=h.actualTileWidth,v=h.actualTileHeight,b&&0!==b.length){e.next=7;break}return e.abrupt("return",null);case 7:if(0!==b[0].from||0!==b[0].to){e.next=10;break}return y=new Uint8Array(s*l),e.abrupt("return",new le.a({width:s,height:l,pixels:null,mask:y,validPixelCount:0}));case 10:for(g=this.ioConfig.bandIds,j=this._getBandSegmentCount(),O=[],x=0,x=0;x<j;x++)g&&!g.includes(x)||O.push(this.request(this._files.data,{range:{from:b[x].from,to:b[x].to},responseType:"array-buffer",signal:i.signal}));return e.next=15,Promise.all(O);case 15:for(w=e.sent,I=w.map((function(e){return e.data.byteLength})).reduce((function(e,t){return e+t})),M=new Uint8Array(I),k=0,x=0;x<j;x++)M.set(new Uint8Array(w[x].data),k),k+=w[x].data.byteLength;return S=lt.get(this.rasterInfo.storageInfo.compression).decoderFormat,e.next=23,this.decodePixelBlock(M.buffer,{width:s,height:l,format:S,planes:(null===g||void 0===g?void 0:g.length)||d,pixelType:p});case 23:if(null!=(T=e.sent)){e.next=26;break}return e.abrupt("return",null);case 26:if(null!=(A=this.rasterInfo.noDataValue)&&"lerc"!==S&&!T.mask&&null!=(A=A[0])){if(D=T.width*T.height,C=new Uint8Array(D),Math.abs(A)>1e24)for(x=0;x<D;x++)Math.abs((T.pixels[0][x]-A)/A)>1e-6&&(C[x]=1);else for(x=0;x<D;x++)T.pixels[0][x]!==A&&(C[x]=1);T.mask=C}if(R=0,N=0,m!==s||v!==l)if(L=T.mask)for(x=0;x<l;x++)if(N=x*s,x<v)for(R=m;R<s;R++)L[N+R]=0;else for(R=0;R<s;R++)L[N+R]=0;else for(L=new Uint8Array(s*l),T.mask=L,x=0;x<v;x++)for(N=x*s,R=0;R<m;R++)L[N+R]=1;return e.abrupt("return",T);case 31:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_parseIndex",value:function(e){if(e.byteLength%16>0)throw new Error("invalid array buffer must be multiples of 16");var t,r,n,a,i,o;if(ot.a){for(r=new Uint8Array(e),a=new ArrayBuffer(e.byteLength),n=new Uint8Array(a),i=0;i<e.byteLength/4;i++)for(o=0;o<4;o++)n[4*i+o]=r[4*i+3-o];t=new Uint32Array(a)}else t=new Uint32Array(e);return t}},{key:"_getBandSegmentCount",value:function(){return lt.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount}},{key:"_getTileLocation",value:function(e,t,r){var n,a,i,o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,u=o.pyramidScalingFactor,c=this.rasterInfo,f=c.width,d=c.height,p=this._getBandSegmentCount(),h=0,b=0;for(i=0;i<e;i++)b=Math.pow(u,i),h+=(n=Math.ceil(f/s/b))*(a=Math.ceil(d/l/b));b=Math.pow(u,e),n=Math.ceil(f/s/b),a=Math.ceil(d/l/b),h+=t*n+r,h*=4*p;for(var m=this._storageIndex.subarray(h,h+4*p),v=0,y=0,g=[],j=0;j<p;j++)y=(v=m[4*j]*Math.pow(2,32)+m[4*j+1])+m[4*j+2]*Math.pow(2,32)+m[4*j+3],g.push({from:v,to:y});return{ranges:g,actualTileWidth:r<n-1?s:Math.ceil(f/b)-s*(n-1),actualTileHeight:t<a-1?l:Math.ceil(d/b)-l*(a-1)}}},{key:"_parseHeader",value:function(e){var t=Ee(e,"MRF_META/Raster");if(!t)throw new b.a("mrf:open","not a valid MRF format");var r=Ee(t,"Size"),n=parseInt(r.getAttribute("x"),10),a=parseInt(r.getAttribute("y"),10),i=parseInt(r.getAttribute("c"),10),o=(Ue(t,"Compression")||"none").toLowerCase();if(!lt.has(o))throw new b.a("mrf:open","currently does not support compression "+o);var s=Ue(t,"DataType")||"UInt8",l=st.get(s);if(null==l)throw new b.a("mrf:open","currently does not support pixel type "+s);var u,c,f=Ee(t,"PageSize"),d=parseInt(f.getAttribute("x"),10),p=parseInt(f.getAttribute("y"),10),h=Ee(t,"DataValues");if(h&&(null!=(c=h.getAttribute("NoData"))&&(u=c.trim().split(" ").map((function(e){return parseFloat(e)})))),Ee(e,"MRF_META/CachedSource"))throw new b.a("mrf:open","currently does not support MRF referencing other data files");var m,v=Ee(e,"MRF_META/GeoTags"),y=Ee(v,"BoundingBox"),g=!1;if(null!=y){var j,O=parseFloat(y.getAttribute("minx")),x=parseFloat(y.getAttribute("miny")),w=parseFloat(y.getAttribute("maxx")),I=parseFloat(y.getAttribute("maxy")),M=Ue(v,"Projection")||"",k=Oe.a.WGS84;if("LOCAL_CS[]"!==M)if(M.toLowerCase().startsWith("epsg:")){var S=Number(M.slice(5));isNaN(S)||0===S||(k=new Oe.a({wkid:S}))}else k=null!==(j=qe(M))&&void 0!==j?j:Oe.a.WGS84;else g=!0,k=new Oe.a({wkid:3857});(m=new ee.a(O,x,w,I)).spatialReference=k}else g=!0,m=new ee.a({xmin:-.5,ymin:.5-a,xmax:n-.5,ymax:.5,spatialReference:new Oe.a({wkid:3857})});var T=Ee(e,"MRF_META/Rsets"),A=parseInt(T&&T.getAttribute("scale")||"2",10),D=m.spatialReference,C=new W.a({origin:new te.a({x:m.xmin,y:m.ymax,spatialReference:D}),blockWidth:d,blockHeight:p,pyramidBlockWidth:d,pyramidBlockHeight:p,compression:o,pyramidScalingFactor:A}),R=new te.a({x:m.width/n,y:m.height/a,spatialReference:D}),N=new De.a({width:n,height:a,extent:m,isPseudoSpatialReference:g,spatialReference:D,bandCount:i,pixelType:l,pixelSize:R,noDataValue:u,storageInfo:C}),L=Ue(e,"datafile"),B=Ue(e,"IndexFile");return{rasterInfo:N,files:{mrf:this.url,index:B||this.url.replace(".mrf",".idx"),data:L||this.url.replace(".mrf",lt.get(o).blobExtension)}}}},{key:"_fetchAuxiliaryData",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".aux.xml",{responseType:"xml",signal:null===t||void 0===t?void 0:t.signal});case 3:return r=e.sent,a=r.data,e.abrupt("return",Xe(a));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(ne);Object(p.a)([Object(j.b)()],ut.prototype,"_files",void 0),Object(p.a)([Object(j.b)()],ut.prototype,"_storageIndex",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],ut.prototype,"datasetFormat",void 0);var ct=ut=Object(p.a)([Object(M.a)("esri.layers.support.rasterIO.MRFRaster")],ut),ft=r(1660),dt=r(1662),pt=function(e,t){var r;return null===(r=e.get(t))||void 0===r?void 0:r.values},ht=function(e,t){var r;return null===(r=e.get(t))||void 0===r||null===(r=r.values)||void 0===r?void 0:r[0]},bt=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._files=null,e._headerInfo=null,e._bufferSize=1048576,e.datasetFormat="TIFF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,s,l,u,c,f,d,p,h,m,v,y,g,j,O,x,w;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return i=t?t.signal:null,e.next=5,this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:i});case 5:if(s=e.sent,l=s.data){e.next=9;break}throw new b.a("tiffraster:open","failed to open url "+this.url);case 9:return this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf(".")),u=Object(ft.i)(l),c=u.littleEndian,f=u.firstIFDPos,d=u.isBigTiff,p=[],e.next=13,this._readIFDs(p,l,c,f,0,d?8:4,i);case 13:if(h=this._parseIFDs(p),m=h.imageInfo,v=h.rasterInfo,y=Object(ft.e)(p),g=Object(ft.d)(p),this._headerInfo=Object(o.a)({littleEndian:c,isBigTiff:d,ifds:p,pyramidIFDs:y,maskIFDs:g},m),this._set("rasterInfo",v),m.isSupported){e.next=16;break}throw new b.a("tiffraster:open","this tiff is not supported: "+m.message);case 16:if(m.tileWidth){e.next=18;break}throw new b.a("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");case 18:if(j=null===(r=p[0].get("PREDICTOR"))||void 0===r||null===(r=r.values)||void 0===r?void 0:r[0],3!==(null===(a=p[0].get("SAMPLEFORMAT"))||void 0===a||null===(a=a.values)||void 0===a?void 0:a[0])||2!==j){e.next=21;break}throw new b.a("tiffraster:open","unsupported horizontal difference encoding. Predictor=3 is supported for floatting point data");case 21:if(O=this.ioConfig.skipExtensions,(x=void 0===O?[]:O).includes("aux.xml")){e.next=27;break}return e.next=25,this._fetchAuxiliaryMetaData(t);case 25:null!=(w=e.sent)&&this._processPAMInfo(w,v);case 27:if(e.t0=x.includes("vat.dbf")||1!==v.bandCount||"u8"!==v.pixelType,e.t0){e.next=33;break}return e.next=31,this._fetchAuxiliaryTable(t);case 31:v.attributeTable=e.sent,null!=v.attributeTable&&(v.keyProperties.DataType="thematic");case 33:this.updateTileInfo();case 34:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u.length>3&&void 0!==u[3]?u[3]:{},null!==(i=this._headerInfo)&&void 0!==i&&i.isSupported&&!this.isBlockOutside(t,r,a)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this._fetchRawTiffTile(t,r,a,!1,o);case 5:if(null==(s=e.sent)||!this._headerInfo.hasMaskBand){e.next=11;break}return e.next=9,this._fetchRawTiffTile(t,r,a,!0,o);case 9:null!=(l=e.sent)&&l.pixels[0]instanceof Uint8Array&&(s.mask=l.pixels[0]);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_parseIFDs",value:function(e){var t,r,n=Object(ft.c)(e),a=n.width,i=n.height,s=n.tileWidth,l=n.tileHeight,u=n.planes,c=n.pixelType,f=n.compression,d=n.firstPyramidLevel,p=n.maximumPyramidLevel,h=n.pyramidBlockWidth,b=n.pyramidBlockHeight,m=n.tileBoundary,v=n.affine,y=n.metadata,g=qe((null===(t=n.extent.spatialReference)||void 0===t?void 0:t.wkt)||(null===(r=n.extent.spatialReference)||void 0===r?void 0:r.wkid)),j=!!n.isPseudoGeographic;null==g&&(j=!0,g=new Oe.a({wkid:3857}));var O=new ee.a(Object(o.a)(Object(o.a)({},n.extent),{},{spatialReference:g})),x=new te.a(O?{x:O.xmin,y:O.ymax,spatialReference:g}:{x:0,y:0}),w=new W.a({blockWidth:s,blockHeight:l,pyramidBlockWidth:h,pyramidBlockHeight:b,compression:f,origin:x,firstPyramidLevel:d,maximumPyramidLevel:p,blockBoundary:m}),I=new te.a({x:(O.xmax-O.xmin)/a,y:(O.ymax-O.ymin)/i,spatialReference:g}),M=y?{BandProperties:y.bandProperties,DataType:y.dataType}:{},k=null,S=ht(e[0],"PHOTOMETRICINTERPRETATION"),T=pt(e[0],"COLORMAP");if(S<=3&&(null===T||void 0===T?void 0:T.length)>3&&T.length%3==0){k=[];for(var A=T.length/3,D=0;D<A;D++)k.push([D,T[D]>>>8,T[D+A]>>>8,T[D+2*A]>>>8])}var C=new De.a({width:a,height:i,bandCount:u,pixelType:c,pixelSize:I,storageInfo:w,spatialReference:g,isPseudoSpatialReference:j,keyProperties:M,extent:O,colormap:k,statistics:y?y.statistics:null});return null!==v&&void 0!==v&&v.length&&(C.nativeExtent=new ee.a({xmin:-.5,ymin:.5-i,xmax:a-.5,ymax:.5,spatialReference:g}),C.transform=new We.a({polynomialOrder:1,forwardCoefficients:[v[2]+v[0]/2,v[5]-v[3]/2,v[0],v[3],-v[1],-v[4]]}),C.extent=C.transform.forwardTransform(C.nativeExtent),C.pixelSize=new te.a({x:(O.xmax-O.xmin)/a,y:(O.ymax-O.ymin)/i,spatialReference:g}),w.origin.x=-.5,w.origin.y=.5),{imageInfo:n,rasterInfo:C}}},{key:"_processPAMInfo",value:function(e,t){var r;if(t.statistics=null!==(r=e.statistics)&&void 0!==r?r:t.statistics,t.histograms=e.histograms,e.histograms&&null==t.statistics&&(t.statistics=Object(me.f)(e.histograms)),e.transform&&null==t.transform){t.transform=e.transform,t.nativeExtent=t.extent;var n=t.transform.forwardTransform(t.nativeExtent);t.pixelSize=new te.a({x:(n.xmax-n.xmin)/t.width,y:(n.ymax-n.ymin)/t.height,spatialReference:t.spatialReference}),t.extent=n}t.isPseudoSpatialReference&&e.spatialReference&&(t.spatialReference=e.spatialReference,t.extent.spatialReference=t.nativeExtent.spatialReference=t.storageInfo.origin.spatialReference=t.spatialReference)}},{key:"_readIFDs",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a,i,o){var s,l,u,c=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=c.length>5&&void 0!==c[5]?c[5]:4,l=c.length>6?c[6]:void 0,i){e.next=4;break}return e.abrupt("return",null);case 4:if(!(i>=r.byteLength||i<0)){e.next=10;break}return e.next=7,this.request(this.url,{range:{from:i+o,to:i+o+this._bufferSize},responseType:"array-buffer",signal:l});case 7:r=e.sent.data,o=i+o,i=0;case 10:return e.next=12,this._readIFD(r,a,i,o,dt.a.TIFF_TAGS,s,l);case 12:if(u=e.sent,t.push(u.ifd),u.nextIFD){e.next=15;break}return e.abrupt("return",null);case 15:return e.next=17,this._readIFDs(t,r,a,u.nextIFD-o,o,s,l);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}()},{key:"_readIFD",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a,i){var o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,w=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=w.length>4&&void 0!==w[4]?w[4]:dt.a.TIFF_TAGS,s=w.length>5&&void 0!==w[5]?w[5]:4,l=w.length>6?w[6]:void 0,t){e.next=5;break}return e.abrupt("return",null);case 5:if(!(u=Object(ft.h)(t,r,a,i,o,s)).success){e.next=25;break}if(d=[],null!==(c=u.ifd)&&void 0!==c&&c.forEach((function(e){e.values||d.push(e)})),!(d.length>0)){e.next=16;break}if(p=d.map((function(e){return e.offlineOffsetSize})).filter(x.i),h=Math.min.apply(null,p.map((function(e){return e[0]}))),!(Math.min.apply(null,p.map((function(e){return e[0]+e[1]})))-h<=this._bufferSize)){e.next=16;break}return e.next=13,this.request(this.url,{range:{from:h,to:h+this._bufferSize},responseType:"array-buffer",signal:l});case 13:b=e.sent,m=b.data,t=m,i=h,d.forEach((function(e){return Object(ft.g)(t,r,e,i)}));case 16:if(null===(f=u.ifd)||void 0===f||!f.has("GEOKEYDIRECTORY")){e.next=24;break}if(v=u.ifd.get("GEOKEYDIRECTORY"),!((y=null===v||void 0===v?void 0:v.values)&&y.length>4)){e.next=24;break}return g=y[0]+"."+y[1]+"."+y[2],e.next=22,this._readIFD(t,r,v.valueOffset+6-i,i,dt.a.GEO_KEYS,2,l);case 22:j=e.sent,v.data=j.ifd,v.data&&v.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[g]});case 24:return e.abrupt("return",u);case 25:if(!u.requiredBufferSize||u.requiredBufferSize===t.byteLength){e.next=30;break}return e.next=28,this.request(this.url,{range:{from:i,to:i+u.requiredBufferSize+4},responseType:"array-buffer",signal:l});case 28:return O=e.sent,e.abrupt("return",(t=O.data).byteLength<u.requiredBufferSize?null:this._readIFD(t,r,0,i,dt.a.TIFF_TAGS,4,l));case 30:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_fetchRawTiffTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a,i){var o,s,l,u,c,f,d,p,h,b,m,v,y,g,j,O,x,w,I,M,k,S,T,A,D=this,C=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=C.length>4&&void 0!==C[4]?C[4]:{},s=this._getTileLocation(t,r,a,i)){e.next=4;break}return e.abrupt("return",null);case 4:return l=s.ranges,u=s.actualTileWidth,c=s.actualTileHeight,f=s.ifd,d=l.map((function(e){return D.request(D.url,{range:e,responseType:"array-buffer",signal:o.signal})})),e.next=11,Promise.all(d);case 11:if(p=e.sent,h=p.map((function(e){return e.data.byteLength})).reduce((function(e,t){return e+t})),b=1===p.length?p[0].data:new ArrayBuffer(h),m=[0],v=[0],p.length>1)for(y=new Uint8Array(b),g=0,j=0;g<p.length;g++)O=p[g].data,y.set(new Uint8Array(O),j),m[g]=j,j+=O.byteLength,v[g]=O.byteLength;return x=this.getBlockWidthHeight(t),w=x.blockWidth,I=x.blockHeight,e.next=22,this.decodePixelBlock(b,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:f,offsets:m,sizes:v},width:w,height:I,planes:null,pixelType:null});case 22:if(null!=(M=e.sent)){e.next=25;break}return e.abrupt("return",null);case 25:if(u!==w||c!==I)if(A=M.mask)for(k=0;k<I;k++)if(T=k*w,k<c)for(S=u;S<w;S++)A[T+S]=0;else for(S=0;S<w;S++)A[T+S]=0;else for(A=new Uint8Array(w*I),M.mask=A,k=0;k<c;k++)for(T=k*w,S=0;S<u;S++)A[T+S]=1;return e.abrupt("return",M);case 27:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"_getTileLocation",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.rasterInfo.storageInfo,i=a.firstPyramidLevel,o=a.blockBoundary,s=0===e?0:e-(i-1),l=this._headerInfo;if(!l)return null;var u=n?l.maskIFDs[s]:0===s?null===l||void 0===l?void 0:l.ifds[0]:null===l||void 0===l?void 0:l.pyramidIFDs[s-1];if(!u)return null;var c=Object(ft.f)(u,l),f=pt(u,"TILEOFFSETS");if(void 0===f)return null;var d=pt(u,"TILEBYTECOUNTS"),p=o[s],h=p.minRow,b=p.minCol,m=p.maxRow,v=p.maxCol;if(t>m||r>v||t<h||r<b)return null;var y=ht(u,"IMAGEWIDTH"),g=ht(u,"IMAGELENGTH"),j=ht(u,"TILEWIDTH"),O=ht(u,"TILELENGTH"),x=[];if(c)for(var w=this.rasterInfo.bandCount,I=0;I<w;I++){var M=I*(m+1)*(v+1)+t*(v+1)+r;x[I]={from:f[M],to:f[M]+d[M]-1}}else{var k=t*(v+1)+r;x.push({from:f[k],to:f[k]+d[k]-1})}for(var S=0;S<x.length;S++)if(null==x[S].from||!x[S].to)return null;return{ranges:x,ifd:u,actualTileWidth:r===v&&y%j||j,actualTileHeight:t===m&&g%O||O}}},{key:"_fetchAuxiliaryMetaData",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".aux.xml",{responseType:"xml",signal:null===t||void 0===t?void 0:t.signal});case 3:return r=e.sent,a=r.data,e.abrupt("return",Xe(a));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchAuxiliaryTable",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:null===t||void 0===t?void 0:t.signal});case 3:return r=e.sent,a=r.data,i=Ne.parse(a),e.abrupt("return",null!==i&&void 0!==i&&i.recordSet?ae.a.fromJSON(i.recordSet):null);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(ne);Object(p.a)([Object(j.b)()],bt.prototype,"_files",void 0),Object(p.a)([Object(j.b)()],bt.prototype,"_headerInfo",void 0),Object(p.a)([Object(j.b)()],bt.prototype,"_bufferSize",void 0),Object(p.a)([Object(j.b)({type:String,json:{write:!0}})],bt.prototype,"datasetFormat",void 0);var mt=bt=Object(p.a)([Object(M.a)("esri.layers.support.rasterDatasets.TIFFRaster")],bt),vt=new Map;vt.set("CRF",{desc:"Cloud Raster Format",constructor:_e}),vt.set("MRF",{desc:"Meta Raster Format",constructor:ct}),vt.set("TIFF",{desc:"GeoTIFF",constructor:mt}),vt.set("RasterTileServer",{desc:"Raster Tile Server",constructor:it}),vt.set("JPG",{desc:"JPG Raster Format",constructor:Ye}),vt.set("PNG",{desc:"PNG Raster Format",constructor:Ye}),vt.set("GIF",{desc:"GIF Raster Format",constructor:Ye}),vt.set("BMP",{desc:"BMP Raster Format",constructor:Ye});var yt=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"supportedFormats",get:function(){var e=new Set;return vt.forEach((function(t,r){return e.add(r)})),e}},{key:"open",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l,u,c,f,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,a=t.ioConfig,i=t.sourceJSON,null==(o=t.datasetFormat)&&r.lastIndexOf(".")&&(o=r.slice(r.lastIndexOf(".")+1).toUpperCase()),"OVR"===o||"TIF"===o?o="TIFF":"JPG"!==o&&"JPEG"!==o&&"JFIF"!==o||(o="JPG"),r.toLowerCase().includes("/imageserver")&&!r.toLowerCase().includes("/wcsserver")&&(o="RasterTileServer"),s={url:r,sourceJSON:i,datasetFormat:o,ioConfig:null!==a&&void 0!==a?a:{bandIds:null,sampling:null}},!o||!this.supportedFormats.has(o)){e.next=12;break}if("CRF"!==o||null!==a&&void 0!==a&&a.enableCRF){e.next=7;break}throw new b.a("rasterfactory:open","cannot open raster: ".concat(r));case 7:return l=vt.get(o).constructor,u=new l(s),e.next=11,u.open({signal:t.signal});case 11:return e.abrupt("return",u);case 12:if(!o){e.next=14;break}throw new b.a("rasterfactory:open","not a supported format "+o);case 14:return c=Array.from(vt.keys()),f=0,d=function e(){return(o=c[f++])&&("CRF"!==o||null!==a&&void 0!==a&&a.enableCRF)?(l=vt.get(o).constructor,(u=new l(s)).open({signal:t.signal}).then((function(){return u})).catch((function(){return e()}))):null},e.abrupt("return",d());case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(e,t,r){vt.has(e.toUpperCase())||vt.set(e.toUpperCase(),{desc:t,constructor:r})}}]),e}(),gt=r(486),jt=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(s.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a)))._primaryRasters=[],e.bandIds=null,e.interpolation=null,e.legendEnabled=!0,e.isReference=null,e.listMode="show",e.sourceJSON=null,e.version=null,e.type="imagery-tile",e.operationalLayerType="ArcGISTiledImageServiceLayer",e.popupEnabled=!0,e.popupTemplate=null,e.fields=null,e}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(o.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).catch(y.m).then((function(){return t._openRaster(r)}))),Promise.resolve(this)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"rasterFields",get:function(){var e=[new Te.a({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),new Te.a({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"})],t=this.rasterInfo,r=null===t||void 0===t?void 0:t.attributeTable,n=null!=r?r.fields:null;if(n){var a=n.filter((function(e){return"oid"!==e.type&&"value"!==e.name.toLowerCase()})).map((function(e){var t=e.clone();return t.name="Raster."+e.name,t}));e.push.apply(e,Object(i.a)(a))}var o=null===t||void 0===t?void 0:t.dataType,s=null===t||void 0===t?void 0:t.multidimensionalInfo;if(("vector-magdir"===o||"vector-uv"===o)&&null!=s){var l,u=null===(l=s.variables[0].unit)||void 0===l?void 0:l.trim(),c="Magnitude"+(u?" (".concat(u,")"):"");e.push(new Te.a({name:"Raster.Magnitude",alias:c,domain:null,editable:!1,type:"double"})),e.push(new Te.a({name:"Raster.Direction",alias:"Direction (\xb0)",domain:null,editable:!1,type:"double"}))}return e}},{key:"createPopupTemplate",value:function(e){var t=this.rasterFields,r=new Set(t.map((function(e){return e.name})).filter((function(e){return"raster.servicepixelvalue.raw"!==e.toLowerCase()})));return Object(gt.a)({fields:t,title:this.title},Object(o.a)(Object(o.a)({},e),{},{visibleFieldNames:r}))}},{key:"generateRasterInfo",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a,i,o,s,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(O.d)(H.a,t)){e.next=2;break}return e.abrupt("return",this.rasterInfo);case 2:return e.prev=2,o={raster:this._primaryRasters[0]},this._primaryRasters.length>1&&this._primaryRasters.forEach((function(e){return o[e.url]=e})),s=Object(be.a)(null!==(a=null===(i=t.functionDefinition)||void 0===i?void 0:i.toJSON())&&void 0!==a?a:t.toJSON(),o),l=new oe({rasterFunction:s}),e.next=8,l.open(r);case 8:return e.abrupt("return",l.rasterInfo);case 11:if(e.prev=11,e.t0=e.catch(2),!(e.t0 instanceof b.a)){e.next=15;break}throw e.t0;case 15:throw new b.a("imagery-tile-layer","the given raster function is not supported");case 16:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"write",value:function(e,t){var n,a=null!==(n=this._primaryRasters[0])&&void 0!==n?n:this.raster;if(this.loaded?"RasterTileServer"===a.datasetFormat&&("Raster"===a.tileType||"Map"===a.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return Object(u.a)(Object(c.a)(r.prototype),"write",this).call(this,e,t);if(t&&t.messages){var i="".concat(t.origin,"/").concat(t.layerContainerType||"operational-layers");t.messages.push(new b.a("layer:unsupported","Layers (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' are not supported in the context of '").concat(i,"'"),{layer:this}))}return null}},{key:"_openRaster",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,s,l,u,c,f,d,p,h,v,y,j=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,!this.raster){e.next=10;break}if(e.t0=this.raster.rasterInfo,e.t0){e.next=6;break}return e.next=6,this.raster.open();case 6:"Function"===this.raster.datasetFormat?(r=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url,e.next=35;break;case 10:return a=this.rasterFunction,i=[this.url],a&&Object(be.b)(a.toJSON(),i),e.next=14,Promise.all(i.map((function(e){return yt.open({url:e,sourceJSON:j.sourceJSON,ioConfig:Object(o.a)(Object(o.a)({sampling:"closest"},j.ioConfig),{},{customFetchParameters:j.customParameters}),signal:t})})));case 14:if(s=e.sent,l=s.findIndex((function(e){return null==e})),!(l>-1)){e.next=18;break}throw new b.a("imagery-tile-layer:open","cannot open raster: ".concat(i[l]));case 18:if(this._primaryRasters=s,!a){e.next=34;break}return f={raster:this._primaryRasters[0]},this._primaryRasters.length>1&&this._primaryRasters.forEach((function(e){return f[e.url]=e})),d=Object(be.a)(null!==(u=null===(c=a.functionDefinition)||void 0===c?void 0:c.toJSON())&&void 0!==u?u:a.toJSON(),f),p=new oe({rasterFunction:d}),e.prev=22,e.next=25,p.open();case 25:this.raster=p,e.next=32;break;case 28:e.prev=28,e.t1=e.catch(22),h=m.a.getLogger(this),e.t1 instanceof b.a&&h.error("imagery-tile-layer:open",e.t1.message),h.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=s[0];case 32:e.next=35;break;case 34:this.raster=s[0];case 35:if(v=this.raster.rasterInfo){e.next=38;break}throw new b.a("imagery-tile-layer:load","cannot load resources on "+this.url);case 38:this._set("rasterInfo",r?v:this._primaryRasters[0].rasterInfo),this._set("spatialReference",v.spatialReference),this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,null!=this.sourceJSON?(y="Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:Object(o.a)(Object(o.a)({},this.sourceJSON),{},{minScale:0,maxScale:0}),this.read(y,{origin:"service"})):this.read({tileInfo:this.rasterInfo.storageInfo.tileInfo.toJSON()},{origin:"service"}),this.title||(this.title=this.raster.datasetName),"Map"===this.raster.tileType&&(this.popupEnabled=!1),this._configDefaultSettings(),this.addHandles(Object(g.e)((function(){return j.customParameters}),(function(e){j.raster&&(j.raster.ioConfig.customFetchParameters=e)})));case 40:case"end":return e.stop()}}),e,this,[[22,28]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(Object(T.a)(Object(ke.a)(Object(we.a)(Object(Ie.a)(Object(A.a)(function(e){var t=function(e){Object(f.a)(i,e);var t=Object(d.a)(i);function i(){var e,r;Object(s.a)(this,i);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=t.call.apply(t,[this].concat(a)))._isConstructedFromFunctionRaster=!1,r._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},r.bandIds=null,r.copyright=null,r.interpolation="nearest",r.multidimensionalSubset=null,r.raster=null,r.rasterInfo=null,r.sourceJSON=null,r.spatialReference=null,r.symbolizer=null,r._isConstructedFromFunctionRaster="Function"===(null===(e=a[0])||void 0===e||null===(e=e.raster)||void 0===e?void 0:e.datasetFormat),r}return Object(l.a)(i,[{key:"fullExtent",get:function(){var e;return null===(e=this.rasterInfo)||void 0===e?void 0:e.extent}},{key:"multidimensionalDefinition",set:function(e){this._set("multidimensionalDefinition",e),this.updateRenderer()}},{key:"rasterFunction",set:function(e){var t;"none"===(null===(t=e)||void 0===t||null===(t=t.functionName)||void 0===t?void 0:t.toLowerCase())&&(e=void 0),this._set("rasterFunction",e),this.updateRasterFunction()}},{key:"url",set:function(e){this._set("url",Object(B.g)(e,xe))}},{key:"renderer",set:function(e){null==e&&null==this.rasterFunction?this._configDefaultRenderer("override"):(this._set("renderer",e),this.updateRenderer())}},{key:"readRenderer",value:function(e,t,r){var n,a=null===t||void 0===t||null===(n=t.layerDefinition)||void 0===n||null===(n=n.drawingInfo)||void 0===n?void 0:n.renderer;return Object(C.b)(a,r)||void 0}},{key:"convertVectorFieldData",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a,i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&this.rasterInfo){e.next=2;break}return e.abrupt("return",null);case 2:return a=this._rasterJobHandler.instance,i=this.rasterInfo.dataType,e.abrupt("return",a?a.convertVectorFieldData({pixelBlock:t,dataType:i},r):Object($.b)(t,i));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"computeStatisticsHistograms",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a,i,s,l,u,c,f,d,p,h,m,v,y;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(O.d)(ge.a,t).clone(),i=this.rasterInfo,null!=(s=t.geometry)){e.next=4;break}throw new b.a("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");case 4:if(l=s,u=i.spatialReference,e.t0=s.spatialReference.equals(u),e.t0){e.next=11;break}return e.next=10,Object(Y.g)();case 10:l="extent"===s.type?Object(Y.h)(s,u):Object(Y.j)(s,u);case 11:return c=null!==(a=t.pixelSize)&&void 0!==a?a:new te.a({x:i.pixelSize.x,y:i.pixelSize.y,spatialReference:u}),f=he(i,l,c),d=f.extent,p=f.width,h=f.height,e.next=18,this.fetchPixels(d,p,h,Object(o.a)(Object(o.a)({},r),{},{interpolation:"nearest"}));case 18:if(null!=(m=e.sent).pixelBlock){e.next=21;break}throw new b.a("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");case 21:return e.next=23,ue(m.pixelBlock,d,l);case 23:return v=e.sent,y=this._rasterJobHandler.instance,e.abrupt("return",y?y.computeStatisticsHistograms({pixelBlock:v},r):Object(me.c)(v));case 26:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createFlowMesh",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._rasterJobHandler.instance,e.abrupt("return",a?a.createFlowMesh(t,r):Object(je.a)(t.meshType,t.simulationSettings,t.flowData,null!=r.signal?r.signal:(new AbortController).signal));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"normalizeRasterFetchOptions",value:function(e){var t,r=(null!==(t=this.rasterInfo)&&void 0!==t?t:{}).multidimensionalInfo;if(null==r)return e;var n=e.multidimensionalDefinition||this.multidimensionalDefinition;null!=n&&n.length||(n=Object(G.b)(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));var a=e.timeExtent||this.timeExtent;if(null!=n&&null!=a&&(null!=a.start||null!=a.end)){var i;n=n.map((function(e){return e.clone()}));var s=null===(i=r.variables.find((function(e){return e.name===n[0].variableName})))||void 0===i||null===(i=i.dimensions)||void 0===i?void 0:i.find((function(e){return"StdTime"===e.name})),l=n.find((function(e){return"StdTime"===e.dimensionName}));if(!s||!l)return Object(o.a)(Object(o.a)({},e),{},{multidimensionalDefinition:null});var u=a.start,c=a.end,f=null==u?null:u.getTime(),d=null==c?null:c.getTime(),p=null!==f&&void 0!==f?f:d,h=null!==d&&void 0!==d?d:f;if(null!=s.values){var b=s.values.filter((function(e){if(Array.isArray(e)){if(p===h)return e[0]<=p&&e[1]>=p;var t=e[0]<=p&&e[1]>p||e[0]<h&&e[1]>=h,r=e[0]>=p&&e[1]<=h||e[0]<p&&e[1]>h;return t||r}return p===h?e===p:e>=p&&e<=h}));if(b.length){var m=b.sort((function(e,t){var r=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:e,a=Array.isArray(t)?t[0]:t,i=Array.isArray(t)?t[1]:t;return p===h?r-a:Math.abs(n-h)-Math.abs(i-h)}))[0];l.values=[m]}else n=null}else if(s.hasRegularIntervals&&s.extent){var v=Object(D.a)(s.extent,2),y=v[0],g=v[1];p>g||h<y?n=null:l.values=p===h?[p]:[Math.max(y,p),Math.min(g,h)]}}return null!=n&&Object(G.g)(n,this.multidimensionalSubset)?Object(o.a)(Object(o.a)({},e),{},{multidimensionalDefinition:null}):Object(o.a)(Object(o.a)({},e),{},{multidimensionalDefinition:n})}},{key:"updateRasterFunction",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,r,a,i,o,s,l,u,c,f,d,p,h,b,m;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loaded&&"imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson)){e.next=2;break}return e.abrupt("return");case 2:if(!this._isConstructedFromFunctionRaster||"Function"!==this.raster.datasetFormat){e.next=5;break}return r=this.raster.rasterFunction.toJSON(),e.abrupt("return",(!this.rasterFunction&&r&&this._set("rasterFunction",H.a.fromJSON(r)),void(this._cachedRasterFunctionJson=null===(t=this.rasterFunction)||void 0===t?void 0:t.toJSON())));case 5:if(i=this.raster,o=!1,"Function"===i.datasetFormat?(a=i.primaryRasters.rasters,i=a[0],o=!0):a=[i],!(s=this.rasterFunction)){e.next=19;break}return f={raster:i},a.length>1&&a.forEach((function(e){return f[e.url]=e})),d=Object(be.a)(null!==(l=null===(u=s.functionDefinition)||void 0===u?void 0:u.toJSON())&&void 0!==l?l:s.toJSON(),f),(p=new oe({rasterFunction:d})).rasterJobHandler=this._rasterJobHandler.instance,e.next=15,p.open();case 15:this._cachedRasterFunctionJson=null===(c=this.rasterFunction)||void 0===c?void 0:c.toJSON(),this.raster=p,e.next=23;break;case 19:return this.raster=i,this._cachedRasterFunctionJson=null,e.next=23,i.when();case 23:if(this._cachedRendererJson=null,o||s){e.next=25;break}return e.abrupt("return");case 25:h=this.bandIds,b=this.raster.rasterInfo.bandCount,m=null!==h&&void 0!==h&&h.length?h.some((function(e){return e>=b})):b>=3,h&&(m||this.renderer&&"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null),this._configDefaultRenderer("auto");case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateRenderer",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,r,a,i,s,l,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.loaded,r=this.symbolizer,t&&r&&this.renderer){e.next=3;break}return e.abrupt("return");case 3:if(a=this.raster.rasterInfo,i=Object(G.c)(a,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),s=null===i||void 0===i?void 0:i.name,l=Object(ve.f)(Object(o.a)(Object(o.a)({},this.renderer.toJSON()),{},{variableName:s})),JSON.stringify(this._cachedRendererJson)!==JSON.stringify(l)){e.next=6;break}return e.abrupt("return");case 6:if(u=this._rasterJobHandler.instance,e.t0=u,!e.t0){e.next=15;break}return r.rasterInfo=Object(ve.e)(a,s),r.rendererJSON=l,r.bind(),e.next=14,u.updateSymbolizer(r);case 14:this._cachedRendererJson=l;case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyRenderer",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){var a,i,s,l,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(i=t&&t.pixelBlock)&&i.pixels&&i.pixels.length>0){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.updateRenderer();case 5:if(l=this._rasterJobHandler.instance,u=null!==(a=this.bandIds)&&void 0!==a?a:[],!l){e.next=12;break}return e.next=9,l.symbolize(Object(o.a)(Object(o.a)({},t),{},{simpleStretchParams:r,bandIds:u}));case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=this.symbolizer.symbolize(Object(o.a)(Object(o.a)({},t),{},{simpleStretchParams:r,bandIds:u}));case 13:return s=e.t0,e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTileUrl",value:function(e,t,r){return"RasterTileServer"===this.raster.datasetFormat?"".concat(this.url,"/tile/").concat(e,"/").concat(t,"/").concat(r):""}},{key:"getCompatibleTileInfo",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.loaded||null==t)return null;if(r&&e.equals(this.spatialReference))return this.tileInfo;var n=Object(L.e)(e);return E.a.create({size:256,spatialReference:e,origin:n?{x:n.origin[0],y:n.origin[1]}:{x:t.xmin,y:t.ymax}})}},{key:"getCompatibleFullExtent",value:function(e){return this.loaded?(this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(e)||(this._compatibleFullExtent=this.raster.computeExtent(e)),this._compatibleFullExtent):null}},{key:"fetchTile",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,a,i){var s,l,u,c,f,d=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=d.length>3&&void 0!==d[3]?d[3]:{},r(this),!l.requestAsImageElement){e.next=4;break}return u=this.getTileUrl(t,a,i),e.abrupt("return",Object(R.default)(u,{responseType:"image",query:Object(o.a)(Object(o.a)({},this.refreshParameters),this.raster.ioConfig.customFetchParameters),signal:l.signal}).then((function(e){return e.data})));case 4:if(null==(c=this.rasterInfo).multidimensionalInfo||null!=(l=this.normalizeRasterFetchOptions(l)).multidimensionalDefinition){e.next=8;break}return f=l.tileInfo||c.storageInfo.tileInfo,e.abrupt("return",{extent:this.raster.getTileExtentFromTileInfo(t,a,i,f),pixelBlock:null});case 8:return e.next=10,this._initJobHandler();case 10:return e.next=12,this.updateRasterFunction();case 12:return"raster-shaded-relief"===(null===(s=this.renderer)||void 0===s?void 0:s.type)&&(l=Object(o.a)(Object(o.a)({},l),{},{buffer:{cols:1,rows:1}})),e.abrupt("return",this.raster.fetchTile(t,a,i,l));case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var i,o=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o.length>3&&void 0!==o[3]?o[3]:{},null==this.rasterInfo.multidimensionalInfo||null!=(i=this.normalizeRasterFetchOptions(i)).multidimensionalDefinition){e.next=5;break}e.t0={extent:t,pixelBlock:null},e.next=12;break;case 5:return e.next=7,this._initJobHandler();case 7:return e.next=9,this.updateRasterFunction();case 9:r=Math.round(r),a=Math.round(a),e.t0=this.raster.fetchPixels(t,r,a,i);case 12:return e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"identify",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var r,a,i,o,s,l=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.length>1&&void 0!==l[1]?l[1]:{},i=this.raster,null==(o=this.rasterInfo).multidimensionalInfo){e.next=5;break}if(o.hasMultidimensionalTranspose&&(Object(G.i)(a.multidimensionalDefinition)||a.transposedVariableName||a.timeExtent)||null!=(a=this.normalizeRasterFetchOptions(a)).multidimensionalDefinition){e.next=5;break}return e.abrupt("return",{location:t,value:null});case 5:if(!(s=null===(r=this.multidimensionalSubset)||void 0===r?void 0:r.areaOfInterest)||s.contains(t)){e.next=8;break}throw new b.a("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");case 8:return e.abrupt("return",i.identify(t,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"increaseRasterJobHandlerUsage",value:function(){this._rasterJobHandler.refCount++}},{key:"decreaseRasterJobHandlerUsage",value:function(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}},{key:"hasStandardTime",value:function(){var e,t,r,n=null===(e=this.rasterInfo)||void 0===e?void 0:e.multidimensionalInfo;if(null==n||"standard-time"!==(null===(t=this.rasterInfo)||void 0===t?void 0:t.dataType))return!1;var a=this.multidimensionalDefinition,i=null===a||void 0===a||null===(r=a[0])||void 0===r?void 0:r.variableName;return n.variables.some((function(e){return e.name===i&&(!(null!==a&&void 0!==a&&a[0].dimensionName)||e.dimensions.some((function(e){return"StdTime"===e.name})))}))}},{key:"getStandardTimeValue",value:function(e){return new Date(24*(e-25569)*3600*1e3).toString()}},{key:"getMultidimensionalSubsetVariables",value:function(e){var t,r=null!==e&&void 0!==e?e:null===(t=this.rasterInfo)||void 0===t?void 0:t.multidimensionalInfo;return Object(G.f)(this.multidimensionalSubset,r)}},{key:"_configDefaultSettings",value:function(){this._configDefaultInterpolation(),this.multidimensionalDefinition||(this.multidimensionalDefinition=Object(G.b)(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset})),this.rasterFunction&&"Function"===this.raster.datasetFormat&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON()),this._configDefaultRenderer()}},{key:"_initJobHandler",value:function(){var e=this;if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;var t=new F.a;return this._rasterJobHandler.connectionPromise=t.initialize().then(Object(a.a)(Object(n.a)().mark((function a(){return Object(n.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r(e),e._rasterJobHandler.instance=t,e.raster.rasterJobHandler=t,"Function"===e.raster.datasetFormat&&e.raster.syncJobHandler(),n.t0=e.rasterFunction,!n.t0){n.next=8;break}return n.next=8,e.updateRasterFunction().catch((function(){}));case 8:e.renderer&&e.updateRenderer();case 9:case"end":return n.stop()}}),a)})))).catch((function(){})),this._rasterJobHandler.connectionPromise}},{key:"_shutdownJobHandler",value:function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null,this.raster&&(this.raster.rasterJobHandler=null)}},{key:"_configDefaultInterpolation",value:function(){if(null==this.interpolation){var e;r(this);var t=this.raster,n=Object(ve.c)(t.rasterInfo,t.tileType,null===(e=this.sourceJSON)||void 0===e?void 0:e.defaultResamplingMethod);this._set("interpolation",n)}}},{key:"_configDefaultRenderer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no";r(this);var t=this.raster.rasterInfo;!this.bandIds&&t.bandCount>1&&(this.bandIds=Object(ve.b)(t));var n=Object(G.c)(t,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),a=null===n||void 0===n?void 0:n.name;if(!this.renderer||"override"===e){var i,s,l=Object(ve.a)(t,{bandIds:this.bandIds,variableName:a}),u=t.statistics,c=u&&u.length>0?u[0]:null,f=null!==(i=null===c||void 0===c?void 0:c.max)&&void 0!==i?i:0,d=null!==(s=null===c||void 0===c?void 0:c.min)&&void 0!==s?s:0;"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===l.type&&(f>1e24||d<-1e24)&&(l.dynamicRangeAdjustment=!0,l.statistics=null,"none"===l.stretchType&&(l.stretchType="min-max")),this.renderer=l}var p=Object(ve.f)(Object(o.a)(Object(o.a)({},this.renderer.toJSON()),{},{variableName:a})),h=Object(ve.e)(t,a);this.symbolizer?(this.symbolizer.rendererJSON=p,this.symbolizer.rasterInfo=h):this.symbolizer=new ye.a({rendererJSON:p,rasterInfo:h});var b=this.symbolizer.bind();if(b.success){if("auto"===e){var m=this.raster.rasterInfo.colormap,v=this.renderer;if(null!=m&&"raster-colormap"===v.type){var y=Object(ve.a)(this.raster.rasterInfo);JSON.stringify(y)!==JSON.stringify(v)&&this._configDefaultRenderer("override")}else if("raster-stretch"===v.type){var g,j,O=null===(g=this.bandIds)||void 0===g?void 0:g.length,x=null===(j=v.statistics)||void 0===j?void 0:j.length;!v.dynamicRangeAdjustment&&x&&O&&x!==O&&this._configDefaultRenderer("override")}}}else xe.warn("imagery-tile-mixin",b.error||"The given renderer is not supported by the layer."),"auto"===e&&this._configDefaultRenderer("override")}}]),i}(e);function r(e){if(!e.raster||!e.rasterInfo)throw new b.a("imagery-tile","no raster")}return Object(p.a)([Object(j.b)()],t.prototype,"_cachedRendererJson",void 0),Object(p.a)([Object(j.b)()],t.prototype,"_cachedRasterFunctionJson",void 0),Object(p.a)([Object(j.b)()],t.prototype,"_compatibleFullExtent",void 0),Object(p.a)([Object(j.b)()],t.prototype,"_isConstructedFromFunctionRaster",void 0),Object(p.a)([Object(j.b)()],t.prototype,"_rasterJobHandler",void 0),Object(p.a)([Object(j.b)()],t.prototype,"bandIds",void 0),Object(p.a)([Object(j.b)({json:{origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),Object(p.a)([Object(j.b)({json:{read:!1}})],t.prototype,"fullExtent",null),Object(p.a)([Object(j.b)()],t.prototype,"interpolation",void 0),Object(p.a)([Object(j.b)()],t.prototype,"ioConfig",void 0),Object(p.a)([Object(j.b)({type:[_.a],json:{write:!0}})],t.prototype,"multidimensionalDefinition",null),Object(p.a)([Object(j.b)({type:P.a,json:{write:!0}})],t.prototype,"multidimensionalSubset",void 0),Object(p.a)([Object(j.b)()],t.prototype,"raster",void 0),Object(p.a)([Object(j.b)({type:H.a,json:{name:"renderingRule",write:!0}})],t.prototype,"rasterFunction",null),Object(p.a)([Object(j.b)()],t.prototype,"rasterInfo",void 0),Object(p.a)([Object(j.b)()],t.prototype,"sourceJSON",void 0),Object(p.a)([Object(j.b)({readOnly:!0,type:Oe.a,json:{read:!1}})],t.prototype,"spatialReference",void 0),Object(p.a)([Object(j.b)({type:E.a})],t.prototype,"tileInfo",void 0),Object(p.a)([Object(j.b)(z.o)],t.prototype,"url",null),Object(p.a)([Object(j.b)({types:C.a,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:function(){var e,t="raster-stretch"===(null===(e=this.renderer)||void 0===e?void 0:e.type)&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!t}}},origins:{"web-scene":{types:C.c,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:function(e){return{enabled:e&&"vector-field"!==e.type&&"flow"!==e.type}}}}}}})],t.prototype,"renderer",null),Object(p.a)([Object(N.a)("renderer")],t.prototype,"readRenderer",null),Object(p.a)([Object(j.b)()],t.prototype,"symbolizer",void 0),t=Object(p.a)([Object(M.a)("esri.layers.ImageryTileMixin")],t),t}(Object(Se.a)(Object(S.a)(Object(Me.a)(Object(v.a)(k.a)))))))))));Object(p.a)([Object(j.b)()],jt.prototype,"_primaryRasters",void 0),Object(p.a)([Object(j.b)({type:[O.a],json:{write:{overridePolicy:function(){var e;return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==(null===(e=this.bandIds)||void 0===e?void 0:e.join(","))}}}}})],jt.prototype,"bandIds",void 0),Object(p.a)([Object(j.b)({json:{write:{overridePolicy:function(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),Object(I.a)(Ae.a)],jt.prototype,"interpolation",void 0),Object(p.a)([Object(j.b)(z.e)],jt.prototype,"legendEnabled",void 0),Object(p.a)([Object(j.b)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],jt.prototype,"isReference",void 0),Object(p.a)([Object(j.b)({type:["show","hide"]})],jt.prototype,"listMode",void 0),Object(p.a)([Object(j.b)({json:{read:!0,write:!0}})],jt.prototype,"blendMode",void 0),Object(p.a)([Object(j.b)()],jt.prototype,"sourceJSON",void 0),Object(p.a)([Object(j.b)({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],jt.prototype,"version",void 0),Object(p.a)([Object(j.b)({readOnly:!0,json:{read:!1}})],jt.prototype,"type",void 0),Object(p.a)([Object(j.b)({type:["ArcGISTiledImageServiceLayer"]})],jt.prototype,"operationalLayerType",void 0),Object(p.a)([Object(j.b)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",overridePolicy:function(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer:function(e,t,r){t[r]=!e}}}})],jt.prototype,"popupEnabled",void 0),Object(p.a)([Object(j.b)({type:h.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:function(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],jt.prototype,"popupTemplate",void 0),Object(p.a)([Object(j.b)({readOnly:!0})],jt.prototype,"defaultPopupTemplate",null),Object(p.a)([Object(j.b)({readOnly:!0,type:[Te.a]})],jt.prototype,"fields",void 0),Object(p.a)([Object(j.b)({readOnly:!0,type:[Te.a]})],jt.prototype,"rasterFields",null);var Ot=jt=Object(p.a)([Object(M.a)("esri.layers.ImageryTileLayer")],jt)},217:function(e,t,r){"use strict";r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return C}));var n=r(4),a=r(99),i=r(12),o=r(92),s=r(187),l=r(101),u=r(102),c=r(164),f=r(192),d=r(242),p=r(132),h=r(233),b=r(1),m=(r(119),r(129)),v=r(122),y=r(221);function g(e,t,r,n){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(Object(n.a)().mark((function e(t,r,a,i){var o,s,l,u,c,f,d,p;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(y.c)(t),s=r[0].spatialReference,l=Object(b.a)(Object(b.a)({},i),{},{query:Object(b.a)(Object(b.a)({},o.query),{},{f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:Object(v.c)(r[0]),geometries:r}),cutter:JSON.stringify(a)})}),e.next=5,Object(m.default)(o.path+"/cut",l);case 5:return u=e.sent,c=u.data,f=c.cutIndexes,d=c.geometries,p=void 0===d?[]:d,e.abrupt("return",{cutIndexes:f,geometries:p.map((function(e){var t=Object(v.a)(e);return t.spatialReference=s,t}))});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=r(128),x=r(417);function w(e,t,r){return I.apply(this,arguments)}function I(){return(I=Object(i.a)(Object(n.a)().mark((function e(t,r,a){var i,o,s,l,u,c,f;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="string"==typeof t?Object(O.Q)(t):t,s=r[0].spatialReference,l=Object(v.c)(r[0]),u=Object(b.a)(Object(b.a)({},a),{},{query:Object(b.a)(Object(b.a)({},o.query),{},{f:"json",sr:null!==(i=s.wkid)&&void 0!==i?i:JSON.stringify(s),geometries:JSON.stringify(Object(x.b)(r))})}),e.next=6,Object(m.default)(o.path+"/simplify",u);case 6:return c=e.sent,f=c.data,e.abrupt("return",Object(x.a)(f.geometries,l,s));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=u.a.getLogger("esri.geometry.support.normalizeUtils");function k(e,t,r){if(t){var n=function(e,t){if(!(e instanceof f.a||e instanceof c.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw M.error(r),new l.a(r)}var n,a=Object(d.b)(e),i=[],s=Object(o.a)(a);try{for(s.s();!(n=s.n()).done;){var u=n.value,p=[];i.push(p),p.push([u[0][0],u[0][1]]);for(var h=0;h<u.length-1;h++){var b=u[h][0],m=u[h][1],v=u[h+1][0],y=u[h+1][1],g=Math.sqrt((v-b)*(v-b)+(y-m)*(y-m)),j=(y-m)/g,O=(v-b)/g,x=g/t;if(x>1){for(var w=1;w<=x-1;w++){var I=w*t,k=O*I+b,S=j*I+m;p.push([k,S])}var T=(g+Math.floor(x-1)*t)/2,A=O*T+b,D=j*T+m;p.push([A,D])}p.push([v,y])}}}catch(C){s.e(C)}finally{s.f()}return function(e){return"polygon"===e.type}(e)?new c.a({rings:i,spatialReference:e.spatialReference}):new f.a({paths:i,spatialReference:e.spatialReference})}(e,1e6);e=Object(h.e)(n,!0)}return r&&(e=Object(d.d)(e,r)),e}function S(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var a=Object(d.c)(n,t);e[0]=n+a*(-2*t)}else if(n<r){var i=Object(d.c)(n,r);e[0]=n+i*(-2*r)}}else{var o=e.x;if(o>t){var s=Object(d.c)(o,t);e=e.clone().offset(s*(-2*t),0)}else if(o<r){var l=Object(d.c)(o,r);e=e.clone().offset(l*(-2*r),0)}}return e}function T(e,t){for(var r=-1,n=function(){for(var n=t.cutIndexes[a],i=t.geometries[a],s=Object(d.b)(i),l=function(e){var t=s[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,a=0;a<t.length;a++){var o=t[a][0];n=o>n?o:n}n=Number(n.toFixed(9));for(var s=-360*Object(d.c)(n,180),l=0;l<t.length;l++){var u=i.getPoint(e,l);i.setPoint(e,l,u.clone().offset(s,0))}return!0}))},u=0;u<s.length;u++)l(u);if(n===r){if(function(e){return"polygon"===e[0].type}(e)){var c,f=Object(o.a)(Object(d.b)(i));try{for(f.s();!(c=f.n()).done;){var p=c.value;e[n]=e[n].addRing(p)}}catch(v){f.e(v)}finally{f.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var h,b=Object(o.a)(Object(d.b)(i));try{for(b.s();!(h=b.n()).done;){var m=h.value;e[n]=e[n].addPath(m)}}catch(v){b.e(v)}finally{b.f()}}}else r=n,e[n]=i},a=0;a<t.cutIndexes.length;a++)n();return e}function A(e,t,r){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(Object(n.a)().mark((function e(t,r,a){var i,l,u,b,m,v,y,j,O,x,I,D,C,R,N,L,B,z,_,P,H,F,E,U,J,Z,V,W,G,q,K,X,Q,Y,$,ee,te,re,ne,ae,ie;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",A([t],r));case 2:r&&"string"!=typeof r&&M.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead"),l="string"==typeof r?r:null!==(i=null===r||void 0===r?void 0:r.url)&&void 0!==i?i:s.a.geometryServiceUrl,I=0,D=[],C=[],R=Object(o.a)(t);try{for(R.s();!(N=R.n()).done;)null!=(L=N.value)?(u||(u=L.spatialReference,b=Object(p.e)(u),m=u.isWebMercator,j=m?102100:4326,v=d.a[j].maxX,y=d.a[j].minX,O=d.a[j].plus180Line,x=d.a[j].minus180Line),b?"mesh"===L.type?C.push(L):"point"===L.type?C.push(S(L.clone(),v,y)):"multipoint"===L.type?((B=L.clone()).points=B.points.map((function(e){return S(e,v,y)})),C.push(B)):"extent"===L.type?(z=L.clone()._normalize(!1,!1,b),C.push(z.rings?new c.a(z):z)):L.extent?(_=L.extent,P=Object(d.c)(_.xmin,y)*(2*v),H=0===P?L.clone():Object(d.d)(L.clone(),P),_.offset(P,0),_.intersects(O)&&_.xmax!==v?(I=_.xmax>I?_.xmax:I,H=k(H,m),D.push(H),C.push("cut")):_.intersects(x)&&_.xmin!==y?(I=_.xmax*(2*v)>I?_.xmax*(2*v):I,H=k(H,m,360),D.push(H),C.push("cut")):C.push(H)):C.push(L.clone()):C.push(L)):C.push(L)}catch(n){R.e(n)}finally{R.f()}for(F=Object(d.c)(I,v),E=-90,U=F,J=new f.a;F>0;)Z=360*F-180,J.addPath([[Z,E],[Z,-1*E]]),E*=-1,F--;if(!(D.length>0&&U>0)){e.next=29;break}return e.t0=T,e.t1=D,e.next=16,g(l,D,J,a);case 16:for(e.t2=e.sent,V=(0,e.t0)(e.t1,e.t2),W=[],G=[],q=0;q<C.length;q++)"cut"!==(K=C[q])?G.push(K):(X=V.shift(),null!=(Q=t[q])&&"polygon"===Q.type&&Q.rings&&Q.rings.length>1&&X.rings.length>=Q.rings.length?(W.push(X),G.push("simplify")):G.push(m?Object(h.b)(X):X));if(W.length){e.next=23;break}return e.abrupt("return",G);case 23:return e.next=25,w(l,W,a);case 25:for(Y=e.sent,$=[],ee=0;ee<G.length;ee++)"simplify"!==(te=G[ee])?$.push(te):$.push(m?Object(h.b)(Y.shift()):Y.shift());return e.abrupt("return",$);case 29:for(re=[],ne=0;ne<C.length;ne++)"cut"!==(ae=C[ne])?re.push(ae):(ie=D.shift(),re.push(!0===m?Object(h.b)(ie):ie));return e.abrupt("return",re);case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){var r=Object(p.e)(t);if(r){var n=Object(a.a)(r.valid,2),i=n[0],o=n[1],s=o-i;if(e<i)for(;e<i;)e+=s;if(e>o)for(;e>o;)e-=s}return e}},242:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u}));var n=r(92),a=r(192),i=r(125),o=r(122),s={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new a.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator}),minus180Line:new a.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new a.a({paths:[[[180,-180],[180,180]]],spatialReference:i.a.WGS84}),minus180Line:new a.a({paths:[[[-180,-180],[-180,180]]],spatialReference:i.a.WGS84})}};function l(e,t){return Math.ceil((e-t)/(2*t))}function u(e,t){var r,a=c(e),i=Object(n.a)(a);try{for(i.s();!(r=i.n()).done;){var o,s=r.value,l=Object(n.a)(s);try{for(l.s();!(o=l.n()).done;){o.value[0]+=t}}catch(u){l.e(u)}finally{l.f()}}}catch(u){i.e(u)}finally{i.f()}return e}function c(e){return Object(o.g)(e)?e.rings:e.paths}},573:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(105),c=r(116),f=r(97),d=r(96),p=r(95),h=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).variableName=null,n.dimensionName=null,n.values=[],n.isSlice=!1,n}return Object(i.a)(r,[{key:"clone",value:function(){return new n({variableName:this.variableName,dimensionName:this.dimensionName,values:Object(c.a)(this.values),isSlice:this.isSlice})}}]),r}(u.a);Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],h.prototype,"variableName",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],h.prototype,"dimensionName",void 0),Object(l.a)([Object(f.b)({type:d.p.array(d.p.oneOf([d.p.native(Number),d.p.array(d.p.native(Number))])),json:{write:!0}})],h.prototype,"values",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],h.prototype,"isSlice",void 0);var b=h=n=Object(l.a)([Object(p.a)("esri.layers.support.DimensionalDefinition")],h)},610:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r(92),a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(105),c=r(116),f=r(97),d=r(96),p=r(138),h=r(136),b=r(95),m=r(137),v=r(146),y=(r(98),r(93),r(854)),g=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).pixelType="unknown",e}return Object(i.a)(r)}(u.a);Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],g.prototype,"name",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],g.prototype,"description",void 0),Object(l.a)([Object(f.b)({type:d.a,json:{type:d.a,write:!0,name:"_object_id"}})],g.prototype,"id",void 0),Object(l.a)([Object(f.b)({type:String,json:{type:y.c.jsonValues,read:y.c.read,write:y.c.write}})],g.prototype,"pixelType",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],g.prototype,"type",void 0);var j=g=Object(l.a)([Object(b.a)("esri.layers.support.RasterFunctionInfo")],g),O=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).isDataset=!1,e.isPublic=!1,e.type="RasterFunctionVariable",e}return Object(i.a)(r)}(u.a);Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],O.prototype,"name",void 0),Object(l.a)([Object(f.b)({type:Number,json:{type:d.a,write:!0,name:"_object_id"}})],O.prototype,"id",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],O.prototype,"isDataset",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],O.prototype,"isPublic",void 0),Object(l.a)([Object(f.b)({json:{write:!0}})],O.prototype,"value",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],O.prototype,"type",void 0);var x={key:"type",base:null,typeMap:{RasterFunctionVariable:O=Object(l.a)([Object(b.a)("esri.layers.support.RasterFunctionVariable")],O)}},w=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r)}(u.a);Object(l.a)([Object(f.b)({types:x,json:{types:x,name:"MatchVariable"}})],w.prototype,"matchVariable",void 0),Object(l.a)([Object(f.b)({types:x,json:{types:x,name:"UnionDimension"}})],w.prototype,"unionDimension",void 0),Object(l.a)([Object(f.b)({type:Number,json:{type:d.a,write:!0,name:"_object_id"}})],w.prototype,"id",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],w.prototype,"type",void 0);var I=w=Object(l.a)([Object(b.a)("esri.layers.support.RasterFunctionProperties")],w),M=new v.a({0:"mosaic",1:"item",2:"item-group"},{useNumericKeys:!0}),k=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).functionType="mosaic",e.type="RasterFunctionTemplate",e}return Object(i.a)(r)}(u.a);Object(l.a)([Object(f.b)({type:[String],json:{write:!0}})],k.prototype,"aliases",void 0),Object(l.a)([Object(f.b)({type:Object,json:{write:!0}})],k.prototype,"arguments",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"description",void 0),Object(l.a)([Object(f.b)({type:j,json:{write:!0,name:"function"}})],k.prototype,"functionInfo",void 0),Object(l.a)([Object(f.b)({type:M.apiValues,json:{type:[0,1,2],read:M.read,write:M.write}})],k.prototype,"functionType",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"group",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"help",void 0),Object(l.a)([Object(f.b)({type:Number,json:{type:d.a,write:!0,name:"_object_id"}})],k.prototype,"id",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"name",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0,name:"definition"}})],k.prototype,"queryDefinition",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"tag",void 0),Object(l.a)([Object(f.b)({type:I,json:{write:!0}})],k.prototype,"properties",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"thumbnail",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],k.prototype,"thumbnailEx",void 0),Object(l.a)([Object(f.b)({json:{type:["RasterFunctionTemplate"],write:!0}})],k.prototype,"type",void 0);var S,T=k=Object(l.a)([Object(b.a)("esri.layers.support.RasterFunctionTemplate")],k),A=new Set(["raster","raster2","dem","fillraster"]),D=new Set(["rasters"]),C=function(e){return e&&e.rasterFunction?z.fromJSON(e):e},R=function(e){return e&&e instanceof z?e.toJSON():e},N=function(e){return(null===e||void 0===e?void 0:e.functionName)&&!e.declaredClass},L=function(e){return N(e)?new z(e):e},B={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:T}},json:{write:!0,name:"rasterFunctionDefinition"}},z=S=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).functionName=null,n.outputPixelType="unknown",n.variableName=null,n.functionDefinition=null,n}return Object(i.a)(r,[{key:"functionArguments",set:function(e){if(e){var t=Object.keys(e);if(t.some((function(t){return A.has(t.toLowerCase())&&N(e[t])}))||t.some((function(t){return D.has(t.toLowerCase())&&Array.isArray(e[t])&&e[t].some((function(e){return N(e)}))}))){e=Object(c.a)(e);var r,a=Object(n.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;A.has(i.toLowerCase())?e[i]=L(e[i]):D.has(i.toLowerCase())&&Array.isArray(e[i])&&(e[i]=e[i].map((function(e){return L(e)})))}}catch(o){a.e(o)}finally{a.f()}}}this._set("functionArguments",e)}},{key:"readFunctionArguments",value:function(e){return function(e){if(null==e)return null;e=Object(c.a)(e);for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];A.has(a.toLowerCase())?t[a]=C(e[a]):D.has(a.toLowerCase())&&Array.isArray(e[a])?t[a]=e[a].map(C):t[a]=e[a]}return t}(e)}},{key:"writeFunctionArguments",value:function(e,t,r){for(var n={},a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];A.has(o.toLowerCase())?n[o]=R(e[o]):D.has(o.toLowerCase())&&Array.isArray(e[o])?n[o]=e[o].map(R):n[o]=R(e[o])}t[r]=n}},{key:"readFunctionName",value:function(e,t){var r=t.rasterFunctionInfos;return t.name||(r&&r.length&&"None"!==r[0].name?r[0].name:t.rasterFunctionDefinition?t.rasterFunctionDefinition.name:t.rasterFunction)}},{key:"rasterFunctionDefinition",get:function(){var e;return null===(e=this.functionDefinition)||void 0===e?void 0:e.toJSON()},set:function(e){this.functionDefinition=e?T.fromJSON(e):null}},{key:"clone",value:function(){return new S({functionName:this.functionName,functionArguments:Object(c.a)(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:Object(c.a)(this.rasterFunctionDefinition)})}}]),r}(u.a);Object(l.a)([Object(f.b)({json:{type:Object,name:"rasterFunctionArguments"}})],z.prototype,"functionArguments",null),Object(l.a)([Object(h.a)("functionArguments")],z.prototype,"readFunctionArguments",null),Object(l.a)([Object(m.a)("functionArguments")],z.prototype,"writeFunctionArguments",null),Object(l.a)([Object(f.b)({json:{type:String,write:{target:"rasterFunction"}}})],z.prototype,"functionName",void 0),Object(l.a)([Object(h.a)("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],z.prototype,"readFunctionName",null),Object(l.a)([Object(p.a)({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),Object(f.b)({json:{default:"unknown"}})],z.prototype,"outputPixelType",void 0),Object(l.a)([Object(f.b)({type:String,json:{read:!0,write:!0}})],z.prototype,"variableName",void 0),Object(l.a)([Object(f.b)()],z.prototype,"rasterFunctionDefinition",null),Object(l.a)([Object(f.b)(B)],z.prototype,"functionDefinition",void 0);var _=z=S=Object(l.a)([Object(b.a)("esri.layers.support.RasterFunction")],z)},708:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(4),a=r(12),i=r(1),o=r(89),s=r(88),l=r(90),u=r(91),c=r(94),f=r(129),d=r(126),p=r(676),h=r(101),b=r(287),m=r(381),v=r(440),y=r(110),g=r(127),j=r(313),O=r(128),x=r(97),w=(r(96),r(98)),I=(r(93),r(95)),M=r(630),k=r(116),S=r(312);var T,A=function(){function e(t){Object(o.a)(this,e),this._validateJSON(t);var r=t.location,n=t.data;this.location=Object.freeze(Object(k.a)(r));for(var a=this.location.width,i=this.location.height,s=!0,l=!0,u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e<=S.a?t?new Array(e).fill(0):new Array(e):new Uint32Array(e)}(Math.ceil(a*i/32)),c=0,f=0;f<n.length;f++){var d=f%32;n[f]?(l=!1,u[c]|=1<<d):s=!1,31===d&&++c}l?(this._availability="unavailable",this.byteSize=40):s?(this._availability="available",this.byteSize=40):(this._availability=u,this.byteSize=40+Object(S.b)(u))}return Object(s.a)(e,[{key:"getAvailability",value:function(e,t){if("unavailable"===this._availability||"available"===this._availability)return this._availability;var r=(e-this.location.top)*this.location.width+(t-this.location.left),n=r%32,a=r>>5,i=this._availability;return a<0||a>i.length?"unknown":i[a]&1<<n?"available":"unavailable"}},{key:"_validateJSON",value:function(e){if(!e||!e.location)throw new h.a("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new h.a("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new h.a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new h.a("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new h.a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}],[{key:"fromDefinition",value:function(t,r){var n=t.service.request||f.default,a=t.row,o=t.col,s=t.width,l=t.height,u={query:{f:"json"}};return r=r?Object(i.a)(Object(i.a)({},u),r):u,n(function(e){var t,r;if(null!==(t=e.service.tileServers)&&void 0!==t&&t.length){var n=e.service.tileServers;r="".concat(n&&n.length?n[e.row%n.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}else r="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);var a=e.service.query;return a&&(r="".concat(r,"?").concat(a)),r}(t),r).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:a,left:o,width:s,height:l},valid:!0,data:Object(w.d)(s*l,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==a||t.location.left!==o||t.location.width!==s||t.location.height!==l))throw new h.a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:a,left:o,width:s,height:l}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){return Object.freeze(new e(t))}}]),e}();function D(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var C=T=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e))._pendingTilemapRequests={},n.request=f.default,n.size=32,n._prefetchingEnabled=!0,n}return Object(s.a)(r,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new m.a(2*p.a.MEGABYTES),this.addHandles([Object(g.e)((function(){var t=e.layer;return[null===t||void 0===t?void 0:t.parsedUrl,null===t||void 0===t?void 0:t.tileServers,null===t||void 0===t?void 0:t.apiKey,null===t||void 0===t?void 0:t.customParameters]}),(function(){return e._initializeTilemapDefinition()}),g.a)])}},{key:"effectiveMinLOD",get:function(){var e;return null!==(e=this.minLOD)&&void 0!==e?e:this.layer.tileInfo.lods[0].level}},{key:"effectiveMaxLOD",get:function(){var e;return null!==(e=this.maxLOD)&&void 0!==e?e:this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}},{key:"fetchTilemap",value:function(e,t,r,n){var a=this;if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new h.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var o=this._tmpTilemapDefinition,s=this._tilemapFromCache(e,t,r,o);if(s)return Promise.resolve(s);var l=n&&n.signal;return n=Object(i.a)(Object(i.a)({},n),{},{signal:null}),new Promise((function(e,t){Object(y.k)(l,(function(){return t(Object(y.b)())}));var r=D(o),i=a._pendingTilemapRequests[r];if(!i){i=A.fromDefinition(o,n).then((function(e){return a._tilemapCache.put(r,e,e.byteSize),e}));var s=function(){return delete a._pendingTilemapRequests[r]};a._pendingTilemapRequests[r]=i,i.then(s,s)}i.then(e,t)}))}},{key:"getAvailability",value:function(e,t,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";var n=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return n?n.getAvailability(t,r):"unknown"}},{key:"fetchAvailability",value:function(e,t,r,n){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new h.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):this.fetchTilemap(e,t,r,n).catch((function(e){return e})).then((function(n){if(n instanceof A){var a=n.getAvailability(t,r);if("unavailable"===a)throw new h.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r});return a}if(Object(y.h)(n))throw n;return"unknown"}))}},{key:"fetchAvailabilityUpsample",value:function(e,t,r,n,a){var i=this;n.level=e,n.row=t,n.col=r;var o=this.layer.tileInfo;o.updateTileInfo(n);var s=this.fetchAvailability(e,t,r,a).catch((function(e){if(Object(y.h)(e))throw e;if(o.upsampleTile(n))return i.fetchAvailabilityUpsample(n.level,n.row,n.col,n,a);throw e}));return this._fetchAvailabilityUpsamplePrefetch(n.id,e,t,r,a,s),s}},{key:"_fetchAvailabilityUpsamplePrefetch",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a,o,s,l){var u,c,f,d,p,h,m,v,g=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled&&null!=t){e.next=2;break}return e.abrupt("return");case 2:if(u="prefetch-".concat(t),!this.hasHandles(u)){e.next=5;break}return e.abrupt("return");case 5:return c=new AbortController,l.then((function(){return c.abort()}),(function(){return c.abort()})),f=!1,d=Object(b.b)((function(){f||(f=!0,c.abort())})),this.addHandles(d,u),e.next=12,Object(j.c)(10,c.signal).catch((function(){}));case 12:if(f||(f=!0,this.removeHandles(u)),!Object(y.i)(c)){e.next=15;break}return e.abrupt("return");case 15:p=new M.a(t,r,a,o),h=Object(i.a)(Object(i.a)({},s),{},{signal:c.signal}),m=this.layer.tileInfo,v=Object(n.a)().mark((function e(){var t,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.fetchAvailability(p.level,p.row,p.col,h),T._prefetches.push(t),r=function(){T._prefetches.removeUnordered(t)},t.then(r,r);case 4:case"end":return e.stop()}}),e)})),0;case 18:if(!(T._prefetches.length<T._maxPrefetch&&m.upsampleTile(p))){e.next=23;break}return e.delegateYield(v(),"t0",20);case 20:e.next=18;break;case 23:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,o){return e.apply(this,arguments)}}()},{key:"_initializeTilemapDefinition",value:function(){var e;if(this.layer.parsedUrl){var t=this.layer,r=t.parsedUrl,n=t.apiKey,a=t.customParameters;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:r.path,query:Object(O.I)(Object(i.a)(Object(i.a)(Object(i.a)({},r.query),a),{},{token:null!==n&&void 0!==n?n:null===(e=r.query)||void 0===e?void 0:e.token})),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,r,n){n.level=e,n.row=t-t%this.size,n.col=r-r%this.size;var a=D(n);return this._tilemapCache.get(a)}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,r,n){return!!e._tilemapFromCache(t,r,n,e._tmpTilemapDefinition)}}}}]),r}(d.a);C._maxPrefetch=4,C._prefetches=new v.a({initialSize:T._maxPrefetch}),Object(c.a)([Object(x.b)({constructOnly:!0})],C.prototype,"layer",void 0),Object(c.a)([Object(x.b)({constructOnly:!0})],C.prototype,"minLOD",void 0),Object(c.a)([Object(x.b)({constructOnly:!0})],C.prototype,"maxLOD",void 0),Object(c.a)([Object(x.b)({constructOnly:!0})],C.prototype,"request",void 0),Object(c.a)([Object(x.b)({constructOnly:!0})],C.prototype,"size",void 0),C=T=Object(c.a)([Object(I.a)("esri.layers.support.TilemapCache")],C)},747:function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n,a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(481),c=r(146),f=r(105),d=r(116),p=r(102),h=r(97),b=r(191),m=r(136),v=r(95),y=r(137),g=r(96),j=r(135),O=r(573),x=r(610),w=Object(c.b)()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),I=Object(c.b)()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});var M=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).ascending=!0,n.itemRasterFunction=null,n.lockRasterIds=null,n.method=null,n.multidimensionalDefinition=null,n.objectIds=null,n.operation=null,n.sortField=null,n.sortValue=null,n.viewpoint=null,n.where=null,n}return Object(i.a)(r,[{key:"readAscending",value:function(e,t){return null!=t.ascending?t.ascending:null==t.sortAscending||t.sortAscending}},{key:"itemRenderingRule",get:function(){return Object(u.b)(p.a.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._get("itemRasterFunction")},set:function(e){Object(u.b)(p.a.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._set("itemRasterFunction",e)}},{key:"readMethod",value:function(e,t){return function(e){var t;switch(e?e.toLowerCase().replace("esrimosaic",""):""){case"byattribute":case"attribute":t="esriMosaicAttribute";break;case"lockraster":t="esriMosaicLockRaster";break;case"center":t="esriMosaicCenter";break;case"northwest":t="esriMosaicNorthwest";break;case"nadir":t="esriMosaicNadir";break;case"viewpoint":t="esriMosaicViewpoint";break;case"seamline":t="esriMosaicSeamline";break;default:t="esriMosaicNone"}return I.fromJSON(t)}(t.mosaicMethod||t.defaultMosaicMethod)}},{key:"writeMultidimensionalDefinition",value:function(e,t,r){null!=e&&(e=e.filter((function(e){var t=e.variableName,r=e.dimensionName;return t&&"*"!==t||r}))).length&&(t[r]=e.map((function(e){return e.toJSON()})))}},{key:"readOperation",value:function(e,t){var r=t.mosaicOperation,n=t.mosaicOperator&&t.mosaicOperator.toLowerCase(),a=r||(n?w.toJSON(n):null);return w.fromJSON(a)||"first"}},{key:"castSortValue",value:function(e){return null==e||"string"==typeof e||"number"==typeof e?e:"".concat(e)}},{key:"clone",value:function(){return new n({ascending:this.ascending,itemRasterFunction:Object(d.a)(this.itemRasterFunction),lockRasterIds:Object(d.a)(this.lockRasterIds),method:this.method,multidimensionalDefinition:Object(d.a)(this.multidimensionalDefinition),objectIds:Object(d.a)(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:Object(d.a)(this.viewpoint),where:this.where})}}]),r}(f.a);Object(l.a)([Object(h.b)({type:Boolean,json:{write:!0}})],M.prototype,"ascending",void 0),Object(l.a)([Object(m.a)("ascending",["ascending","sortAscending"])],M.prototype,"readAscending",null),Object(l.a)([Object(h.b)({type:x.a,json:{name:"itemRenderingRule",write:!0}})],M.prototype,"itemRasterFunction",void 0),Object(l.a)([Object(h.b)({type:x.a})],M.prototype,"itemRenderingRule",null),Object(l.a)([Object(h.b)({type:[g.a],json:{write:{overridePolicy:function(){return{enabled:"lock-raster"===this.method}}}}})],M.prototype,"lockRasterIds",void 0),Object(l.a)([Object(h.b)({type:String,json:{type:I.jsonValues,write:{target:"mosaicMethod",writer:I.write}}})],M.prototype,"method",void 0),Object(l.a)([Object(m.a)("method",["mosaicMethod","defaultMosaicMethod"])],M.prototype,"readMethod",null),Object(l.a)([Object(h.b)({type:[O.a],json:{write:!0}})],M.prototype,"multidimensionalDefinition",void 0),Object(l.a)([Object(y.a)("multidimensionalDefinition")],M.prototype,"writeMultidimensionalDefinition",null),Object(l.a)([Object(h.b)({type:[g.a],json:{name:"fids",write:!0}})],M.prototype,"objectIds",void 0),Object(l.a)([Object(h.b)({json:{type:w.jsonValues,read:{reader:w.read},write:{target:"mosaicOperation",writer:w.write}}})],M.prototype,"operation",void 0),Object(l.a)([Object(m.a)("operation",["mosaicOperation","mosaicOperator"])],M.prototype,"readOperation",null),Object(l.a)([Object(h.b)({type:String,json:{write:{overridePolicy:function(){return{enabled:"attribute"===this.method}}}}})],M.prototype,"sortField",void 0),Object(l.a)([Object(h.b)({type:[String,Number],json:{write:{allowNull:!0,overridePolicy:function(){return{enabled:"attribute"===this.method,allowNull:!0}}}}})],M.prototype,"sortValue",void 0),Object(l.a)([Object(b.a)("sortValue")],M.prototype,"castSortValue",null),Object(l.a)([Object(h.b)({type:j.a,json:{write:!0}})],M.prototype,"viewpoint",void 0),Object(l.a)([Object(h.b)({type:String,json:{write:!0}})],M.prototype,"where",void 0);var k=M=n=Object(l.a)([Object(v.a)("esri.layers.support.MosaicRule")],M)},809:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(89),a=r(88),i=r(90),o=r(91),s=r(94),l=r(146),u=r(105),c=r(97),f=(r(96),r(98),r(93),r(138)),d=r(95),p=new l.a({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),h=new l.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),b=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).type="class-breaks-definition",a.breakCount=null,a.classificationField=null,a.classificationMethod=null,a.normalizationField=null,a.normalizationType=null,a}return Object(a.a)(r,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}},{key:"definedInterval",set:function(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}}]),r}(u.a);Object(s.a)([Object(f.a)({classBreaksDef:"class-breaks-definition"})],b.prototype,"type",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],b.prototype,"breakCount",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],b.prototype,"classificationField",void 0),Object(s.a)([Object(c.b)({type:String,json:{read:p.read,write:p.write}})],b.prototype,"classificationMethod",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],b.prototype,"normalizationField",void 0),Object(s.a)([Object(c.b)({json:{read:h.read,write:h.write}})],b.prototype,"normalizationType",void 0),Object(s.a)([Object(c.b)({value:null,json:{write:!0}})],b.prototype,"standardDeviationInterval",null),Object(s.a)([Object(c.b)({value:null,json:{write:!0}})],b.prototype,"definedInterval",null);var m=b=Object(s.a)([Object(d.a)("esri.rest.support.ClassBreaksDefinition")],b)},810:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(102).a.getLogger("esri.rest.support.generateRendererUtils");function a(e,t){return Number(e.toFixed(t))}function i(e){var t=e.normalizationTotal;return{classBreaks:o(e),normalizationTotal:t}}function o(e){var t,r=e.definition,n=r.classificationMethod,i=r.normalizationType,o=r.definedInterval,c=null!==(t=r.breakCount)&&void 0!==t?t:1,f=[],d=e.values;if(0===d.length)return[];d=d.sort((function(e,t){return e-t}));var p=d[0],h=d[d.length-1];if("equal-interval"===n)if(d.length>=c){for(var b=(h-p)/c,m=p,v=1;v<c;v++){var y=a(p+v*b,6);f.push({minValue:m,maxValue:y,label:s(m,y,i)}),m=y}f.push({minValue:m,maxValue:h,label:s(m,h,i)})}else d.forEach((function(e){f.push({minValue:e,maxValue:e,label:s(e,e,i)})}));else if("natural-breaks"===n){for(var g=l(d),j=e.valueFrequency||g.valueFrequency,O=u(g.uniqueValues,j,c),x=p,w=1;w<c;w++)if(g.uniqueValues.length>w){var I=a(g.uniqueValues[O[w]],6);f.push({minValue:x,maxValue:I,label:s(x,I,i)}),x=I}f.push({minValue:x,maxValue:h,label:s(x,h,i)})}else if("quantile"===n)if(d.length>=c&&p!==h){for(var M=p,k=Math.ceil(d.length/c),S=0,T=1;T<c;T++){var A=k+S-1;A>d.length&&(A=d.length-1),A<0&&(A=0),f.push({minValue:M,maxValue:d[A],label:s(M,d[A],i)}),M=d[A],S+=k,k=Math.ceil((d.length-S)/(c-T))}f.push({minValue:M,maxValue:h,label:s(M,h,i)})}else for(var D=-1,C=0;C<d.length;C++){var R=d[C];R!==D&&(D=R,f.push({minValue:D,maxValue:R,label:s(D,R,i)}),D=R)}else if("standard-deviation"===n){var N=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/=e.length,t}(d),L=function(e,t){for(var r=0,n=0;n<e.length;n++){var a=e[n];r+=(a-t)*(a-t)}return r/=e.length,Math.sqrt(r)}(d,N);if(0===L)f.push({minValue:d[0],maxValue:d[0],label:s(d[0],d[0],i)});else{for(var B=function(e,t,r,n,a){var i=Math.max(n-e,t-n)/a/r;return i=i>=1?1:i>=.5?.5:.25,i}(p,h,c,N,L)*L,z=0,_=p,P=c;P>=1;P--){var H=a(N-(P-.5)*B,6);f.push({minValue:_,maxValue:H,label:s(_,H,i)}),_=H,z++}var F=a(N+.5*B,6);f.push({minValue:_,maxValue:F,label:s(_,F,i)}),_=F,z++;for(var E=1;E<=c;E++)F=z===2*c?h:a(N+(E+.5)*B,6),f.push({minValue:_,maxValue:F,label:s(_,F,i)}),_=F,z++}}else if("defined-interval"===n){if(!o)return f;for(var U=d[0],J=d[d.length-1],Z=Math.ceil((J-U)/o),V=U,W=1;W<Z;W++){var G=a(U+W*o,6);f.push({minValue:V,maxValue:G,label:s(V,G,i)}),V=G}f.push({minValue:V,maxValue:J,label:s(V,J,i)})}return f}function s(e,t,r){return e===t?r&&"percent-of-total"===r?e+"%":e.toString():r&&"percent-of-total"===r?e+"% - "+t+"%":e+" - "+t}function l(e){for(var t=[],r=[],n=Number.MIN_VALUE,a=1,i=-1,o=0;o<e.length;o++){var s=e[o];s===n?(a++,r[i]=a):null!==s&&(t.push(s),n=s,a=1,r.push(a),i++)}return{uniqueValues:t,valueFrequency:r}}function u(e,t,r){var n=e.length,a=[];r>n&&(r=n);for(var i=0;i<r;i++)a.push(Math.round(i*n/r-1));a.push(n-1);var o=c(a,e,t,r);return function(e,t,r,n,a,i){for(var o=0,s=0,l=0,u=0,c=!0,d=0;d<2&&c;d++){0===d&&(c=!1);for(var p=0;p<i-1;p++)for(;r[p+1]+1!==r[p+2];){r[p+1]=r[p+1]+1;var h=f(p,r,n,a);l=h.sbMean,o=h.sbSdcm;var b=f(p+1,r,n,a);if(u=b.sbMean,!(o+(s=b.sbSdcm)<t[p]+t[p+1])){r[p+1]=r[p+1]-1;break}t[p]=o,t[p+1]=s,e[p]=l,e[p+1]=u,c=!0}for(var m=i-1;m>0;m--)for(;r[m]!==r[m-1]+1;){r[m]=r[m]-1;var v=f(m-1,r,n,a);l=v.sbMean,o=v.sbSdcm;var y=f(m,r,n,a);if(u=y.sbMean,!(o+(s=y.sbSdcm)<t[m-1]+t[m])){r[m]=r[m]+1;break}t[m-1]=o,t[m]=s,e[m-1]=l,e[m]=u,c=!0}}return c}(o.mean,o.sdcm,a,e,t,r)&&(o=c(a,e,t,r)),a}function c(e,t,r,n){for(var a=[],i=[],o=[],s=0,l=[],u=[],c=0;c<n;c++){var d=f(c,e,t,r);l.push(d.sbMean),u.push(d.sbSdcm),s+=u[c]}for(var p,h=s,b=!0;b||s<h;){b=!1,a=[];for(var m=0;m<n;m++)a.push(e[m]);for(var v=0;v<n;v++)for(var y=e[v]+1;y<=e[v+1];y++)if(p=t[y],v>0&&y!==e[v+1]&&Math.abs(p-l[v])>Math.abs(p-l[v-1]))e[v]=y;else if(v<n-1&&e[v]!==y-1&&Math.abs(p-l[v])>Math.abs(p-l[v+1])){e[v+1]=y-1;break}h=s,s=0,i=[],o=[];for(var g=0;g<n;g++){i.push(l[g]),o.push(u[g]);var j=f(g,e,t,r);l[g]=j.sbMean,u[g]=j.sbSdcm,s+=u[g]}}if(s>h){for(var O=0;O<n;O++)e[O]=a[O],l[O]=i[O],u[O]=o[O];s=h}return{mean:l,sdcm:u}}function f(e,t,r,a){for(var i=0,o=0,s=t[e]+1;s<=t[e+1];s++){var l=a[s];i+=r[s]*l,o+=l}o<=0&&n.warn("Exception in Natural Breaks calculation");for(var u=i/o,c=0,f=t[e]+1;f<=t[e+1];f++)c+=a[f]*Math.pow(r[f]-u,2);return{sbMean:u,sbSdcm:c}}},850:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,a=r(4),i=r(12),o=r(89),s=r(88),l=r(90),u=r(91),c=r(94),f=r(143),d=r(146),p=r(105),h=r(108),b=r(97),m=(r(96),r(98),r(93),r(138)),v=r(95),y=r(477),g=r(611),j=r(505),O=new d.a({flow_from:"flow-from",flow_to:"flow-to"}),x=n=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).density=.8,n.color=new f.a([255,255,255,1]),n.maxPathLength=200,n.trailWidth=1.5,n.flowSpeed=10,n.trailLength=100,n.smoothing=0,n.flowRepresentation="flow-from",n.type="flow",n.authoringInfo=null,n.legendOptions=null,n.trailCap="butt",n.background="none",n}return Object(s.a)(r,[{key:"clone",value:function(){var e,t,r=this.density,a=this.maxPathLength,i=this.trailWidth,o=this.flowSpeed,s=this.trailLength,l=this.smoothing,u=this.flowRepresentation,c=this.trailCap,f=this.background,d=this.color.clone(),p=(this.visualVariables||[]).map((function(e){return e.clone()})),h=null===(e=this.authoringInfo)||void 0===e?void 0:e.clone(),b=null===(t=this.legendOptions)||void 0===t?void 0:t.clone();return new n({density:r,color:d,maxPathLength:a,trailWidth:i,flowSpeed:o,trailLength:s,trailCap:c,background:f,smoothing:l,flowRepresentation:u,visualVariables:p,authoringInfo:h,legendOptions:b})}},{key:"getSymbol",value:function(e,t){}},{key:"getSymbolAsync",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return[]}}]),r}(Object(y.a)(p.a));Object(c.a)([Object(b.b)({type:Number,json:{write:!0}})],x.prototype,"density",void 0),Object(c.a)([Object(b.b)({type:f.a,json:{write:{allowNull:!0}}})],x.prototype,"color",void 0),Object(c.a)([Object(b.b)({type:Number,cast:h.e,json:{write:!0}})],x.prototype,"maxPathLength",void 0),Object(c.a)([Object(b.b)({type:Number,cast:h.e,json:{write:!0}})],x.prototype,"trailWidth",void 0),Object(c.a)([Object(b.b)({type:Number,json:{write:!0}})],x.prototype,"flowSpeed",void 0),Object(c.a)([Object(b.b)({type:Number,json:{write:!0}})],x.prototype,"trailLength",void 0),Object(c.a)([Object(b.b)({type:Number,cast:h.e,json:{write:!1}})],x.prototype,"smoothing",void 0),Object(c.a)([Object(b.b)({type:O.apiValues,json:{type:O.jsonValues,read:{reader:O.read},write:{writer:O.write}}})],x.prototype,"flowRepresentation",void 0),Object(c.a)([Object(m.a)({flowRenderer:"flow"})],x.prototype,"type",void 0),Object(c.a)([Object(b.b)({type:g.a,json:{write:!0}})],x.prototype,"authoringInfo",void 0),Object(c.a)([Object(b.b)({type:j.a,json:{write:!0}})],x.prototype,"legendOptions",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],x.prototype,"trailCap",void 0),Object(c.a)([Object(b.b)({type:String,json:{write:!0}})],x.prototype,"background",void 0);var w=x=n=Object(c.a)([Object(v.a)("esri.renderers.FlowRenderer")],x)},851:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(105),c=r(116),f=r(97),d=(r(96),r(138)),p=r(136),h=r(95),b=r(720),m=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).altitude=45,n.azimuth=315,n.colorRamp=null,n.hillshadeType="traditional",n.pixelSizePower=.664,n.pixelSizeFactor=.024,n.scalingType="none",n.type="raster-shaded-relief",n.zFactor=1,n}return Object(i.a)(r,[{key:"readColorRamp",value:function(e){return Object(b.a)(e)}},{key:"clone",value:function(){return new n({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:Object(c.a)(this.colorRamp)})}}]),r}(u.a);Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],m.prototype,"altitude",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],m.prototype,"azimuth",void 0),Object(l.a)([Object(f.b)({types:b.b,json:{write:!0}})],m.prototype,"colorRamp",void 0),Object(l.a)([Object(p.a)("colorRamp")],m.prototype,"readColorRamp",null),Object(l.a)([Object(f.b)({type:["traditional","multi-directional"],json:{write:!0}})],m.prototype,"hillshadeType",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],m.prototype,"pixelSizePower",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],m.prototype,"pixelSizeFactor",void 0),Object(l.a)([Object(f.b)({type:["none","adjusted"],json:{write:!0}})],m.prototype,"scalingType",void 0),Object(l.a)([Object(d.a)({rasterShadedRelief:"raster-shaded-relief"})],m.prototype,"type",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],m.prototype,"zFactor",void 0);var v=m=n=Object(l.a)([Object(h.a)("esri.renderers.RasterShadedReliefRenderer")],m)},852:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(105),c=r(116),f=r(97),d=(r(96),r(138)),p=r(136),h=r(95),b=r(137),m=r(1175),v=r(720),y=n=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).colorRamp=null,n.computeGamma=!1,n.dynamicRangeAdjustment=!1,n.gamma=[],n.maxPercent=null,n.minPercent=null,n.numberOfStandardDeviations=null,n.outputMax=null,n.outputMin=null,n.sigmoidStrengthLevel=null,n.statistics=[],n.histograms=null,n.useGamma=!1,n.stretchType="none",n.type="raster-stretch",n}return Object(i.a)(r,[{key:"readColorRamp",value:function(e){if(e)return Object(v.a)(e)}},{key:"writeStatistics",value:function(e,t,r){var n;(null===(n=e)||void 0===n?void 0:n.length)&&(Array.isArray(e[0])||(e=e.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),t[r]=e)}},{key:"readStretchType",value:function(e,t){var r=t.stretchType;return"number"==typeof r&&(r=m.a[r]),m.b.read(r)}},{key:"clone",value:function(){return new n({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:Object(c.a)(this.statistics),gamma:Object(c.a)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:Object(c.a)(this.colorRamp),histograms:Object(c.a)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}}]),r}(u.a);Object(l.a)([Object(f.b)({types:v.b,json:{write:!0}})],y.prototype,"colorRamp",void 0),Object(l.a)([Object(p.a)("colorRamp")],y.prototype,"readColorRamp",null),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],y.prototype,"computeGamma",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],y.prototype,"dynamicRangeAdjustment",void 0),Object(l.a)([Object(f.b)({type:[Number],json:{write:!0}})],y.prototype,"gamma",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"maxPercent",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"minPercent",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"numberOfStandardDeviations",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],y.prototype,"outputMax",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],y.prototype,"outputMin",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],y.prototype,"sigmoidStrengthLevel",void 0),Object(l.a)([Object(f.b)({json:{type:[[Number]],write:!0}})],y.prototype,"statistics",void 0),Object(l.a)([Object(f.b)()],y.prototype,"histograms",void 0),Object(l.a)([Object(b.a)("statistics")],y.prototype,"writeStatistics",null),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],y.prototype,"useGamma",void 0),Object(l.a)([Object(f.b)({type:m.b.apiValues,json:{type:m.b.jsonValues,write:m.b.write}})],y.prototype,"stretchType",void 0),Object(l.a)([Object(p.a)("stretchType",["stretchType"])],y.prototype,"readStretchType",null),Object(l.a)([Object(d.a)({rasterStretch:"raster-stretch"})],y.prototype,"type",void 0);var g=y=n=Object(l.a)([Object(h.a)("esri.renderers.RasterStretchRenderer")],y)},853:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n,a=r(4),i=r(12),o=r(92),s=r(89),l=r(88),u=r(90),c=r(91),f=r(94),d=r(143),p=(r(119),r(172)),h=(r(177),r(146)),b=r(105),m=r(116),v=r(97),y=(r(96),r(138)),g=r(136),j=r(95),O=r(217),x=r(571),w=r(347),I=r(477),M=r(781),k=r(780),S=r(582),T=r(982),A=r(346),D=r(394),C=r(739),R=r(135),N=r(562),L=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]),B=new h.a({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"}),z=new h.a({flow_from:"flow-from",flow_to:"flow-to"}),_=n=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this,e)).attributeField="Magnitude",n.flowRepresentation="flow-from",n.rotationType="arithmetic",n.style="single-arrow",n.symbolTileSize=50,n.type="vector-field",n}return Object(l.a)(r,[{key:"readInputUnit",value:function(e,t){return L.has(e)?x.i.fromJSON(e):null}},{key:"readOutputUnit",value:function(e,t){return L.has(e)?x.i.fromJSON(e):null}},{key:"styleRenderer",get:function(){var e=this.style,t=this.attributeField,r=this._createStyleRenderer(e);return r.field=t,r}},{key:"sizeVariables",get:function(){var e=[];if(this.visualVariables){var t,r=Object(o.a)(this.visualVariables);try{for(r.s();!(t=r.n()).done;){var n=t.value;"size"===n.type&&e.push(n)}}catch(i){r.e(i)}finally{r.f()}}if(0===e.length){var a=new S.a({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize});this.visualVariables?this.visualVariables.push(a):this._set("visualVariables",[a]),e.push(a)}return e}},{key:"rotationVariables",get:function(){var e=[];if(this.visualVariables){var t,r=Object(o.a)(this.visualVariables);try{for(r.s();!(t=r.n()).done;){var n=t.value;"rotation"===n.type&&e.push(n)}}catch(i){r.e(i)}finally{r.f()}}if(0===e.length){var a=new k.a({field:"Direction",rotationType:this.rotationType});this.visualVariables?this.visualVariables.push(a):this._set("visualVariables",[a]),e.push(a)}return e}},{key:"clone",value:function(){return new n({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:Object(m.a)(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}},{key:"getGraphicsFromPixelData",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var r,n,i,o,s,l,u,c,f,d,h,b,m,v,y,g=this,j=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=j.length>1&&void 0!==j[1]&&j[1],i=j.length>2&&void 0!==j[2]?j[2]:[],o=new Array,s=Object(x.f)(this.inputUnit,this.outputUnit),l=(null===(r=this.rotationVariables[0])||void 0===r?void 0:r.rotationType)||this.rotationType,null!=(u=n?Object(x.b)(t.pixelBlock,"vector-uv",l,s):Object(x.c)(t.pixelBlock,"vector-magdir",s))){e.next=5;break}return e.abrupt("return",o);case 5:c=t.extent,f=null!=u.mask&&u.mask.length>0,d=0,h=(c.xmax-c.xmin)/u.width,b=(c.ymax-c.ymin)/u.height,m=0;case 9:if(!(m<u.height)){e.next=20;break}v=Object(a.a)().mark((function e(){var t,r,n,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new R.a({x:c.xmin+y*h+h/2,y:c.ymax-m*b-b/2,spatialReference:c.spatialReference}),e.next=3,Object(O.a)(t);case 3:t=e.sent[0],r=i.some((function(e){return e.intersects(t)})),f&&!u.mask[d]||r||(n={Magnitude:u.pixels[0][d],Direction:u.pixels[1][d]},(s=new p.a({geometry:{type:"point",x:t.x,y:t.y,spatialReference:c.spatialReference},attributes:n})).symbol=g._getVisualVariablesAppliedSymbol(s),o.push(s));case 6:case"end":return e.stop()}}),e)})),y=0;case 12:if(!(y<u.width)){e.next=17;break}return e.delegateYield(v(),"t0",14);case 14:y++,d++,e.next=12;break;case 17:m++,e.next=9;break;case 20:return e.abrupt("return",o);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){}},{key:"getSymbolAsync",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return[]}},{key:"getClassBreakInfos",value:function(){var e;return null===(e=this.styleRenderer)||void 0===e?void 0:e.classBreakInfos}},{key:"getDefaultSymbol",value:function(){var e;return null===(e=this.styleRenderer)||void 0===e?void 0:e.defaultSymbol}},{key:"_getDefaultSymbol",value:function(e){return new D.a({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new A.a({width:0}),size:20,color:e||new d.a([0,92,230])})}},{key:"_getVisualVariablesAppliedSymbol",value:function(e){var t;if(e){var r=null===(t=this.styleRenderer)||void 0===t||null===(t=t.getSymbol(e))||void 0===t?void 0:t.clone(),n=this.sizeVariables,a=this.rotationVariables;if(n&&n.length&&this.sizeVariables.forEach((function(t){return Object(C.d)(r,Object(T.getAllSizes)([t],e))})),a&&a.length){var i="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180;e.attributes.Direction=e.attributes.Direction+i,this.rotationVariables.forEach((function(t){return Object(C.c)(r,Object(T.getRotationAngle)(t,e),t.axis)}))}return r}}},{key:"_createStyleRenderer",value:function(e){var t={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(e){case"single-arrow":t=this._createSingleArrowRenderer();break;case"beaufort-kn":t=this._createBeaufortKnotsRenderer();break;case"beaufort-m":t=this._createBeaufortMeterRenderer();break;case"beaufort-ft":t=this._createBeaufortFeetRenderer();break;case"beaufort-mi":t=this._createBeaufortMilesRenderer();break;case"beaufort-km":t=this._createBeaufortKilometersRenderer();break;case"ocean-current-m":t=this._createCurrentMeterRenderer();break;case"ocean-current-kn":t=this._createCurrentKnotsRenderer();break;case"simple-scalar":t=this._createSimpleScalarRenderer();break;case"wind-barb":t=this._createWindBarbsRenderer();break;case"classified-arrow":t=this._createClassifiedArrowRenderer()}return new w.a(t)}},{key:"_createSingleArrowRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol()}}},{key:"_createBeaufortKnotsRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new d.a([214,47,39])),classBreakInfos:this._getClassBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])}}},{key:"_createBeaufortMeterRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new d.a([214,47,39])),classBreakInfos:this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortFeetRenderer",value:function(){var e=this._getDefaultSymbol(new d.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 3.28084*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortMilesRenderer",value:function(){var e=this._getDefaultSymbol(new d.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 2.23694*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortKilometersRenderer",value:function(){var e=this._getDefaultSymbol(new d.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 3.6*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createCurrentMeterRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new d.a([177,177,177])),classBreakInfos:this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])}}},{key:"_createCurrentKnotsRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new d.a([177,177,177])),classBreakInfos:this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])}}},{key:"_createClassifiedArrowRenderer",value:function(){var e,t=this._getDefaultSymbol(new d.a([56,168,0])),r=[0,1e-6,3.5,7,10.5,14];if(null!==(e=this.sizeVariables)&&void 0!==e&&e.length){var n=this.sizeVariables[0].minDataValue,a=this.sizeVariables[0].maxDataValue;if(n&&a){var i=(a-n)/5;r=Array.from(Array(6).keys()).map((function(e){return n+i*e}))}}return{defaultSymbol:t,classBreakInfos:this._getClassBreaks(r,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])}}},{key:"_createSimpleScalarRenderer",value:function(){return{defaultSymbol:N.a.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII=",height:20,width:20,type:"esriPMS",angle:0})}}},{key:"_createWindBarbsRenderer",value:function(){var e=Array.from(Array(31).keys()).map((function(e){return 5*e})),t=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"90-95",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="}],r=N.a.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",height:20,width:20,type:"esriPMS",angle:0}),n=e.map((function(n,a){var i;if(a!==e.length-1)if(0===a)i={minValue:n,maxValue:e[a+1],symbol:r};else{var o=N.a.fromJSON({type:"esriPMS",imageData:t[a].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0});i={minValue:n,maxValue:e[a+1],symbol:o}}return new M.a(i)}));return{defaultSymbol:r,classBreakInfos:n}}},{key:"_getClassBreaks",value:function(e,t){var r=this;return t.map((function(t,n){return new M.a({minValue:e[n],maxValue:e[n+1],symbol:r._getDefaultSymbol(new d.a(t))})}))}}]),r}(Object(I.a)(b.a));Object(f.a)([Object(v.b)({type:String,json:{write:!0}})],_.prototype,"attributeField",void 0),Object(f.a)([Object(v.b)({type:z.apiValues,json:{type:z.jsonValues,read:{reader:z.read},write:{writer:z.write}}})],_.prototype,"flowRepresentation",void 0),Object(f.a)([Object(v.b)({type:["geographic","arithmetic"],json:{write:!0}})],_.prototype,"rotationType",void 0),Object(f.a)([Object(v.b)({type:B.apiValues,json:{type:B.jsonValues,read:{reader:B.read},write:{writer:B.write}}})],_.prototype,"style",void 0),Object(f.a)([Object(v.b)({json:{write:!0}})],_.prototype,"symbolTileSize",void 0),Object(f.a)([Object(v.b)({type:x.i.apiValues,json:{type:x.i.jsonValues,write:{writer:x.i.write}}})],_.prototype,"inputUnit",void 0),Object(f.a)([Object(g.a)("inputUnit")],_.prototype,"readInputUnit",null),Object(f.a)([Object(v.b)({type:x.i.apiValues,json:{type:x.i.jsonValues,read:{reader:x.i.read},write:{writer:x.i.write}}})],_.prototype,"outputUnit",void 0),Object(f.a)([Object(g.a)("outputUnit")],_.prototype,"readOutputUnit",null),Object(f.a)([Object(y.a)({vectorField:"vector-field"})],_.prototype,"type",void 0),Object(f.a)([Object(v.b)({type:w.a})],_.prototype,"styleRenderer",null),Object(f.a)([Object(v.b)({type:S.a})],_.prototype,"sizeVariables",null),Object(f.a)([Object(v.b)({type:k.a})],_.prototype,"rotationVariables",null);var P=_=n=Object(f.a)([Object(j.a)("esri.renderers.VectorFieldRenderer")],_)},854:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o}));var n=r(146),a=Object(n.b)()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),i=Object(n.b)()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"}),o=Object(n.b)()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"})},864:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(112),a=r(89),i=r(88),o=r(90),s=r(91),l=r(94),u=r(105),c=r(97),f=r(96),d=(r(98),r(93),r(138)),p=r(95),h=r(143),b=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).value=null,e.label=null,e.color=null,e}return Object(i.a)(r)}(u.a);Object(l.a)([Object(c.b)({type:Number,json:{write:!0}})],b.prototype,"value",void 0),Object(l.a)([Object(c.b)({type:String,json:{write:!0}})],b.prototype,"label",void 0),Object(l.a)([Object(c.b)({type:h.a,json:{type:[f.a],write:!0}})],b.prototype,"color",void 0);var m,v=b=Object(l.a)([Object(p.a)("esri.renderers.support.ColormapInfo")],b),y=r(685),g=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).colormapInfos=null,n.type="raster-colormap",n}return Object(i.a)(r,[{key:"clone",value:function(){return new m({colormapInfos:this.colormapInfos.map((function(e){return e.toJSON()}))})}},{key:"extractColormap",value:function(){return this.colormapInfos.map((function(e){var t=e.value,r=e.color;return[t,r.r,r.g,r.b,r.a>1?r.a:255*r.a&255]})).sort((function(e,t){return e[0]-t[0]}))}}],[{key:"createFromColormap",value:function(e,t){if(!e)return null;var r=5===e[0].length,a=Object(n.a)(e).sort((function(e,t){return e[0]-t[0]})).map((function(e){var n;return v.fromJSON({value:e[0],color:r?e.slice(1,5):e.slice(1,4).concat([255]),label:t?null!==(n=t[e[0]])&&void 0!==n?n:"":e[0]})}));return new m({colormapInfos:a})}},{key:"createFromColorramp",value:function(e){var t=Object(y.c)(e);return m.createFromColormap(t)}}]),r}(u.a);Object(l.a)([Object(c.b)({type:[v],json:{write:!0}})],g.prototype,"colormapInfos",void 0),Object(l.a)([Object(d.a)({rasterColormap:"raster-colormap"})],g.prototype,"type",void 0);var j=g=m=Object(l.a)([Object(p.a)("esri.renderers.RasterColormapRenderer")],g)},911:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return j})),r.d(t,"f",(function(){return y})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return h})),r.d(t,"i",(function(){return v}));var n=r(1),a=r(112),i=r(98),o=r(573);function s(e,t,r){var n=t.shift();if(0===r.length){r.push({sliceId:-1,multidimensionalDefinition:[]})}for(var i=r.length,o=function(){var t,i=r.shift().multidimensionalDefinition;null===(t=n.values)||void 0===t||t.forEach((function(t){r.push({sliceId:-1,multidimensionalDefinition:[].concat(Object(a.a)(i),[{variableName:e,dimensionName:n.name,values:[t]}])})}))},l=0;l<i;l++)o();t.length&&s(e,t,r)}function l(e,t){var r=[],i=0;return(t?e.variables.filter((function(e){return e.name.toLowerCase()===t.toLowerCase()})):Object(a.a)(e.variables).sort((function(e,t){return e.name>t.name?1:-1}))).forEach((function(e){var t=[],o=Object(a.a)(e.dimensions).sort((function(e,t){return e.name>t.name?-1:1}));s(e.name,o,t),t.forEach((function(e){r.push(Object(n.a)(Object(n.a)({},e),{},{sliceId:i++}))}))})),r}function u(e,t,r){var n=e;if(t&&(t=Object(a.a)(t).sort((function(e,t){return e.dimensionName<t.dimensionName?-1:1}))).forEach((function(e){var t=e.dimensionName,r=e.values,a=e.isSlice;r.length&&(n=n.filter((function(e){var n=e.multidimensionalDefinition.find((function(e){return e.dimensionName===t}));if(null==n)return!1;var i=n.values[0];return"number"==typeof i?"number"==typeof r[0]?r.includes(i):r.some((function(e){return e[0]<=i&&e[1]>=i})):"number"==typeof r[0]?r.some((function(e){return i[0]<=e&&i[1]>=e})):a?r.some((function(e){return e[0]===i[0]&&e[0]===i[1]})):r.some((function(e){return e[0]>=i[0]&&e[0]<=i[1]||e[1]>=i[0]&&e[1]<=i[1]||e[0]<i[0]&&e[1]>i[1]}))})))})),n.length&&r&&null!=r.start&&null!=r.end){var i=r.start.getTime(),o=r.end.getTime(),s=n[0].multidimensionalDefinition.findIndex((function(e){return"StdTime"===e.dimensionName}));s>-1&&(n=n.filter((function(e){var t=e.multidimensionalDefinition[s].values[0];return i<=t&&o>=t})))}return n.map((function(e){return e.sliceId}))}function c(e,t){return Array.isArray(e)?t[0]===t[1]?e[0]===t[0]||e[1]===t[0]:e[0]>=t[0]&&e[0]<=t[1]&&e[1]>=t[0]&&e[1]<=t[1]:e>=t[0]&&e<=t[1]}function f(e){return 1===e.length?[e[0],e[0]]:[e[0],e[e.length-1]]}function d(e,t,r){var i,o;if(null===t||void 0===t||null===(i=t.subsetDefinitions)||void 0===i||!i.length)return e;if(r){var s,l=t.variables;if(l.length&&!l.includes(r))return null;var u=t.subsetDefinitions.find((function(t){return t.dimensionName===e.name&&t.variableName===r}));if(null===u||void 0===u||null===(s=u.values)||void 0===s||!s.length)return e;o=f(u.values)}else{var d=t.dimensions.find((function(t){return t.name===e.name}));o=null===d||void 0===d?void 0:d.extent}var p=o;if(!p||null===p||void 0===p||!p.length)return e;var h=e.values.filter((function(e){return c(e,p)}));return Object(n.a)(Object(n.a)({},e),{},{extent:Object(a.a)(p),values:h})}function p(e,t,r){var n;if(null===t||void 0===t||null===(n=t.subsetDefinitions)||void 0===n||!n.length)return!1;var a=t.variables;if(a.length&&e.some((function(e){var t=e.variableName;return t&&!a.includes(t)})))return!0;for(var i,o=function(){var n=e[s],a=t.subsetDefinitions.find((function(e){return(""===n.variableName||e.variableName===n.variableName)&&e.dimensionName===n.dimensionName}));if(null!==a&&void 0!==a&&a.values.length){var i=f(a.values);if(n.isSlice||2!==n.values.length||Array.isArray(n.values[0])||n.values[0]===n.values[1]||!r){if(n.values.some((function(e){return!c(e,i)})))return{v:!0}}else if(!function(e,t){return e[0]<=t[0]&&e[1]>=t[0]||e[0]<=t[1]&&e[1]>=t[1]||e[0]>=t[0]&&e[1]<=t[1]}(n.values,i))return{v:!0}}},s=0;s<e.length;s++)if(i=o())return i.v;return!1}function h(e,t){if(null==e)return{isOutside:!1};var r=t.geometry,n=t.timeExtent,a=t.multidimensionalDefinition,i=null;if(null!=n&&(i=function(e,t){var r,n,a=e.dimensions.find((function(e){return"StdTime"===e.name}));if(null==a||null==t.start&&null==t.end)return t;t=t.clone();var i=t.toJSON(),s=i.start,l=i.end,u=s===l?[s]:null!=s&&null!=l?[s,l]:[null!==s&&void 0!==s?s:l];return 2===u.length&&null!==a&&void 0!==a&&a.extent.length&&(u[0]=Math.max(u[0],a.extent[0]),u[1]=Math.min(u[1],null!==(r=a.extent[1])&&void 0!==r?r:a.extent[0]),u[1]<u[0])||p([new o.a({variableName:"",dimensionName:"StdTime",isSlice:1===u.length,values:u})],e,!0)?null:(t.start=new Date(u[0]),t.end=new Date(null!==(n=u[1])&&void 0!==n?n:u[0]),t)}(e,n),null==i))return{isOutside:!0};var s=e.areaOfInterest;if(s&&r){var l="point"===r.type?r:"extent"===r.type?r.center:"polygon"===r.type?r.centroid:null;if(l&&!s.contains(l))return{isOutside:!0}}return null!=a&&a.length&&p(a,e,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:r,timeExtent:i,multidimensionalDefinition:a}}}function b(e){var t,r,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.multidimensionalInfo,o=e.keyProperties;if(null==i)return null;var s=a.variableName,l=a.multidimensionalSubset,u=a.multidimensionalDefinition,c=null!=u?null===(t=u[0])||void 0===t?void 0:t.variableName:null,f=s||c||(null===o||void 0===o?void 0:o.DefaultVariable),d=i.variables;return(null===l||void 0===l||null===(r=l.variables)||void 0===r?void 0:r.length)&&(d=d.filter((function(e){var t=e.name;return l.variables.includes(t)}))),f&&null!==(n=d.find((function(e){return e.name===f})))&&void 0!==n?n:d[0]}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=b(e,t);if(!r)return null;var n=[],a=r.dimensions,i=r.name;if(0===a.length)return[new o.a({variableName:i,dimensionName:"",values:[],isSlice:!0})];for(var s=0;s<a.length;s++){var l,u=d(a[s],t.multidimensionalSubset,i);if(!u)return null;var c=u.values,f=u.extent,p=null!==(l=null===c||void 0===c?void 0:c[0])&&void 0!==l?l:f[0];"stdz"===u.name.toLowerCase()&&!u.hasRanges&&Math.abs(f[1])<=Math.abs(f[0])&&(p=null!==c&&void 0!==c&&c.length?c[c.length-1]:f[1]),n.push(new o.a({variableName:i,dimensionName:u.name,values:[p],isSlice:!t.useRangeForRangedDimensionInfo||!!u.hasRanges}))}return n}function v(e){return!(null==e||!e.length)&&e.some((function(e){if(null==e.values)return!0;var t=e.values.length;return 0===t||t>1||!e.isSlice&&Array.isArray(e.values[0])}))}function y(e,t){var r;if(null==t||null==e)return null;var a=t.variables.map((function(e){return Object(n.a)({},e)}));return null!==e&&void 0!==e&&null!==(r=e.variables)&&void 0!==r&&r.length&&(a=a.filter((function(t){var r=t.name;return e.variables.includes(r)}))).forEach((function(t){t.dimensions=t.dimensions.map((function(r){return d(r,e,t.name)})).filter(i.i)})),a}function g(e){var t,r,n,a=null===(t=e.values)||void 0===t?void 0:t.length;if(a)return a;var i=e.extent,o=e.unit,s=e.interval||1,l=i?i[1]-i[0]:0;if("ISO8601"!==o)return Math.round(l/s);switch(null!==(r=null===(n=e.intervalUnit)||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:"seconds"){case"seconds":a=Math.round(l/1e3/s);break;case"minutes":a=Math.round(l/6e4/s);break;case"hours":a=Math.round(l/36e5/s);break;case"days":a=Math.round(l/864e5/s);break;case"months":var u=new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear(),c=new Date(i[0]).getUTCMonth(),f=new Date(i[1]).getUTCMonth();a=0===u?f-c+1:f+11-c+12*(u-1)+1;break;case"years":a=Math.round((new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear())/s);break;case"decades":a=Math.round((new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear())/10/s);break;default:a=0}return a}function j(e,t){for(var r,n=0,i=e[0].variableName,o=Object(a.a)(t.variables).sort((function(e,t){return e.name>t.name?1:-1})),s=function(){var t=o[l],r=Object(a.a)(t.dimensions).sort((function(e,t){return e.name>t.name?-1:1}));if(t.name!==i)return n+=r.map((function(e){return g(e)})).reduce((function(e,t){return e*t})),0;for(var s,u=r.map((function(e){return g(e)})),c=r.length,f=function(t){var a=e.find((function(e){return e.dimensionName===r[t].name}));if(null==a)return{v:{v:null}};var i=function(e,t){var r,n=t.values;if(null!==n&&void 0!==n&&n.length){var a=Array.isArray(n[0]),i=Array.isArray(e);return a!==i?-1:a&&i?n.findIndex((function(t){return t[0]===e[0]&&t[1]===e[1]})):n.indexOf(e)}var o=t.extent;if(Array.isArray(e)||e<o[0]||e>o[1])return-1;var s=t.interval||1;if("ISO8601"!==t.unit)return Math.round((e-o[0])/s);var l=o[0],u=-1;switch((null===(r=t.intervalUnit)||void 0===r?void 0:r.toLowerCase())||"seconds"){case"seconds":u=Math.round((e-l)/1e3/s);break;case"minutes":u=Math.round((e-l)/6e4/s);break;case"hours":u=Math.round((e-l)/36e5/s);break;case"days":u=Math.round((e-l)/864e5/s);break;case"months":var c=new Date(e).getUTCFullYear()-new Date(l).getUTCFullYear(),f=new Date(l).getUTCMonth(),d=new Date(e).getUTCMonth();u=0===c?d-f:d+11-f+12*(c-1);break;case"years":u=Math.round((new Date(e).getUTCFullYear()-new Date(l).getUTCFullYear())/s);break;case"decades":u=Math.round((new Date(e).getUTCFullYear()-new Date(l).getUTCFullYear())/10/s)}return u}(a.values[0],r[t]);if(-1===i)return{v:{v:null}};u.shift(),n+=t===c-1?i:i*u.reduce((function(e,t){return e*t}))},d=0;d<c;d++)if(s=f(d))return s.v;return 1},l=0;l<o.length;l++)if(0!==(r=s())){if(1===r)break;if(r)return r.v}return n}}}]);
//# sourceMappingURL=171.fd08cce3.chunk.js.map
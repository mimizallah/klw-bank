(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[39],{936:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return _e}));var n=r(92),a=r(4),i=r(12),o=r(1),u=r(89),s=r(88),l=r(107),c=r(106),p=r(90),b=r(91),d=r(94),y=r(145),f=r(101),v=r(189),O=r(590),h=r(281),j=r(110),m=r(127),g=r(352),w=r(128),k=r(97),x=(r(96),r(98),r(93),r(136)),F=r(95),S=r(292),I=r(259),E=r(541),T=r(485),C=r(330),L=r(542),P=r(783),_=r(1243),A=r(311),G=r(326),D=r(425),q=r(302),R=r(566),V=r(324),N=r(244),U=r(565),M=r(544),Q=r(195),H=r(105),J=r(137),B=r(749),z=function(e){Object(p.a)(r,e);var t=Object(b.a)(r);function r(){var e;return Object(u.a)(this,r),(e=t.apply(this,arguments)).code=null,e.defaultValues={},e.domains=null,e.name=null,e}return Object(s.a)(r,[{key:"readDomains",value:function(e){if(!e)return null;for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t[a]=Object(B.a)(e[a])}return t}},{key:"writeDomains",value:function(e,t){if(e){for(var r={},n=0,a=Object.keys(e);n<a.length;n++){var i,o=a[n];e[o]&&(r[o]=null===(i=e[o])||void 0===i?void 0:i.toJSON())}t.domains=r}}}]),r}(H.a);Object(d.a)([Object(k.b)({type:Number,json:{write:!0}})],z.prototype,"code",void 0),Object(d.a)([Object(k.b)({type:Object,json:{write:!0}})],z.prototype,"defaultValues",void 0),Object(d.a)([Object(k.b)({json:{write:!0}})],z.prototype,"domains",void 0),Object(d.a)([Object(x.a)("domains")],z.prototype,"readDomains",null),Object(d.a)([Object(J.a)("domains")],z.prototype,"writeDomains",null),Object(d.a)([Object(k.b)({type:String,json:{write:!0}})],z.prototype,"name",void 0);var Z=z=Object(d.a)([Object(F.a)("esri.layers.support.Subtype")],z),K=r(258),W=r(347),X=(r(432),r(438),r(439),r(437),r(301)),Y=r(397),$=r(350),ee=(r(416),r(234)),te=r(116),re=r(329),ne=r(102),ae=r(263),ie=r(518),oe=r(1238),ue=r(787),se=r(497),le=r(383),ce=r(210),pe=r(486),be=r(523),de=["charts","editingEnabled","formTemplate","labelsVisible","labelingInfo","legendEnabled","minScale","maxScale","opacity","popupEnabled","popupTemplate","renderer","subtypeCode","templates","title","visible"],ye={key:"type",base:X.a,errorContext:"renderer",typeMap:{simple:Y.a,"unique-value":$.a,"class-breaks":W.a}},fe=Object(M.a)(),ve=Object(ie.b)({types:ye}),Oe=0;function he(e){var t=e.json.write;return"object"==typeof t?t.ignoreOrigin=!0:e.json.write={ignoreOrigin:!0},e}function je(e){switch(e){case"point":case"multipoint":return be.a.clone();case"polyline":return be.c.clone();case"polygon":case"multipatch":return be.b.clone();default:return null}}function me(e,t){var r;return null==e?null:null===(r=t.subtypes)||void 0===r?void 0:r.find((function(t){return t.code===e}))}function ge(e,t){var r=null;switch(t.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":r="point";break;case"esriGeometryPolyline":r="line";break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":r="polygon";break;default:t.type,r=null}var n={},a=me(e,t);if(null!=a){var i=a.defaultValues;for(var o in i)n[o]=i[o]}return n[t.subtypeField]=e,new ue.a({name:"New Feature",drawingTool:r,prototype:{attributes:n}})}var we="esri.layers.support.SubtypeSublayer",ke=function(e){Object(p.a)(r,e);var t=Object(b.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).charts=null,n.editingEnabled=!0,n.fieldOverrides=null,n.fieldsIndex=null,n.formTemplate=null,n.id="".concat(Date.now().toString(16),"-subtype-sublayer-").concat(Oe++),n.type="subtype-sublayer",n.labelsVisible=!0,n.labelingInfo=null,n.layerType="ArcGISFeatureLayer",n.legendEnabled=!0,n.listMode="show",n.minScale=0,n.maxScale=0,n.opacity=1,n.parent=null,n.popupEnabled=!0,n.popupTemplate=null,n.subtypeCode=null,n.templates=null,n.title=null,n.visible=!0,n}return Object(s.a)(r,[{key:"capabilities",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.capabilities}},{key:"effectiveCapabilities",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.effectiveCapabilities}},{key:"effectiveEditingEnabled",get:function(){var e=this.parent;return e?e.effectiveEditingEnabled&&this.editingEnabled:this.editingEnabled}},{key:"elevationInfo",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.elevationInfo}},{key:"writeFieldOverrides",value:function(e,t,r){var n,a,i=this.fields,o=this.parent;if(i){a=[];var u=0;i.forEach((function(e){var t,r=e.name,n=e.alias,i=e.editable;if(e.visible){var s=null===o||void 0===o||null===(t=o.fields)||void 0===t?void 0:t.find((function(e){return e.name===r}));if(s){var l={name:r},c=!1;n!==s.alias&&(l.alias=n,c=!0),i!==s.editable&&(l.editable=i,c=!0),a.push(l),c&&u++}}})),0===u&&a.length===i.length&&(a=null)}else a=Object(te.a)(e);(null===(n=a)||void 0===n?void 0:n.length)&&Object(ae.c)(r,a,t)}},{key:"fields",get:function(){var e=this.parent,t=this.fieldOverrides,r=this.subtypeCode,a=null===e||void 0===e?void 0:e.fields;if(!e||null===a||void 0===a||!a.length)return null;var i,o=e.subtypes,u=e.subtypeField,s=null===o||void 0===o?void 0:o.find((function(e){return e.code===r})),l=null===s||void 0===s?void 0:s.defaultValues,c=null===s||void 0===s?void 0:s.domains,p=[],b=Object(n.a)(a);try{var d=function(){var e,n,a=i.value.clone(),o=a.name,s=null===t||void 0===t?void 0:t.find((function(e){return e.name===o}));if(a.visible=!t||!!s,s){var b=s.alias,d=s.editable;b&&(a.alias=b),!1===d&&(a.editable=!1)}var y=null!==(e=null===l||void 0===l?void 0:l[o])&&void 0!==e?e:null;a.defaultValue=o===u?r:y;var f=null!==(n=null===c||void 0===c?void 0:c[o])&&void 0!==n?n:null;a.domain=o===u?null:f?"inherited"===f.type?a.domain:f.clone():null,p.push(a)};for(b.s();!(i=b.n()).done;)d()}catch(y){b.e(y)}finally{b.f()}return p}},{key:"floorInfo",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.floorInfo}},{key:"geometryType",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.geometryType}},{key:"effectiveScaleRange",get:function(){return{minScale:this.minScale,maxScale:this.maxScale}}},{key:"objectIdField",get:function(){var e;return this.parent||ne.a.getLogger(we).error(Fe("objectIdField")),null===(e=this.parent)||void 0===e?void 0:e.objectIdField}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",get:function(){if(this._isOverridden("renderer"))return this._get("renderer");var e=this.parent;return e&&!e.isTable&&"mesh"!==e.geometryType?function(e){return new Y.a({symbol:je(e)})}(e.geometryType):null},set:function(e){Object(Q.m)(e,this.fieldsIndex),this._override("renderer",e)}},{key:"readRendererFromService",value:function(e,t,r){var n,a;if("Table"===t.type)return null;var i,o=null===(n=t.drawingInfo)||void 0===n?void 0:n.renderer,u=ve(o,t,r),s=this.subtypeCode;if(null!=s&&function(e,t){return!!t&&"unique-value"===(null===e||void 0===e?void 0:e.type)&&"string"==typeof e.field&&e.field.toLowerCase()===t.toLowerCase()&&!e.field2&&!e.field3&&!e.valueExpression}(u,t.subtypeField)){var l,c=null===(l=u.uniqueValueInfos)||void 0===l?void 0:l.find((function(e){var t=e.value;return(t="number"==typeof t?String(t):t)===String(s)}));c&&(i=new Y.a({symbol:c.symbol}))}else"simple"!==(null===u||void 0===u?void 0:u.type)||(null===(a=u.visualVariables)||void 0===a?void 0:a.length)||(i=u);return i}},{key:"readRenderer",value:function(e,t,r){var n,a,i=null===t||void 0===t||null===(n=t.layerDefinition)||void 0===n||null===(n=n.drawingInfo)||void 0===n?void 0:n.renderer;if(i){var o=null===(a=i.visualVariables)||void 0===a?void 0:a.some((function(e){return"rotationInfo"!==e.type}));return o?void 0:ve(i,t,r)||void 0}}},{key:"spatialReference",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.spatialReference}},{key:"readTemplatesFromService",value:function(e,t){return[ge(this.subtypeCode,t)]}},{key:"readTitleFromService",value:function(e,t){var r=me(this.subtypeCode,t);return null!=r?r.name:null}},{key:"url",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.url}},{key:"userHasUpdateItemPrivileges",get:function(){var e;return!(null===(e=this.parent)||void 0===e||!e.userHasUpdateItemPrivileges)}},{key:"addAttachment",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.parent){e.next=3;break}throw Fe("addAttachment");case 3:if(t.getAttribute(n.subtypeField)===this.subtypeCode){e.next=5;break}throw new f.a("subtype-sublayer:addAttachment","The feature provided does not belong to this SubtypeSublayer");case 5:return e.abrupt("return",n.addAttachment(t,r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r,n){var i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.parent){e.next=3;break}throw Fe("updateAttachment");case 3:if(t.getAttribute(i.subtypeField)===this.subtypeCode){e.next=5;break}throw new f.a("subtype-sublayer:updateAttachment","The feature provided does not belong to this SubtypeSublayer");case 5:return e.abrupt("return",i.updateAttachment(t,r,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"deleteAttachments",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.parent){e.next=3;break}throw Fe("deleteAttachments");case 3:if(t.getAttribute(n.subtypeField)===this.subtypeCode){e.next=5;break}throw new f.a("subtype-sublayer:deleteAttachments","The feature provided does not belong to this SubtypeSublayer");case 5:return e.abrupt("return",n.deleteAttachments(t,r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.parent){e.next=2;break}throw Fe("applyEdits");case 2:return e.abrupt("return",this.parent.applyEdits(t,r));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createPopupTemplate",value:function(e){var t=this,r=this.parent,n=this.fields,a=this.title;r&&(t={displayField:r.displayField,editFieldsInfo:r.editFieldsInfo,fields:n,objectIdField:r.objectIdField,title:a});return Object(pe.a)(t,e)}},{key:"createQuery",value:function(){if(!this.parent)throw Fe("createQuery");var e=Object(U.e)(this.parent),t="".concat(this.parent.subtypeField,"=").concat(this.subtypeCode);return e.where=Object(g.b)(t,this.parent.definitionExpression),e}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"getFieldDomain",value:function(e){return this._getLayerDomain(e)}},{key:"hasUserOverrides",value:function(){var e=this;return de.some((function(t){return e.originIdOf(t)===S.a.USER}))}},{key:"queryAttachments",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if((n=e.sent).parent){e.next=5;break}throw Fe("queryAttachments");case 5:return i=t.clone(),e.abrupt("return",(i.where=xe(i.where,n.parent.subtypeField,n.subtypeCode),n.parent.queryAttachments(t,r)));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatures",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var n,i,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if((i=e.sent).parent){e.next=5;break}throw Fe("queryFeatures");case 5:return o=null!==(n=ce.a.from(t))&&void 0!==n?n:i.createQuery(),e.abrupt("return",(null!=t&&(o.where=xe(o.where,i.parent.subtypeField,i.subtypeCode)),i.parent.queryFeatures(o,r)));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}}]),r}(Object(v.b)(Object(h.a)(Object(ee.a)(re.a))));Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"capabilities",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"effectiveCapabilities",null),Object(d.a)([Object(k.b)({json:{write:{ignoreOrigin:!0}}})],ke.prototype,"charts",void 0),Object(d.a)([Object(k.b)({type:Boolean,nonNullable:!0,json:{name:"enableEditing",write:{ignoreOrigin:!0}}})],ke.prototype,"editingEnabled",void 0),Object(d.a)([Object(k.b)({type:Boolean,readOnly:!0})],ke.prototype,"effectiveEditingEnabled",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"elevationInfo",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{name:"layerDefinition.fieldOverrides",origins:{service:{read:!1}},write:{ignoreOrigin:!0,allowNull:!0}}})],ke.prototype,"fieldOverrides",void 0),Object(d.a)([Object(J.a)("fieldOverrides")],ke.prototype,"writeFieldOverrides",null),Object(d.a)([Object(k.b)(Object(o.a)(Object(o.a)({},fe.fields),{},{readOnly:!0,json:{read:!1}}))],ke.prototype,"fields",null),Object(d.a)([Object(k.b)(fe.fieldsIndex)],ke.prototype,"fieldsIndex",void 0),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"floorInfo",null),Object(d.a)([Object(k.b)({type:oe.a,json:{name:"formInfo",write:{ignoreOrigin:!0}}})],ke.prototype,"formTemplate",void 0),Object(d.a)([Object(k.b)({type:String,readOnly:!0,json:{origins:{service:{read:!1}},write:{ignoreOrigin:!0}}})],ke.prototype,"id",void 0),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"geometryType",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"type",void 0),Object(d.a)([Object(k.b)(he(Object(te.a)(N.d)))],ke.prototype,"labelsVisible",void 0),Object(d.a)([Object(k.b)({type:[se.a],json:{name:"layerDefinition.drawingInfo.labelingInfo",origins:{service:{read:!1}},read:{reader:le.a},write:{ignoreOrigin:!0}}})],ke.prototype,"labelingInfo",void 0),Object(d.a)([Object(k.b)({type:["ArcGISFeatureLayer"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],ke.prototype,"layerType",void 0),Object(d.a)([Object(k.b)(he(Object(te.a)(N.e)))],ke.prototype,"legendEnabled",void 0),Object(d.a)([Object(k.b)({type:["show","hide"]})],ke.prototype,"listMode",void 0),Object(d.a)([Object(k.b)(function(){var e=Object(te.a)(N.h);return e.json.origins.service.read=!1,he(e)}())],ke.prototype,"minScale",void 0),Object(d.a)([Object(k.b)(function(){var e=Object(te.a)(N.g);return e.json.origins.service.read=!1,he(e)}())],ke.prototype,"maxScale",void 0),Object(d.a)([Object(k.b)({readOnly:!0})],ke.prototype,"effectiveScaleRange",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"objectIdField",null),Object(d.a)([Object(k.b)({type:Number,range:{min:0,max:1},nonNullable:!0,json:{write:{ignoreOrigin:!0}}})],ke.prototype,"opacity",void 0),Object(d.a)([Object(k.b)()],ke.prototype,"parent",void 0),Object(d.a)([Object(k.b)(he(Object(te.a)(N.k)))],ke.prototype,"popupEnabled",void 0),Object(d.a)([Object(k.b)({type:K.a,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],ke.prototype,"popupTemplate",void 0),Object(d.a)([Object(k.b)({readOnly:!0})],ke.prototype,"defaultPopupTemplate",null),Object(d.a)([Object(k.b)({types:ye,json:{write:{target:"layerDefinition.drawingInfo.renderer",ignoreOrigin:!0}}})],ke.prototype,"renderer",null),Object(d.a)([Object(x.a)("service","renderer",["drawingInfo.renderer","subtypeField","type"])],ke.prototype,"readRendererFromService",null),Object(d.a)([Object(x.a)("renderer",["layerDefinition.drawingInfo.renderer"])],ke.prototype,"readRenderer",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"spatialReference",null),Object(d.a)([Object(k.b)({type:Number,json:{origins:{service:{read:!1}},write:{ignoreOrigin:!0}}})],ke.prototype,"subtypeCode",void 0),Object(d.a)([Object(k.b)({type:[ue.a],json:{name:"layerDefinition.templates",write:{ignoreOrigin:!0}}})],ke.prototype,"templates",void 0),Object(d.a)([Object(x.a)("service","templates",["geometryType","subtypeField","subtypes","type"])],ke.prototype,"readTemplatesFromService",null),Object(d.a)([Object(k.b)({type:String,json:{write:{ignoreOrigin:!0}}})],ke.prototype,"title",void 0),Object(d.a)([Object(x.a)("service","title",["subtypes"])],ke.prototype,"readTitleFromService",null),Object(d.a)([Object(k.b)({readOnly:!0,json:{read:!1}})],ke.prototype,"url",null),Object(d.a)([Object(k.b)({readOnly:!0})],ke.prototype,"userHasUpdateItemPrivileges",null),Object(d.a)([Object(k.b)({type:Boolean,nonNullable:!0,json:{name:"visibility",write:{ignoreOrigin:!0}}})],ke.prototype,"visible",void 0),ke=Object(d.a)([Object(F.a)(we)],ke);var xe=function(e,t,r){var n=new RegExp("".concat(t,"\\s*=\\s*\\d+")),a="".concat(t,"=").concat(r),i=null!==e&&void 0!==e?e:"";return n.test(i)?i.replace(n,a):Object(g.b)(a,i)},Fe=function(e){return new f.a("This sublayer must have a parent SubtypeGroupLayer in order to use ".concat(e))},Se=ke,Ie=r(893),Ee=r(894),Te="SubtypeGroupLayer";function Ce(e,t){return new f.a("layer:unsupported","Layer (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' ").concat(t),{layer:e})}var Le=Object(M.a)(),Pe=function(e){Object(p.a)(d,e);var t=Object(b.a)(d);function d(){var e;Object(u.a)(this,d);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n)))._sublayersCollectionChanged=!1,e._sublayerLookup=new Map,e.fields=null,e.fieldsIndex=null,e.outFields=null,e.subtypes=null,e.sublayers=new(y.a.ofType(Se)),e.timeInfo=null,e.title="Layer",e.type="subtype-group",e.addHandles(Object(m.e)((function(){return e.sublayers}),(function(t,r){return e._handleSublayersChange(t,r)}),m.c)),e}return Object(s.a)(d,[{key:"destroy",value:function(){var e;null===(e=this.source)||void 0===e||e.destroy()}},{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(o.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=null!=e?e.signal:null,n=this.loadFromPortal({supportedTypes:["Feature Service"]},e).catch(j.m).then(Object(i.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url){e.next=2;break}throw new f.a("subtype-grouplayer:missing-url-or-source","SubtypeGroupLayer must be created with either a url or a portal item");case 2:if(null!=t.layerId){e.next=4;break}throw new f.a("subtype-grouplayer:missing-layerid","layerId is required for a SubtypeGroupLayer created with url");case 4:return e.t0=t,e.next=7,t.createGraphicsSource(r);case 7:return e.t1=e.sent,e.abrupt("return",e.t0._initLayerProperties.call(e.t0,e.t1));case 9:case"end":return e.stop()}}),e)})))).then((function(){return t._setUserPrivileges(t.serviceItemId,e)})).then((function(){return Object(U.g)(t,e)}));return this.addResolvingPromise(n),Promise.resolve(this)}},{key:"createQueryVersion",get:function(){var e;return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(null!==(e=this._get("createQueryVersion"))&&void 0!==e?e:0)+1}},{key:"editingEnabled",get:function(){return this.loaded&&null!=this.capabilities&&this.capabilities.operations.supportsEditing&&this.userHasEditingPrivileges}},{key:"effectiveEditingEnabled",get:function(){return Object(U.c)(this)}},{key:"parsedUrl",get:function(){var e=Object(w.Q)(this.url);return null!=e&&null!=this.layerId&&(e.path=Object(w.D)(e.path,this.layerId.toString())),e}},{key:"source",set:function(e){this._get("source")!==e&&this._set("source",e)}},{key:"readTitleFromService",value:function(e,t){var r=t.name;return this.url?Object(V.i)(this.url,r):r}},{key:"addAttachment",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.a)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r,n){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.t)(this,t,r,n,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.b)(this,t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"on",value:function(e,t){return Object(l.a)(Object(c.a)(d.prototype),"on",this).call(this,e,t)}},{key:"createGraphicsSource",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.r)(Promise.all([r.e(0),r.e(6),r.e(22),r.e(54)]).then(r.bind(null,2273)),t);case 2:return n=e.sent,i=n.default,e.abrupt("return",new i({layer:this}).load({signal:t}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createQuery",value:function(){var e=Object(U.e)(this),t=this.sublayers.map((function(e){return e.subtypeCode}));return e.where=Object(g.b)("".concat(this.subtypeField," IN (").concat(t.join(","),")"),this.definitionExpression),e}},{key:"deleteAttachments",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.f)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchRecomputedExtents",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.h)(this,t,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"findSublayerForFeature",value:function(e){var t=this.fieldsIndex.get(this.subtypeField),r=e.attributes[t.name];return this.findSublayerForSubtypeCode(r)}},{key:"findSublayerForSubtypeCode",value:function(e){return this._sublayerLookup.get(e)}},{key:"getFieldDomain",value:function(e,t){return this._getLayerDomain(e)}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"loadAll",value:function(){var e=this;return Object(O.a)(this,(function(t){t(e.sublayers)}))}},{key:"queryAttachments",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.k)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatures",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){var i,o,u,s,l,c,p,b,d;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return u=e.sent,s=null!==(i=ce.a.from(t))&&void 0!==i?i:u.createQuery(),(l=null!==(o=s.outFields)&&void 0!==o?o:[]).includes(this.subtypeField)||(l.push(this.subtypeField),s.outFields=l),e.next=8,u.source.queryFeatures(s,r);case 8:if(null!==(c=e.sent)&&void 0!==c&&c.features){p=Object(n.a)(c.features);try{for(p.s();!(b=p.n()).done;)(d=b.value).layer=d.sourceLayer=this.findSublayerForFeature(d)}catch(a){p.e(a)}finally{p.f()}}return e.abrupt("return",c);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryObjectIds",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.n)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.m)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryExtent",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.l)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeatures",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.o)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeaturesCount",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.p)(this,t,r,Te));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"write",value:function(e,t){var r,n=t.origin,a=t.layerContainerType,i=t.messages;if(this.isTable){if("web-scene"===n||"web-map"===n&&"tables"!==a)return null!==i&&void 0!==i&&i.push(Ce(this,"using a table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&"web-map"===n&&"tables"===a)return null!==i&&void 0!==i&&i.push(Ce(this,"using a non-table source cannot be written to tables in web maps")),null;return null!==(r=this.sublayers)&&void 0!==r&&r.length?Object(l.a)(Object(c.a)(d.prototype),"write",this).call(this,e,t):(null!==i&&void 0!==i&&i.push(new f.a("web-document-write:invalid-property","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' has invalid value for 'sublayers' property. 'sublayers' collection should contain at least one sublayer"),{layer:this})),null)}},{key:"serviceSupportsSpatialReference",value:function(e){return!!this.loaded&&Object(Ee.a)(this,e)}},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}},{key:"_initLayerProperties",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var r,n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._set("source",t),(n=t.sourceJSON)&&(this.sourceJSON=n,this.read(n,{origin:"service",url:this.parsedUrl})),!this.isTable){e.next=4;break}throw new f.a("subtype-grouplayer:unsupported-source","SubtypeGroupLayer cannot be created using a layer with table source");case 4:if(null!==(r=this.subtypes)&&void 0!==r&&r.length){e.next=6;break}throw new f.a("subtype-grouplayer:missing-subtypes","SubtypeGroupLayer must be created using a layer with subtypes");case 6:this._verifyFields(),Object(Q.n)(this.timeInfo,this.fieldsIndex);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasDataChanged",value:function(){var e=Object(i.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(U.j)(this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_verifyFields",value:function(){var e,t,r,n=null!==(e=null===(t=this.parsedUrl)||void 0===t?void 0:t.path)&&void 0!==e?e:"undefined";this.objectIdField||console.log("SubtypeGroupLayer: 'objectIdField' property is not defined (url: "+n+")"),this.isTable||-1!==n.search(/\/FeatureServer\//i)||(null===(r=this.fields)||void 0===r?void 0:r.some((function(e){return"geometry"===e.type})))||console.log("SubtypeGroupLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+n+")")}},{key:"_handleSublayersChange",value:function(e,t){var r=this;t&&(t.forEach((function(e){e.parent=null})),this.handles.remove("sublayers-owner"),this._sublayerLookup.clear()),e&&(e.forEach((function(e){e.parent=r,r._sublayerLookup.set(e.subtypeCode,e)})),this._sublayersCollectionChanged=!1,this.handles.add([e.on("after-add",(function(e){var t=e.item;t.parent=r,r._sublayerLookup.set(t.subtypeCode,t)})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,r._sublayerLookup.delete(t.subtypeCode)})),e.on("after-changes",(function(){r._sublayersCollectionChanged=!0}))],"sublayers-owner"))}}]),d}(Object(_.a)(Object(P.a)(Object(C.a)(Object(R.a)(Object(q.a)(Object(D.a)(Object(T.a)(Object(A.a)(Object(G.a)(Object(h.a)(Object(L.a)(Object(E.a)(Object(v.b)(I.a))))))))))))));Object(d.a)([Object(k.b)({readOnly:!0})],Pe.prototype,"createQueryVersion",null),Object(d.a)([Object(k.b)({readOnly:!0})],Pe.prototype,"editingEnabled",null),Object(d.a)([Object(k.b)({readOnly:!0})],Pe.prototype,"effectiveEditingEnabled",null),Object(d.a)([Object(k.b)(Object(o.a)(Object(o.a)({},Le.fields),{},{readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}))],Pe.prototype,"fields",void 0),Object(d.a)([Object(k.b)(Le.fieldsIndex)],Pe.prototype,"fieldsIndex",void 0),Object(d.a)([Object(k.b)(N.c)],Pe.prototype,"id",void 0),Object(d.a)([Object(k.b)({type:["show","hide","hide-children"]})],Pe.prototype,"listMode",void 0),Object(d.a)([Object(k.b)({value:"SubtypeGroupLayer",type:["SubtypeGroupLayer"]})],Pe.prototype,"operationalLayerType",void 0),Object(d.a)([Object(k.b)(Le.outFields)],Pe.prototype,"outFields",void 0),Object(d.a)([Object(k.b)({readOnly:!0})],Pe.prototype,"parsedUrl",null),Object(d.a)([Object(k.b)()],Pe.prototype,"source",null),Object(d.a)([Object(k.b)({type:[Z],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],Pe.prototype,"subtypes",void 0),Object(d.a)([Object(k.b)({type:y.a.ofType(Se),json:{origins:{service:{read:{source:"subtypes",reader:function(e,t,r){var n=e.map((function(e){var n=e.code,a=new Se({subtypeCode:n});return a.read(t,r),a}));return new(y.a.ofType(Se))(n)}}}},name:"layers",write:{overridePolicy:function(e,t,r){var n=this.originOf("sublayers"),a=S.a.PORTAL_ITEM,i=!0;if(Object(S.e)(n)===a&&Object(S.e)(r.origin)>a){var o=e.some((function(e){return e.hasUserOverrides()}));i=this._sublayersCollectionChanged||o}return{enabled:i,ignoreOrigin:!0}}}}})],Pe.prototype,"sublayers",void 0),Object(d.a)([Object(k.b)({type:Ie.a})],Pe.prototype,"timeInfo",void 0),Object(d.a)([Object(k.b)({json:{origins:{"portal-item":{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0}}}}})],Pe.prototype,"title",void 0),Object(d.a)([Object(x.a)("service","title",["name"])],Pe.prototype,"readTitleFromService",null),Object(d.a)([Object(k.b)({json:{read:!1}})],Pe.prototype,"type",void 0);var _e=Pe=Object(d.a)([Object(F.a)("esri.layers.SubtypeGroupLayer")],Pe)}}]);
//# sourceMappingURL=39.230100e1.chunk.js.map
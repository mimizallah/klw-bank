(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[32],{1086:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return f}));var n=r(4),a=r(12),u=r(88),o=r(89),s=r(373),i=Object(u.a)((function e(t){Object(o.a)(this,e),this.data=t,this.type="encoded-mesh-texture",this.encoding=s.g.KTX2_ENCODING}));function c(e){return"encoded-mesh-texture"===(null===e||void 0===e?void 0:e.type)}function f(e){return l.apply(this,arguments)}function l(){return l=Object(a.a)(Object(n.a)().mark((function e(t){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new Blob([t]),a=new FileReader;a.onload=function(){var t=a.result;e(JSON.parse(t))},a.onerror=function(e){r(e)},a.readAsText(n)})));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=Object(a.a)(Object(n.a)().mark((function e(t,r){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r===s.g.KTX2_ENCODING?new i(t):new Promise((function(e,n){var a=new Blob([t],{type:r}),u=URL.createObjectURL(a),o=new Image,s=function(){URL.revokeObjectURL(u),"decode"in o?o.decode().then((function(){return e(o)}),(function(){return e(o)})).then(c):(e(o),c())},i=function(e){URL.revokeObjectURL(u),n(e),c()},c=function(){o.removeEventListener("load",s),o.removeEventListener("error",i)};o.addEventListener("load",s),o.addEventListener("error",i),o.src=u})));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}},1167:function(e,t,r){"use strict";function n(e){switch(e){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}r.d(t,"a",(function(){return n}))},1226:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return u}));var n=r(312);function a(e,t){u(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,u=t.length/2,o=0,s=0;if(Object(n.c)(t)||Object(n.e)(t))for(var i=0;i<u;++i)e[o]=t[s],e[o+1]=t[s+1],o+=r,s+=a;else{var c=Object(n.p)(t);if(Object(n.k)(t))for(var f=0;f<u;++f)e[o]=Math.max(t[s]/c,-1),e[o+1]=Math.max(t[s+1]/c,-1),o+=r,s+=a;else for(var l=0;l<u;++l)e[o]=t[s]/c,e[o+1]=t[s+1]/c,o+=r,s+=a}}function o(e,t,r,n){for(var a,u,o=e.typedBuffer,s=e.typedBufferStride,i=null!==(a=null===n||void 0===n?void 0:n.count)&&void 0!==a?a:e.count,c=(null!==(u=null===n||void 0===n?void 0:n.dstIndex)&&void 0!==u?u:0)*s,f=0;f<i;++f)o[c]=t,o[c+1]=r,c+=s}Object.freeze(Object.defineProperty({__proto__:null,fill:o,normalizeIntegerBuffer:u,normalizeIntegerBufferView:a},Symbol.toStringTag,{value:"Module"}))},1227:function(e,t,r){"use strict";function n(e,t){a(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function a(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,a=t.length/n,u=0,o=0,s=0;s<a;++s)e[u]=t[o],e[u+1]=t[o+1],e[u+2]=t[o+2],u+=r,o+=n}function u(e,t,r,n,a){for(var u,o,s=e.typedBuffer,i=e.typedBufferStride,c=null!==(u=null===a||void 0===a?void 0:a.count)&&void 0!==u?u:e.count,f=(null!==(o=null===a||void 0===a?void 0:a.dstIndex)&&void 0!==o?o:0)*i,l=0;l<c;++l)s[f]=t,s[f+1]=r,s[f+2]=n,f+=i}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return u}));Object.freeze(Object.defineProperty({__proto__:null,copy:a,copyView:n,fill:u},Symbol.toStringTag,{value:"Module"}))},1228:function(e,t,r){"use strict";function n(e,t){a(e.typedBuffer,t,e.typedBufferStride)}function a(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=t.typedBuffer,a=t.typedBufferStride,u=t.count,o=0,s=0,i=0;i<u;++i)e[o]=n[s],e[o+1]=n[s+1],e[o+2]=n[s+2],e[o+3]=n[s+3],o+=r,s+=a}function u(e,t,r,n,a,u){for(var o,s,i=e.typedBuffer,c=e.typedBufferStride,f=null!==(o=null===u||void 0===u?void 0:u.count)&&void 0!==o?o:e.count,l=(null!==(s=null===u||void 0===u?void 0:u.dstIndex)&&void 0!==s?s:0)*c,d=0;d<f;++d)i[l]=t,i[l+1]=r,i[l+2]=n,i[l+3]=a,l+=c}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return u}));Object.freeze(Object.defineProperty({__proto__:null,copy:a,copyView:n,fill:u},Symbol.toStringTag,{value:"Module"}))},1562:function(e,t,r){"use strict";function n(e,t){var r=e.count;t||(t=new e.TypedArrayConstructor(r));for(var n=0;n<r;n++)t[n]=e.get(n);return t}r.d(t,"a",(function(){return n}));Object.freeze(Object.defineProperty({__proto__:null,makeDense:n},Symbol.toStringTag,{value:"Module"}))},1748:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return u}));var n=r(636);function a(e,t,r){u(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function u(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a;if(e.length/a==t.length/u)for(var o=e.length/a,s=r[0],i=r[1],c=r[2],f=r[3],l=r[4],d=r[5],p=r[6],b=r[7],h=r[8],x=0,v=0,m=0;m<o;m++){var O=t[x],y=t[x+1],w=t[x+2],T=t[x+3];e[v]=s*O+f*y+p*w,e[v+1]=i*O+l*y+b*w,e[v+2]=c*O+d*y+h*w,e[v+3]=T,x+=u,v+=a}else n.a.error("source and destination buffers need to have the same number of elements")}function o(e,t){for(var r=Math.min(e.count,t.count),n=e.typedBuffer,a=e.typedBufferStride,u=t.typedBuffer,o=t.typedBufferStride,s=0;s<r;s++){var i=s*a,c=s*o,f=u[c],l=u[c+1],d=u[c+2],p=f*f+l*l+d*d;if(p>0){var b=1/Math.sqrt(p);n[i]=b*f,n[i+1]=b*l,n[i+2]=b*d}}}function s(e,t,r){i(e.typedBuffer,t,r,e.typedBufferStride)}function i(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=Math.min(e.length/n,t.count),u=t.typedBuffer,o=t.typedBufferStride,s=0,i=0,c=0;c<a;c++)e[i]=r*u[s],e[i+1]=r*u[s+1],e[i+2]=r*u[s+2],e[i+3]=r*u[s+3],s+=o,i+=n}Object.freeze(Object.defineProperty({__proto__:null,normalize:o,scale:i,scaleView:s,transformMat3:u,transformMat3View:a,transformMat4:function(e,t,r){if(e.count===t.count)for(var a=e.count,u=r[0],o=r[1],s=r[2],i=r[3],c=r[4],f=r[5],l=r[6],d=r[7],p=r[8],b=r[9],h=r[10],x=r[11],v=r[12],m=r[13],O=r[14],y=r[15],w=e.typedBuffer,T=e.typedBufferStride,g=t.typedBuffer,k=t.typedBufferStride,_=0;_<a;_++){var j=_*T,S=_*k,N=g[S],A=g[S+1],E=g[S+2],R=g[S+3];w[j]=u*N+c*A+p*E+v*R,w[j+1]=o*N+f*A+b*E+m*R,w[j+2]=s*N+l*A+h*E+O*R,w[j+3]=i*N+d*A+x*E+y*R}else n.a.error("source and destination buffers need to have the same number of elements")}},Symbol.toStringTag,{value:"Module"}))},1749:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(4),a=r(12),u=r(89),o=r(88),s=r(129),i=r(339),c=r(101),f=r(110),l=r(128),d=function(){function e(t){Object(u.a)(this,e),this._streamDataRequester=t}return Object(o.a)(e,[{key:"loadJSON",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._load("json",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadBinary",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l.y)(t)?(Object(f.n)(r),Object(l.i)(t)):this._load("binary",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadImage",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._load("image",t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_load",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,r,a){var u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this._streamDataRequester){e.next=4;break}return e.next=3,Object(s.default)(r,{responseType:p[t]});case 3:return e.abrupt("return",e.sent.data);case 4:return e.next=6,Object(i.d)(this._streamDataRequester.request(r,t,a));case 6:if(!0!==(u=e.sent).ok){e.next=9;break}return e.abrupt("return",u.value);case 9:throw Object(f.m)(u.error),new c.a("","Request for resource failed: ".concat(u.error));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}(),p={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},1750:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(312),a=r(811),u=r(100);function o(e,t){switch(t){case u.q.TRIANGLES:return"number"==typeof(r=e)?Object(a.b)(r):Object(n.n)(r)?new Uint16Array(r):r;case u.q.TRIANGLE_STRIP:return function(e){var t="number"==typeof e?e:e.length;if(t<3)return[];var r=t-2,n=Object(a.c)(3*r);if("number"==typeof e)for(var u=0,o=0;o<r;o+=1)o%2==0?(n[u++]=o,n[u++]=o+1,n[u++]=o+2):(n[u++]=o+1,n[u++]=o,n[u++]=o+2);else for(var s=0,i=0;i<r;i+=1)i%2==0?(n[s++]=e[i],n[s++]=e[i+1],n[s++]=e[i+2]):(n[s++]=e[i+1],n[s++]=e[i],n[s++]=e[i+2]);return n}(e);case u.q.TRIANGLE_FAN:return function(e){var t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);var r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){for(var a=0,u=0;u<r;++u)n[a++]=0,n[a++]=u+1,n[a++]=u+2;return n}for(var o=e[0],s=e[1],i=0,c=0;c<r;++c){var f=e[c+2];n[i++]=o,n[i++]=s,n[i++]=f,s=f}return n}(e)}var r}},1760:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=2.1},1773:function(e,t,r){"use strict";r.d(t,"a",(function(){return z}));var n=r(92),a=r(4),u=r(12),o=r(102),s=r(331),i=r(1),c=r(100);var f,l,d=r(34),p=r(89),b=r(88),h=r(101),x=r(402),v=r(110),m=r(128),O=r(886),y=r(379),w=r(468),T=r(447),g=r(705),k=r(1562),_=(r(93),function(){function e(t){Object(p.a)(this,e),this._data=t,this._offset4=0,this._dataUint32=new Uint32Array(this._data,0,Math.floor(this._data.byteLength/4))}return Object(b.a)(e,[{key:"readUint32",value:function(){var e=this._offset4;return this._offset4+=1,this._dataUint32[e]}},{key:"readUint8Array",value:function(e){var t=4*this._offset4;return this._offset4+=e/4,new Uint8Array(this._data,t,e)}},{key:"remainingBytes",value:function(){return this._data.byteLength-4*this._offset4}}]),e}());!function(e){e.SCALAR="SCALAR",e.VEC2="VEC2",e.VEC3="VEC3",e.VEC4="VEC4",e.MAT2="MAT2",e.MAT3="MAT3",e.MAT4="MAT4"}(f||(f={})),function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"}(l||(l={}));var j=r(537),S={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},N={pbrMetallicRoughness:S,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},A={ESRI_externalColorMixMode:"tint"},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(i.a)(Object(i.a)({},S),e.pbrMetallicRoughness),r=function(e){switch(e.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:Object(j.a)(e.ESRI_externalColorMixMode),e.ESRI_externalColorMixMode="tint"}return e}(Object(i.a)(Object(i.a)({},A),e.extras));return Object(i.a)(Object(i.a)(Object(i.a)({},N),e),{},{pbrMetallicRoughness:t,extras:r})};var R={magFilter:c.x.LINEAR,minFilter:c.x.LINEAR_MIPMAP_LINEAR,wrapS:c.z.REPEAT,wrapT:c.z.REPEAT};var C,M=r(1086),L=1179937895,B=1313821514,I=5130562,U=function(){function e(t,r,n,a){if(Object(p.a)(this,e),this._context=t,this.uri=r,this.json=n,this._glbBuffer=a,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._supportedExtensions=["KHR_texture_basisu"],this._baseUri=function(e){var t,r;return e.replace(/^(.*\/)?([^/]*)$/,(function(e,n,a){return t=n||"",r=a||"",""})),{dirPart:t,filePart:r}}(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),null==n.scenes)throw new h.a("gltf-loader-unsupported-feature","Scenes must be defined.");if(null==n.meshes)throw new h.a("gltf-loader-unsupported-feature","Meshes must be defined");if(null==n.nodes)throw new h.a("gltf-loader-unsupported-feature","Nodes must be defined.");this._computeNodeParents()}return Object(b.a)(e,[{key:"getBuffer",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n,u;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.json.buffers[t]).uri){e.next=5;break}if(null!=this._glbBuffer){e.next=4;break}throw new h.a("gltf-loader-error","GLB buffer not present");case 4:return e.abrupt("return",this._glbBuffer);case 5:return e.next=7,this._getBufferLoader(t,r);case 7:if((u=e.sent).byteLength===n.byteLength){e.next=10;break}throw new h.a("gltf-loader-error","Buffer byte lengths should match.");case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getBufferLoader",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n,u,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._bufferLoaders.get(t))){e.next=3;break}return e.abrupt("return",n);case 3:return u=this.json.buffers[t].uri,o=this._context.loadBinary(this._resolveUri(u),r).then((function(e){return new Uint8Array(e)})),e.abrupt("return",(this._bufferLoaders.set(t,o),o));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAccessor",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n,u,o,s,i,c,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.json.accessors){e.next=2;break}throw new h.a("gltf-loader-unsupported-feature","Accessors missing.");case 2:if(null!=(null===(n=this.json.accessors[t])||void 0===n?void 0:n.bufferView)){e.next=5;break}throw new h.a("gltf-loader-unsupported-feature","Some accessor does not specify a bufferView.");case 5:if(!(n.type in[f.MAT2,f.MAT3,f.MAT4])){e.next=7;break}throw new h.a("gltf-loader-unsupported-feature","AttributeType ".concat(n.type," is not supported"));case 7:return u=this.json.bufferViews[n.bufferView],e.next=10,this.getBuffer(u.buffer,r);case 10:return o=e.sent,s=P[n.type],i=V[n.componentType],c=s*i,l=u.byteStride||c,e.abrupt("return",{raw:o.buffer,byteStride:l,byteOffset:o.byteOffset+(u.byteOffset||0)+(n.byteOffset||0),entryCount:n.count,isDenselyPacked:l===c,componentCount:s,componentByteSize:i,componentType:n.componentType,min:n.min,max:n.max,normalized:!!n.normalized});case 16:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getIndexData",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.indices){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getAccessor(t.indices,r);case 4:if(!(n=e.sent).isDenselyPacked){e.next=14;break}e.t0=n.componentType,e.next=e.t0===c.k.UNSIGNED_BYTE?9:e.t0===c.k.UNSIGNED_SHORT?10:e.t0===c.k.UNSIGNED_INT?11:12;break;case 9:return e.abrupt("return",new Uint8Array(n.raw,n.byteOffset,n.entryCount));case 10:return e.abrupt("return",new Uint16Array(n.raw,n.byteOffset,n.entryCount));case 11:return e.abrupt("return",new Uint32Array(n.raw,n.byteOffset,n.entryCount));case 12:e.next=20;break;case 14:e.t1=n.componentType,e.next=e.t1===c.k.UNSIGNED_BYTE?17:e.t1===c.k.UNSIGNED_SHORT?18:e.t1===c.k.UNSIGNED_INT?19:20;break;case 17:return e.abrupt("return",Object(k.a)(this._wrapAccessor(g.l,n)));case 18:return e.abrupt("return",Object(k.a)(this._wrapAccessor(g.j,n)));case 19:return e.abrupt("return",Object(k.a)(this._wrapAccessor(g.k,n)));case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getPositionData",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.attributes.POSITION){e.next=2;break}throw new h.a("gltf-loader-unsupported-feature","No POSITION vertex data found.");case 2:return e.next=4,this.getAccessor(t.attributes.POSITION,r);case 4:if((n=e.sent).componentType===c.k.FLOAT){e.next=7;break}throw new h.a("gltf-loader-unsupported-feature","Expected type FLOAT for POSITION vertex attribute, but found "+c.k[n.componentType]);case 7:if(3===n.componentCount){e.next=9;break}throw new h.a("gltf-loader-unsupported-feature","POSITION vertex attribute must have 3 components, but found "+n.componentCount.toFixed());case 9:return e.abrupt("return",this._wrapAccessor(g.u,n));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNormalData",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.attributes.NORMAL){e.next=2;break}throw new h.a("gltf-loader-error","No NORMAL vertex data found.");case 2:return e.next=4,this.getAccessor(t.attributes.NORMAL,r);case 4:if((n=e.sent).componentType===c.k.FLOAT){e.next=7;break}throw new h.a("gltf-loader-unsupported-feature","Expected type FLOAT for NORMAL vertex attribute, but found "+c.k[n.componentType]);case 7:if(3===n.componentCount){e.next=9;break}throw new h.a("gltf-loader-unsupported-feature","NORMAL vertex attribute must have 3 components, but found "+n.componentCount.toFixed());case 9:return e.abrupt("return",this._wrapAccessor(g.u,n));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTangentData",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.attributes.TANGENT){e.next=2;break}throw new h.a("gltf-loader-error","No TANGENT vertex data found.");case 2:return e.next=4,this.getAccessor(t.attributes.TANGENT,r);case 4:if((n=e.sent).componentType===c.k.FLOAT){e.next=7;break}throw new h.a("gltf-loader-unsupported-feature","Expected type FLOAT for TANGENT vertex attribute, but found "+c.k[n.componentType]);case 7:if(4===n.componentCount){e.next=9;break}throw new h.a("gltf-loader-unsupported-feature","TANGENT vertex attribute must have 4 components, but found "+n.componentCount.toFixed());case 9:return e.abrupt("return",new g.C(n.raw,n.byteOffset,n.byteStride,n.byteOffset+n.byteStride*n.entryCount));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTextureCoordinates",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.attributes.TEXCOORD_0){e.next=2;break}throw new h.a("gltf-loader-error","No TEXCOORD_0 vertex data found.");case 2:return e.next=4,this.getAccessor(t.attributes.TEXCOORD_0,r);case 4:if(2===(n=e.sent).componentCount){e.next=7;break}throw new h.a("gltf-loader-unsupported-feature","TEXCOORD_0 vertex attribute must have 2 components, but found "+n.componentCount.toFixed());case 7:if(n.componentType!==c.k.FLOAT){e.next=9;break}return e.abrupt("return",this._wrapAccessor(g.m,n));case 9:if(n.normalized){e.next=11;break}throw new h.a("gltf-loader-unsupported-feature","Integer component types are only supported for a normalized accessor for TEXCOORD_0.");case 11:return e.abrupt("return",q(n));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getVertexColors",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.attributes.COLOR_0){e.next=2;break}throw new h.a("gltf-loader-error","No COLOR_0 vertex data found.");case 2:return e.next=4,this.getAccessor(t.attributes.COLOR_0,r);case 4:if(4===(n=e.sent).componentCount||3===n.componentCount){e.next=7;break}throw new h.a("gltf-loader-unsupported-feature","COLOR_0 attribute must have 3 or 4 components, but found "+n.componentCount.toFixed());case 7:if(4!==n.componentCount){e.next=16;break}if(n.componentType!==c.k.FLOAT){e.next=10;break}return e.abrupt("return",this._wrapAccessor(g.C,n));case 10:if(n.componentType!==c.k.UNSIGNED_BYTE){e.next=12;break}return e.abrupt("return",this._wrapAccessor(g.J,n));case 12:if(n.componentType!==c.k.UNSIGNED_SHORT){e.next=14;break}return e.abrupt("return",this._wrapAccessor(g.H,n));case 14:e.next=23;break;case 16:if(3!==n.componentCount){e.next=23;break}if(n.componentType!==c.k.FLOAT){e.next=19;break}return e.abrupt("return",this._wrapAccessor(g.u,n));case 19:if(n.componentType!==c.k.UNSIGNED_BYTE){e.next=21;break}return e.abrupt("return",this._wrapAccessor(g.B,n));case 21:if(n.componentType!==c.k.UNSIGNED_SHORT){e.next=23;break}return e.abrupt("return",this._wrapAccessor(g.z,n));case 23:throw new h.a("gltf-loader-unsupported-feature","Unsupported component type for COLOR_0 attribute: "+c.k[n.componentType]);case 24:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hasPositions",value:function(e){return void 0!==e.attributes.POSITION}},{key:"hasNormals",value:function(e){return void 0!==e.attributes.NORMAL}},{key:"hasVertexColors",value:function(e){return void 0!==e.attributes.COLOR_0}},{key:"hasTextureCoordinates",value:function(e){return void 0!==e.attributes.TEXCOORD_0}},{key:"hasTangents",value:function(e){return void 0!==e.attributes.TANGENT}},{key:"getMaterial",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r,n){var u,o,s,i,c,f,l,d,p,b,h,x,v,m,O;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=t.material?this._materialCache.get(t.material):void 0){e.next=35;break}return l=null!=t.material?E(this.json.materials[t.material]):E(),d=l.pbrMetallicRoughness,p=this.hasVertexColors(t),b=this.getTexture(d.baseColorTexture,r),h=this.getTexture(l.normalTexture,r),x=n?this.getTexture(l.occlusionTexture,r):void 0,v=n?this.getTexture(l.emissiveTexture,r):void 0,m=n?this.getTexture(d.metallicRoughnessTexture,r):void 0,O=null!=t.material?t.material:-1,e.t0=l.alphaMode,e.t1=l.alphaCutoff,e.t2=d.baseColorFactor,e.t3=!!l.doubleSided,e.next=9,b;case 9:return e.t4=e.sent,e.next=12,h;case 12:return e.t5=e.sent,e.t6=l.name,e.t7=O,e.next=17,x;case 17:return e.t8=e.sent,e.next=20,v;case 20:return e.t9=e.sent,e.t10=l.emissiveFactor,e.t11=d.metallicFactor,e.t12=d.roughnessFactor,e.next=26,m;case 26:e.t13=e.sent,e.t14=p,e.t15=l.extras.ESRI_externalColorMixMode,e.t16=null===d||void 0===d||null===(o=d.baseColorTexture)||void 0===o||null===(o=o.extensions)||void 0===o?void 0:o.KHR_texture_transform,e.t17=null===(s=l.normalTexture)||void 0===s||null===(s=s.extensions)||void 0===s?void 0:s.KHR_texture_transform,e.t18=null===(i=l.occlusionTexture)||void 0===i||null===(i=i.extensions)||void 0===i?void 0:i.KHR_texture_transform,e.t19=null===(c=l.emissiveTexture)||void 0===c||null===(c=c.extensions)||void 0===c?void 0:c.KHR_texture_transform,e.t20=null===d||void 0===d||null===(f=d.metallicRoughnessTexture)||void 0===f||null===(f=f.extensions)||void 0===f?void 0:f.KHR_texture_transform,u={alphaMode:e.t0,alphaCutoff:e.t1,color:e.t2,doubleSided:e.t3,colorTexture:e.t4,normalTexture:e.t5,name:e.t6,id:e.t7,occlusionTexture:e.t8,emissiveTexture:e.t9,emissiveFactor:e.t10,metallicFactor:e.t11,roughnessFactor:e.t12,metallicRoughnessTexture:e.t13,hasVertexColors:e.t14,ESRI_externalColorMixMode:e.t15,colorTextureTransform:e.t16,normalTextureTransform:e.t17,occlusionTextureTransform:e.t18,emissiveTextureTransform:e.t19,metallicRoughnessTextureTransform:e.t20};case 35:return e.abrupt("return",u);case 36:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getTexture",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n,u,o,s,c,f;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(0===(t.texCoord||0)){e.next=4;break}throw new h.a("gltf-loader-unsupported-feature","Only TEXCOORD with index 0 is supported.");case 4:return n=t.index,u=this.json.textures[n],a=null!=u.sampler?this.json.samplers[u.sampler]:{},o=Object(i.a)(Object(i.a)({},R),a),s=this._getTextureSourceId(u),c=this.json.images[s],e.next=11,this._loadTextureImageData(n,u,r);case 11:return f=e.sent,e.abrupt("return",Object(x.a)(this._textureCache,n,(function(){var e=function(e){return 33071===e||33648===e||10497===e},t=function(e){throw new h.a("gltf-loader-error","Unexpected TextureSampler WrapMode: ".concat(e))};return{data:f,wrapS:e(o.wrapS)?o.wrapS:t(o.wrapS),wrapT:e(o.wrapT)?o.wrapT:t(o.wrapT),minFilter:o.minFilter,name:c.name,id:n}})));case 13:case"end":return e.stop()}var a}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNodeTransform",value:function(e){if(void 0===e)return F;var t=this._nodeTransformCache.get(e);if(!t){var r=this.getNodeTransform(this._getNodeParent(e)),n=this.json.nodes[e];n.matrix?t=Object(y.l)(Object(s.d)(),r,n.matrix):n.translation||n.rotation||n.scale?(t=Object(s.c)(r),n.translation&&Object(y.r)(t,t,n.translation),n.rotation&&(G[3]=Object(w.c)(G,n.rotation),Object(y.e)(t,t,G[3],G)),n.scale&&Object(y.k)(t,t,n.scale)):t=Object(s.c)(r),this._nodeTransformCache.set(e,t)}return t}},{key:"_wrapAccessor",value:function(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}},{key:"_resolveUri",value:function(e){return Object(m.E)(e,this._baseUri)}},{key:"_getNodeParent",value:function(e){return this._nodeParentMap.get(e)}},{key:"_checkVersionSupported",value:function(){var e=O.a.parse(this.json.asset.version,"glTF");D.validate(e)}},{key:"_checkRequiredExtensionsSupported",value:function(){var e=this,t=this.json;if(t.extensionsRequired&&!t.extensionsRequired.every((function(t){return e._supportedExtensions.includes(t)})))throw new h.a("gltf-loader-unsupported-feature","gltf loader was not able to load unsupported feature. Required extensions: "+t.extensionsRequired.join(", "))}},{key:"_computeNodeParents",value:function(){var e=this;this.json.nodes.forEach((function(t,r){t.children&&t.children.forEach((function(t){e._nodeParentMap.set(t,r)}))}))}},{key:"_loadTextureImageData",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r,n){var u,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u=this._textureLoaders.get(t))){e.next=3;break}return e.abrupt("return",u);case 3:return o=this._createTextureLoader(r,n),e.abrupt("return",(this._textureLoaders.set(t,o),o));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getTextureSourceId",value:function(e){if(void 0!==e.extensions&&null!==e.extensions.KHR_texture_basisu)return e.extensions.KHR_texture_basisu.source;if(null!==e.source)return e.source;throw new h.a("gltf-loader-unsupported-feature","Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.")}},{key:"_createTextureLoader",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r){var n,u,o,s,i,c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._getTextureSourceId(t),!(u=this.json.images[n]).uri){e.next=8;break}if(!u.uri.endsWith(".ktx2")){e.next=7;break}return e.next=5,this._context.loadBinary(this._resolveUri(u.uri),r);case 5:return o=e.sent,e.abrupt("return",new M.a(new Uint8Array(o)));case 7:return e.abrupt("return",this._context.loadImage(this._resolveUri(u.uri),r));case 8:if(null!=u.bufferView){e.next=10;break}throw new h.a("gltf-loader-unsupported-feature","Image bufferView must be defined.");case 10:if(null!=u.mimeType){e.next=12;break}throw new h.a("gltf-loader-unsupported-feature","Image mimeType must be defined.");case 12:return s=this.json.bufferViews[u.bufferView],e.next=15,this.getBuffer(s.buffer,r);case 15:if(i=e.sent,null==s.byteStride){e.next=18;break}throw new h.a("gltf-loader-unsupported-feature","byteStride not supported for image buffer");case 18:return c=i.byteOffset+(s.byteOffset||0),e.abrupt("return",Object(M.b)(new Uint8Array(i.buffer,c,s.byteLength),u.mimeType));case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getLoadedBuffersSize",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(){var t,r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._glbBuffer){e.next=2;break}return e.abrupt("return",this._glbBuffer.byteLength);case 2:return e.next=4,Object(v.f)(Array.from(this._bufferLoaders.values()));case 4:return t=e.sent,e.next=7,Object(v.f)(Array.from(this._textureLoaders.values()));case 7:return r=e.sent,e.abrupt("return",t.reduce((function(e,t){var r;return e+(null!==(r=null===t||void 0===t?void 0:t.byteLength)&&void 0!==r?r:0)}),0)+r.reduce((function(e,t){return e+(t?Object(M.c)(t)?t.data.byteLength:t.width*t.height*4:0)}),0));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"load",value:function(){var t=Object(u.a)(Object(a.a)().mark((function t(r,n,u){var o,s,i,c,f,l;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(m.y)(n)){t.next=13;break}if(!(o=Object(m.h)(n))||"model/gltf-binary"===o.mediaType){t.next=10;break}return t.prev=3,s=JSON.parse(o.isBase64?atob(o.data):o.data),t.abrupt("return",new e(r,n,s));case 8:t.prev=8,t.t0=t.catch(3);case 10:if(i=Object(m.i)(n),!e._isGLBData(i)){t.next=13;break}return t.abrupt("return",this._fromGLBData(r,n,i));case 13:if(!n.endsWith(".gltf")){t.next=18;break}return t.next=16,r.loadJSON(n,u);case 16:return c=t.sent,t.abrupt("return",new e(r,n,c));case 18:return t.next=20,r.loadBinary(n,u);case 20:if(f=t.sent,!e._isGLBData(f)){t.next=23;break}return t.abrupt("return",this._fromGLBData(r,n,f));case 23:return t.next=25,r.loadJSON(n,u);case 25:return l=t.sent,t.abrupt("return",new e(r,n,l));case 27:case"end":return t.stop()}}),t,this,[[3,8]])})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"_isGLBData",value:function(e){if(null==e)return!1;var t=new _(e);return t.remainingBytes()>=4&&t.readUint32()===L}},{key:"_fromGLBData",value:function(){var t=Object(u.a)(Object(a.a)().mark((function t(r,n,u){var o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._parseGLBData(u);case 2:return o=t.sent,t.abrupt("return",new e(r,n,o.json,o.binaryData));case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"_parseGLBData",value:function(){var e=Object(u.a)(Object(a.a)().mark((function e(t){var r,n,u,s,i,c,f,l,d;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=new _(t)).remainingBytes()<12)){e.next=3;break}throw new h.a("gltf-loader-error","GLB binary data is insufficiently large.");case 3:if(n=r.readUint32(),u=r.readUint32(),s=r.readUint32(),n===L){e.next=6;break}throw new h.a("gltf-loader-error","Magic first 4 bytes do not fit to expected GLB value.");case 6:if(!(t.byteLength<s)){e.next=8;break}throw new h.a("gltf-loader-error","GLB binary data is smaller than header specifies.");case 8:if(2===u){e.next=10;break}throw new h.a("gltf-loader-unsupported-feature","An unsupported GLB container version was detected. Only version 2 is supported.");case 10:f=0;case 11:if(!(r.remainingBytes()>=8)){e.next=33;break}if(l=r.readUint32(),d=r.readUint32(),0!==f){e.next=23;break}if(d===B){e.next=16;break}throw new h.a("gltf-loader-error","First GLB chunk must be JSON.");case 16:if(!(l<0)){e.next=18;break}throw new h.a("gltf-loader-error","No JSON data found.");case 18:return e.next=20,Object(M.d)(r.readUint8Array(l));case 20:i=e.sent,e.next=30;break;case 23:if(1!==f){e.next=29;break}if(d===I){e.next=26;break}throw new h.a("gltf-loader-unsupported-feature","Second GLB chunk expected to be BIN.");case 26:c=r.readUint8Array(l),e.next=30;break;case 29:o.a.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] More than 2 GLB chunks detected. Skipping.");case 30:f+=1;case 31:e.next=11;break;case 33:if(i){e.next=35;break}throw new h.a("gltf-loader-error","No GLB JSON chunk detected.");case 35:return e.abrupt("return",{json:i,binaryData:c});case 36:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),F=Object(y.a)(Object(s.d)(),Math.PI/2),D=new O.a(2,0,"glTF"),G=Object(T.b)(),P={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},V=(C={},Object(d.a)(C,c.k.BYTE,1),Object(d.a)(C,c.k.UNSIGNED_BYTE,1),Object(d.a)(C,c.k.SHORT,2),Object(d.a)(C,c.k.UNSIGNED_SHORT,2),Object(d.a)(C,c.k.FLOAT,4),Object(d.a)(C,c.k.INT,4),Object(d.a)(C,c.k.UNSIGNED_INT,4),C);function q(e){switch(e.componentType){case c.k.BYTE:return new g.q(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case c.k.UNSIGNED_BYTE:return new g.t(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case c.k.SHORT:return new g.o(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case c.k.UNSIGNED_SHORT:return new g.r(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case c.k.UNSIGNED_INT:return new g.s(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case c.k.FLOAT:return new g.m(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)}}var H=0;function z(e,t){return K.apply(this,arguments)}function K(){return K=Object(u.a)(Object(a.a)().mark((function e(t,r){var i,f,l,d,p,b,h,x,v,m,O,y=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=y.length>2&&void 0!==y[2]?y[2]:{},f=!(y.length>3&&void 0!==y[3])||y[3],e.next=4,U.load(t,r,i);case 4:return l=e.sent,d="gltf_"+H++,p={lods:[],materials:new Map,textures:new Map,meta:Y(l)},b=!(!l.json.asset.extras||"symbolResource"!==l.json.asset.extras.ESRI_type),h=new Map,e.next=11,J(l,function(){var e=Object(u.a)(Object(a.a)().mark((function e(t,r,n,u){var b,x,v,m,O,y,w,T,g,k,_,j,S;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x=null!==(b=h.get(n))&&void 0!==b?b:0,h.set(n,x+1),v=void 0!==t.mode?t.mode:c.q.TRIANGLES,null!=(m=v===c.q.TRIANGLES||v===c.q.TRIANGLE_STRIP||v===c.q.TRIANGLE_FAN?v:null)){e.next=5;break}return e.abrupt("return",void o.a.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Unsupported primitive mode ("+c.q[v]+"). Skipping primitive."));case 5:if(l.hasPositions(t)){e.next=7;break}return e.abrupt("return",void o.a.getLogger("esri.views.3d.glTF").warn("Skipping primitive without POSITION vertex attribute."));case 7:return O=l.getPositionData(t,i),y=l.getMaterial(t,i,f),w=l.hasNormals(t)?l.getNormalData(t,i):null,T=l.hasTangents(t)?l.getTangentData(t,i):null,g=l.hasTextureCoordinates(t)?l.getTextureCoordinates(t,i):null,k=l.hasVertexColors(t)?l.getVertexColors(t,i):null,_=l.getIndexData(t,i),e.t0=Object(s.c)(r),e.next=17,O;case 17:if(e.t1=e.sent,!w){e.next=24;break}return e.next=21,w;case 21:e.t2=e.sent,e.next=25;break;case 24:e.t2=null;case 25:if(e.t3=e.t2,!g){e.next=32;break}return e.next=29,g;case 29:e.t4=e.sent,e.next=33;break;case 32:e.t4=null;case 33:if(e.t5=e.t4,!k){e.next=40;break}return e.next=37,k;case 37:e.t6=e.sent,e.next=41;break;case 40:e.t6=null;case 41:if(e.t7=e.t6,!T){e.next=48;break}return e.next=45,T;case 45:e.t8=e.sent,e.next=49;break;case 48:e.t8=null;case 49:return e.t9=e.t8,e.t10={position:e.t1,normal:e.t3,texCoord0:e.t5,color:e.t7,tangent:e.t9},e.next=53,_;case 53:return e.t11=e.sent,e.t12=m,e.t13=W,e.t14=p,e.next=59,y;case 59:e.t15=e.sent,e.t16=d,e.t17=(0,e.t13)(e.t14,e.t15,e.t16),j={transform:e.t0,attributes:e.t10,indices:e.t11,primitiveType:e.t12,material:e.t17},S=null,null!=p.meta&&null!=p.meta.ESRI_lod&&"screenSpaceRadius"===p.meta.ESRI_lod.metric&&(S=p.meta.ESRI_lod.thresholds[n]),p.lods[n]=p.lods[n]||{parts:[],name:u,lodThreshold:S},p.lods[n].parts[x]=j;case 65:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}());case 11:x=Object(n.a)(p.lods);try{for(x.s();!(v=x.n()).done;)(m=v.value).parts=m.parts.filter((function(e){return!!e}))}catch(w){x.e(w)}finally{x.f()}return e.next=15,l.getLoadedBuffersSize();case 15:return O=e.sent,e.abrupt("return",{model:p,meta:{isEsriSymbolResource:b,uri:l.uri},customMeta:{},size:O});case 17:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}function Y(e){var t=e.json,r=null;return t.nodes.forEach((function(e){var t=e.extras;null!=t&&(t.ESRI_proxyEllipsoid||t.ESRI_lod)&&(r=t)})),r}function J(e,t){return X.apply(this,arguments)}function X(){return X=Object(u.a)(Object(a.a)().mark((function e(t,r){var s,i,c,f,l,d,p,b,h,x;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x=function(){return x=Object(u.a)(Object(a.a)().mark((function e(u,i){var c,l,d,p,b,x,v,m,O;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=s.nodes[u],l=t.getNodeTransform(u),null!=c.weights&&o.a.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Morph targets are not supported."),null!=c.mesh){d=s.meshes[c.mesh],p=Object(n.a)(d.primitives);try{for(p.s();!(b=p.n()).done;)x=b.value,f.push(r(x,l,i,d.name))}catch(a){p.e(a)}finally{p.f()}}v=Object(n.a)(c.children||[]);try{for(v.s();!(m=v.n()).done;)O=m.value,f.push(h(O,i))}catch(a){v.e(a)}finally{v.f()}case 4:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)},h=function(e,t){return x.apply(this,arguments)},s=t.json,i=s.scenes[s.scene||0].nodes,c=i.length>1,f=[],l=Object(n.a)(i);try{for(l.s();!(d=l.n()).done;)p=d.value,b=s.nodes[p],f.push(h(p,0)),(v=b).extensions&&v.extensions.MSFT_lod&&Array.isArray(v.extensions.MSFT_lod.ids)&&!c&&b.extensions.MSFT_lod.ids.forEach((function(e,t){return h(e,t+1)}))}catch(m){l.e(m)}finally{l.f()}return e.next=7,Promise.all(f);case 7:case"end":return e.stop()}var v}),e)}))),X.apply(this,arguments)}function W(e,t,r){var n=function(t){var n="".concat(r,"_tex_").concat(t&&t.id).concat(t&&t.name?"_"+t.name:"");if(t&&!e.textures.has(n)){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{data:e,parameters:Object(i.a)({wrap:Object(i.a)({s:c.z.REPEAT,t:c.z.REPEAT},t.wrap),noUnpackFlip:!0,mipmap:!1},t)}}(t.data,{wrap:{s:t.wrapS,t:t.wrapT},mipmap:Q.includes(t.minFilter),noUnpackFlip:!0});e.textures.set(n,a)}return n},a="".concat(r,"_mat_").concat(t.id,"_").concat(t.name);if(!e.materials.has(a)){var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)({color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,colorTextureTransform:null,normalTextureTransform:null,occlusionTextureTransform:null,emissiveTextureTransform:null,metallicRoughnessTextureTransform:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply"},e)}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?n(t.colorTexture):void 0,textureNormal:t.normalTexture?n(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?n(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?n(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?n(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],colorTextureTransform:t.colorTextureTransform,normalTextureTransform:t.normalTextureTransform,occlusionTextureTransform:t.occlusionTextureTransform,emissiveTextureTransform:t.emissiveTextureTransform,metallicRoughnessTextureTransform:t.metallicRoughnessTextureTransform,metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});e.materials.set(a,u)}return a}var Q=[c.x.LINEAR_MIPMAP_LINEAR,c.x.LINEAR_MIPMAP_NEAREST]},373:function(e,t,r){"use strict";var n,a,u,o,s,i,c,f,l,d;r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return c})),function(e){e[e.None=0]="None",e[e.Front=1]="Front",e[e.Back=2]="Back",e[e.COUNT=3]="COUNT"}(n||(n={})),function(e){e[e.Less=0]="Less",e[e.Lequal=1]="Lequal",e[e.COUNT=2]="COUNT"}(a||(a={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.UPDATE=1]="UPDATE"}(u||(u={})),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(o||(o={})),function(e){e[e.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",e[e.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(s||(s={})),function(e){e[e.Highlight=0]="Highlight",e[e.MaskOccludee=1]="MaskOccludee",e[e.COUNT=2]="COUNT"}(i||(i={})),function(e){e[e.CHANGED=0]="CHANGED",e[e.UNCHANGED=1]="UNCHANGED"}(c||(c={})),function(e){e[e.Blend=0]="Blend",e[e.Opaque=1]="Opaque",e[e.Mask=2]="Mask",e[e.MaskBlend=3]="MaskBlend",e[e.COUNT=4]="COUNT"}(f||(f={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(l||(l={})),function(e){e.DDS_ENCODING="image/vnd-ms.dds",e.KTX2_ENCODING="image/ktx2",e.BASIS_ENCODING="image/x.basis"}(d||(d={}))}}]);
//# sourceMappingURL=32.77295c46.chunk.js.map
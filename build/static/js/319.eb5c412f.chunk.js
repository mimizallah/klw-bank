(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[319],{1795:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return ae}));var n,i=r(4),a=r(99),o=r(12),s=r(1),c=r(89),l=r(88),d=r(107),p=r(106),b=r(90),u=r(91),y=r(94),j=(r(119),r(258)),f=(r(347),r(432),r(438),r(439),r(437),r(301),r(397),r(350),r(416)),m=r(467),O=r(129),v=r(101),h=r(287),g=r(102),w=r(281),I=r(110),k=r(97),S=r(96),x=(r(98),r(93),r(136)),R=r(95),T=r(364),F=r(259),P=r(485),D=r(330),E=r(542),N=r(784),U=r(751),C=r(311),_=r(326),A=r(425),L=r(302),J=r(566),G=r(244),M=r(565),V=r(325),z=r(544),W=r(195),q=r(497),Q=r(383),B=r(105),H=n=function(e){Object(b.a)(r,e);var t=Object(u.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).age=null,e.ageReceived=null,e.displayCount=null,e.maxObservations=1,e}return Object(l.a)(r,[{key:"clone",value:function(){return new n({age:this.age,ageReceived:this.ageReceived,displayCount:this.displayCount,maxObservations:this.maxObservations})}}]),r}(B.a);Object(y.a)([Object(k.b)({type:Number,json:{write:!0}})],H.prototype,"age",void 0),Object(y.a)([Object(k.b)({type:Number,json:{write:!0}})],H.prototype,"ageReceived",void 0),Object(y.a)([Object(k.b)({type:Number,json:{write:!0}})],H.prototype,"displayCount",void 0),Object(y.a)([Object(k.b)({type:Number,json:{write:!0}})],H.prototype,"maxObservations",void 0);var K=H=n=Object(y.a)([Object(R.a)("esri.layers.support.PurgeOptions")],H),X=r(724),Y=r(210),Z=r(486),$=r(647),ee=r(125),te=r(130),re=Object(z.a)();function ne(e,t){return new v.a("layer:unsupported","Layer (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' ").concat(t),{layer:e})}var ie=function(e){Object(b.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).copyright=null,e.definitionExpression=null,e.displayField=null,e.elevationInfo=null,e.fields=null,e.fieldsIndex=null,e.geometryDefinition=null,e.geometryType=null,e.labelsVisible=!0,e.labelingInfo=null,e.legendEnabled=!0,e.maxReconnectionAttempts=0,e.maxReconnectionInterval=20,e.maxScale=0,e.minScale=0,e.objectIdField=null,e.operationalLayerType="ArcGISStreamLayer",e.popupEnabled=!0,e.popupTemplate=null,e.purgeOptions=new K,e.refreshInterval=0,e.screenSizePerspectiveEnabled=!0,e.sourceJSON=null,e.spatialReference=ee.a.WGS84,e.type="stream",e.url=null,e.updateInterval=300,e.useViewTime=!0,e.webSocketUrl=null,e}return Object(l.a)(n,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(s.a)({url:e},t):e}},{key:"load",value:function(e){var t=this;if(!("WebSocket"in globalThis))return this.addResolvingPromise(Promise.reject(new v.a("stream-layer:websocket-unsupported","WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))),Promise.resolve(this);var r=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Stream Service","Feed"]},e).catch(I.m).then((function(){return t._fetchService(r)}))),Promise.resolve(this)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"featureReduction",set:function(e){var t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}},{key:"renderer",set:function(e){Object(W.m)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"readRenderer",value:function(e,t,r){var n,i=null===(n=(t=t.layerDefinition||t).drawingInfo)||void 0===n?void 0:n.renderer;if(i){var a=Object(f.b)(i,t,r)||void 0;return a||g.a.getLogger(this).error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r}),a}return Object(M.d)(t,r)}},{key:"connect",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var n,o,s,c,l,d,p,b,u,y,j,f,m,O,v,g,w,I,k;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.all([r.e(6),r.e(322),r.e(239)]).then(r.bind(null,1778)),this.load()]);case 2:return n=e.sent,o=Object(a.a)(n,1),s=o[0].createConnection,c=this.geometryType?T.a.toJSON(this.geometryType):null,l=t||this.createConnectionParameters(),d=l.customParameters,p=void 0===d?null:d,b=l.definitionExpression,u=void 0===b?null:b,y=l.geometryDefinition,j=void 0===y?null:y,f=l.maxReconnectionAttempts,m=void 0===f?0:f,O=l.maxReconnectionInterval,v=void 0===O?20:O,g=l.spatialReference,w=void 0===g?this.spatialReference:g,I=s(this.parsedUrl,this.spatialReference,w,c,{geometry:j,where:u},m,v,null!==p&&void 0!==p?p:void 0),k=Object(h.a)([this.on("send-message-to-socket",(function(e){return I.sendMessageToSocket(e)})),this.on("send-message-to-client",(function(e){return I.sendMessageToClient(e)}))]),e.abrupt("return",(I.once("destroy",k.remove),I));case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createConnectionParameters",value:function(){return{spatialReference:this.spatialReference,customParameters:this.customParameters,definitionExpression:this.definitionExpression,geometryDefinition:this.geometryDefinition,maxReconnectionAttempts:this.maxReconnectionAttempts,maxReconnectionInterval:this.maxReconnectionInterval}}},{key:"createPopupTemplate",value:function(e){return Object(Z.a)(this,e)}},{key:"createQuery",value:function(){var e=new Y.a;return e.returnGeometry=!0,e.outFields=["*"],e.where=this.definitionExpression||"1=1",e}},{key:"getFieldDomain",value:function(e,t){if(!this.fields)return null;var r=null;return this.fields.some((function(t){return t.name===e&&(r=t.domain),!!r})),r}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"serviceSupportsSpatialReference",value:function(e){return!0}},{key:"sendMessageToSocket",value:function(e){this.emit("send-message-to-socket",e)}},{key:"sendMessageToClient",value:function(e){this.emit("send-message-to-client",e)}},{key:"write",value:function(e,t){var r=null===t||void 0===t?void 0:t.messages;return this.webSocketUrl?(null!==r&&void 0!==r&&r.push(ne(this,"using a custom websocket connection cannot be written to web scenes and web maps")),null):this.parsedUrl?Object(d.a)(Object(p.a)(n.prototype),"write",this).call(this,e,t):(null!==r&&void 0!==r&&r.push(ne(this,"using a client-side only connection without a url cannot be written to web scenes and web maps")),null)}},{key:"_fetchService",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var r,n,a,o,c,l,d=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.webSocketUrl||!this.parsedUrl){e.next=9;break}if(this.sourceJSON){e.next=7;break}return e.next=4,Object(O.default)(this.parsedUrl.path,{query:Object(s.a)(Object(s.a)({f:"json"},this.customParameters),this.parsedUrl.query),responseType:"json",signal:t});case 4:n=e.sent,a=n.data,this.sourceJSON=a;case 7:e.next=21;break;case 9:if(null!==(o=this.timeInfo)&&void 0!==o&&o.trackIdField){e.next=11;break}throw new v.a("stream-layer:missing-metadata","The stream layer trackIdField must be specified.");case 11:if(this.objectIdField){e.next=16;break}if(l=null===(c=this.fields.find((function(e){return"oid"===e.type})))||void 0===c?void 0:c.name,l){e.next=15;break}throw new v.a("stream-layer:missing-metadata","The stream layer objectIdField must be specified.");case 15:this.objectIdField=l;case 16:if(this.fields){e.next=18;break}throw new v.a("stream-layer:missing-metadata","The stream layer fields must be specified.");case 18:if(this.fields.some((function(e){return e.name===d.objectIdField}))||this.fields.push(new V.a({name:this.objectIdField,alias:this.objectIdField,type:"oid"})),this.geometryType){e.next=20;break}throw new v.a("stream-layer:missing-metadata","The stream layer geometryType must be specified.");case 20:this.webSocketUrl&&(this.url=this.webSocketUrl);case 21:return e.abrupt("return",(this.read(this.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:null===(r=this.portalItem)||void 0===r?void 0:r.portal,url:this.parsedUrl}),Object(W.m)(this.renderer,this.fieldsIndex),Object(W.n)(this.timeInfo,this.fieldsIndex),this.objectIdField||(this.objectIdField="__esri_stream_id__"),Object(X.a)(this,{origin:"service"})));case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Object(U.a)(Object(N.a)(Object(D.a)(Object(J.a)(Object(L.a)(Object(A.a)(Object(P.a)(Object(C.a)(Object(_.a)(Object(w.a)(Object(E.a)(F.a))))))))))));Object(y.a)([Object(k.b)({type:String})],ie.prototype,"copyright",void 0),Object(y.a)([Object(k.b)({readOnly:!0})],ie.prototype,"defaultPopupTemplate",null),Object(y.a)([Object(k.b)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],ie.prototype,"definitionExpression",void 0),Object(y.a)([Object(k.b)({type:String})],ie.prototype,"displayField",void 0),Object(y.a)([Object(k.b)({type:$.a})],ie.prototype,"elevationInfo",void 0),Object(y.a)([Object(k.b)({json:{origins:{"web-map":{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],ie.prototype,"featureReduction",null),Object(y.a)([Object(k.b)(re.fields)],ie.prototype,"fields",void 0),Object(y.a)([Object(k.b)(re.fieldsIndex)],ie.prototype,"fieldsIndex",void 0),Object(y.a)([Object(k.b)({type:te.a,json:{name:"layerDefinition.definitionGeometry",write:!0}})],ie.prototype,"geometryDefinition",void 0),Object(y.a)([Object(k.b)({type:T.a.apiValues,json:{read:{reader:T.a.read}}})],ie.prototype,"geometryType",void 0),Object(y.a)([Object(k.b)(G.d)],ie.prototype,"labelsVisible",void 0),Object(y.a)([Object(k.b)({type:[q.a],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:Q.a},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],ie.prototype,"labelingInfo",void 0),Object(y.a)([Object(k.b)(G.e)],ie.prototype,"legendEnabled",void 0),Object(y.a)([Object(k.b)({type:["show","hide"]})],ie.prototype,"listMode",void 0),Object(y.a)([Object(k.b)({type:S.a})],ie.prototype,"maxReconnectionAttempts",void 0),Object(y.a)([Object(k.b)({type:S.a})],ie.prototype,"maxReconnectionInterval",void 0),Object(y.a)([Object(k.b)(G.g)],ie.prototype,"maxScale",void 0),Object(y.a)([Object(k.b)(G.h)],ie.prototype,"minScale",void 0),Object(y.a)([Object(k.b)({type:String})],ie.prototype,"objectIdField",void 0),Object(y.a)([Object(k.b)({value:"ArcGISStreamLayer",type:["ArcGISStreamLayer"]})],ie.prototype,"operationalLayerType",void 0),Object(y.a)([Object(k.b)(G.k)],ie.prototype,"popupEnabled",void 0),Object(y.a)([Object(k.b)({type:j.a,json:{name:"popupInfo",write:!0}})],ie.prototype,"popupTemplate",void 0),Object(y.a)([Object(k.b)({type:K})],ie.prototype,"purgeOptions",void 0),Object(y.a)([Object(k.b)({json:{read:!1,write:!1}})],ie.prototype,"refreshInterval",void 0),Object(y.a)([Object(k.b)({types:m.a,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{name:"layerDefinition.drawingInfo.renderer",types:m.b,write:!0}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],ie.prototype,"renderer",null),Object(y.a)([Object(x.a)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Object(x.a)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],ie.prototype,"readRenderer",null),Object(y.a)([Object(k.b)(G.n)],ie.prototype,"screenSizePerspectiveEnabled",void 0),Object(y.a)([Object(k.b)()],ie.prototype,"sourceJSON",void 0),Object(y.a)([Object(k.b)({type:ee.a,json:{origins:{service:{read:{source:"spatialReference"}}}}})],ie.prototype,"spatialReference",void 0),Object(y.a)([Object(k.b)({json:{read:!1}})],ie.prototype,"type",void 0),Object(y.a)([Object(k.b)(G.o)],ie.prototype,"url",void 0),Object(y.a)([Object(k.b)({type:Number})],ie.prototype,"updateInterval",void 0),Object(y.a)([Object(k.b)({json:{read:!1,write:!1}})],ie.prototype,"useViewTime",void 0),Object(y.a)([Object(k.b)({type:String})],ie.prototype,"webSocketUrl",void 0);var ae=ie=Object(y.a)([Object(R.a)("esri.layers.StreamLayer")],ie)}}]);
//# sourceMappingURL=319.eb5c412f.chunk.js.map
(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[49,246],{1026:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return y})),i.d(t,"c",(function(){return v})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return c})),i.d(t,"f",(function(){return d})),i.d(t,"g",(function(){return b})),i.d(t,"h",(function(){return l})),i.d(t,"i",(function(){return f})),i.d(t,"j",(function(){return s})),i.d(t,"k",(function(){return p})),i.d(t,"l",(function(){return u})),i.d(t,"m",(function(){return o}));var n,a,r=i(143);(a=n||(n={}))[a.size=22]="size",a[a.lineWidth=50]="lineWidth",a[a.maxSize=120]="maxSize",a[a.maxOutlineSize=80]="maxOutlineSize",a[a.tallSymbolWidth=20]="tallSymbolWidth";var o={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function s(e,t,i){var a=n.size,r=a,o=a;e<1?r*=.75:e>1&&(o*=1.25);var s=a,l=a;return t&&i&&(r=o=s=l=0),[{type:"path",path:[{command:"M",values:[s,0]},{command:"L",values:[i?s:.875*s,0]},{command:"L",values:[i?r-.5*s:0,o-.5*l]},{command:"L",values:[r-.5*s,o-.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,0]},{command:"L",values:[s,t?0:.125*l]},{command:"L",values:[r-.5*s,t?o-.5*l:l]},{command:"L",values:[r-.5*s,o-.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r-.5*s,o-.5*l]},{command:"L",values:[i?r-.5*s:0,o-.5*l]},{command:"L",values:[i?r-.5*s:0,t?o-.5*l:l]},{command:"L",values:[r-.5*s,t?o-.5*l:l]},{command:"Z",values:[]}]}]}function l(e){var t=n.size,i=.5*e;return[{type:"path",path:[{command:"M",values:[0,.7*t*.5]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+i]},{command:"L",values:[0,.7*t+i-.7*t*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+i]},{command:"L",values:[t,i]},{command:"L",values:[t,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,0]},{command:"L",values:[t,0]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[0,.7*t*.5]},{command:"Z",values:[]}]}]}function u(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function c(e,t){var i=t?n.tallSymbolWidth:e,a=e,r=t?4:6;i<=n.size?i-=.5*r:i-=r;var o=t?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,.5*o]},{command:"L",values:[.5*i,o]},{command:"L",values:[0,.5*o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*o]},{command:"L",values:[.5*i,o]},{command:"L",values:[.5*i,a]},{command:"L",values:[0,a-.5*o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,o]},{command:"L",values:[.5*i,a]},{command:"L",values:[i,a-.5*o]},{command:"L",values:[i,.5*o]},{command:"Z",values:[]}]}]}function d(e,t){var i=t?n.tallSymbolWidth:e,a=e,r=t?4:6;i<=n.size?i-=.5*r:i-=r;var o=.5*i,s=.15*i,l=a-s;return[{type:"ellipse",cx:.5*i,cy:l,rx:o,ry:s},{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[0,l]},{command:"L",values:[i,l]},{command:"L",values:[i,s]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:s,rx:o,ry:s}]}function h(e,t){var i=t?n.tallSymbolWidth:e,a=e,r=t?4:6;i<=n.size?i-=.5*r:i-=r;var o=.15*i,s=a-o;return[{type:"ellipse",cx:.5*i,cy:s,rx:.5*i,ry:o},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,s]},{command:"L",values:[0,s]},{command:"Z",values:[]}]}]}function f(e){var t=e,i=e;t<n.size?t-=3:t-=6;var a=.15*t;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[t,0]},{command:"L",values:[.5*t,i-a]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:0,rx:.5*t,ry:a}]}function b(e){var t=e,i=e;t<n.size?t-=2:t-=4;var a=t,r=i,o=Math.floor(e/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*a,0]},{command:"L",values:[a,.5*r-o]},{command:"L",values:[.45*a-o,.5*r+o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*a,0]},{command:"L",values:[.45*a-o,.5*r+o]},{command:"L",values:[0,.5*r-o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*r-o]},{command:"L",values:[.45*a-o,.5*r+o]},{command:"L",values:[.45*a,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*a,i]},{command:"L",values:[a,.5*r-o]},{command:"L",values:[.45*a-o,.5*r+o]},{command:"Z",values:[]}]}]}function p(e){var t=e,i=e;i<n.size?i-=1:i-=2;return[{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[t,i]},{command:"L",values:[.45*t,.6*i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[.45*t,.6*i]},{command:"L",values:[0,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,i]},{command:"L",values:[.45*t,.6*i]},{command:"L",values:[t,i]},{command:"Z",values:[]}]}]}function v(e,t){return Math.round(Math.min(Math.max(e+255*t*.75,0),255))}function y(e,t){if(null==e)return new r.a;if("type"in e&&("linear"===e.type||"pattern"===e.type))return e;var i=new r.a(e);return new r.a([v(i.r,t),v(i.g,t),v(i.b,t),i.a])}},1166:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}));i(484),i(371),i(728),i(283),i(209),i(540);function n(e){return e&&"function"==typeof e.render}function a(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}},1178:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return p}));var n=i(277),a=i(129),r=i(600),o=i(101),s=i(93),l=(i(881),i(882)),u=i(1666),c=i(739),d=Object(l.a)();function h(e,t){d.append(e,t),d.detach(t)}function f(e,t,i){var n=Math.ceil(t[0]),a=Math.ceil(t[1]);if(!e.some((function(e){return!!e.length})))return null;var r=i&&i.node||document.createElement("div");return null!=i.opacity&&(r.style.opacity=i.opacity.toString()),null!=i.effectView&&(r.style.filter=Object(c.f)(i.effectView)),h(r,(function(){return Object(u.g)(e,n,a,i)})),r}function b(e,t,i,n,a){if("multiply"===a)e[t]*=i[0],e[t+1]*=i[1],e[t+2]*=i[2],e[t+3]*=i[3];else{var o=Object(r.a)({r:e[t],g:e[t+1],b:e[t+2]});o.h=n.h,o.s=n.s,o.v=o.v/100*n.v;var s=Object(r.d)(o);e[t]=s.r,e[t+1]=s.g,e[t+2]=s.b,e[t+3]*=i[3]}}function p(e,t,i,l,u){return function(e,t,i){return e?Object(a.default)(e,{responseType:"image"}).then((function(e){var n=e.data,a=n.width,r=n.height,o=a/r,s=t;if(i){var l=Math.max(a,r);s=Math.min(s,l)}return{image:n,width:o<=1?Math.ceil(s*o):s,height:o<=1?s:Math.ceil(s/o)}})):Promise.reject(new o.a("renderUtils: imageDataSize","href not provided."))}(e,t,u).then((function(a){var o,u,c=null!==(o=a.width)&&void 0!==o?o:t,d=null!==(u=a.height)&&void 0!==u?u:t;if(a.image&&function(e,t){return!(!e||"ignore"===t)&&("multiply"!==t||255!==e.r||255!==e.g||255!==e.b||1!==e.a)}(i,l)){var h=a.image.width,f=a.image.height;Object(s.a)("edge")&&/\.svg$/i.test(e)&&(h-=1,f-=1);var p=function(e,t){e=Math.ceil(e),t=Math.ceil(t);var i=document.createElement("canvas");i.width=e,i.height=t,i.style.width=e+"px",i.style.height=t+"px";var n=i.getContext("2d");return n.clearRect(0,0,e,t),n}(c,d);p.drawImage(a.image,0,0,h,f,0,0,c,d);for(var v=p.getImageData(0,0,c,d),y=[i.r/255,i.g/255,i.b/255,i.a],g=Object(r.a)(i),m=0;m<v.data.length;m+=4)b(v.data,m,y,g,l);p.putImageData(v,0,0),e=p.canvas.toDataURL("image/png")}else{var _=n.c&&n.c.findCredential(e);if(_&&_.token){var O=e.includes("?")?"&":"?";e="".concat(e).concat(O,"token=").concat(_.token)}}return{url:e,width:c,height:d}})).catch((function(){return{url:e,width:t,height:t}}))}},1333:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i(120),a=i(89),r=i(88),o=i(107),s=i(106),l=i(90),u=i(91),c=i(529),d=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(){return Object(a.a)(this,i),t.apply(this,arguments)}return Object(r.a)(i,[{key:"_beforeChanged",value:function(){Object(o.a)(Object(s.a)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("pointerBaseWidth")||this.isDirty("cornerRadius")||this.isDirty("pointerLength")||this.isDirty("pointerX")||this.isDirty("pointerY")||this.isDirty("width")||this.isDirty("height"))&&(this._clear=!0)}},{key:"_changed",value:function(){if(Object(o.a)(Object(s.a)(i.prototype),"_changed",this).call(this),this._clear){this.markDirtyBounds();var e=this.width(),t=this.height();if(e>0&&t>0){var n=this.get("cornerRadius",8);n=Object(c.ib)(n,0,Math.min(e/2,t/2));var a=this.get("pointerX",0),r=this.get("pointerY",0),l=this.get("pointerBaseWidth",15)/2,u=(a-0)*(t-0)-(r-0)*(e-0),d=(a-0)*(0-t)-(r-t)*(e-0),h=this._display;if(h.moveTo(n,0),u>0&&d>0){var f=Math.round(Object(c.ib)(a,n+l,e-l-n));r=Object(c.ib)(r,-1/0,0),h.lineTo(f-l,0),h.lineTo(a,r),h.lineTo(f+l,0)}if(h.lineTo(e-n,0),h.arcTo(e,0,e,n,n),u>0&&d<0){var b=Math.round(Object(c.ib)(r,n+l,t-l-n));a=Object(c.ib)(a,e,1/0),h.lineTo(e,n),h.lineTo(e,Math.max(b-l,n)),h.lineTo(a,r),h.lineTo(e,b+l)}if(h.lineTo(e,t-n),h.arcTo(e,t,e-n,t,n),u<0&&d<0){var p=Math.round(Object(c.ib)(a,n+l,e-l-n));r=Object(c.ib)(r,t,1/0),h.lineTo(e-n,t),h.lineTo(p+l,t),h.lineTo(a,r),h.lineTo(p-l,t)}if(h.lineTo(n,t),h.arcTo(0,t,0,t-n,n),u<0&&d>0){var v=Math.round(Object(c.ib)(r,n+l,t-n-l));a=Object(c.ib)(a,-1/0,0),h.lineTo(0,t-n),h.lineTo(0,v+l),h.lineTo(a,r),h.lineTo(0,Math.max(v-l,n))}h.lineTo(0,n),h.arcTo(0,0,n,0,n),h.closePath()}}}}]),i}(c.K);Object.defineProperty(d,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PointedRectangle"}),Object.defineProperty(d,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.K.classNames.concat([d.className])});var h=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(e,r,o){var s,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return Object(a.a)(this,i),s=t.call(this,e,r,o,l),Object.defineProperty(Object(n.a)(s),"_fx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(n.a)(s),"_fy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(n.a)(s),"_label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(s),"_fillDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(s),"_strokeDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(s),"_labelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(s),"_w",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(n.a)(s),"_h",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(n.a)(s),"_keepHoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(n.a)(s),"_htmlContentHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),s}return Object(r.a)(i,[{key:"_afterNew",value:function(){var e=this;this._settings.themeTags=Object(c.jb)(this._settings.themeTags,["tooltip"]),Object(o.a)(Object(s.a)(i.prototype),"_afterNew",this).call(this),this.set("background",d.new(this._root,{themeTags:["tooltip","background"]})),this._label=this.children.push(c.kb.new(this._root,{})),this._disposers.push(this._label.events.on("boundschanged",(function(){e._updateBackground()}))),this._disposers.push(this.on("bounds",(function(){e._updateBackground()}))),this._updateTextColor(),this._root.tooltipContainer.children.push(this),this.hide(0),this._disposers.push(this.label.onPrivate("htmlElement",(function(t){t&&(Object(c.Xb)(t,"pointerover",(function(t){e._htmlContentHovered=!0})),Object(c.Xb)(t,"pointerout",(function(t){e._htmlContentHovered=!1})))}))),this._root._tooltips.push(this)}},{key:"label",get:function(){return this._label}},{key:"dispose",value:function(){Object(o.a)(Object(s.a)(i.prototype),"dispose",this).call(this),Object(c.cb)(this._root._tooltips,this)}},{key:"_updateChildren",value:function(){Object(o.a)(Object(s.a)(i.prototype),"_updateChildren",this).call(this),(this.isDirty("pointerOrientation")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&this.get("background")._markDirtyKey("width"),null!=this.get("labelText")&&this.label.set("text",this.get("labelText")),null!=this.get("labelHTML")&&this.label.set("html",this.get("labelHTML"))}},{key:"_changed",value:function(){var e=this;if(Object(o.a)(Object(s.a)(i.prototype),"_changed",this).call(this),(this.isDirty("pointTo")||this.isDirty("pointerOrientation"))&&this._updateBackground(),this.isDirty("tooltipTarget")&&this.updateBackgroundColor(),this.isDirty("keepTargetHover"))if(this.get("keepTargetHover")){var t=this.get("background");this._keepHoverDp=new c.n([t.events.on("pointerover",(function(t){var i=e.get("tooltipTarget");i&&(i.parent&&i.parent.getPrivate("tooltipTarget")==i&&(i=i.parent),i.hover())})),t.events.on("pointerout",(function(t){var i=e.get("tooltipTarget");i&&(i.parent&&i.parent.getPrivate("tooltipTarget")==i&&(i=i.parent),e._htmlContentHovered||i.unhover())}))])}else this._keepHoverDp&&(this._keepHoverDp.dispose(),this._keepHoverDp=void 0)}},{key:"_onShow",value:function(){Object(o.a)(Object(s.a)(i.prototype),"_onShow",this).call(this),this.updateBackgroundColor()}},{key:"updateBackgroundColor",value:function(){var e,t,i=this,n=this.get("tooltipTarget"),a=this.get("background");n&&a&&(e=n.get("fill"),t=n.get("stroke"),null==e&&(e=t),this.get("getFillFromSprite")&&(this._fillDp&&this._fillDp.dispose(),null!=e&&a.set("fill",e),this._fillDp=n.on("fill",(function(e){null!=e&&(a.set("fill",e),i._updateTextColor(e))})),this._disposers.push(this._fillDp)),this.get("getStrokeFromSprite")&&(this._strokeDp&&this._strokeDp.dispose(),null!=e&&a.set("stroke",e),this._strokeDp=n.on("fill",(function(e){null!=e&&a.set("stroke",e)})),this._disposers.push(this._strokeDp)),this.get("getLabelFillFromSprite")&&(this._labelDp&&this._labelDp.dispose(),null!=e&&this.label.set("fill",e),this._labelDp=n.on("fill",(function(e){null!=e&&i.label.set("fill",e)})),this._disposers.push(this._labelDp))),this._updateTextColor(e)}},{key:"_updateTextColor",value:function(e){this.get("autoTextColor")&&(null==e&&(e=this.get("background").get("fill")),null==e&&(e=this._root.interfaceColors.get("background")),e instanceof c.d&&this.label.set("fill",c.d.alternative(e,this._root.interfaceColors.get("alternativeText"),this._root.interfaceColors.get("text"))))}},{key:"_setDataItem",value:function(e){Object(o.a)(Object(s.a)(i.prototype),"_setDataItem",this).call(this,e),this.label._setDataItem(e)}},{key:"_updateBackground",value:function(){Object(o.a)(Object(s.a)(i.prototype),"updateBackground",this).call(this);var e=this._root.container;if(e){var t=.5,n=.5,a=this.get("centerX");a instanceof c.r&&(t=a.value);var r=this.get("centerY");r instanceof c.r&&(n=r.value);var l=e.width(),u=e.height(),h=this.parent,f=0,b=0;if(h){f=h.x(),b=h.y();var p=h.get("layerMargin");p&&(f+=p.left||0,b+=p.top||0,l+=(p.left||0)+(p.right||0),u+=(p.top||0)+(p.bottom||0))}var v=this.get("bounds",{left:-f,top:-b,right:l-f,bottom:u-b});this._updateBounds();var y=this.width(),g=this.height();0===y&&(y=this._w),0===g&&(g=this._h);var m=this.get("pointTo",{x:l/2,y:u/2}),_=m.x,O=m.y,j=this.get("pointerOrientation"),w=this.get("background"),k=0,x=0,M=0;w instanceof d&&(k=w.get("pointerLength",0),M=x=w.get("strokeWidth",0)/2,w.set("width",y),w.set("height",g));var P,C,A=v.right-v.left,T=v.bottom-v.top;"horizontal"==j||"left"==j||"right"==j?(x=0,"horizontal"==j?_>v.left+A/2?(_-=y*(1-t)+k,M*=-1):_+=y*t+k:"left"==j?_+=y*(1-t)+k:(_-=y*t+k,M*=-1)):(M=0,"vertical"==j?O>v.top+g/2+k?O-=g*(1-n)+k:(O+=g*n+k,x*=-1):"down"==j?O-=g*(1-n)+k:(O+=g*n+k,x*=-1)),_=Object(c.ib)(_,v.left+y*t,v.left+A-y*(1-t))+M,O=Object(c.ib)(O,v.top+g*n,v.top+T-g*(1-n))-x,P=m.x-_+y*t+M,C=m.y-O+g*n-x,this._fx=_,this._fy=O;var I=this.get("animationDuration",0);if(I>0&&this.get("visible")&&this.get("opacity")>.1){var D=this.get("animationEasing");this.animate({key:"x",to:_,duration:I,easing:D}),this.animate({key:"y",to:O,duration:I,easing:D})}else this.set("x",_),this.set("y",O);w instanceof d&&(w.set("pointerX",P),w.set("pointerY",C)),y>0&&(this._w=y),g>0&&(this._h=g)}}}]),i}(c.G);Object.defineProperty(h,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tooltip"}),Object.defineProperty(h,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.G.classNames.concat([h.className])})},1334:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return c}));var n=i(89),a=i(88),r=i(107),o=i(106),s=i(90),l=i(91),u=i(529);function c(e,t,i,n){e.set(t,i.get(n)),i.on(n,(function(i){e.set(t,i)}))}var d=function(e){Object(s.a)(i,e);var t=Object(l.a)(i);function i(){return Object(n.a)(this,i),t.apply(this,arguments)}return Object(a.a)(i,[{key:"setupDefaultRules",value:function(){Object(r.a)(Object(o.a)(i.prototype),"setupDefaultRules",this).call(this);var e=this._root.language,t=this._root.interfaceColors,n=this._root.horizontalLayout,a=this._root.verticalLayout,s=this.rule.bind(this);s("InterfaceColors").setAll({stroke:u.d.fromHex(15066597),fill:u.d.fromHex(15987699),primaryButton:u.d.fromHex(6788316),primaryButtonHover:u.d.fromHex(6779356),primaryButtonDown:u.d.fromHex(6872182),primaryButtonActive:u.d.fromHex(6872182),primaryButtonText:u.d.fromHex(16777215),primaryButtonStroke:u.d.fromHex(16777215),secondaryButton:u.d.fromHex(14277081),secondaryButtonHover:u.d.fromHex(10724259),secondaryButtonDown:u.d.fromHex(9276813),secondaryButtonActive:u.d.fromHex(15132390),secondaryButtonText:u.d.fromHex(0),secondaryButtonStroke:u.d.fromHex(16777215),grid:u.d.fromHex(0),background:u.d.fromHex(16777215),alternativeBackground:u.d.fromHex(0),text:u.d.fromHex(0),alternativeText:u.d.fromHex(16777215),disabled:u.d.fromHex(11382189),positive:u.d.fromHex(5288704),negative:u.d.fromHex(11730944)});var l=s("ColorSet");l.setAll({passOptions:{hue:.05,saturation:0,lightness:0},colors:[u.d.fromHex(6797276)],step:1,reuse:!1,startIndex:0}),l.setPrivate("currentStep",0),l.setPrivate("currentPass",0),s("Entity").setAll({stateAnimationDuration:0,stateAnimationEasing:Object(u.mb)(u.ob)}),s("Component").setAll({interpolationDuration:0,interpolationEasing:Object(u.mb)(u.ob)}),s("Sprite").setAll({visible:!0,scale:1,opacity:1,rotation:0,position:"relative",tooltipX:u.nb,tooltipY:u.nb,tooltipPosition:"fixed",isMeasured:!0}),s("Sprite").states.create("default",{visible:!0,opacity:1}),s("Container").setAll({interactiveChildren:!0,setStateOnChildren:!1}),s("Graphics").setAll({strokeWidth:1}),s("Chart").setAll({width:u.H,height:u.H,interactiveChildren:!1}),s("Sprite",["horizontal","center"]).setAll({centerX:u.nb,x:u.nb}),s("Sprite",["vertical","center"]).setAll({centerY:u.nb,y:u.nb}),s("Container",["horizontal","layout"]).setAll({layout:n}),s("Container",["vertical","layout"]).setAll({layout:a}),s("Pattern").setAll({repetition:"repeat",width:50,height:50,rotation:0,fillOpacity:1}),s("LinePattern").setAll({gap:6,colorOpacity:1,width:49,height:49}),s("RectanglePattern").setAll({gap:6,checkered:!1,centered:!0,maxWidth:5,maxHeight:5,width:48,height:48,strokeWidth:0}),s("CirclePattern").setAll({gap:5,checkered:!1,centered:!1,radius:3,strokeWidth:0,width:45,height:45}),s("LinearGradient").setAll({rotation:90}),s("Legend").setAll({fillField:"fill",strokeField:"stroke",nameField:"name",layout:u.E.new(this._root,{}),layer:30,clickTarget:"itemContainer"}),s("Container",["legend","item","itemcontainer"]).setAll({paddingLeft:5,paddingRight:5,paddingBottom:5,paddingTop:5,layout:n,setStateOnChildren:!0,interactiveChildren:!1,ariaChecked:!0,focusable:!0,ariaLabel:e.translate("Press ENTER to toggle"),role:"checkbox"});var d=s("Rectangle",["legend","item","background"]);d.setAll({fillOpacity:0}),c(d,"fill",t,"background"),s("Container",["legend","marker"]).setAll({setStateOnChildren:!0,centerY:u.nb,paddingLeft:0,paddingRight:0,paddingBottom:0,paddingTop:0,width:18,height:18}),s("RoundedRectangle",["legend","marker","rectangle"]).setAll({width:u.H,height:u.H,cornerRadiusBL:3,cornerRadiusTL:3,cornerRadiusBR:3,cornerRadiusTR:3});var h=s("RoundedRectangle",["legend","marker","rectangle"]).states.create("disabled",{});c(h,"fill",t,"disabled"),c(h,"stroke",t,"disabled"),s("Label",["legend","label"]).setAll({centerY:u.nb,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,populateText:!0}),c(s("Label",["legend","label"]).states.create("disabled",{}),"fill",t,"disabled"),s("Label",["legend","value","label"]).setAll({centerY:u.nb,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,width:50,centerX:u.H,populateText:!0}),c(s("Label",["legend","value","label"]).states.create("disabled",{}),"fill",t,"disabled"),s("HeatLegend").setAll({stepCount:1}),s("RoundedRectangle",["heatlegend","marker"]).setAll({cornerRadiusTR:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusBL:0}),s("RoundedRectangle",["vertical","heatlegend","marker"]).setAll({height:u.H,width:15}),s("RoundedRectangle",["horizontal","heatlegend","marker"]).setAll({width:u.H,height:15}),s("HeatLegend",["vertical"]).setAll({height:u.H}),s("HeatLegend",["horizontal"]).setAll({width:u.H}),s("Label",["heatlegend","start"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5}),s("Label",["heatlegend","end"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5});var f=s("Label");f.setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"1em",populateText:!1}),c(f,"fill",t,"text"),s("RadialLabel").setAll({textType:"regular",centerY:u.nb,centerX:u.nb,inside:!1,radius:0,baseRadius:u.H,orientation:"auto",textAlign:"center"}),s("RoundedRectangle").setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8}),s("PointedRectangle").setAll({pointerBaseWidth:15,pointerLength:10,cornerRadius:8}),s("Slice").setAll({shiftRadius:0,dRadius:0,dInnerRadius:0});var b=s("Tick");b.setAll({strokeOpacity:.15,isMeasured:!1,length:4.5,position:"absolute",crisp:!0}),c(b,"stroke",t,"grid"),s("Bullet").setAll({locationX:.5,locationY:.5}),s("Tooltip").setAll({position:"absolute",getFillFromSprite:!0,getStrokeFromSprite:!1,autoTextColor:!0,paddingTop:9,paddingBottom:8,paddingLeft:10,paddingRight:10,marginBottom:5,pointerOrientation:"vertical",centerX:u.nb,centerY:u.nb,animationEasing:Object(u.mb)(u.ob),exportable:!1}),s("PointedRectangle",["tooltip","background"]).setAll({strokeOpacity:.9,cornerRadius:4,pointerLength:4,pointerBaseWidth:8,fillOpacity:.9,stroke:u.d.fromHex(16777215)});var p=s("Label",["tooltip"]);p.setAll({role:"tooltip",populateText:!0,paddingRight:0,paddingTop:0,paddingLeft:0,paddingBottom:0}),c(p,"fill",t,"alternativeText"),s("Button").setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,interactive:!0,layout:n,interactiveChildren:!1,setStateOnChildren:!0,focusable:!0}),s("Button").states.create("hover",{}),s("Button").states.create("down",{stateAnimationDuration:0}),s("Button").states.create("active",{});var v=s("RoundedRectangle",["button","background"]);c(v,"fill",t,"primaryButton"),c(v,"stroke",t,"primaryButtonStroke"),c(s("RoundedRectangle",["button","background"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),c(s("RoundedRectangle",["button","background"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown"),c(s("RoundedRectangle",["button","background"]).states.create("active",{}),"fill",t,"primaryButtonActive"),c(s("Graphics",["button","icon"]),"stroke",t,"primaryButtonText"),c(s("Label",["button"]),"fill",t,"primaryButtonText"),s("Button",["zoom"]).setAll({paddingTop:18,paddingBottom:18,paddingLeft:12,paddingRight:12,centerX:46,centerY:-10,y:0,x:u.H,role:"button",ariaLabel:e.translate("Zoom Out"),layer:30});var y=s("RoundedRectangle",["background","button","zoom"]);y.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),c(y,"fill",t,"primaryButton"),c(s("RoundedRectangle",["background","button","zoom"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),c(s("RoundedRectangle",["background","button","zoom"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown");var g=s("Graphics",["icon","button","zoom"]);g.setAll({crisp:!0,strokeOpacity:.7,draw:function(e){e.moveTo(0,0),e.lineTo(12,0)}}),c(g,"stroke",t,"primaryButtonText"),s("Button",["resize"]).setAll({paddingTop:9,paddingBottom:9,paddingLeft:13,paddingRight:13,draggable:!0,centerX:u.nb,centerY:u.nb,position:"absolute",role:"slider",ariaValueMin:"0",ariaValueMax:"100",ariaLabel:e.translate("Use up and down arrows to move selection")});var m=s("RoundedRectangle",["background","resize","button"]);m.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),c(m,"fill",t,"secondaryButton"),c(m,"stroke",t,"secondaryButtonStroke"),c(s("RoundedRectangle",["background","resize","button"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),c(s("RoundedRectangle",["background","resize","button"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown");var _=s("Graphics",["resize","button","icon"]);_.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:function(e){e.moveTo(0,.5),e.lineTo(0,12.5),e.moveTo(4,.5),e.lineTo(4,12.5)}}),c(_,"stroke",t,"secondaryButtonText"),s("Button",["resize","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize"}),s("Button",["resize","horizontal"]).setAll({cursorOverStyle:"ew-resize"}),s("Button",["play"]).setAll({paddingTop:13,paddingBottom:13,paddingLeft:14,paddingRight:14,ariaLabel:e.translate("Play"),toggleKey:"active"});var O=s("RoundedRectangle",["play","background"]);O.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),c(O,"fill",t,"primaryButton");var j=s("Graphics",["play","icon"]);j.setAll({stateAnimationDuration:0,dx:1,draw:function(e){e.moveTo(0,-5),e.lineTo(8,0),e.lineTo(0,5),e.lineTo(0,-5)}}),c(j,"fill",t,"primaryButtonText"),s("Graphics",["play","icon"]).states.create("default",{stateAnimationDuration:0}),s("Graphics",["play","icon"]).states.create("active",{stateAnimationDuration:0,draw:function(e){e.moveTo(-4,-5),e.lineTo(-1,-5),e.lineTo(-1,5),e.lineTo(-4,5),e.lineTo(-4,-5),e.moveTo(4,-5),e.lineTo(1,-5),e.lineTo(1,5),e.lineTo(4,5),e.lineTo(4,-5)}}),s("Button",["switch"]).setAll({paddingTop:4,paddingBottom:4,paddingLeft:4,paddingRight:4,ariaLabel:e.translate("Press ENTER to toggle"),toggleKey:"active",width:40,height:24,layout:null});var w=s("RoundedRectangle",["switch","background"]);w.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),c(w,"fill",t,"primaryButton");var k=s("Circle",["switch","icon"]);k.setAll({radius:8,centerY:0,centerX:0,dx:0}),c(k,"fill",t,"primaryButtonText"),s("Graphics",["switch","icon"]).states.create("active",{dx:16}),s("Scrollbar").setAll({start:0,end:1,layer:30,animationEasing:Object(u.mb)(u.ob)}),s("Scrollbar",["vertical"]).setAll({marginRight:13,marginLeft:13,minWidth:12,height:u.H}),s("Scrollbar",["horizontal"]).setAll({marginTop:13,marginBottom:13,minHeight:12,width:u.H}),this.rule("Button",["scrollbar"]).setAll({exportable:!1});var x=s("RoundedRectangle",["scrollbar","main","background"]);x.setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8,fillOpacity:.8}),c(x,"fill",t,"fill");var M=s("RoundedRectangle",["scrollbar","thumb"]);M.setAll({role:"slider",ariaLive:"polite",position:"absolute",draggable:!0}),c(M,"fill",t,"secondaryButton"),c(s("RoundedRectangle",["scrollbar","thumb"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),c(s("RoundedRectangle",["scrollbar","thumb"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown"),s("RoundedRectangle",["scrollbar","thumb","vertical"]).setAll({x:u.nb,width:u.H,centerX:u.nb,ariaLabel:e.translate("Use up and down arrows to move selection")}),s("RoundedRectangle",["scrollbar","thumb","horizontal"]).setAll({y:u.nb,centerY:u.nb,height:u.H,ariaLabel:e.translate("Use left and right arrows to move selection")});var P=s("PointedRectangle",["axis","tooltip","background"]);P.setAll({cornerRadius:0}),c(P,"fill",t,"alternativeBackground"),s("Label",["axis","tooltip"]).setAll({role:void 0}),s("Label",["axis","tooltip","y"]).setAll({textAlign:"right"}),s("Label",["axis","tooltip","y","opposite"]).setAll({textAlign:"left"}),s("Label",["axis","tooltip","x"]).setAll({textAlign:"center"}),s("Tooltip",["categoryaxis"]).setAll({labelText:"{category}"}),s("Star").setAll({spikes:5,innerRadius:5,radius:10}),s("Tooltip",["stock"]).setAll({paddingTop:6,paddingBottom:5,paddingLeft:7,paddingRight:7}),s("PointedRectangle",["tooltip","stock","axis"]).setAll({pointerLength:0,pointerBaseWidth:0,cornerRadius:3}),s("Label",["tooltip","stock"]).setAll({fontSize:"0.8em"}),s("SpriteResizer").setAll({rotationStep:10}),s("Container",["resizer","grip"]).states.create("hover",{});var C=s("RoundedRectangle",["resizer","grip"]);C.setAll({strokeOpacity:.7,strokeWidth:1,fillOpacity:1,width:12,height:12}),c(C,"fill",t,"background"),c(C,"stroke",t,"alternativeBackground");var A=s("RoundedRectangle",["resizer","grip","outline"]);A.setAll({strokeOpacity:0,fillOpacity:0,width:20,height:20}),A.states.create("hover",{fillOpacity:.3}),c(A,"fill",t,"alternativeBackground"),s("RoundedRectangle",["resizer","grip","left"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0}),s("RoundedRectangle",["resizer","grip","right"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0});var T=s("Rectangle",["resizer","rectangle"]);T.setAll({strokeDasharray:[2,2],strokeOpacity:.5,strokeWidth:1}),c(T,"stroke",t,"alternativeBackground")}}]),i}(u.lb)},1666:function(e,t,i){"use strict";i.d(t,"a",(function(){return L})),i.d(t,"b",(function(){return x})),i.d(t,"c",(function(){return M})),i.d(t,"d",(function(){return S})),i.d(t,"e",(function(){return B})),i.d(t,"f",(function(){return C})),i.d(t,"g",(function(){return R})),i.d(t,"h",(function(){return k}));var n=i(92),a=i(143),r=i(93),o=i(111),s=i(182),l=i(219),u=(i(209),i(283)),c="http://www.w3.org/2000/svg",d=0,h=0,f=Object(r.a)("android"),b=Object(r.a)("chrome")||f&&f>=4?"auto":"optimizeLegibility",p={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},v=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,y={},g={},m={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},_=Math.PI,O=1;function j(e,t){var i=e*(_/180);return Math.abs(t*Math.sin(i))+Math.abs(t*Math.cos(i))}function w(e){return e.map((function(e){return"".concat(e.command," ").concat(e.values.join(" "))})).join(" ").trim()}function k(e,t,i,n){if(e){if("circle"===e.type)return Object(u.a)("circle",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if("ellipse"===e.type)return Object(u.a)("ellipse",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if("rect"===e.type)return Object(u.a)("rect",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if("image"===e.type)return Object(u.a)("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if("path"===e.type){var a="string"!=typeof e.path?w(e.path):e.path;return Object(u.a)("path",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",d:a})}if("text"===e.type)return Object(o.c)(n),Object(u.a)("text",{"dominant-baseline":n.dominantBaseline,fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4","text-anchor":n.align,"text-decoration":n.decoration,kerning:n.kerning,rotate:n.rotate,"text-rendering":b,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,"font-size":n.font.size,"font-family":n.font.family,x:e.x,y:e.y},e.text)}return null}function x(e){var t={fill:"none",pattern:null,linearGradient:null};if(e)if("type"in e&&"pattern"===e.type){var i="patternId-"+ ++d;t.fill="url(#".concat(i,")"),t.pattern={id:i,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else if("type"in e&&"linear"===e.type){var n="linearGradientId-"+ ++h;t.fill="url(#".concat(n,")"),t.linearGradient={id:n,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map((function(e){return{offset:e.offset,color:e.color&&new a.a(e.color).toString()}}))}}else if(e){var r=new a.a(e);t.fill=r.toString()}return t}function M(e){var t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(e&&(null!=e.width&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=new a.a(e.color).toString()),e.dashArray&&(t.dashArray=e.dashArray),e.dashArray&&(t.dashOffset=e.dashoffset),e.style)){var i=null;if(e.style in m&&(i=m[e.style]),Array.isArray(i)){var n;i=i.slice(0);for(var r=null!==(n=e.width)&&void 0!==n?n:0,o=0;o<i.length;++o)i[o]*=r;if("butt"!==e.cap){for(var s=0;s<i.length;s+=2)i[s]-=r,i[s]<1&&(i[s]=1);for(var l=1;l<i.length;l+=2)i[l]+=r}i=i.join(",")}t.dashArray=i}return t}function P(e,t){var i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(e){var n=e.alignBaseline,a="baseline"===n?"auto":"top"===n?"text-top":"bottom"===n?"hanging":n;i.align=e.align,i.dominantBaseline=a,i.decoration=e.decoration,i.kerning=e.kerning?"auto":"0",i.rotate=e.rotated?"90":"0",Object(o.c)(t),i.font.style=t.style||"normal",i.font.variant=t.variant||"normal",i.font.weight=t.weight||"normal",i.font.size=t.size&&t.size.toString()||"10pt",i.font.family=t.family||"serif"}return i}function C(e){var t=e.pattern,i=e.linearGradient;if(t)return Object(u.a)("pattern",{id:t.id,patternUnits:"userSpaceOnUse",x:t.x,y:t.y,width:t.width,height:t.height},Object(u.a)("image",{x:t.image.x,y:t.image.y,width:t.image.width,height:t.image.height,href:t.image.href}));if(i){var n=i.stops.map((function(e,t){return Object(u.a)("stop",{key:"".concat(t,"-stop"),offset:e.offset,"stop-color":e.color})}));return Object(u.a)("linearGradient",{id:i.id,gradientUnits:"userSpaceOnUse",x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n)}return null}function A(e,t){if(!e||0===e.length)return null;var i,a=[],r=Object(n.a)(e);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=o.shape,l=o.fill,c=o.stroke,d=o.font,h=x(l),f=M(c),b="text"===s.type?P(s,d):null,p=k(s,h.fill,f,b);p&&a.push(p)}}catch(v){r.e(v)}finally{r.f()}return Object(u.a)("mask",{id:t,maskUnits:"userSpaceOnUse"},Object(u.a)("g",null,a))}function T(e,t,i){return Object(l.j)(e,Object(l.c)(e),[t,i])}function I(e,t,i,n,a){return Object(l.i)(e,Object(l.c)(e),[t,i]),e[4]=e[4]*t-n*t+n,e[5]=e[5]*i-a*i+a,e}function D(e,t){y&&"left"in y?(null!=y.left&&y.left>e&&(y.left=e),(null==y.right||y.right<e)&&(y.right=e),(null==y.top||y.top>t)&&(y.top=t),(null==y.bottom||y.bottom<t)&&(y.bottom=t)):y={left:e,bottom:t,right:e,top:t}}function F(e){var t,i=e.args,n=i.length;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(t=0;t<n;t+=2)D(i[t],i[t+1]);g.x=i[n-2],g.y=i[n-1];break;case"H":for(t=0;t<n;++t)D(i[t],g.y);g.x=i[n-1];break;case"V":for(t=0;t<n;++t)D(g.x,i[t]);g.y=i[n-1];break;case"m":var a=0;"x"in g||(D(g.x=i[0],g.y=i[1]),a=2);for(t=a;t<n;t+=2)D(g.x+=i[t],g.y+=i[t+1]);break;case"l":case"t":for(t=0;t<n;t+=2)D(g.x+=i[t],g.y+=i[t+1]);break;case"h":for(t=0;t<n;++t)D(g.x+=i[t],g.y);break;case"v":for(t=0;t<n;++t)D(g.x,g.y+=i[t]);break;case"c":for(t=0;t<n;t+=6)D(g.x+i[t],g.y+i[t+1]),D(g.x+i[t+2],g.y+i[t+3]),D(g.x+=i[t+4],g.y+=i[t+5]);break;case"s":case"q":for(t=0;t<n;t+=4)D(g.x+i[t],g.y+i[t+1]),D(g.x+=i[t+2],g.y+=i[t+3]);break;case"A":for(t=0;t<n;t+=7)D(i[t+5],i[t+6]);g.x=i[n-2],g.y=i[n-1];break;case"a":for(t=0;t<n;t+=7)D(g.x+=i[t+5],g.y+=i[t+6])}}function E(e,t,i){var n,a=p[e.toLowerCase()];"number"==typeof a&&(a?t.length>=a&&(n={action:e,args:t.slice(0,t.length-t.length%a)},i.push(n),F(n)):(n={action:e,args:[]},i.push(n),F(n)))}function S(e){var t={x:0,y:0,width:0,height:0};if("circle"===e.type)t.x=e.cx-e.r,t.y=e.cy-e.r,t.width=2*e.r,t.height=2*e.r;else if("ellipse"===e.type)t.x=e.cx-e.rx,t.y=e.cy-e.ry,t.width=2*e.rx,t.height=2*e.ry;else if("image"===e.type||"rect"===e.type)t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height;else if("path"===e.type){var i=Object(o.m)(function(e){var t=("string"!=typeof e.path?w(e.path):e.path).match(v),i=[];if(y={},g={},!t)return null;for(var n="",a=[],r=t.length,o=0;o<r;++o){var s=t[o],l=parseFloat(s);isNaN(l)?(n&&E(n,a,i),a=[],n=s):a.push(l)}E(n,a,i);var u={x:0,y:0,width:0,height:0};return y&&"left"in y&&(u.x=y.left,u.y=y.top,u.width=y.right-y.left,u.height=y.bottom-y.top),u}(e));t.x=i.x,t.y=i.y,t.width=i.width,t.height=i.height}return t}function L(e){var t,i={x:0,y:0,width:0,height:0},a=null,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=Object(n.a)(e);try{for(s.s();!(t=s.n()).done;){var l=t.value;a?(a.x=Math.min(a.x,l.x),a.y=Math.min(a.y,l.y),r=Math.max(r,l.x+l.width),o=Math.max(o,l.y+l.height)):((a=i).x=l.x,a.y=l.y,r=l.x+l.width,o=l.y+l.height)}}catch(u){s.e(u)}finally{s.f()}return a&&(a.width=r-a.x,a.height=o-a.y),a}function B(e,t,i,n,a,r,o,u,c){var d=(o&&r?j(r,t):t)/2,h=(o&&r?j(r,i):i)/2;if(c){var f=c[0],b=c[1];d=(o&&r?j(r,f):f)/2,h=(o&&r?j(r,b):b)/2}var p=e.width+n,v=e.height+n,y=Object(s.a)(),g=Object(s.a)(),m=!1;if(a&&0!==p&&0!==v){var _=t!==i?t/i:p/v,O=t>i?t:i,w=1,k=1;isNaN(O)||(_>1?(w=O/p,k=O/_/v):(k=O/v,w=O*_/p)),Object(l.g)(g,g,I(y,w,k,d,h)),m=!0}var x=e.x+(p-n)/2,M=e.y+(v-n)/2;if(Object(l.g)(g,g,T(y,d-x,h-M)),!m&&(p>t||v>i)){var P=p/t>v/i,C=(P?t:i)/(P?p:v);Object(l.g)(g,g,I(y,C,C,x,M))}return r&&Object(l.g)(g,g,function(e,t,i,n){var a=t%360*Math.PI/180;Object(l.h)(e,Object(l.c)(e),a);var r=Math.cos(a),o=Math.sin(a),s=e[4],u=e[5];return e[4]=s*r-u*o+n*o-i*r+i,e[5]=u*r+s*o-i*o-n*r+n,e}(y,r,x,M)),u&&Object(l.g)(g,g,T(y,u[0],u[1])),"matrix(".concat(g[0],",").concat(g[1],",").concat(g[2],",").concat(g[3],",").concat(g[4],",").concat(g[5],")")}function R(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=[],s=[],l=++O,d=function(e,t,i){var n=null===e||void 0===e?void 0:e.effects.find((function(e){return"bloom"===e.type}));if(!n)return null;var a=n.strength,r=n.radius,o=a>0?r:0,s=(a+o)*t,l=4*a+1;return Object(u.a)("filter",{id:"bloom".concat(i),x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},Object(u.a)("feMorphology",{operator:"dilate",radius:(a+.5*o)*(Math.pow(5,t/100)*(.4+t/100)),in:"SourceGraphic",result:"dilate"}),Object(u.a)("feGaussianBlur",{in:"dilate",stdDeviation:s/25,result:"blur"}),Object(u.a)("feGaussianBlur",{in:"blur",stdDeviation:s/50,result:"intensityBlur"}),Object(u.a)("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},Object(u.a)("feFuncR",{type:"linear",slope:l}),Object(u.a)("feFuncG",{type:"linear",slope:l}),Object(u.a)("feFuncB",{type:"linear",slope:l})),Object(u.a)("feMerge",null,Object(u.a)("feMergeNode",{in:"intensityBlur"}),Object(u.a)("feMergeNode",{in:"intensityBrightness"}),Object(u.a)("feGaussianBlur",{stdDeviation:a/10})))}(a.effectView,t,l),h=null;if(d){var f,b=null===(f=a.effectView)||void 0===f?void 0:f.effects.find((function(e){return"bloom"===e.type})),p=(b.strength?b.strength+b.radius/2:0)/3,v=t+t*p,y=i+i*p;h=[Math.max(v,10),Math.max(y,10)]}for(var g=0;g<e.length;g++){var m,_,w,T=e[g],I=[],D=[],F=0,E=0,R=0,N=Object(n.a)(T);try{for(N.s();!(w=N.n()).done;){var z=w.value,H=z.shape,V=z.fill,W=z.stroke,U=z.font,Y=z.offset;a.ignoreStrokeWidth||"text"===H.type||(F+=W&&W.width||0);var q=x(V),G=M(W),X="text"===H.type?P(H,U):null;r.push(C(q)),I.push(k(H,q.fill,G,X)),D.push(S(H)),Y&&(E+=Y[0],R+=Y[1])}}catch(J){N.e(J)}finally{N.f()}var K=B(Object(o.m)(L(D)),t,i,F,null!==(m=a.scale)&&void 0!==m&&m,a.rotation,null!==(_=a.useRotationSize)&&void 0!==_&&_,[E,R],h),Z=null;if(a.masking){var $="mask-".concat(g),Q=a.masking[g];r.push(A(Q,$)),Z="url(#".concat($,")")}s.push(Z?Object(u.a)("g",{mask:Z},Object(u.a)("g",{transform:K},I)):Object(u.a)("g",{transform:K},I))}return a.useRotationSize&&a.rotation&&(t=j(a.rotation,t),i=j(a.rotation,i)),d&&(Object(o.c)(h),t=h[0],i=h[1]),Object(u.a)("svg",{xmlns:c,width:t,height:i,style:"display: block;","aria-labelledby":a.ariaLabel,role:"img",focusable:!1},d,Object(u.a)("defs",null,r),d?Object(u.a)("g",{filter:"url(#bloom".concat(l,")")},s):s)}},1875:function(e,t,i){"use strict";i.r(t),i.d(t,"createRoot",(function(){return Ie})),i.d(t,"esriChartColorSet",(function(){return Fe}));var n=i(4),a=i(12),r=i(92),o=i(367),s=i(120),l=i(107),u=i(106),c=i(90),d=i(91),h=i(89),f=i(88),b=(i(462),i(529)),p=i(1333),v=i(1334),y=i(314),g=function(){function e(){var t=this;Object(h.a)(this,e),Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._observer=new ResizeObserver((function(e){Object(b.Cb)(e,(function(e){Object(b.Cb)(t._targets,(function(t){t.target===e.target&&t.callback()}))}))}))}return Object(f.a)(e,[{key:"addTarget",value:function(e,t){this._observer.observe(e,{box:"border-box"}),this._targets.push({target:e,callback:t})}},{key:"removeTarget",value:function(e){this._observer.unobserve(e),Object(b.Ib)(this._targets,(function(t){return t.target!==e}))}}]),e}(),m=function(){function e(){Object(h.a)(this,e),Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]})}return Object(f.a)(e,[{key:"addTarget",value:function(t,i){var n=this;if(null===this._timer){var a=null;this._timer=requestAnimationFrame((function t(){var i=Date.now();(null===a||i>a+e.delay)&&(a=i,Object(b.Cb)(n._targets,(function(e){var t=e.target.getBoundingClientRect();t.width===e.size.width&&t.height===e.size.height||(e.size=t,e.callback())}))),0===n._targets.length?n._timer=null:n._timer=requestAnimationFrame(t)}))}this._targets.push({target:t,callback:i,size:{width:0,height:0,left:0,right:0,top:0,bottom:0,x:0,y:0}})}},{key:"removeTarget",value:function(e){Object(b.Ib)(this._targets,(function(t){return t.target!==e})),0===this._targets.length&&null!==this._timer&&(cancelAnimationFrame(this._timer),this._timer=null)}}]),e}();Object.defineProperty(m,"delay",{enumerable:!0,configurable:!0,writable:!0,value:200});var _=null;var O=function(){function e(t,i){Object(h.a)(this,e),Object.defineProperty(this,"_sensor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._sensor=(null===_&&(_="undefined"!=typeof ResizeObserver?new g:new m),_),this._element=t,this._listener=Object(b.Mb)(i),this._sensor.addTarget(t,i)}return Object(f.a)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element),this._listener.dispose())}},{key:"sensor",get:function(){return this._sensor}}]),e}(),j=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i)}(b.f);Object.defineProperty(j,"className",{enumerable:!0,configurable:!0,writable:!0,value:"InterfaceColors"}),Object.defineProperty(j,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:b.f.classNames.concat([j.className])});var w=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"_setDefaults",value:function(){this._setDefault("negativeBase",0),this._setDefault("numberFormat","#,###.#####"),this._setDefault("smallNumberThreshold",1);var e="_big_number_suffix_",t="_small_number_suffix_",n="_byte_suffix_";this._setDefault("bigNumberPrefixes",[{number:1e3,suffix:this._t(e+"3")},{number:1e6,suffix:this._t(e+"6")},{number:1e9,suffix:this._t(e+"9")},{number:1e12,suffix:this._t(e+"12")},{number:1e15,suffix:this._t(e+"15")},{number:1e18,suffix:this._t(e+"18")},{number:1e21,suffix:this._t(e+"21")},{number:1e24,suffix:this._t(e+"24")}]),this._setDefault("smallNumberPrefixes",[{number:1e-24,suffix:this._t(t+"24")},{number:1e-21,suffix:this._t(t+"21")},{number:1e-18,suffix:this._t(t+"18")},{number:1e-15,suffix:this._t(t+"15")},{number:1e-12,suffix:this._t(t+"12")},{number:1e-9,suffix:this._t(t+"9")},{number:1e-6,suffix:this._t(t+"6")},{number:.001,suffix:this._t(t+"3")}]),this._setDefault("bytePrefixes",[{number:1,suffix:this._t(n+"B")},{number:1024,suffix:this._t(n+"KB")},{number:1048576,suffix:this._t(n+"MB")},{number:1073741824,suffix:this._t(n+"GB")},{number:1099511627776,suffix:this._t(n+"TB")},{number:0x4000000000000,suffix:this._t(n+"PB")}]),Object(l.a)(Object(u.a)(i.prototype),"_setDefaults",this).call(this)}},{key:"_beforeChanged",value:function(){Object(l.a)(Object(u.a)(i.prototype),"_beforeChanged",this).call(this)}},{key:"format",value:function(e,t,i){var n;(null==t||Object(b.Gb)(t)&&"number"===t.toLowerCase())&&(t=this.get("numberFormat",""));var a=Number(e);if(Object(b.C)(t))try{return this.get("intlLocales")?new Intl.NumberFormat(this.get("intlLocales"),t).format(a):new Intl.NumberFormat(void 0,t).format(a)}catch(s){return"Invalid"}else{t=Object(b.Ab)(t);var r,o=this.parseFormat(t,this._root.language);r=a>this.get("negativeBase")?o.positive:a<this.get("negativeBase")?o.negative:o.zero,null==i||r.mod||((r=Object(b.zb)(r)).decimals.active=0==a?0:i),n=r.template.split(b.q).join(this.applyFormat(a,r))}return n}},{key:"parseFormat",value:function(e,t){var i=this,n=t.translateEmpty("_thousandSeparator"),a=t.translateEmpty("_decimalSeparator"),r={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:n},decimals:{active:-1,passive:-1,separator:a},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:n},decimals:{active:-1,passive:-1,separator:a},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:n},decimals:{active:-1,passive:-1,separator:a},template:"",source:"",parsed:!1}},o=(e=e.replace("||",b.Bb)).split("|");return r.positive.source=o[0],void 0===o[2]?r.zero=r.positive:r.zero.source=o[2],void 0===o[1]?r.negative=r.positive:r.negative.source=o[1],Object(b.Db)(r,(function(e,t){if(!t.parsed){var n=t.source;"number"===n.toLowerCase()&&(n=i.get("numberFormat","#,###.#####"));for(var a=b.u.chunk(n,!0),r=0;r<a.length;r++){var o=a[r];if(o.text=o.text.replace(b.Bb,"|"),"value"===o.type){var s=o.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP\u2030!]?/);if(s)if(null===s||""===s[0])t.template+=o.text;else{var l=s[0].match(/[abespABESP%\u2030!]{2}|[abespABESP%\u2030]{1}$/);l&&(t.mod=l[0].toLowerCase(),t.modSpacing=!!s[0].match(/[ ]{1}[abespABESP%\u2030!]{1}$/));var u=s[0].split(".");if(""===u[0]);else{t.thousands.active=(u[0].match(/0/g)||[]).length,t.thousands.passive=(u[0].match(/\#/g)||[]).length+t.thousands.active;var c=u[0].split(",");1===c.length||(t.thousands.interval=(c.pop()||"").length,0===t.thousands.interval&&(t.thousands.interval=-1))}void 0===u[1]||(t.decimals.active=(u[1].match(/0/g)||[]).length,t.decimals.passive=(u[1].match(/\#/g)||[]).length+t.decimals.active),t.template+=o.text.split(s[0]).join(b.q)}}else t.template+=o.text}t.parsed=!0}})),r}},{key:"applyFormat",value:function(e,t){var i=e<0;e=Math.abs(e);var n,a="",r="",o=t.mod?t.mod.split(""):[];if(-1!==o.indexOf("b")){var s=this.applyPrefix(e,this.get("bytePrefixes"),-1!==o.indexOf("!"));e=s[0],a=s[1],r=s[2],t.modSpacing&&(r=" "+r)}else if(-1!==o.indexOf("a")){var l=this.applyPrefix(e,e<this.get("smallNumberThreshold")?this.get("smallNumberPrefixes"):this.get("bigNumberPrefixes"),-1!==o.indexOf("!"));e=l[0],a=l[1],r=l[2],t.modSpacing&&(r=" "+r)}else if(-1!==o.indexOf("p")){var u=Math.min(e.toString().length+2,21);e=parseFloat(e.toPrecision(u)),a=this._root.language.translate("_percentPrefix"),r=this._root.language.translate("_percentSuffix"),""==a&&""==r&&(r="%")}else if(-1!==o.indexOf("%")){var c=Math.min(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(c)),r="%"}else if(-1!==o.indexOf("\u2030")){var d=Math.min(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(d)),r="\u2030"}if(-1!==o.indexOf("e"))n=t.decimals.passive>=0?e.toExponential(t.decimals.passive).split("e"):e.toExponential().split("e"),e=Number(n[0]),r="e"+n[1],t.modSpacing&&(r=" "+r);else if(0===t.decimals.passive)e=Math.round(e);else if(t.decimals.passive>0){var h=Math.pow(10,t.decimals.passive);e=Math.round(e*h)/h}var f="",p=Object(b.Lb)(e).split("."),v=p[0];if(v.length<t.thousands.active&&(v=Array(t.thousands.active-v.length+1).join("0")+v),t.thousands.interval>0){for(var y=[],g=v.split("").reverse().join(""),m=0,_=v.length;m<=_;m+=t.thousands.interval){var O=g.substr(m,t.thousands.interval).split("").reverse().join("");""!==O&&y.unshift(O)}v=y.join(t.thousands.separator)}f+=v,1===p.length&&p.push("");var j=p[1];return j.length<t.decimals.active&&(j+=Array(t.decimals.active-j.length+1).join("0")),""!==j&&(f+=t.decimals.separator+j),""===f&&(f="0"),0!==e&&i&&-1===o.indexOf("s")&&(f="-"+f),a&&(f=a+f),r&&(f+=r),f}},{key:"applyPrefix",value:function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,a="",r="",o=!1,s=1,l=0,u=t.length;l<u;l++)t[l].number<=e&&(0===t[l].number?n=0:(n=e/t[l].number,s=t[l].number),a=t[l].prefix,r=t[l].suffix,o=!0);return!o&&i&&t.length&&0!=e&&(n=e/t[0].number,a=t[0].prefix,r=t[0].suffix,o=!0),o&&(n=parseFloat(n.toPrecision(Math.min(s.toString().length+Math.floor(n).toString().replace(/[^0-9]*/g,"").length,21)))),[n,a,r]}},{key:"escape",value:function(e){return e.replace("||",b.Bb)}},{key:"unescape",value:function(e){return e.replace(b.Bb,"|")}}]),i}(b.f);function k(e,t){var i=0,n=0,a=1,r=0,o=0,s=0,l=0,u=0;return e.formatToParts(t).forEach((function(e){switch(e.type){case"year":i=+e.value;break;case"month":n=+e.value-1;break;case"day":a=+e.value;break;case"hour":r=+e.value;break;case"minute":o=+e.value;break;case"second":s=+e.value;break;case"fractionalSecond":l=+e.value;break;case"weekday":switch(e.value){case"Sun":u=0;break;case"Mon":u=1;break;case"Tue":u=2;break;case"Wed":u=3;break;case"Thu":u=4;break;case"Fri":u=5;break;case"Sat":u=6}}})),24===r&&(r=0),{year:i,month:n,day:a,hour:r,minute:o,second:s,millisecond:l,weekday:u}}function x(e,t){var i=k(e,t),n=i.year,a=i.month,r=i.day,o=i.hour,s=i.minute,l=i.second,u=i.millisecond;return Date.UTC(n,a,r,o,s,l,u)}var M=function(){function e(t,i){if(Object(h.a)(this,e),Object.defineProperty(this,"_utc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dtf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this.name=t,this._utc=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3}),this._dtf=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3})}return Object(f.a)(e,[{key:"convertLocal",value:function(e){var t=this.offsetUTC(e),i=e.getTimezoneOffset(),n=new Date(e);n.setUTCMinutes(n.getUTCMinutes()-(t-i));var a=n.getTimezoneOffset();return i!=a&&n.setUTCMinutes(n.getUTCMinutes()+a-i),n}},{key:"offsetUTC",value:function(e){return(x(this._utc,e)-x(this._dtf,e))/6e4}},{key:"parseDate",value:function(e){return k(this._dtf,e)}}],[{key:"new",value:function(e){return new this(e,!0)}}]),e}(),P=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"_setDefaults",value:function(){this._setDefault("capitalize",!0),this._setDefault("dateFormat","yyyy-MM-dd"),Object(l.a)(Object(u.a)(i.prototype),"_setDefaults",this).call(this)}},{key:"_beforeChanged",value:function(){Object(l.a)(Object(u.a)(i.prototype),"_beforeChanged",this).call(this)}},{key:"format",value:function(e,t){var i;void 0!==t&&""!==t||(t=this.get("dateFormat","yyyy-MM-dd"));var n=e;if(Object(b.C)(t))try{var a=this.get("intlLocales");return a?new Intl.DateTimeFormat(a,t).format(n):new Intl.DateTimeFormat(void 0,t).format(n)}catch(s){return"Invalid"}var r=this.parseFormat(t),o=this._root.timezone;return o&&!this._root.utc&&(n=o.convertLocal(n)),Object(b.Eb)(n.getTime())?(i=this.applyFormat(n,r),this.get("capitalize")&&(i=i.replace(/^.{1}/,i.substr(0,1).toUpperCase())),i):"Invalid date"}},{key:"applyFormat",value:function(e,t){var i,n,a,r,o,s,l,u,c=t.template,d=e.getTime();this._root.utc?(i=e.getUTCFullYear(),n=e.getUTCMonth(),a=e.getUTCDay(),r=e.getUTCDate(),o=e.getUTCHours(),s=e.getUTCMinutes(),l=e.getUTCSeconds(),u=e.getUTCMilliseconds()):(i=e.getFullYear(),n=e.getMonth(),a=e.getDay(),r=e.getDate(),o=e.getHours(),s=e.getMinutes(),l=e.getSeconds(),u=e.getMilliseconds());for(var h=0,f=t.parts.length;h<f;h++){var p="";switch(t.parts[h]){case"G":p=this._t(i<0?"_era_bc":"_era_ad");break;case"yyyy":p=Math.abs(i).toString(),i<0&&(p+=this._t("_era_bc"));break;case"yyy":case"yy":case"y":p=Math.abs(i).toString().substr(-t.parts[h].length),i<0&&(p+=this._t("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":var v=Object(b.Qb)(e,this._root.utc);p="YYYY"==t.parts[h]?Math.abs(v).toString():Math.abs(v).toString().substr(-t.parts[h].length),v<0&&(p+=this._t("_era_bc"));break;case"u":case"F":case"g":break;case"q":p=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":p=this._t(this._getMonth(n)).substr(0,1);break;case"MMMM":p=this._t(this._getMonth(n));break;case"MMM":p=this._t(this._getShortMonth(n));break;case"MM":p=Object(b.Nb)(n+1,2,"0");break;case"M":p=(n+1).toString();break;case"ww":p=Object(b.Nb)(Object(b.Pb)(e,this._root.utc),2,"0");break;case"w":p=Object(b.Pb)(e,this._root.utc).toString();break;case"W":p=Object(b.Ob)(e,this._root.utc).toString();break;case"dd":p=Object(b.Nb)(r,2,"0");break;case"d":p=r.toString();break;case"DD":case"DDD":p=Object(b.Nb)(Object(b.Kb)(e,this._root.utc).toString(),t.parts[h].length,"0");break;case"D":p=Object(b.Kb)(e,this._root.utc).toString();break;case"t":p=this._root.language.translateFunc("_dateOrd").call(this,r);break;case"E":p=(a||7).toString();break;case"EE":p=Object(b.Nb)((a||7).toString(),2,"0");break;case"EEE":case"eee":p=this._t(this._getShortWeekday(a));break;case"EEEE":case"eeee":p=this._t(this._getWeekday(a));break;case"EEEEE":case"eeeee":p=this._t(this._getShortWeekday(a)).substr(0,1);break;case"e":case"ee":p=(a-(this._root.locale.firstDayOfWeek||1)+1).toString(),"ee"==t.parts[h]&&(p=Object(b.Nb)(p,2,"0"));break;case"a":p=o>=12?this._t("PM"):this._t("AM");break;case"aa":p=o>=12?this._t("P.M."):this._t("A.M.");break;case"aaa":p=o>=12?this._t("P"):this._t("A");break;case"h":p=Object(b.Jb)(o).toString();break;case"hh":p=Object(b.Nb)(Object(b.Jb)(o),2,"0");break;case"H":p=o.toString();break;case"HH":p=Object(b.Nb)(o,2,"0");break;case"K":p=Object(b.Jb)(o,0).toString();break;case"KK":p=Object(b.Nb)(Object(b.Jb)(o,0),2,"0");break;case"k":p=(o+1).toString();break;case"kk":p=Object(b.Nb)(o+1,2,"0");break;case"m":p=s.toString();break;case"mm":p=Object(b.Nb)(s,2,"0");break;case"s":p=l.toString();break;case"ss":p=Object(b.Nb)(l,2,"0");break;case"S":case"SS":case"SSS":p=Math.round(u/1e3*Math.pow(10,t.parts[h].length)).toString();break;case"x":p=d.toString();break;case"n":case"nn":case"nnn":p=Object(b.Nb)(u,t.parts[h].length,"0");break;case"z":p=Object(b.Hb)(e,!1,!1,this._root.utc);break;case"zz":p=Object(b.Hb)(e,!0,!1,this._root.utc);break;case"zzz":p=Object(b.Hb)(e,!1,!0,this._root.utc);break;case"zzzz":p=Object(b.Hb)(e,!0,!0,this._root.utc);break;case"Z":case"ZZ":var y=this._root.utc?"UTC":this._root.timezone;y instanceof M&&(y=y.name);var g=y?Object(b.Fb)(y):e.getTimezoneOffset(),m=Math.abs(g)/60,_=Math.floor(m),O=60*m-60*_;this._root.utc&&(_=0,O=0),"Z"==t.parts[h]?(p="GMT",p+=g>0?"-":"+",p+=Object(b.Nb)(_,2)+":"+Object(b.Nb)(O,2)):(p=g>0?"-":"+",p+=Object(b.Nb)(_,2)+Object(b.Nb)(O,2));break;case"i":p=e.toISOString();break;case"I":p=e.toUTCString()}c=c.replace(b.q,p)}return c}},{key:"parseFormat",value:function(e){for(var t={template:"",parts:[]},i=b.u.chunk(e,!0),n=0;n<i.length;n++){var a=i[n];if("value"===a.type){if(a.text.match(/^date$/i)){var r=this.get("dateFormat","yyyy-MM-dd");Object(b.Gb)(r)||(r="yyyy-MM-dd"),a.text=r}var o=a.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(o)for(var s=0;s<o.length;s++)t.parts.push(o[s]),a.text=a.text.replace(o[s],b.q)}t.template+=a.text}return t}},{key:"_months",value:function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}},{key:"_getMonth",value:function(e){return this._months()[e]}},{key:"_shortMonths",value:function(){return["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},{key:"_getShortMonth",value:function(e){return this._shortMonths()[e]}},{key:"_weekdays",value:function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},{key:"_getWeekday",value:function(e){return this._weekdays()[e]}},{key:"_shortWeekdays",value:function(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},{key:"_getShortWeekday",value:function(e){return this._shortWeekdays()[e]}},{key:"parse",value:function(e,t){if(e instanceof Date)return e;if(Object(b.Eb)(e))return new Date(e);var i;Object(b.Gb)(e)||(e=e.toString());var n="";t=(t=Object(b.Ab)(t)).substr(0,e.length);for(var a=this.parseFormat(t),r={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},o={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:this._root.utc},s=0,l=0,u=0;u<a.parts.length;u++){switch(l=u+s+1,a.parts[u]){case"yyyy":case"YYYY":n+="([0-9]{4})",r.year=l;break;case"yyy":case"YYY":n+="([0-9]{3})",r.year3=l;break;case"yy":case"YY":n+="([0-9]{2})",r.year2=l;break;case"y":case"Y":n+="([0-9]{1})",r.year1=l;break;case"MMMM":n+="("+this.getStringList(this._months()).join("|")+")",r.monthLong=l;break;case"MMM":n+="("+this.getStringList(this._shortMonths()).join("|")+")",r.monthShort=l;break;case"MM":case"M":n+="([0-9]{2}|[0-9]{1})",r.month=l;break;case"ww":case"w":n+="([0-9]{2}|[0-9]{1})",r.week=l;break;case"dd":case"d":n+="([0-9]{2}|[0-9]{1})",r.day=l;break;case"DDD":case"DD":case"D":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",r.yearDay=l;break;case"dddd":n+="("+this.getStringList(this._weekdays()).join("|")+")",r.weekdayLong=l;break;case"ddd":n+="("+this.getStringList(this._shortWeekdays()).join("|")+")",r.weekdayShort=l;break;case"aaa":case"aa":case"a":n+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",r.am=l;break;case"hh":case"h":n+="([0-9]{2}|[0-9]{1})",r.hour12Base1=l;break;case"HH":case"H":n+="([0-9]{2}|[0-9]{1})",r.hourBase0=l;break;case"KK":case"K":n+="([0-9]{2}|[0-9]{1})",r.hour12Base0=l;break;case"kk":case"k":n+="([0-9]{2}|[0-9]{1})",r.hourBase1=l;break;case"mm":case"m":n+="([0-9]{2}|[0-9]{1})",r.minute=l;break;case"ss":case"s":n+="([0-9]{2}|[0-9]{1})",r.second=l;break;case"SSS":case"SS":case"S":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",r.millisecond=l,r.millisecondDigits=a.parts[u].length;break;case"nnn":case"nn":case"n":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",r.millisecond=l;break;case"x":n+="([0-9]{1,})",r.timestamp=l;break;case"Z":n+="GMT([-+]+[0-9]{2}:[0-9]{2})",r.zone=l;break;case"ZZ":n+="([\\-+]+[0-9]{2}[0-9]{2})",r.zone=l;break;case"i":n+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\.?([0-9]{0,3})([zZ]|[+\\-][0-9]{2}:?[0-9]{2}|$)",r.iso=l,s+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":s--}n+="[^0-9]*"}var c=new RegExp(n),d=e.match(c);if(d){if(r.year>-1&&(o.year=parseInt(d[r.year])),r.year3>-1){var h=parseInt(d[r.year3]);h+=1e3,o.year=h}if(r.year2>-1){var f=parseInt(d[r.year2]);f+=f>50?1e3:2e3,o.year=f}if(r.year1>-1){var p=parseInt(d[r.year1]);p=10*Math.floor((new Date).getFullYear()/10)+p,o.year=p}if(r.monthLong>-1&&(o.month=this.resolveMonth(d[r.monthLong])),r.monthShort>-1&&(o.month=this.resolveShortMonth(d[r.monthShort])),r.month>-1&&(o.month=parseInt(d[r.month])-1),r.week>-1&&-1===r.day&&(o.month=0,o.day=Object(b.Rb)(parseInt(d[r.week]),o.year,1,this._root.utc)),r.day>-1&&(o.day=parseInt(d[r.day])),r.yearDay>-1&&(o.month=0,o.day=parseInt(d[r.yearDay])),r.hourBase0>-1&&(o.hour=parseInt(d[r.hourBase0])),r.hourBase1>-1&&(o.hour=parseInt(d[r.hourBase1])-1),r.hour12Base0>-1){var v=parseInt(d[r.hour12Base0]);11==v&&(v=0),r.am>-1&&!this.isAm(d[r.am])&&(v+=12),o.hour=v}if(r.hour12Base1>-1){var y=parseInt(d[r.hour12Base1]);12==y&&(y=0),r.am>-1&&!this.isAm(d[r.am])&&(y+=12),o.hour=y}if(r.minute>-1&&(o.minute=parseInt(d[r.minute])),r.second>-1&&(o.second=parseInt(d[r.second])),r.millisecond>-1){var g=parseInt(d[r.millisecond]);2==r.millisecondDigits?g*=10:1==r.millisecondDigits&&(g*=100),o.millisecond=g}if(r.timestamp>-1){o.timestamp=parseInt(d[r.timestamp]);var m=new Date(o.timestamp);o.year=m.getUTCFullYear(),o.month=m.getUTCMonth(),o.day=m.getUTCDate(),o.hour=m.getUTCHours(),o.minute=m.getUTCMinutes(),o.second=m.getUTCSeconds(),o.millisecond=m.getUTCMilliseconds()}r.zone>-1&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),d[r.zone])),r.iso>-1&&(o.year=Object(b.Sb)(d[r.iso+0]),o.month=Object(b.Sb)(d[r.iso+1])-1,o.day=Object(b.Sb)(d[r.iso+2]),o.hour=Object(b.Sb)(d[r.iso+3]),o.minute=Object(b.Sb)(d[r.iso+4]),o.second=Object(b.Sb)(d[r.iso+5]),o.millisecond=Object(b.Sb)(d[r.iso+6]),"Z"==d[r.iso+7]||"z"==d[r.iso+7]?o.utc=!0:""!=d[r.iso+7]&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),d[r.iso+7]))),i=o.utc?new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond)):new Date(o.year,o.month,o.day,o.hour,o.minute+o.offset,o.second,o.millisecond)}else i=new Date(e);return i}},{key:"resolveTimezoneOffset",value:function(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){var i=t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/),n=i[1],a=i[2],r=i[3],o=60*parseInt(a)+parseInt(r);return"+"==n&&(o*=-1),o-(e||new Date).getTimezoneOffset()}return 0}},{key:"resolveMonth",value:function(e){var t=this._months().indexOf(e);return t>-1||!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._months()).indexOf(e))>-1?t:0}},{key:"resolveShortMonth",value:function(e){var t=this._shortMonths().indexOf(e);return t>-1?t:(t=this._months().indexOf(e))>-1||this._root.language&&!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._shortMonths()).indexOf(e))>-1?t:0}},{key:"isAm",value:function(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1}},{key:"getStringList",value:function(e){for(var t=[],i=0;i<e.length;i++)this._root.language?t.push(Object(b.Tb)(this._t(e[i]))):t.push(Object(b.Tb)(e[i]));return t}}]),i}(b.f),C=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){var e;return Object(h.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(s.a)(e),"_unitAliases",{enumerable:!0,configurable:!0,writable:!0,value:{Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"}}),e}return Object(f.a)(i,[{key:"_setDefaults",value:function(){var e="_duration_millisecond",t="_duration_second",n="_duration_minute",a="_duration_hour",r="_duration_day",o="_duration_week",s="_duration_month",c="_minute",d="_hour",h="_day",f="_week",b="_week",p="_year";this._setDefault("negativeBase",0),this._setDefault("baseUnit","second"),this._setDefault("durationFormats",{millisecond:{millisecond:this._t(e),second:this._t(e+"_second"),minute:this._t(e+c),hour:this._t(e+d),day:this._t(e+h),week:this._t(e+f),month:this._t(e+b),year:this._t(e+p)},second:{second:this._t(t),minute:this._t(t+c),hour:this._t(t+d),day:this._t(t+h),week:this._t(t+f),month:this._t(t+b),year:this._t(t+p)},minute:{minute:this._t(n),hour:this._t(n+d),day:this._t(n+h),week:this._t(n+f),month:this._t(n+b),year:this._t(n+p)},hour:{hour:this._t(a),day:this._t(a+h),week:this._t(a+f),month:this._t(a+b),year:this._t(a+p)},day:{day:this._t(r),week:this._t(r+f),month:this._t(r+b),year:this._t(r+p)},week:{week:this._t(o),month:this._t(o+b),year:this._t(o+p)},month:{month:this._t(s),year:this._t(s+p)},year:{year:this._t("_duration_year")}}),Object(l.a)(Object(u.a)(i.prototype),"_setDefaults",this).call(this)}},{key:"_beforeChanged",value:function(){Object(l.a)(Object(u.a)(i.prototype),"_beforeChanged",this).call(this)}},{key:"format",value:function(e,t,i){var n=i||this.get("baseUnit");void 0!==t&&""!==t||(t=null!=this.get("durationFormat")?this.get("durationFormat"):this.getFormat(Object(b.Sb)(e),void 0,n)),t=Object(b.Ab)(t);var a,r=this.parseFormat(t,n),o=Number(e);a=o>this.get("negativeBase")?r.positive:o<this.get("negativeBase")?r.negative:r.zero;var s=this.applyFormat(o,a);return""!==a.color&&(s="["+a.color+"]"+s+"[/]"),s}},{key:"parseFormat",value:function(e,t){var i=this,n=t||this.get("baseUnit"),a={positive:{color:"",template:"",parts:[],source:"",baseUnit:n,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:n,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:n,parsed:!1,absolute:!1}},r=(e=e.replace("||",b.Bb)).split("|");return a.positive.source=r[0],void 0===r[2]?a.zero=a.positive:a.zero.source=r[2],void 0===r[1]?a.negative=a.positive:a.negative.source=r[1],Object(b.Db)(a,(function(e,t){if(!t.parsed){var n,a=t.source;(n=t.source.match(/^\[([^\]]*)\]/))&&n.length&&""!==n[0]&&(a=t.source.substr(n[0].length),t.color=n[1]);for(var r=b.u.chunk(a,!0),o=0;o<r.length;o++){var s=r[o];if(s.text=s.text.replace(b.Bb,"|"),"value"===s.type){s.text.match(/[yYMdDwhHKkmsSn]+a/)&&(t.absolute=!0,s.text=s.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));var l=s.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(l)for(var u=0;u<l.length;u++)null==l[u]&&(l[u]=i._unitAliases[l[u]]),t.parts.push(l[u]),s.text=s.text.replace(l[u],b.q)}t.template+=s.text}t.parsed=!0}})),a}},{key:"applyFormat",value:function(e,t){var i=!t.absolute&&e<this.get("negativeBase");e=Math.abs(e);for(var n=this.toTimeStamp(e,t.baseUnit),a=t.template,r=0,o=t.parts.length;r<o;r++){var s=t.parts[r],l=this._toTimeUnit(s.substr(0,1)),u=s.length,c=Math.floor(n/this._getUnitValue(l));a=a.replace(b.q,Object(b.Nb)(c,u,"0")),n-=c*this._getUnitValue(l)}return i&&(a="-"+a),a}},{key:"toTimeStamp",value:function(e,t){return e*this._getUnitValue(t)}},{key:"_toTimeUnit",value:function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}}},{key:"getFormat",value:function(e,t,i){if(null!=this.get("durationFormat"))return this.get("durationFormat");if(i||(i=this.get("baseUnit")),null!=t&&e!=t){e=Math.abs(e),t=Math.abs(t);var n=this.getValueUnit(Math.max(e,t),i);return this.get("durationFormats")[i][n]}var a=this.getValueUnit(e,i);return this.get("durationFormats")[i][a]}},{key:"getValueUnit",value:function(e,t){var i;t||(t=this.get("baseUnit"));var n=this.getMilliseconds(e,t);return Object(b.Ub)(this._getUnitValues(),(function(e,a){if(e==t||i){if(n/a<=1)return i||(i=e),!1;i=e}return!0})),i}},{key:"getMilliseconds",value:function(e,t){return t||(t=this.get("baseUnit")),e*this._getUnitValue(t)}},{key:"_getUnitValue",value:function(e){return this._getUnitValues()[e]}},{key:"_getUnitValues",value:function(){return{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6}}}]),i}(b.f),A={firstDayOfWeek:1,_decimalSeparator:".",_thousandSeparator:",",_percentPrefix:null,_percentSuffix:"%",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"\u03bc",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_millisecond_full:"HH:mm:ss SSS",_date_second:"HH:mm:ss",_date_second_full:"HH:mm:ss",_date_minute:"HH:mm",_date_minute_full:"HH:mm - MMM dd, yyyy",_date_hour:"HH:mm",_date_hour_full:"HH:mm - MMM dd, yyyy",_date_day:"MMM dd",_date_day_full:"MMM dd, yyyy",_date_week:"ww",_date_week_full:"MMM dd, yyyy",_date_month:"MMM",_date_month_full:"MMM, yyyy",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(e){var t="th";if(e<11||e>13)switch(e%10){case 1:t="st";break;case 2:t="nd";break;case 3:t="rd"}return t},"Zoom Out":"",Play:"",Stop:"",Legend:"","Press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Press ENTER to open":"","Press ENTER to print.":"","Press ENTER to export as %1.":"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"",HTML:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""},T=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"_setDefaults",value:function(){this.setPrivate("defaultLocale",A),Object(l.a)(Object(u.a)(i.prototype),"_setDefaults",this).call(this)}},{key:"translate",value:function(e,t){t||(t=this._root.locale||this.getPrivate("defaultLocale"));for(var i=e,n=t[e],a=arguments.length,r=new Array(a>2?a-2:0),o=2;o<a;o++)r[o-2]=arguments[o];if(null===n)i="";else if(null!=n)n&&(i=n);else if(t!==this.getPrivate("defaultLocale"))return this.translate.apply(this,[e,this.getPrivate("defaultLocale")].concat(r));if(r.length)for(var s=r.length,l=0;l<s;++l)i=i.split("%"+(l+1)).join(r[l]);return i}},{key:"translateAny",value:function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),a=2;a<i;a++)n[a-2]=arguments[a];return this.translate.apply(this,[e,t].concat(n))}},{key:"setTranslationAny",value:function(e,t,i){(i||this._root.locale)[e]=t}},{key:"setTranslationsAny",value:function(e,t){var i=this;Object(b.Db)(e,(function(e,n){i.setTranslationAny(e,n,t)}))}},{key:"translateEmpty",value:function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),a=2;a<i;a++)n[a-2]=arguments[a];var r=this.translate.apply(this,[e,t].concat(n));return r==e?"":r}},{key:"translateFunc",value:function(e,t){return this._root.locale[e]?this._root.locale[e]:t!==this.getPrivate("defaultLocale")?this.translateFunc(e,this.getPrivate("defaultLocale")):function(){return""}}},{key:"translateAll",value:function(e,t){var i=this;return this.isDefault()?e:Object(b.Vb)(e,(function(e){return i.translate(e,t)}))}},{key:"isDefault",value:function(){return this.getPrivate("defaultLocale")===this._root.locale}}]),i}(b.f),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;Object(h.a)(this,e),Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"d",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.a=t,this.b=i,this.c=n,this.d=a,this.tx=r,this.ty=o}return Object(f.a)(e,[{key:"setTransform",value:function(e,t,i,n,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;this.a=Math.cos(a)*r,this.b=Math.sin(a)*r,this.c=-Math.sin(a)*r,this.d=Math.cos(a)*r,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d)}},{key:"apply",value:function(e){return{x:this.a*e.x+this.c*e.y+this.tx,y:this.b*e.x+this.d*e.y+this.ty}}},{key:"applyInverse",value:function(e){var t=1/(this.a*this.d+this.c*-this.b);return{x:this.d*t*e.x+-this.c*t*e.y+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*e.y+-this.b*t*e.x+(-this.ty*this.a+this.tx*this.b)*t}}},{key:"append",value:function(e){var t=this.a,i=this.b,n=this.c,a=this.d;this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*a,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*a,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*a+this.ty}},{key:"prepend",value:function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty}},{key:"copyFrom",value:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty}}]),e}(),D=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(l){a=!0,r=l}finally{try{!n&&s.return&&s.return()}finally{if(a)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},F=2*Math.PI,E=function(e,t,i,n,a,r,o){var s=e.x,l=e.y;return{x:n*(s*=t)-a*(l*=i)+r,y:a*s+n*l+o}},S=function(e,t){var i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),n=Math.cos(e),a=Math.sin(e),r=Math.cos(e+t),o=Math.sin(e+t);return[{x:n-a*i,y:a+n*i},{x:r+o*i,y:o-r*i},{x:r,y:o}]},L=function(e,t,i,n){var a=e*i+t*n;return a>1&&(a=1),a<-1&&(a=-1),(e*n-t*i<0?-1:1)*Math.acos(a)},B=function(e){var t=e.px,i=e.py,n=e.cx,a=e.cy,r=e.rx,o=e.ry,s=e.xAxisRotation,l=void 0===s?0:s,u=e.largeArcFlag,c=void 0===u?0:u,d=e.sweepFlag,h=void 0===d?0:d,f=[];if(0===r||0===o)return[];var b=Math.sin(l*F/360),p=Math.cos(l*F/360),v=p*(t-n)/2+b*(i-a)/2,y=-b*(t-n)/2+p*(i-a)/2;if(0===v&&0===y)return[];r=Math.abs(r),o=Math.abs(o);var g=Math.pow(v,2)/Math.pow(r,2)+Math.pow(y,2)/Math.pow(o,2);g>1&&(r*=Math.sqrt(g),o*=Math.sqrt(g));var m=function(e,t,i,n,a,r,o,s,l,u,c,d){var h=Math.pow(a,2),f=Math.pow(r,2),b=Math.pow(c,2),p=Math.pow(d,2),v=h*f-h*p-f*b;v<0&&(v=0),v/=h*p+f*b;var y=(v=Math.sqrt(v)*(o===s?-1:1))*a/r*d,g=v*-r/a*c,m=u*y-l*g+(e+i)/2,_=l*y+u*g+(t+n)/2,O=(c-y)/a,j=(d-g)/r,w=(-c-y)/a,k=(-d-g)/r,x=L(1,0,O,j),M=L(O,j,w,k);return 0===s&&M>0&&(M-=F),1===s&&M<0&&(M+=F),[m,_,x,M]}(t,i,n,a,r,o,c,h,b,p,v,y),_=D(m,4),O=_[0],j=_[1],w=_[2],k=_[3],x=Math.abs(k)/(F/4);Math.abs(1-x)<1e-7&&(x=1);var M=Math.max(Math.ceil(x),1);k/=M;for(var P=0;P<M;P++)f.push(S(w,k)),w+=k;return f.map((function(e){var t=E(e[0],r,o,p,b,O,j),i=t.x,n=t.y,a=E(e[1],r,o,p,b,O,j),s=a.x,l=a.y,u=E(e[2],r,o,p,b,O,j);return{x1:i,y1:n,x2:s,y2:l,x:u.x,y:u.y}}))};function R(e,t,i){if(t!==i)throw new Error("Required "+i+" arguments for "+e+" but got "+t)}function N(e,t,i){if(t<i)throw new Error("Required at least "+i+" arguments for "+e+" but got "+t)}function z(e,t,i){if(N(e,t,i),t%i!=0)throw new Error("Arguments for "+e+" must be in pairs of "+i)}function H(e){for(var t=0;t<e.length;t+=7){var i=t+3,n=e[i];if(n.length>1){var a=/^([01])([01])(.*)$/.exec(n);null!==a&&(e.splice(i,0,a[1]),++i,e.splice(i,0,a[2]),++i,a[3].length>0?e[i]=a[3]:e.splice(i,1))}if((n=e[++i]).length>1){var r=/^([01])(.+)$/.exec(n);null!==r&&(e.splice(i,0,r[1]),e[++i]=r[2])}}}function V(e){if(0===e||1===e)return e;throw new Error("Flag must be 0 or 1")}function W(e,t){for(;(!e.interactive||t(e))&&e._parent;)e=e._parent}function U(e,t,i){return Object(b.Xb)(e,Object(b.i)(t),(function(e){var t=Object(b.j)(e),n=e.touches;n?(0==n.length&&(n=e.changedTouches),i(Object(b.l)(n),t)):i([e],t)}))}function Y(e){var t=document.createElement("canvas");t.width=1,t.height=1;var i=t.getContext("2d",{willReadFrequently:!0});i.drawImage(e,0,0,1,1);try{return i.getImageData(0,0,1,1),!1}catch(n){return console.warn('Image "'+e.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function q(e){e.width=0,e.height=0,e.style.width="0px",e.style.height="0px"}var G=function(){function e(){Object(h.a)(this,e),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}return Object(f.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._y=e}}]),e}(),X=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(h.a)(this,i),n=t.call(this),Object.defineProperty(Object(s.a)(n),"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(Object(s.a)(n),"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(s.a)(n),"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(s.a)(n),"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"inactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(Object(s.a)(n),"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(Object(s.a)(n),"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(Object(s.a)(n),"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"crisp",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new G}),Object.defineProperty(Object(s.a)(n),"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new I}),Object.defineProperty(Object(s.a)(n),"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new I}),Object.defineProperty(Object(s.a)(n),"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new I}),Object.defineProperty(Object(s.a)(n),"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n._renderer=e,n}return Object(f.a)(i,[{key:"_dispose",value:function(){this._renderer._removeObject(this),this.getLayer().dirty=!0}},{key:"getCanvas",value:function(){return this.getLayer().view}},{key:"getLayer",value:function(){for(var e=this;;){if(e._layer)return e._layer;if(!e._parent)return this._renderer.defaultLayer;e=e._parent}}},{key:"setLayer",value:function(e,t){if(null==e)this._layer=void 0;else{this._layer=this._renderer.getLayer(e,true),this._layer.visible=true,this._layer.margin=t,t&&Object(b.x)(this._layer.view,!1),this._renderer._ghostLayer.setMargin(this._renderer.layers),this._parent&&this._parent.registerChildLayer(this._layer),this._layer.dirty=!0,this._renderer.resizeLayer(this._layer),this._renderer.resizeGhost()}}},{key:"markDirtyLayer",value:function(){this.getLayer().dirty=!0}},{key:"clear",value:function(){this.invalidateBounds()}},{key:"invalidateBounds",value:function(){this._localBounds=void 0}},{key:"_addBounds",value:function(e){}},{key:"_getColorId",value:function(){return void 0===this._colorId&&(this._colorId=this._renderer.paintId(this)),this._colorId}},{key:"_isInteractive",value:function(){return 0==this.inactive&&(this.interactive||this._renderer._forceInteractive>0)}},{key:"_isInteractiveMask",value:function(){return this._isInteractive()}},{key:"contains",value:function(e){for(;;){if(e===this)return!0;if(!e._parent)return!1;e=e._parent}}},{key:"toGlobal",value:function(e){return this._matrix.apply(e)}},{key:"toLocal",value:function(e){return this._matrix.applyInverse(e)}},{key:"getLocalMatrix",value:function(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}},{key:"getLocalBounds",value:function(){if(!this._localBounds){var e=1e7;this._localBounds={left:e,top:e,right:-e,bottom:-e},this._addBounds(this._localBounds)}return this._localBounds}},{key:"getAdjustedBounds",value:function(e){this._setMatrix();var t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),n=t.apply({x:e.right,y:e.top}),a=t.apply({x:e.right,y:e.bottom}),r=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,n.x,a.x,r.x),top:Math.min(i.y,n.y,a.y,r.y),right:Math.max(i.x,n.x,a.x,r.x),bottom:Math.max(i.y,n.y,a.y,r.y)}}},{key:"on",value:function(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new b.e((function(){}))}},{key:"_setMatrix",value:function(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}},{key:"_transform",value:function(e,t){var i=this._matrix,n=i.tx*t,a=i.ty*t;this.crisp&&(n=Math.floor(n)+.5,a=Math.floor(a)+.5),e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,n,a)}},{key:"_transformMargin",value:function(e,t,i){var n=this._matrix;e.setTransform(n.a*t,n.b*t,n.c*t,n.d*t,(n.tx+i.left)*t,(n.ty+i.top)*t)}},{key:"_transformLayer",value:function(e,t,i){i.margin?this._transformMargin(e,i.scale||t,i.margin):this._transform(e,i.scale||t)}},{key:"render",value:function(e){var t=this;if(this.visible&&(!1!==this.exportable||!this._renderer._omitTainted)){this._setMatrix();var i=this._renderer.resolution,n=this._renderer.layers,a=this._renderer._ghostLayer,r=a.context,o=this.mask;o&&o._setMatrix(),Object(b.Cb)(n,(function(e){if(e){var n=e.context;n.save(),o&&(o._transformLayer(n,i,e),o._runPath(n),n.clip()),n.globalAlpha=t.compoundAlpha*t.alpha,t._transformLayer(n,i,e),t.filter&&(n.filter=t.filter)}})),r.save(),o&&this._isInteractiveMask()&&(o._transformMargin(r,i,a.margin),o._runPath(r),r.clip()),this._transformMargin(r,i,a.margin),this._render(e),r.restore(),Object(b.Cb)(n,(function(e){e&&e.context.restore()}))}}},{key:"_render",value:function(e){!1===this.exportable&&((this._layer||e).tainted=!0)}},{key:"hovering",value:function(){return this._renderer._hovering.has(this)}},{key:"dragging",value:function(){var e=this;return this._renderer._dragging.some((function(t){return t.value===e}))}},{key:"shouldCancelTouch",value:function(){var e=this._renderer;return!(e.tapToActivate&&!e._touchActive)&&(!!this.cancelTouch||!!this._parent&&this._parent.shouldCancelTouch())}}]),i}(b.w),K=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){var e;return Object(h.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(s.a)(e),"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(s.a)(e),"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(e),"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]}),e}return Object(f.a)(i,[{key:"_isInteractiveMask",value:function(){return this.interactiveChildren||Object(l.a)(Object(u.a)(i.prototype),"_isInteractiveMask",this).call(this)}},{key:"addChild",value:function(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}},{key:"addChildAt",value:function(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}},{key:"removeChild",value:function(e){e._parent=void 0,Object(b.k)(this._children,e)}},{key:"_render",value:function(e){var t=this;Object(l.a)(Object(u.a)(i.prototype),"_render",this).call(this,e);var n=this._renderer;this.interactive&&this.interactiveChildren&&++n._forceInteractive;var a=this._layer||e;Object(b.Cb)(this._children,(function(e){e.compoundAlpha=t.compoundAlpha*t.alpha,e.render(a)})),this.interactive&&this.interactiveChildren&&--n._forceInteractive}},{key:"registerChildLayer",value:function(e){this._childLayers||(this._childLayers=[]),Object(b.m)(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}},{key:"markDirtyLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(l.a)(Object(u.a)(i.prototype),"markDirtyLayer",this).call(this),e&&this._childLayers&&Object(b.Cb)(this._childLayers,(function(e){return e.dirty=!0}))}},{key:"_dispose",value:function(){Object(l.a)(Object(u.a)(i.prototype),"_dispose",this).call(this),this._childLayers&&Object(b.Cb)(this._childLayers,(function(e){e.dirty=!0}))}}]),i}(X);function Z(e,t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.right=Math.max(e.right,t.x),e.bottom=Math.max(e.bottom,t.y)}var $=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"colorize",value:function(e,t){}},{key:"path",value:function(e){}},{key:"addBounds",value:function(e){}}]),e}(),Q=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.beginPath()}}]),i}($),J=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(h.a)(this,i),n=t.call(this),Object.defineProperty(Object(s.a)(n),"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.fillStyle=void 0!==t?t:this.color}}]),i}($),ee=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(h.a)(this,i),n=t.call(this),Object.defineProperty(Object(s.a)(n),"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}]),i}($),te=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.stroke()}}]),i}($),ie=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a){var r;return Object(h.a)(this,i),r=t.call(this),Object.defineProperty(Object(s.a)(r),"width",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(r),"color",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(r),"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:a}),r}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.strokeStyle=void 0!==t?t:this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin)}}]),i}($),ne=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(h.a)(this,i),n=t.call(this),Object.defineProperty(Object(s.a)(n),"dash",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.setLineDash(this.dash)}}]),i}($),ae=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(h.a)(this,i),n=t.call(this),Object.defineProperty(Object(s.a)(n),"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:e}),n}return Object(f.a)(i,[{key:"colorize",value:function(e,t){e.lineDashOffset=this.dashOffset}}]),i}($),re=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r){var o;return Object(h.a)(this,i),o=t.call(this),Object.defineProperty(Object(s.a)(o),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(o),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(o),"width",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(o),"height",{enumerable:!0,configurable:!0,writable:!0,value:r}),o}return Object(f.a)(i,[{key:"path",value:function(e){e.rect(this.x,this.y,this.width,this.height)}},{key:"addBounds",value:function(e){var t=this.x,i=this.y,n=t+this.width,a=i+this.height;Z(e,{x:t,y:i}),Z(e,{x:n,y:i}),Z(e,{x:t,y:a}),Z(e,{x:n,y:a})}}]),i}($),oe=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a){var r;return Object(h.a)(this,i),r=t.call(this),Object.defineProperty(Object(s.a)(r),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(r),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(r),"radius",{enumerable:!0,configurable:!0,writable:!0,value:a}),r}return Object(f.a)(i,[{key:"path",value:function(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}},{key:"addBounds",value:function(e){Z(e,{x:this.x-this.radius,y:this.y-this.radius}),Z(e,{x:this.x+this.radius,y:this.y+this.radius})}}]),i}($),se=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r){var o;return Object(h.a)(this,i),o=t.call(this),Object.defineProperty(Object(s.a)(o),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(o),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(o),"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(o),"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:r}),o}return Object(f.a)(i,[{key:"path",value:function(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,2*Math.PI)}},{key:"addBounds",value:function(e){Z(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),Z(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}]),i}($),le=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r,o,l){var u;return Object(h.a)(this,i),u=t.call(this),Object.defineProperty(Object(s.a)(u),"cx",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(u),"cy",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(u),"radius",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(u),"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Object(s.a)(u),"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(Object(s.a)(u),"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:l}),u}return Object(f.a)(i,[{key:"path",value:function(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}},{key:"addBounds",value:function(e){var t=Object(b.y)(this.cx,this.cy,this.startAngle*b.z,this.endAngle*b.z,this.radius);Z(e,{x:t.left,y:t.top}),Z(e,{x:t.right,y:t.bottom})}}]),i}($),ue=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r,o){var l;return Object(h.a)(this,i),l=t.call(this),Object.defineProperty(Object(s.a)(l),"x1",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(l),"y1",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(l),"x2",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(l),"y2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Object(s.a)(l),"radius",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return Object(f.a)(i,[{key:"path",value:function(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}},{key:"addBounds",value:function(e){}}]),i}($),ce=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(h.a)(this,i),a=t.call(this),Object.defineProperty(Object(s.a)(a),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(a),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),a}return Object(f.a)(i,[{key:"path",value:function(e){e.lineTo(this.x,this.y)}},{key:"addBounds",value:function(e){Z(e,{x:this.x,y:this.y})}}]),i}($),de=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(h.a)(this,i),a=t.call(this),Object.defineProperty(Object(s.a)(a),"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(a),"y",{enumerable:!0,configurable:!0,writable:!0,value:n}),a}return Object(f.a)(i,[{key:"path",value:function(e){e.moveTo(this.x,this.y)}},{key:"addBounds",value:function(e){Z(e,{x:this.x,y:this.y})}}]),i}($),he=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){return Object(h.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"path",value:function(e){e.closePath()}}]),i}($),fe=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r,o,l){var u;return Object(h.a)(this,i),u=t.call(this),Object.defineProperty(Object(s.a)(u),"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(u),"cpY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(u),"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(u),"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Object(s.a)(u),"toX",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(Object(s.a)(u),"toY",{enumerable:!0,configurable:!0,writable:!0,value:l}),u}return Object(f.a)(i,[{key:"path",value:function(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}},{key:"addBounds",value:function(e){Z(e,{x:this.cpX,y:this.cpY}),Z(e,{x:this.cpX2,y:this.cpY2}),Z(e,{x:this.toX,y:this.toY})}}]),i}($),be=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r){var o;return Object(h.a)(this,i),o=t.call(this),Object.defineProperty(Object(s.a)(o),"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(o),"cpY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(o),"toX",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(o),"toY",{enumerable:!0,configurable:!0,writable:!0,value:r}),o}return Object(f.a)(i,[{key:"path",value:function(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}},{key:"addBounds",value:function(e){Z(e,{x:this.cpX,y:this.cpY}),Z(e,{x:this.toX,y:this.toY})}}]),i}($),pe=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r,o){var l;return Object(h.a)(this,i),l=t.call(this),Object.defineProperty(Object(s.a)(l),"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(l),"blur",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(l),"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(l),"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Object(s.a)(l),"opacity",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return Object(f.a)(i,[{key:"colorize",value:function(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}}]),i}($),ve=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a,r,o){var l;return Object(h.a)(this,i),l=t.call(this),Object.defineProperty(Object(s.a)(l),"image",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(Object(s.a)(l),"width",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(Object(s.a)(l),"height",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(Object(s.a)(l),"x",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(Object(s.a)(l),"y",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return Object(f.a)(i,[{key:"path",value:function(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}},{key:"addBounds",value:function(e){Z(e,{x:this.x,y:this.y}),Z(e,{x:this.width,y:this.height})}}]),i}($),ye=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){var e;return Object(h.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(s.a)(e),"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(s.a)(e),"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:b.o.NORMAL}),Object.defineProperty(Object(s.a)(e),"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(e),"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(e),"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return Object(f.a)(i,[{key:"clear",value:function(){Object(l.a)(Object(u.a)(i.prototype),"clear",this).call(this),this._operations.length=0}},{key:"_pushOp",value:function(e){this._operations.push(e)}},{key:"beginFill",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._fillAlpha=t,e?e instanceof b.d?this._pushOp(new J(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new J(e))):this._pushOp(new J("rgba(0, 0, 0, "+t+")"))}},{key:"endFill",value:function(){this._pushOp(new ee(this._hasShadows))}},{key:"endStroke",value:function(){this._pushOp(new te)}},{key:"beginPath",value:function(){this._pushOp(new Q)}},{key:"lineStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0;this._strokeAlpha=i,t?t instanceof b.d?this._pushOp(new ie(e,t.toCSS(i),n)):this._pushOp(new ie(e,t,n)):this._pushOp(new ie(e,"rgba(0, 0, 0, "+i+")",n))}},{key:"setLineDash",value:function(e){this._pushOp(new ne(e||[]))}},{key:"setLineDashOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._pushOp(new ae(e))}},{key:"drawRect",value:function(e,t,i,n){this._pushOp(new re(e,t,i,n))}},{key:"drawCircle",value:function(e,t,i){this._pushOp(new oe(e,t,i))}},{key:"drawEllipse",value:function(e,t,i,n){this._pushOp(new se(e,t,i,n))}},{key:"arc",value:function(e,t,i,n,a){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this._pushOp(new le(e,t,i,n,a,r))}},{key:"arcTo",value:function(e,t,i,n,a){this._pushOp(new ue(e,t,i,n,a))}},{key:"lineTo",value:function(e,t){this._pushOp(new ce(e,t))}},{key:"moveTo",value:function(e,t){this._pushOp(new de(e,t))}},{key:"bezierCurveTo",value:function(e,t,i,n,a,r){this._pushOp(new fe(e,t,i,n,a,r))}},{key:"quadraticCurveTo",value:function(e,t,i,n){this._pushOp(new be(e,t,i,n))}},{key:"closePath",value:function(){this._pushOp(new he)}},{key:"shadow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;this._hasShadows=!0,this._pushOp(new pe(a?e.toCSS(a):e.toCSS(this._fillAlpha||this._strokeAlpha),t,i,n))}},{key:"image",value:function(e,t,i,n,a){this._pushOp(new ve(e,t,i,n,a))}},{key:"svgPath",value:function(e){for(var t,i=this,n=0,a=0,r=null,o=null,s=null,l=null,u=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,c=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;null!==(t=u.exec(e));){for(var d=t[1],h=t[2],f=[];null!==(t=c.exec(h));)f.push(t[1]);switch("S"!==d&&"s"!==d&&"C"!==d&&"c"!==d&&(r=null,o=null),"Q"!==d&&"q"!==d&&"T"!==d&&"t"!==d&&(s=null,l=null),d){case"M":z(d,f.length,2),n=+f[0],a=+f[1],this.moveTo(n,a);for(var p=2;p<f.length;p+=2)n=+f[p],a=+f[p+1],this.lineTo(n,a);break;case"m":z(d,f.length,2),n+=+f[0],a+=+f[1],this.moveTo(n,a);for(var v=2;v<f.length;v+=2)n+=+f[v],a+=+f[v+1],this.lineTo(n,a);break;case"L":z(d,f.length,2);for(var y=0;y<f.length;y+=2)n=+f[y],a=+f[y+1],this.lineTo(n,a);break;case"l":z(d,f.length,2);for(var g=0;g<f.length;g+=2)n+=+f[g],a+=+f[g+1],this.lineTo(n,a);break;case"H":N(d,f.length,1);for(var m=0;m<f.length;++m)n=+f[m],this.lineTo(n,a);break;case"h":N(d,f.length,1);for(var _=0;_<f.length;++_)n+=+f[_],this.lineTo(n,a);break;case"V":N(d,f.length,1);for(var O=0;O<f.length;++O)a=+f[O],this.lineTo(n,a);break;case"v":N(d,f.length,1);for(var j=0;j<f.length;++j)a+=+f[j],this.lineTo(n,a);break;case"C":z(d,f.length,6);for(var w=0;w<f.length;w+=6){var k=+f[w],x=+f[w+1];r=+f[w+2],o=+f[w+3],n=+f[w+4],a=+f[w+5],this.bezierCurveTo(k,x,r,o,n,a)}break;case"c":z(d,f.length,6);for(var M=0;M<f.length;M+=6){var P=+f[M]+n,C=+f[M+1]+a;r=+f[M+2]+n,o=+f[M+3]+a,n+=+f[M+4],a+=+f[M+5],this.bezierCurveTo(P,C,r,o,n,a)}break;case"S":z(d,f.length,4),null!==r&&null!==o||(r=n,o=a);for(var A=0;A<f.length;A+=4){var T=2*n-r,I=2*a-o;r=+f[A],o=+f[A+1],n=+f[A+2],a=+f[A+3],this.bezierCurveTo(T,I,r,o,n,a)}break;case"s":z(d,f.length,4),null!==r&&null!==o||(r=n,o=a);for(var D=0;D<f.length;D+=4){var F=2*n-r,E=2*a-o;r=+f[D]+n,o=+f[D+1]+a,n+=+f[D+2],a+=+f[D+3],this.bezierCurveTo(F,E,r,o,n,a)}break;case"Q":z(d,f.length,4);for(var S=0;S<f.length;S+=4)s=+f[S],l=+f[S+1],n=+f[S+2],a=+f[S+3],this.quadraticCurveTo(s,l,n,a);break;case"q":z(d,f.length,4);for(var L=0;L<f.length;L+=4)s=+f[L]+n,l=+f[L+1]+a,n+=+f[L+2],a+=+f[L+3],this.quadraticCurveTo(s,l,n,a);break;case"T":z(d,f.length,2),null!==s&&null!==l||(s=n,l=a);for(var W=0;W<f.length;W+=2)s=2*n-s,l=2*a-l,n=+f[W],a=+f[W+1],this.quadraticCurveTo(s,l,n,a);break;case"t":z(d,f.length,2),null!==s&&null!==l||(s=n,l=a);for(var U=0;U<f.length;U+=2)s=2*n-s,l=2*a-l,n+=+f[U],a+=+f[U+1],this.quadraticCurveTo(s,l,n,a);break;case"A":case"a":var Y="a"===d;H(f),z(d,f.length,7);for(var q=0;q<f.length;q+=7){var G=+f[q+5],X=+f[q+6];Y&&(G+=n,X+=a);var K=B({px:n,py:a,rx:+f[q],ry:+f[q+1],xAxisRotation:+f[q+2],largeArcFlag:V(+f[q+3]),sweepFlag:V(+f[q+4]),cx:G,cy:X});Object(b.Cb)(K,(function(e){i.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),n=e.x,a=e.y}))}break;case"Z":case"z":R(d,f.length,0),this.closePath()}}}},{key:"_runPath",value:function(e){e.beginPath(),Object(b.Cb)(this._operations,(function(t){t.path(e)}))}},{key:"_render",value:function(e){Object(l.a)(Object(u.a)(i.prototype),"_render",this).call(this,e);var t=this._layer||e,n=t.dirty,a=this._isInteractive();if(n||a){var r,o=t.context,s=this._renderer._ghostLayer.context;n&&(o.globalCompositeOperation=this.blendMode,o.beginPath()),a&&(s.beginPath(),r=this._getColorId()),Object(b.Cb)(this._operations,(function(e){n&&(e.path(o),e.colorize(o,void 0)),a&&(e.path(s),e.colorize(s,r))}))}}},{key:"renderDetached",value:function(e){if(this.visible){this._setMatrix(),e.save();var t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),Object(b.Cb)(this._operations,(function(t){t.path(e),t.colorize(e,void 0)})),e.restore()}}},{key:"_addBounds",value:function(e){this.visible&&this.isMeasured&&Object(b.Cb)(this._operations,(function(t){t.addBounds(e)}))}}]),i}(X),ge=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n,a){var r;return Object(h.a)(this,i),r=t.call(this,e),Object.defineProperty(Object(s.a)(r),"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(r),"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(r),"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(Object(s.a)(r),"textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(s.a)(r),"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(r),"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),r.text=n,r.style=a,r}return Object(f.a)(i,[{key:"invalidateBounds",value:function(){Object(l.a)(Object(u.a)(i.prototype),"invalidateBounds",this).call(this),this._textInfo=void 0}},{key:"_shared",value:function(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}},{key:"_prerender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(l.a)(Object(u.a)(i.prototype),"_render",this).call(this,e);var a=e.context,r=this._renderer._ghostLayer.context,o=this.style,s=this._getFontStyle(void 0,n);a.font=s,this._isInteractive()&&!t&&(r.font=s),o.fill&&(o.fill instanceof b.d?a.fillStyle=o.fill.toCSS(null!=o.fillOpacity?o.fillOpacity:1):a.fillStyle=o.fill),o.shadowColor&&(e.context.shadowColor=o.shadowColor.toCSS(o.shadowOpacity||1)),o.shadowBlur&&(e.context.shadowBlur=o.shadowBlur),o.shadowOffsetX&&(e.context.shadowOffsetX=o.shadowOffsetX),o.shadowOffsetY&&(e.context.shadowOffsetY=o.shadowOffsetY),this._shared(a),this._isInteractive()&&!t&&(r.fillStyle=this._getColorId(),this._shared(r))}},{key:"_getFontStyle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.style,n=[];return e&&e.fontVariant?n.push(e.fontVariant):i.fontVariant&&n.push(i.fontVariant),t||(e&&e.fontWeight?n.push(e.fontWeight):i.fontWeight&&n.push(i.fontWeight)),e&&e.fontStyle?n.push(e.fontStyle):i.fontStyle&&n.push(i.fontStyle),e&&e.fontSize?(Object(b.Eb)(e.fontSize)&&(e.fontSize=e.fontSize+"px"),n.push(e.fontSize)):i.fontSize&&(Object(b.Eb)(i.fontSize)&&(i.fontSize=i.fontSize+"px"),n.push(i.fontSize)),e&&e.fontFamily?n.push(e.fontFamily):i.fontFamily?n.push(i.fontFamily):n.length&&n.push("Arial"),n.join(" ")}},{key:"_render",value:function(e){var t=this,i=this._layer||e;if(this._textInfo||this._measure(i),this.textVisible){var n=this._isInteractive(),a=i.context,r=i.dirty,o=this._renderer._ghostLayer.context;a.save(),o.save(),this._prerender(i),Object(b.Cb)(this._textInfo,(function(e,i){Object(b.Cb)(e.textChunks,(function(i,s){if(i.style&&(a.save(),o.save(),a.font=i.style,t._isInteractive()&&(o.font=i.style)),i.fill&&(a.save(),a.fillStyle=i.fill.toCSS()),r&&a.fillText(i.text,i.offsetX,e.offsetY+i.offsetY),"underline"==i.textDecoration||"line-through"==i.textDecoration){var l,u=1,c=1,d=i.height,h=i.offsetX;switch(t.style.textAlign){case"right":case"end":h-=i.width;break;case"center":h-=i.width/2}if(i.style)switch(b.u.getTextStyle(i.style).fontWeight){case"bolder":case"bold":case"700":case"800":case"900":u=2}d&&(c=d/20),l="line-through"==i.textDecoration?u+e.offsetY+i.offsetY-i.height/2:u+1.5*c+e.offsetY+i.offsetY,a.save(),a.beginPath(),i.fill?a.strokeStyle=i.fill.toCSS():t.style.fill&&t.style.fill instanceof b.d&&(a.strokeStyle=t.style.fill.toCSS()),a.lineWidth=u*c,a.moveTo(h,l),a.lineTo(h+i.width,l),a.stroke(),a.restore()}n&&t.interactive&&o.fillText(i.text,i.offsetX,e.offsetY+i.offsetY),i.fill&&a.restore(),i.style&&(a.restore(),o.restore())}))})),a.restore(),o.restore()}}},{key:"_addBounds",value:function(e){if(this.visible&&this.isMeasured){var t=this._measure(this.getLayer());Z(e,{x:t.left,y:t.top}),Z(e,{x:t.right,y:t.bottom})}}},{key:"_ignoreFontWeight",value:function(){return/apple/i.test(navigator.vendor)}},{key:"_measure",value:function(e){var t=this,i=e.context,n=this._renderer._ghostLayer.context,a="rtl"==this.style.direction;this._textInfo=[];var r=this.style.oversizedBehavior,o=this.style.maxWidth,s=Object(b.Eb)(o)&&"truncate"==r,l=Object(b.Eb)(o)&&("wrap"==r||"wrap-no-break"==r);i.save(),n.save(),this._prerender(e,!0,this._ignoreFontWeight());var u,c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",d=this.text.toString().replace(/\r/g,"").split(/\n/),h=!0,f=0,p=0,v=0;Object(b.Cb)(d,(function(e,a){var r,d=function(){var e,a={offsetY:v,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]},d=t._measureText(c,i),y=d.actualBoundingBoxAscent+d.actualBoundingBoxDescent;a.height=y,a.ascent=d.actualBoundingBoxAscent;var g,m,_,O=t.style.textDecoration,j=!1,w=!0,k=[];Object(b.p)(r,(function(d,f){if("format"==d.type)if("[/]"==d.text)h||(i.restore(),n.restore(),h=!0),g=void 0,u=void 0,m=void 0,O=t.style.textDecoration,_=void 0,e=d.text;else{h||(i.restore(),n.restore());var p=b.u.getTextStyle(d.text),v=t._getFontStyle(p);i.save(),n.save(),i.font=v,u=v,e=d.text,p.textDecoration&&(O=p.textDecoration),p.fill&&(g=p.fill),p.width&&(m=Object(b.Sb)(p.width)),p.verticalAlign&&(_=p.verticalAlign),h=!1;var y=t._measureText(c,i),x=y.actualBoundingBoxAscent+y.actualBoundingBoxDescent;x>a.height&&(a.height=x),y.actualBoundingBoxAscent>a.ascent&&(a.ascent=y.actualBoundingBoxAscent)}else if("value"==d.type&&!j){var M=t._measureText(d.text,i),P=M.actualBoundingBoxLeft+M.actualBoundingBoxRight;if(s){var C=w||t.style.breakWords||!1,A=t.style.ellipsis||"",T=t._measureText(A,i),I=T.actualBoundingBoxLeft+T.actualBoundingBoxRight;if(a.width+P>o){var D=o-a.width-I;d.text=t._truncateText(i,d.text,D,C),d.text+=A,j=!0}}else if(l&&a.width+P>o){var F=o-a.width,E=t._truncateText(i,d.text,F,!1,w&&"wrap-no-break"!=t.style.oversizedBehavior);if(""==E)return t.textVisible=!0,!1;k=r.slice(f+1),Object(b.A)(E)!=Object(b.A)(d.text)&&(k.unshift({type:"value",text:d.text.substr(E.length)}),e&&k.unshift({type:"format",text:e})),d.text=Object(b.A)(E),r=[],j=!0}var S=1,L=1;if(u&&m&&m>P){var B=P/m;switch(t.style.textAlign){case"right":case"end":S=B;break;case"center":S=B,L=B;break;default:L=B}P=m}var R=M.actualBoundingBoxAscent+M.actualBoundingBoxDescent;R>a.height&&(a.height=R),M.actualBoundingBoxAscent>a.ascent&&(a.ascent=M.actualBoundingBoxAscent),a.width+=P,a.left+=M.actualBoundingBoxLeft/S,a.right+=M.actualBoundingBoxRight/L,a.textChunks.push({style:u,fill:g,text:d.text,width:P,height:R,left:M.actualBoundingBoxLeft,right:M.actualBoundingBoxRight,ascent:M.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:O,verticalAlign:_}),w=!1}return!0})),t.style.lineHeight instanceof b.r?(a.height*=t.style.lineHeight.value,a.ascent*=t.style.lineHeight.value):(a.height*=t.style.lineHeight||1.2,a.ascent*=t.style.lineHeight||1.2),f<a.left&&(f=a.left),p<a.right&&(p=a.right),t._textInfo.push(a),v+=a.height,r=k||[]};for(r=""==e?[{type:"value",text:""}]:b.u.chunk(e,!1,t.style.ignoreFormatting);r.length>0;)d()})),h||(i.restore(),n.restore()),Object(b.Cb)(this._textInfo,(function(e,i){var n=0;Object(b.Cb)(e.textChunks,(function(i){if(i.offsetX=n+i.left-e.left,i.offsetY+=e.height-e.height*(t.style.baselineRatio||.19),n+=i.width,i.verticalAlign)switch(i.verticalAlign){case"super":i.offsetY-=e.height/2-i.height/2;break;case"sub":i.offsetY+=i.height/2}}))}));var y={left:a?-p:-f,top:0,right:a?f:p,bottom:v};if("none"!==r){var g=this._fitRatio(y);if(g<1)if("fit"==r)Object(b.Eb)(this.style.minScale)&&g<this.style.minScale?(this.textVisible=!1,y.left=0,y.top=0,y.right=0,y.bottom=0):(this._originalScale&&1!=this._originalScale||(this._originalScale=this.scale),this.scale=g,this.textVisible=!0);else if("hide"==r)this.textVisible=!1,y.left=0,y.top=0,y.right=0,y.bottom=0;else{switch(this.style.textAlign){case"right":case"end":y.left=-o,y.right=0;break;case"center":y.left=-o/2,y.right=o/2;break;default:y.left=0,y.right=o}this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}else this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}return i.restore(),n.restore(),y}},{key:"_fitRatio",value:function(e){var t=this.style.maxWidth,i=this.style.maxHeight;if(!Object(b.Eb)(t)&&!Object(b.Eb)(i))return 1;var n=e.right-e.left,a=e.bottom-e.top;return Math.min(t/n||1,i/a||1)}},{key:"_truncateText",value:function(e,t,i){var n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];do{if(a)t=t.slice(0,-1);else{var o=t.replace(/[^,;:!?\\\/\s]+[,;:!?\\\/\s]*$/g,"");if(""==o&&r)a=!0;else{if(""==o)return t;t=o}}var s=this._measureText(t,e);n=s.actualBoundingBoxLeft+s.actualBoundingBoxRight}while(n>i&&""!=t);return t}},{key:"_measureText",value:function(e,t){var i=t.measureText(e),n={};if(null==i.actualBoundingBoxAscent){var a=document.createElement("div");a.innerText=e,a.style.visibility="hidden",a.style.position="absolute",a.style.top="-1000000px;",a.style.fontFamily=this.style.fontFamily||"",a.style.fontSize=this.style.fontSize+"",document.body.appendChild(a);var r=a.getBoundingClientRect();document.body.removeChild(a);var o=r.height,s=i.width;n={actualBoundingBoxAscent:o,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:s,fontBoundingBoxAscent:o,fontBoundingBoxDescent:0,width:s}}else n={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};var l=i.width;switch(this.style.textAlign){case"right":case"end":n.actualBoundingBoxLeft=l,n.actualBoundingBoxRight=0;break;case"center":n.actualBoundingBoxLeft=l/2,n.actualBoundingBoxRight=l/2;break;default:n.actualBoundingBoxLeft=0,n.actualBoundingBoxRight=l}return n}}]),i}(X),me=Object(f.a)((function e(){Object(h.a)(this,e),Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:Object(b.s)(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"\u2026"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})})),_e=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){var e;return Object(h.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(s.a)(e),"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty(Object(s.a)(e),"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(e),"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(e),"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(e),"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty(Object(s.a)(e),"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(e),"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return Object(f.a)(i,[{key:"_render",value:function(e){"circular"===this.textType?this._renderCircular(e):Object(l.a)(Object(u.a)(i.prototype),"_render",this).call(this,e)}},{key:"_renderCircular",value:function(e){if(this.textVisible){var t=this._layer||e;this._prerender(t);var i=this._isInteractive(),n=t.context,a=t.dirty,r=this._renderer._ghostLayer.context;n.save(),i&&r.save(),this._textInfo||this._measure(t);var o=this.radius||0,s=this.startAngle||0,l=0,u=this.orientation,c="auto"==u?"auto":"inward"==u,d=this.inside,h=this.style.textAlign||"left",f=this.kerning||0,p="left"==h?1:-1,v=!this._textReversed;if("auto"==c){var y=0,g=0;Object(b.Cb)(this._textInfo,(function(e,t){var i=s+e.width/(o-e.height)/2*-p;i>y&&(y=i)})),g="left"==h?(y+l/2)*b.z:"right"==h?(y-l/2)*b.z:s*b.z,g=Object(b.t)(g),c=g>=270||g<=90}1==c&&v&&(this._textInfo.reverse(),this._textReversed=!0),Object(b.Cb)(this._textInfo,(function(e,t){var u=e.height;d||(o+=u),(-1==p&&c||1==p&&!c)&&v&&e.textChunks.reverse();var y=s;l=0,"center"==h&&(y+=e.width/(o-u)/2*-p,l=y-s),y+=Math.PI*(c?0:1),n.save(),i&&r.save(),n.rotate(y),i&&r.rotate(y);var g=0;Object(b.Cb)(e.textChunks,(function(e,t){var s=e.text,l=e.width;g=l/2/(o-u)*p,n.rotate(g),i&&r.rotate(g),e.style&&(n.save(),r.save(),n.font=e.style,i&&(r.font=e.style)),e.fill&&(n.save(),n.fillStyle=e.fill.toCSS()),n.textBaseline="middle",n.textAlign="center",i&&(r.textBaseline="middle",r.textAlign="center"),a&&n.fillText(s,0,(c?1:-1)*(0-o+u/2)),i&&r.fillText(s,0,(c?1:-1)*(0-o+u/2)),e.fill&&n.restore(),e.style&&(n.restore(),r.restore()),g=(l/2+f)/(o-u)*p,n.rotate(g),i&&r.rotate(g)})),n.restore(),i&&r.restore(),d&&(o-=u)})),n.restore(),i&&r.restore()}}},{key:"_measure",value:function(e){return"circular"===this.textType?this._measureCircular(e):Object(l.a)(Object(u.a)(i.prototype),"_measure",this).call(this,e)}},{key:"_measureCircular",value:function(e){var t,i=this,n=e.context,a=this._renderer._ghostLayer.context,r="rtl"==this.style.direction,o=this.style.oversizedBehavior,s=this.style.maxWidth,l=Object(b.Eb)(s)&&"truncate"==o,u=this.style.ellipsis||"";this.textVisible=!0,this._textInfo=[],this._textReversed=!1,n.save(),a.save(),this._prerender(e,!0);var c=this.text.toString().replace(/\r/g,"").split(/\n/),d=!0,h=0,f=0;return Object(b.Cb)(c,(function(e,o){var c,p,v,y=b.u.chunk(e,!1,i.style.ignoreFormatting),g={offsetY:f,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};Object(b.Cb)(y,(function(e,o){if("format"==e.type){if("[/]"==e.text)d||(n.restore(),a.restore(),d=!0),p=void 0,c=void 0,v=void 0;else{var f=b.u.getTextStyle(e.text),y=i._getFontStyle(f);n.save(),a.save(),n.font=y,c=y,f.fill&&(p=f.fill),f.width&&(v=Object(b.Sb)(f.width)),d=!1}l&&(t=i._measureText(u,n))}else if("value"==e.type){var m=e.text.match(/(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g)||[];r&&m.reverse();for(var _=0;_<m.length;_++){var O=m[_],j=i._measureText(O,n),w=j.width;c&&v&&v>w&&(w=v);var k=j.actualBoundingBoxAscent+j.actualBoundingBoxDescent;if(k>g.height&&(g.height=k),j.actualBoundingBoxAscent>g.ascent&&(g.ascent=j.actualBoundingBoxAscent),g.width+=w,g.left+=j.actualBoundingBoxLeft,g.right+=j.actualBoundingBoxRight,g.textChunks.push({style:c,fill:p,text:O,width:w,height:k+j.actualBoundingBoxDescent,left:j.actualBoundingBoxLeft,right:j.actualBoundingBoxRight,ascent:j.actualBoundingBoxAscent,offsetX:0,offsetY:k,textDecoration:void 0}),h+=w,l){t||(t=i._measureText(u,n));var x=t.actualBoundingBoxLeft+t.actualBoundingBoxRight;if((h+=x)+x>s){1==g.textChunks.length?i.textVisible=!1:(g.width+=x,g.left+=t.actualBoundingBoxLeft,g.right+=t.actualBoundingBoxRight,g.textChunks.push({style:c,fill:p,text:u,width:x,height:k+t.actualBoundingBoxDescent,left:t.actualBoundingBoxLeft,right:t.actualBoundingBoxRight,ascent:t.actualBoundingBoxAscent,offsetX:0,offsetY:k,textDecoration:void 0}));break}}if(r)break}}})),i.style.lineHeight instanceof b.r?g.height*=i.style.lineHeight.value:g.height*=i.style.lineHeight||1.2,i._textInfo.push(g),f+=g.height})),d||(n.restore(),a.restore()),"hide"==o&&h>s&&(this.textVisible=!1),Object(b.Cb)(this._textInfo,(function(e){Object(b.Cb)(e.textChunks,(function(t){t.offsetY+=Math.round((e.height-t.height+(e.ascent-t.ascent))/2)}))})),n.restore(),a.restore(),{left:0,top:0,right:0,bottom:0}}}]),i}(ge),Oe=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(h.a)(this,i),a=t.call(this,e),Object.defineProperty(Object(s.a)(a),"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(a),"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.image=n,a}return Object(f.a)(i,[{key:"_dispose",value:function(){Object(l.a)(Object(u.a)(i.prototype),"_dispose",this).call(this),this._imageMask&&q(this._imageMask)}},{key:"getLocalBounds",value:function(){if(!this._localBounds){var e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}},{key:"_render",value:function(e){if(Object(l.a)(Object(u.a)(i.prototype),"_render",this).call(this,e),this.image){var t=this._layer||e;if(void 0===this.tainted&&(this.tainted=Y(this.image),t.tainted=!0),this.tainted&&this._renderer._omitTainted)return;if(t.dirty){this.shadowColor&&(t.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(t.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(t.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(t.context.shadowOffsetY=this.shadowOffsetY);var n=this.width||this.image.naturalWidth,a=this.height||this.image.naturalHeight;t.context.drawImage(this.image,0,0,n,a)}if(this.interactive&&this._isInteractive()){var r=this._getMask(this.image);this._renderer._ghostLayer.context.drawImage(r,0,0)}}}},{key:"clear",value:function(){Object(l.a)(Object(u.a)(i.prototype),"clear",this).call(this),this.image=void 0,this._imageMask=void 0}},{key:"_getMask",value:function(e){if(void 0===this._imageMask){var t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,n=document.createElement("canvas");n.width=t,n.height=i;var a=n.getContext("2d");a.imageSmoothingEnabled=!1,a.fillStyle=this._getColorId(),a.fillRect(0,0,t,i),Y(e)||(a.globalCompositeOperation="destination-in",a.drawImage(e,0,0,t,i)),this._imageMask=n}return this._imageMask}}]),i}(X),je=Object(f.a)((function e(t,i,n,a){Object(h.a)(this,e),Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"originalPoint",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object(b.Wb)("touchevents")&&t instanceof Touch?this.id=t.identifier:this.id=null})),we=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;if(Object(h.a)(this,i),n=t.call(this),Object.defineProperty(Object(s.a)(n),"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(Object(s.a)(n),"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(Object(s.a)(n),"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(s.a)(n),"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(s.a)(n),"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:n.getLayer(0)}),Object.defineProperty(Object(s.a)(n),"_ghostLayer",{enumerable:!0,configurable:!0,writable:!0,value:new ke}),Object.defineProperty(Object(s.a)(n),"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty(Object(s.a)(n),"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:n._patternCanvas.getContext("2d")}),Object.defineProperty(Object(s.a)(n),"_domWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"_domHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"_canvasWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"_canvasHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(s.a)(n),"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(s.a)(n),"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(s.a)(n),"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(s.a)(n),"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(s.a)(n),"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(Object(s.a)(n),"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(s.a)(n),"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(s.a)(n),"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(s.a)(n),"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(Object(s.a)(n),"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(s.a)(n),"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.resolution=null!==e&&void 0!==e?e:window.devicePixelRatio,n.view.style.position="absolute",n.view.appendChild(n._layerDom),n._disposers.push(new b.e((function(){Object(b.Db)(n._events,(function(e,t){t.disposer.dispose()})),Object(b.Cb)(n.layers,(function(e){q(e.view),e.exportableView&&q(e.exportableView)})),q(n._ghostLayer.view),q(n._patternCanvas)}))),n._disposers.push(Object(b.Mb)((function(){null==e&&(n.resolution=window.devicePixelRatio)}))),Object(b.Wb)("touchevents")){var a=function(e){0!==n._dragging.length&&Object(b.p)(n._dragging,(function(t){return!t.value.shouldCancelTouch()||(e.preventDefault(),!1)})),n._touchActiveTimeout&&n._delayTouchDeactivate()};n._disposers.push(Object(b.Xb)(window,"touchstart",a,{passive:!1})),n._disposers.push(Object(b.Xb)(n.view,"touchstart",a,{passive:!1})),n._disposers.push(Object(b.Xb)(n.view,"touchmove",(function(){n._touchActiveTimeout&&n._delayTouchDeactivate()}),{passive:!0})),n._disposers.push(Object(b.Xb)(window,"click",(function(e){n._touchActive=!1}),{passive:!0})),n._disposers.push(Object(b.Xb)(n.view,"click",(function(e){window.setTimeout((function(){n._touchActive=!0,n._delayTouchDeactivate()}),100)}),{passive:!0}))}return Object(b.Wb)("wheelevents")&&n._disposers.push(Object(b.Xb)(n.view,"wheel",(function(e){var t=!1;n._hovering.forEach((function(e){if(e.wheelable)return t=!0,!1})),t&&e.preventDefault()}),{passive:!1})),Object(o.a)(n)}return Object(f.a)(i,[{key:"_delayTouchDeactivate",value:function(){var e=this;this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout((function(){e._touchActive=!1}),this.tapToActivateTimeout))}},{key:"debugGhostView",get:function(){return!!this._ghostLayer.view.parentNode},set:function(e){e?this._ghostLayer.view.parentNode||this.view.appendChild(this._ghostLayer.view):this._ghostLayer.view.parentNode&&this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view)}},{key:"createLinearGradient",value:function(e,t,i,n){return this.defaultLayer.context.createLinearGradient(e,t,i,n)}},{key:"createRadialGradient",value:function(e,t,i,n,a,r){return this.defaultLayer.context.createRadialGradient(e,t,i,n,a,r)}},{key:"createPattern",value:function(e,t,i,n,a){return this._patternCanvas.width=n,this._patternCanvas.height=a,this._patternContext.clearRect(0,0,n,a),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}},{key:"makeContainer",value:function(){return new K(this)}},{key:"makeGraphics",value:function(){return new ye(this)}},{key:"makeText",value:function(e,t){return new ge(this,e,t)}},{key:"makeTextStyle",value:function(){return new me}},{key:"makeRadialText",value:function(e,t){return new _e(this,e,t)}},{key:"makePicture",value:function(e){return new Oe(this,e)}},{key:"resizeLayer",value:function(e){e.resize(this._canvasWidth,this._canvasHeight,this._domWidth,this._domHeight,this.resolution)}},{key:"resizeGhost",value:function(){this._ghostLayer.resize(this._canvasWidth,this._canvasHeight,this._domWidth,this._domHeight,this.resolution)}},{key:"resize",value:function(e,t,i,n){var a=this;this._canvasWidth=e,this._canvasHeight=t,this._domWidth=i,this._domHeight=n,Object(b.Cb)(this.layers,(function(e){e&&(e.dirty=!0,a.resizeLayer(e))})),this.resizeGhost(),this.view.style.width=i+"px",this.view.style.height=n+"px"}},{key:"createDetachedLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e}),n=new xe(t,i);return t.style.position="absolute",t.style.top="0px",t.style.left="0px",n}},{key:"getLayerByOrder",value:function(e){for(var t=this.layers,i=t.length,n=0;n<i;n++){var a=t[n];if(a.order==e)return a}}},{key:"getLayer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getLayerByOrder(e);if(i)return i;var n=this.createDetachedLayer(99==e);n.order=e,n.visible=t,n.visible&&this.resizeLayer(n);var a=this.layers;a.push(n),a.sort((function(e,t){return e.order>t.order?1:e.order<t.order?-1:0}));for(var r,o=a.length,s=Object(b.c)(a,n)+1;s<o;s++)if(a[s].visible){r=a[s];break}return n.visible&&(void 0===r?this._layerDom.appendChild(n.view):this._layerDom.insertBefore(n.view,r.view)),n}},{key:"render",value:function(e){var t=this;if(this._dirtyLayers.length=0,Object(b.Cb)(this.layers,(function(e){e&&e.dirty&&e.visible&&(t._dirtyLayers.push(e),e.clear())})),this._ghostLayer.clear(),e.render(this.defaultLayer),this._ghostLayer.context.restore(),Object(b.Cb)(this.layers,(function(e){if(e){var t=e.context;t.beginPath(),t.moveTo(0,0),t.stroke()}})),Object(b.Cb)(this._dirtyLayers,(function(e){e.context.restore(),e.dirty=!1})),this._hovering.size&&this._lastPointerMoveEvent){var i=this._lastPointerMoveEvent,n=i.events,a=i.target,r=i.native;Object(b.Cb)(n,(function(e){t._dispatchGlobalMousemove(e,a,r)}))}}},{key:"paintId",value:function(e){var t=function(e){for(var t=[0,0,0],i=0;i<24;i++)t[i%3]<<=1,t[i%3]|=1&e,e>>=1;return(0|t[2])+(t[1]<<8)+(t[0]<<16)}(++this._colorId),i=b.d.fromHex(t).toCSS();return this._colorMap[i]=e,i}},{key:"_removeObject",value:function(e){void 0!==e._colorId&&delete this._colorMap[e._colorId]}},{key:"_adjustBoundingBox",value:function(e){var t=this._ghostLayer.margin;return new DOMRect(e.left-t.left,e.top-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}},{key:"getEvent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.view.getBoundingClientRect(),n={x:e.clientX||0,y:e.clientY||0},a={x:n.x-(t?i.left:0),y:n.y-(t?i.top:0)};return new je(e,n,a,this._adjustBoundingBox(i))}},{key:"_getHitTarget",value:function(e,t,i){if(!(0===t.width||0===t.height||e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom)&&i&&this._layerDom.contains(i)){var n=this._ghostLayer.getImageData(e,t);if(0===n.data[0]&&0===n.data[1]&&0===n.data[2])return!1;var a=b.d.fromRGB(n.data[0],n.data[1],n.data[2]).toCSS();return this._colorMap[a]}}},{key:"_withEvents",value:function(e,t){var i=this._events[e];if(void 0!==i){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,Object(b.Ib)(i.callbacks,(function(e){return!e.disposed})),0===i.callbacks.length&&(i.disposer.dispose(),delete this._events[e]))}}}},{key:"_dispatchEventAll",value:function(e,t){this.interactionsEnabled&&this._withEvents(e,(function(e){Object(b.Cb)(e.callbacks,(function(e){e.disposed||e.callback.call(e.context,t)}))}))}},{key:"_dispatchEvent",value:function(e,t,i){if(!this.interactionsEnabled)return!1;var n=!1;return this._withEvents(e,(function(e){Object(b.Cb)(e.callbacks,(function(e){e.disposed||e.object!==t||(e.callback.call(e.context,i),n=!0)}))})),n}},{key:"_dispatchMousedown",value:function(e,t){var i=this,n=e.button;if(0==n||2==n||1==n||void 0===n){var a=this.getEvent(e),r=this._getHitTarget(a.originalPoint,a.bbox,t);if(r){var o=a.id,s=!1;W(r,(function(e){var t={id:o,value:e};return i._mousedown.push(t),!s&&i._dispatchEvent("pointerdown",e,a)&&(s=!0,i._dragging.some((function(t){return t.value===e&&t.id===o}))||i._dragging.push(t)),!0}))}}}},{key:"_dispatchGlobalMousemove",value:function(e,t,i){var n=this,a=this.getEvent(e),r=this._getHitTarget(a.originalPoint,a.bbox,t);a.native=i,r?(this._hovering.forEach((function(e){e.contains(r)||(n._hovering.delete(e),e.cursorOverStyle&&Object(b.g)(document.body,"cursor",e._replacedCursorStyle),n._dispatchEvent("pointerout",e,a))})),a.native&&W(r,(function(e){return n._hovering.has(e)||(n._hovering.add(e),e.cursorOverStyle&&(e._replacedCursorStyle=Object(b.v)(document.body,"cursor"),Object(b.g)(document.body,"cursor",e.cursorOverStyle)),n._dispatchEvent("pointerover",e,a)),!0}))):(this._hovering.forEach((function(e){e.cursorOverStyle&&Object(b.g)(document.body,"cursor",e._replacedCursorStyle),n._dispatchEvent("pointerout",e,a)})),this._hovering.clear()),this._dispatchEventAll("globalpointermove",a)}},{key:"_dispatchGlobalMouseup",value:function(e,t){var i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}},{key:"_dispatchDragMove",value:function(e){var t=this;if(0!==this._dragging.length){var i=this.getEvent(e),n=i.id;this._dragging.forEach((function(e){e.id===n&&t._dispatchEvent("pointermove",e.value,i)}))}}},{key:"_dispatchDragEnd",value:function(e,t){var i,n=this,a=e.button;if(0==a||void 0===a)i="click";else if(2==a)i="rightclick";else{if(1!=a)return;i="middleclick"}var r=this.getEvent(e),o=r.id;if(0!==this._mousedown.length){var s=this._getHitTarget(r.originalPoint,r.bbox,t);s&&this._mousedown.forEach((function(e){e.id===o&&e.value.contains(s)&&n._dispatchEvent(i,e.value,r)})),this._mousedown.length=0}0!==this._dragging.length&&(this._dragging.forEach((function(e){e.id===o&&n._dispatchEvent("pointerup",e.value,r)})),this._dragging.length=0)}},{key:"_dispatchDoubleClick",value:function(e,t){var i=this,n=this.getEvent(e),a=this._getHitTarget(n.originalPoint,n.bbox,t);a&&W(a,(function(e){return!i._dispatchEvent("dblclick",e,n)}))}},{key:"_dispatchWheel",value:function(e,t){var i=this,n=this.getEvent(e),a=this._getHitTarget(n.originalPoint,n.bbox,t);a&&W(a,(function(e){return!i._dispatchEvent("wheel",e,n)}))}},{key:"_makeSharedEvent",value:function(e,t){var i=this;if(void 0===this._listeners[e]){var n=t();this._listeners[e]=new b.h((function(){delete i._listeners[e],n.dispose()}))}return this._listeners[e].increment()}},{key:"_onPointerEvent",value:function(e,t){var i=!1,n=null;function a(){n=null,i=!1}return new b.n([new b.e((function(){null!==n&&clearTimeout(n),a()})),Object(b.Xb)(this.view,Object(b.i)(e),(function(e){i=!0,null!==n&&clearTimeout(n),n=window.setTimeout(a,0)})),U(window,e,(function(e,a){null!==n&&(clearTimeout(n),n=null),t(e,a,i),i=!1}))])}},{key:"_initEvent",value:function(e){var t=this;switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",(function(){var e=function(e,i,n){t._lastPointerMoveEvent={events:e,target:i,native:n},Object(b.Cb)(e,(function(e){t._dispatchGlobalMousemove(e,i,n)}))};return new b.n([t._onPointerEvent("pointerdown",e),t._onPointerEvent("pointermove",e)])}));case"globalpointerup":return this._makeSharedEvent("pointerup",(function(){var e=t._onPointerEvent("pointerup",(function(e,i,n){Object(b.Cb)(e,(function(e){t._dispatchGlobalMouseup(e,n)})),t._lastPointerMoveEvent={events:e,target:i,native:n}})),i=t._onPointerEvent("pointercancel",(function(e,i,n){Object(b.Cb)(e,(function(e){t._dispatchGlobalMouseup(e,n)})),t._lastPointerMoveEvent={events:e,target:i,native:n}}));return new b.e((function(){e.dispose(),i.dispose()}))}));case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",(function(){var e=t._onPointerEvent("pointerdown",(function(e,i){Object(b.Cb)(e,(function(e){t._dispatchMousedown(e,i)}))})),i=t._onPointerEvent("pointermove",(function(e){Object(b.Cb)(e,(function(e){t._dispatchDragMove(e)}))})),n=t._onPointerEvent("pointerup",(function(e,i){Object(b.Cb)(e,(function(e){t._dispatchDragEnd(e,i)}))})),a=t._onPointerEvent("pointercancel",(function(e,i){Object(b.Cb)(e,(function(e){t._dispatchDragEnd(e,i)}))}));return new b.e((function(){e.dispose(),i.dispose(),n.dispose(),a.dispose()}))}));case"dblclick":return this._makeSharedEvent("dblclick",(function(){return t._onPointerEvent("dblclick",(function(e,i){Object(b.Cb)(e,(function(e){t._dispatchDoubleClick(e,i)}))}))}));case"wheel":return this._makeSharedEvent("wheel",(function(){return Object(b.Xb)(window,Object(b.i)("wheel"),(function(e){t._dispatchWheel(e,Object(b.j)(e))}),{passive:!1})}))}}},{key:"_addEvent",value:function(e,t,i,n){var a=this,r=this._events[t];void 0===r&&(r=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});var o={object:e,context:n,callback:i,disposed:!1};return r.callbacks.push(o),new b.e((function(){o.disposed=!0,r.dispatching?r.cleanup=!0:(Object(b.k)(r.callbacks,o),0===r.callbacks.length&&(r.disposer.dispose(),delete a._events[t]))}))}},{key:"getCanvas",value:function(e,t){var i=this;this.render(e),t||(t={});var n=this.resolution,a=Math.floor(this._canvasWidth*this.resolution),r=Math.floor(this._canvasHeight*this.resolution);if(t.minWidth&&t.minWidth>a){var o=t.minWidth/a;o>n&&(n=o*this.resolution)}if(t.minHeight&&t.minHeight>r){var s=t.minHeight/r;s>n&&(n=s*this.resolution)}if(t.maxWidth&&t.maxWidth<a){var l=t.maxWidth/a;l<n&&(n=l*this.resolution)}if(t.maxHeight&&t.maxHeight>r){var u=t.maxHeight/r;u<n&&(n=u*this.resolution)}t.maintainPixelRatio&&(n/=this.resolution);var c=[],d=!1,h=document.createElement("canvas");n!=this.resolution&&(d=!0,a=a*n/this.resolution,r=r*n/this.resolution),h.width=a,h.height=r,h.style.position="fixed",h.style.top="-10000px",this.view.appendChild(h),c.push(h);var f=h.getContext("2d"),p=0,v=0,y=!1;return Object(b.Cb)(this.layers,(function(e){if(e&&e.visible&&(e.tainted||d)){y=!0,e.exportableView=e.view,e.exportableContext=e.context,e.view=document.createElement("canvas"),e.view.style.position="fixed",e.view.style.top="-10000px",i.view.appendChild(e.view),c.push(e.view);var t=0,o=0;e.margin&&(t+=e.margin.left||0+e.margin.right||0,o+=e.margin.top||0+e.margin.bottom||0),e.view.width=a+t,e.view.height=r+o,e.context=e.view.getContext("2d"),e.dirty=!0,e.scale=n}})),y&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),Object(b.Cb)(this.layers,(function(e){if(e&&e.visible){var t=0,n=0;e.margin&&(t=-(e.margin.left||0)*i.resolution,n=-(e.margin.top||0)*i.resolution),f.drawImage(e.view,t,n),e.exportableView&&(e.view=e.exportableView,e.exportableView=void 0),e.exportableContext&&(e.context=e.exportableContext,e.exportableContext=void 0),p<e.view.clientWidth&&(p=e.view.clientWidth),v<e.view.clientHeight&&(v=e.view.clientHeight),e.scale=void 0}})),h.style.width=p+"px",h.style.height=v+"px",Object(b.Cb)(c,(function(e){e.style.position="",e.style.top="",i.view.removeChild(e)})),h}}]),i}(b.b),ke=function(){function e(){Object(h.a)(this,e),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px"}return Object(f.a)(e,[{key:"resize",value:function(e,t,i,n,a){e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px",this._width=Math.floor(e*a),this._height=Math.floor(t*a),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}},{key:"getImageData",value:function(e,t){return this.context.getImageData(Math.round((e.x-t.left)/t.width*this._width),Math.round((e.y-t.top)/t.height*this._height),1,1)}},{key:"setMargin",value:function(e){var t=this;this.margin.left=0,this.margin.right=0,this.margin.top=0,this.margin.bottom=0,Object(b.Cb)(e,(function(e){e.margin&&(t.margin.left=Math.max(t.margin.left,e.margin.left),t.margin.right=Math.max(t.margin.right,e.margin.right),t.margin.top=Math.max(t.margin.top,e.margin.top),t.margin.bottom=Math.max(t.margin.bottom,e.margin.bottom))}))}},{key:"clear",value:function(){this.context.save(),this.context.fillStyle="#000",this.context.fillRect(0,0,this._width,this._height)}}]),e}(),xe=function(){function e(t,i){Object(h.a)(this,e),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"order",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dirty",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportableView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exportableContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=t,this.context=i}return Object(f.a)(e,[{key:"resize",value:function(e,t,i,n,a){null!=this.width&&(e=this.width,i=this.width),null!=this.height&&(t=this.height,n=this.height),this.margin?(e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px"):(this.view.style.left="0px",this.view.style.top="0px"),this._width=Math.floor(e*a),this._height=Math.floor(t*a),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}},{key:"clear",value:function(){this.context.save(),this.context.clearRect(0,0,this._width,this._height)}}]),e}();function Me(e,t){null==e?requestAnimationFrame(t):setTimeout((function(){requestAnimationFrame(t)}),1e3/e)}var Pe=function(){function e(t){var i,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(Object(h.a)(this,e),Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyBounds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPositions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_ticker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tickers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_updateTick",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new b.B}),Object.defineProperty(this,"animationTime",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_animations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rootContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tooltipContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipContainerSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:T.new(this,{})}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:A}),Object.defineProperty(this,"utc",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timezone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numberFormatter",{enumerable:!0,configurable:!0,writable:!0,value:w.new(this,{})}),Object.defineProperty(this,"dateFormatter",{enumerable:!0,configurable:!0,writable:!0,value:P.new(this,{})}),Object.defineProperty(this,"durationFormatter",{enumerable:!0,configurable:!0,writable:!0,value:C.new(this,{})}),Object.defineProperty(this,"tabindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tabindexes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_a11yD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusedSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isShift",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_keyboardDragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_readerAlertElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_logo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDiv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nonce",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interfaceColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verticalLayout",{enumerable:!0,configurable:!0,writable:!0,value:b.a.new(this,{})}),Object.defineProperty(this,"horizontalLayout",{enumerable:!0,configurable:!0,writable:!0,value:b.D.new(this,{})}),Object.defineProperty(this,"gridLayout",{enumerable:!0,configurable:!0,writable:!0,value:b.E.new(this,{})}),Object.defineProperty(this,"_paused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"autoResize",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_fontHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_resizeSensorDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltips",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_htmlElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlEnabledContainers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),!r)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");if(this._settings=a,0==a.accessible&&(this._a11yD=!0),null==a.useSafeResolution&&(a.useSafeResolution=!0),a.useSafeResolution&&(i=Object(b.gb)()),this._renderer=new we(i),n=t instanceof HTMLElement?t:document.getElementById(t),Object(b.Cb)(b.F.rootElements,(function(e){if(e.dom===n)throw new Error("You cannot have multiple Roots on the same DOM node")})),this.interfaceColors=j.new(this,{}),null===n)throw new Error("Could not find HTML element with id `"+t+"`");this.dom=n;var o=document.createElement("div");o.style.position="relative",o.style.height="100%",n.appendChild(o);var s=a.tooltipContainerBounds;s&&(this._tooltipContainerSettings=s),this._inner=o,this._updateComputedStyles(),b.F.rootElements.push(this)}return Object(f.a)(e,[{key:"moveDOM",value:function(e){var t;if(t=e instanceof HTMLElement?e:document.getElementById(e)){for(;this.dom.childNodes.length>0;)t.appendChild(this.dom.childNodes[0]);this.dom=t,this._initResizeSensor(),this.resize()}}},{key:"_handleLogo",value:function(){if(this._logo){var e=this.dom.offsetWidth,t=this.dom.offsetHeight;e<=150||t<=60?this._logo.hide():this._logo.show()}}},{key:"_showBranding",value:function(){if(!this._logo){var e=this.tooltipContainer.children.push(b.G.new(this,{interactive:!0,interactiveChildren:!1,position:"absolute",setStateOnChildren:!0,paddingTop:9,paddingRight:9,paddingBottom:9,paddingLeft:9,scale:.6,y:Object(b.s)(100),centerY:b.H,tooltipText:"Created using amCharts 5",tooltipX:b.H,cursorOverStyle:"pointer",background:b.I.new(this,{fill:Object(b.J)(4671320),fillOpacity:0,tooltipY:5})})),t=p.a.new(this,{pointerOrientation:"horizontal",paddingTop:4,paddingRight:7,paddingBottom:4,paddingLeft:7});t.label.setAll({fontSize:12}),t.get("background").setAll({fill:this.interfaceColors.get("background"),stroke:this.interfaceColors.get("grid"),strokeOpacity:.3}),e.set("tooltip",t),e.events.on("click",(function(){window.open("https://www.amcharts.com/","_blank")})),e.states.create("hover",{}),e.children.push(b.K.new(this,{stroke:Object(b.J)(13421772),strokeWidth:3,svgPath:"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6"})).states.create("hover",{stroke:Object(b.J)(3976191)}),e.children.push(b.K.new(this,{stroke:Object(b.J)(8947848),strokeWidth:3,svgPath:"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0"})).states.create("hover",{stroke:Object(b.J)(4671320)}),this._logo=e,this._handleLogo()}}},{key:"_getRealSize",value:function(){return this.dom.getBoundingClientRect()}},{key:"_getCalculatedSize",value:function(e){return this._settings.calculateSize?this._settings.calculateSize(e):{width:e.width,height:e.height}}},{key:"_init",value:function(){var e=this,t=this._renderer,i=this._getRealSize(),n=this._getCalculatedSize(i),a=Math.floor(n.width),r=Math.floor(n.height),o=Math.floor(i.width),s=Math.floor(i.height),l=b.G.new(this,{visible:!0,width:o,height:s});this._rootContainer=l,this._rootContainer._defaultThemes.push(v.a.new(this));var u=l.children.push(b.G.new(this,{visible:!0,width:b.H,height:b.H}));this.container=u,t.resize(o,s,a,r),this._inner.appendChild(t.view),this._initResizeSensor();var c=document.createElement("div");if(this._htmlElementContainer=c,c.className="am5-html-container",c.style.position="absolute",c.style.pointerEvents="none",this._tooltipContainerSettings||(c.style.overflow="hidden"),this._inner.appendChild(c),!0!==this._a11yD){var d=document.createElement("div");d.className="am5-reader-container",d.setAttribute("role","alert"),d.style.position="absolute",d.style.width="1px",d.style.height="1px",d.style.overflow="hidden",d.style.clip="rect(1px, 1px, 1px, 1px)",this._readerAlertElement=d,this._inner.appendChild(this._readerAlertElement);var h=document.createElement("div");h.className="am5-focus-container",h.style.position="absolute",h.style.pointerEvents="none",h.style.top="0px",h.style.left="0px",h.style.overflow="hidden",h.style.width=a+"px",h.style.height=r+"px",h.setAttribute("role","application"),Object(b.x)(h,!1),this._focusElementContainer=h,this._inner.appendChild(this._focusElementContainer);var f=document.createElement("div");this._tooltipElementContainer=f,f.className="am5-tooltip-container",this._inner.appendChild(f),Object(b.Wb)("keyboardevents")&&(this._disposers.push(Object(b.Xb)(window,"keydown",(function(t){16==t.keyCode?e._isShift=!0:9==t.keyCode&&(e._isShift=t.shiftKey)}))),this._disposers.push(Object(b.Xb)(window,"keyup",(function(t){16==t.keyCode&&(e._isShift=!1)}))),this._disposers.push(Object(b.Xb)(h,"keydown",(function(i){var n=e._focusedSprite;if(n){27==i.keyCode&&(Object(b.L)(),e._focusedSprite=void 0);var a=0,r=0;switch(i.keyCode){case 13:i.preventDefault();var o=t.getEvent(new MouseEvent("click"));return void n.events.dispatch("click",{type:"click",originalEvent:o.event,point:o.point,simulated:!0,target:n});case 37:a=-6;break;case 39:a=6;break;case 38:r=-6;break;case 40:r=6;break;default:return}if(0!=a||0!=r){if(i.preventDefault(),!n.isDragging()){e._keyboardDragPoint={x:0,y:0};var s=t.getEvent(new MouseEvent("mousedown",{clientX:0,clientY:0}));n.events.isEnabled("pointerdown")&&n.events.dispatch("pointerdown",{type:"pointerdown",originalEvent:s.event,point:s.point,simulated:!0,target:n})}var l=e._keyboardDragPoint;l.x+=a,l.y+=r;var u=t.getEvent(new MouseEvent("mousemove",{clientX:l.x,clientY:l.y}),!1);n.events.isEnabled("globalpointermove")&&n.events.dispatch("globalpointermove",{type:"globalpointermove",originalEvent:u.event,point:u.point,simulated:!0,target:n})}}}))),this._disposers.push(Object(b.Xb)(h,"keyup",(function(i){if(e._focusedSprite){var n=e._focusedSprite,a=i.keyCode;switch(a){case 37:case 39:case 38:case 40:if(n.isDragging()){var r=e._keyboardDragPoint,o=t.getEvent(new MouseEvent("mouseup",{clientX:r.x,clientY:r.y}));return n.events.isEnabled("globalpointerup")&&n.events.dispatch("globalpointerup",{type:"globalpointerup",originalEvent:o.event,point:o.point,simulated:!0,target:n}),void(e._keyboardDragPoint=void 0)}if(n.get("focusableGroup")){var s=n.get("focusableGroup"),l=e._tabindexes.filter((function(e){return e.get("focusableGroup")==s})),u=l.indexOf(n),c=l.length-1;(u+=39==a||40==a?1:-1)<0?u=c:u>c&&(u=0),Object(b.M)(l[u].getPrivate("focusElement").dom)}}}}))))}this._startTicker(),this.setThemes([]),this._addTooltip(),this._hasLicense()||this._showBranding()}},{key:"_initResizeSensor",value:function(){var e=this;this._resizeSensorDisposer&&this._resizeSensorDisposer.dispose(),this._resizeSensorDisposer=new O(this.dom,(function(){e.autoResize&&e.resize()})),this._disposers.push(this._resizeSensorDisposer)}},{key:"resize",value:function(){var e=this._getRealSize(),t=this._getCalculatedSize(e),i=Math.floor(t.width),n=Math.floor(t.height);if(i>0&&n>0){var a=Math.floor(e.width),r=Math.floor(e.height),o=this._htmlElementContainer;if(o.style.width=i+"px",o.style.height=n+"px",!0!==this._a11yD){var s=this._focusElementContainer;s.style.width=i+"px",s.style.height=n+"px"}this._renderer.resize(a,r,i,n);var l=this._rootContainer;l.setPrivate("width",a),l.setPrivate("height",r),this._render(),this._handleLogo()}}},{key:"_render",value:function(){this._renderer.render(this._rootContainer._display),this._focusElementDirty&&(this._updateCurrentFocus(),this._focusElementDirty=!1)}},{key:"_runTickers",value:function(e){Object(b.Cb)(this._tickers,(function(t){t(e)}))}},{key:"_runAnimations",value:function(e){Object(b.Ib)(this._animations,(function(t){return t._runAnimation(e)}))}},{key:"_runDirties",value:function(){for(var e=this,t={};this._isDirtyParents;)this._isDirtyParents=!1,Object(b.Z)(this._dirtyParents).forEach((function(i){var n=e._dirtyParents[i];delete e._dirtyParents[i],n.isDisposed()||(t[n.uid]=n,n._prepareChildren())}));Object(b.Z)(t).forEach((function(e){t[e]._updateChildren()}));var i=[];Object(b.Z)(this._dirty).forEach((function(t){var n=e._dirty[t];n.isDisposed()?delete e._dirty[n.uid]:(i.push(n),n._beforeChanged())})),i.forEach((function(t){t._changed(),delete e._dirty[t.uid],t._clearDirty()})),this._isDirty=!1;var n={},a=[];Object(b.Z)(this._dirtyBounds).forEach((function(t){var i=e._dirtyBounds[t];delete e._dirtyBounds[t],i.isDisposed()||(n[i.uid]=i.depth(),a.push(i))})),this._positionHTMLElements(),a.sort((function(e,t){return Object(b.ab)(n[t.uid],n[e.uid])})),a.forEach((function(e){e._updateBounds()}));var r=this._dirtyPositions;Object(b.Z)(r).forEach((function(e){var t=r[e];delete r[e],t.isDisposed()||t._updatePosition()})),i.forEach((function(e){e._afterChanged()}))}},{key:"_renderFrame",value:function(e){return!this._updateTick||(this.events.isEnabled("framestarted")&&this.events.dispatch("framestarted",{type:"framestarted",target:this,timestamp:e}),this._checkComputedStyles(),this._runTickers(e),this._runAnimations(e),this._runDirties(),this._render(),this._positionHTMLElements(),this.events.isEnabled("frameended")&&this.events.dispatch("frameended",{type:"frameended",target:this,timestamp:e}),0===this._tickers.length&&0===this._animations.length&&!this._isDirty)}},{key:"_runTicker",value:function(e,t){this.isDisposed()||(this.animationTime=e,this._renderFrame(e)?(this._ticker=null,this.animationTime=null):this._paused||(t?this._ticker:Me(this.fps,this._ticker)))}},{key:"_runTickerNow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;if(!this.isDisposed())for(var t=performance.now()+e;;){var i=performance.now();if(i>=t){this.animationTime=null;break}if(this.animationTime=i,this._renderFrame(i)){this.animationTime=null;break}}}},{key:"_startTicker",value:function(){var e=this;null===this._ticker&&(this.animationTime=null,this._ticker=function(t){e._runTicker(t)},Me(this.fps,this._ticker))}},{key:"updateTick",get:function(){return this._updateTick},set:function(e){this._updateTick=e,e&&this._startTicker()}},{key:"_addDirtyEntity",value:function(e){void 0===this._dirty[e.uid]&&(this._isDirty=!0,this._dirty[e.uid]=e,this._startTicker())}},{key:"_addDirtyParent",value:function(e){void 0===this._dirtyParents[e.uid]&&(this._isDirty=!0,this._isDirtyParents=!0,this._dirtyParents[e.uid]=e,this._startTicker())}},{key:"_addDirtyBounds",value:function(e){void 0===this._dirtyBounds[e.uid]&&(this._isDirty=!0,this._dirtyBounds[e.uid]=e,this._startTicker())}},{key:"_addDirtyPosition",value:function(e){void 0===this._dirtyPositions[e.uid]&&(this._isDirty=!0,this._dirtyPositions[e.uid]=e,this._startTicker())}},{key:"_addAnimation",value:function(e){-1===this._animations.indexOf(e)&&(this._animations.push(e),this._startTicker())}},{key:"_markDirty",value:function(){this._isDirty=!0}},{key:"_markDirtyRedraw",value:function(){var e=this;this.events.once("frameended",(function(){e._isDirty=!0,e._startTicker()}))}},{key:"eachFrame",value:function(e){var t=this;return this._tickers.push(e),this._startTicker(),new b.e((function(){Object(b.k)(t._tickers,e)}))}},{key:"markDirtyGlobal",value:function(e){var t=this;e||(e=this.container),e.walkChildren((function(e){e instanceof b.G&&t.markDirtyGlobal(e),e.markDirty(),e.markDirtyBounds()}))}},{key:"width",value:function(){return Math.floor(this._getCalculatedSize(this._getRealSize()).width)}},{key:"height",value:function(){return Math.floor(this._getCalculatedSize(this._getRealSize()).height)}},{key:"dispose",value:function(){this._isDisposed||(this._isDisposed=!0,this._rootContainer.dispose(),this._renderer.dispose(),this.horizontalLayout.dispose(),this.verticalLayout.dispose(),this.interfaceColors.dispose(),Object(b.Cb)(this._disposers,(function(e){e.dispose()})),this._inner&&Object(b.bb)(this._inner),Object(b.cb)(b.F.rootElements,this))}},{key:"isDisposed",value:function(){return this._isDisposed}},{key:"readerAlert",value:function(e){!0!==this._a11yD&&(this._readerAlertElement.innerHTML=Object(b.db)(e))}},{key:"setThemes",value:function(e){this._rootContainer.set("themes",e);var t=this.tooltipContainer;t&&t._applyThemes();var i=this.interfaceColors;i&&i._applyThemes()}},{key:"_addTooltip",value:function(){if(!this.tooltipContainer){var e=this._tooltipContainerSettings,t=this._rootContainer.children.push(b.G.new(this,{position:"absolute",isMeasured:!1,width:b.H,height:b.H,layer:e?35:30,layerMargin:e||void 0}));this.tooltipContainer=t;var i=p.a.new(this,{});this.container.set("tooltip",i),i.hide(0),this._tooltip=i}}},{key:"_registerTabindexOrder",value:function(e){1!=this._a11yD&&(e.get("focusable")?Object(b.m)(this._tabindexes,e):Object(b.cb)(this._tabindexes,e),this._invalidateTabindexes())}},{key:"_unregisterTabindexOrder",value:function(e){1!=this._a11yD&&(Object(b.cb)(this._tabindexes,e),this._invalidateTabindexes())}},{key:"_invalidateTabindexes",value:function(){var e=this;if(1!=this._a11yD){this._tabindexes.sort((function(e,t){var i=e.get("tabindexOrder",0),n=t.get("tabindexOrder",0);return i==n?0:i>n?1:-1}));var t=[];Object(b.Cb)(this._tabindexes,(function(i,n){i.getPrivate("focusElement")?e._moveFocusElement(n,i):e._makeFocusElement(n,i);var a=i.get("focusableGroup");a&&(-1!==t.indexOf(a)?i.getPrivate("focusElement").dom.setAttribute("tabindex","-1"):t.push(a))}))}}},{key:"_updateCurrentFocus",value:function(){1!=this._a11yD&&this._focusedSprite&&(this._decorateFocusElement(this._focusedSprite),this._positionFocusElement(this._focusedSprite))}},{key:"_decorateFocusElement",value:function(e,t){if(1!=this._a11yD&&(t||(t=e.getPrivate("focusElement").dom),t)){e.get("visible")&&"tooltip"!=e.get("role")&&!e.isHidden()?"-1"!=t.getAttribute("tabindex")&&t.setAttribute("tabindex",""+this.tabindex):t.removeAttribute("tabindex");var i=e.get("role");i?t.setAttribute("role",i):t.removeAttribute("role");var n=e.get("ariaLabel");if(n){var a=Object(b.eb)(e,n);t.setAttribute("aria-label",a)}else t.removeAttribute("aria-label");var r=e.get("ariaLive");r?t.setAttribute("aria-live",r):t.removeAttribute("aria-live");var o=e.get("ariaChecked");null!=o?t.setAttribute("aria-checked",o?"true":"false"):t.removeAttribute("aria-checked"),e.get("ariaHidden")?t.setAttribute("aria-hidden","hidden"):t.removeAttribute("aria-hidden");var s=e.get("ariaOrientation");s?t.setAttribute("aria-orientation",s):t.removeAttribute("aria-orientation");var l=e.get("ariaValueNow");l?t.setAttribute("aria-valuenow",l):t.removeAttribute("aria-valuenow");var u=e.get("ariaValueMin");u?t.setAttribute("aria-valuemin",u):t.removeAttribute("aria-valuemin");var c=e.get("ariaValueMax");c?t.setAttribute("aria-valuemax",c):t.removeAttribute("aria-valuemax");var d=e.get("ariaValueText");d?t.setAttribute("aria-valuetext",d):t.removeAttribute("aria-valuetext");var h=e.get("ariaControls");h?t.setAttribute("aria-controls",h):t.removeAttribute("aria-controls")}}},{key:"_makeFocusElement",value:function(e,t){var i=this;if(!t.getPrivate("focusElement")&&1!=this._a11yD){var n=document.createElement("div");"tooltip"!=t.get("role")&&(n.tabIndex=this.tabindex),n.style.position="absolute",Object(b.x)(n,!1);var a=[];t.setPrivate("focusElement",{dom:n,disposers:a}),this._decorateFocusElement(t),a.push(Object(b.Xb)(n,"focus",(function(t){i._handleFocus(t,e)}))),a.push(Object(b.Xb)(n,"blur",(function(t){i._handleBlur(t,e)}))),this._moveFocusElement(e,t)}}},{key:"_removeFocusElement",value:function(e){if(1!=this._a11yD){Object(b.cb)(this._tabindexes,e);var t=e.getPrivate("focusElement");t&&(this._focusElementContainer.removeChild(t.dom),Object(b.Cb)(t.disposers,(function(e){e.dispose()})))}}},{key:"_hideFocusElement",value:function(e){1!=this._a11yD&&(e.getPrivate("focusElement").dom.style.display="none")}},{key:"_moveFocusElement",value:function(e,t){if(1!=this._a11yD){var i=this._focusElementContainer,n=t.getPrivate("focusElement").dom;if(n!==this._focusElementContainer.children[e]){var a=this._focusElementContainer.children[e+1];a?i.insertBefore(n,a):i.append(n)}}}},{key:"_positionFocusElement",value:function(e){if(1!=this._a11yD){var t=e.globalBounds(),i=t.right==t.left?e.width():t.right-t.left,n=t.top==t.bottom?e.height():t.bottom-t.top,a=t.left-2,r=t.top-2;i<0&&(a+=i,i=Math.abs(i)),n<0&&(r+=n,n=Math.abs(n));var o=e.getPrivate("focusElement").dom;o.style.top=r+"px",o.style.left=a+"px",o.style.width=i+4+"px",o.style.height=n+4+"px"}}},{key:"_handleFocus",value:function(e,t){if(1!=this._a11yD){var i=this._tabindexes[t];i.isVisibleDeep()?(this._positionFocusElement(i),this._focusedSprite=i,i.events.isEnabled("focus")&&i.events.dispatch("focus",{type:"focus",originalEvent:e,target:i})):this._focusNext(e.target,this._isShift?-1:1)}}},{key:"_focusNext",value:function(e,t){if(1!=this._a11yD){var i=Array.from(document.querySelectorAll(["a[href]","area[href]","button:not([disabled])","details","input:not([disabled])","iframe:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contentEditable=""]','[contentEditable="true"]','[contentEditable="TRUE"]','[tabindex]:not([tabindex^="-"])'].join(","))),n=i.indexOf(e)+t;n<0?n=i.length-1:n>=i.length&&(n=0),i[n].focus()}}},{key:"_handleBlur",value:function(e,t){if(1!=this._a11yD){var i=this._focusedSprite;i&&i.events.isEnabled("blur")&&i.events.dispatch("blur",{type:"blur",originalEvent:e,target:i}),this._focusedSprite=void 0}}},{key:"updateTooltip",value:function(e){if(1!=this._a11yD){var t=Object(b.db)(e._getText()),i=e.getPrivate("tooltipElement");"tooltip"==e.get("role")&&""!=t?(i||(i=this._makeTooltipElement(e)),i.innerHTML!=t&&(i.innerHTML=t)):i&&(i.remove(),e.removePrivate("tooltipElement"))}}},{key:"_makeTooltipElement",value:function(e){var t=this._tooltipElementContainer,i=document.createElement("div");return i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",i.style.clip="rect(1px, 1px, 1px, 1px)",Object(b.x)(i,!1),this._decorateFocusElement(e,i),t.append(i),e.setPrivate("tooltipElement",i),i}},{key:"_removeTooltipElement",value:function(e){if(1!=this._a11yD){var t=e.getPrivate("tooltipElement");if(t){var i=t.parentElement;i&&i.removeChild(t)}}}},{key:"_invalidateAccessibility",value:function(e){if(1!=this._a11yD){this._focusElementDirty=!0;var t=e.getPrivate("focusElement");e.get("focusable")?t&&(this._decorateFocusElement(e),this._positionFocusElement(e)):t&&this._removeFocusElement(e)}}},{key:"focused",value:function(e){return this._focusedSprite===e}},{key:"documentPointToRoot",value:function(e){var t=this.dom.getBoundingClientRect();return{x:e.x-t.left,y:e.y-t.top}}},{key:"rootPointToDocument",value:function(e){var t=this.dom.getBoundingClientRect();return{x:e.x+t.left,y:e.y+t.top}}},{key:"addDisposer",value:function(e){return this._disposers.push(e),e}},{key:"_updateComputedStyles",value:function(){var e=window.getComputedStyle(this.dom),t="";Object(b.Db)(e,(function(e,i){Object(b.Gb)(e)&&e.match(/^font/)&&(t+=i)}));var i=t!=this._fontHash;return i&&(this._fontHash=t),i}},{key:"_checkComputedStyles",value:function(){this._updateComputedStyles()&&this._invalidateLabelBounds(this.container)}},{key:"_invalidateLabelBounds",value:function(e){var t=this;e instanceof b.G?e.children.each((function(e){t._invalidateLabelBounds(e)})):e instanceof b.fb&&e.markDirtyBounds()}},{key:"_hasLicense",value:function(){for(var e=0;e<b.F.licenses.length;e++)if(b.F.licenses[e].match(/^AM5C.{5,}/i))return!0;return!1}},{key:"_licenseApplied",value:function(){this._logo&&this._logo.set("forceHidden",!0)}},{key:"debugGhostView",get:function(){return this._renderer.debugGhostView},set:function(e){this._renderer.debugGhostView=e}},{key:"tapToActivate",get:function(){return this._renderer.tapToActivate},set:function(e){this._renderer.tapToActivate=e}},{key:"tapToActivateTimeout",get:function(){return this._renderer.tapToActivateTimeout},set:function(e){this._renderer.tapToActivateTimeout=e}},{key:"_makeHTMLElement",value:function(e){var t=this,i=this._htmlElementContainer,n=document.createElement("div");return e.setPrivate("htmlElement",n),n.style.position="absolute",n.style.overflow="auto",n.style.boxSizing="border-box",Object(b.x)(n,e.get("interactive",!1)),e.events.isEnabled("click")&&(Object(b.x)(n,!0),this._disposers.push(Object(b.Xb)(n,"click",(function(i){var n=t._renderer.getEvent(i);e.events.dispatch("click",{type:"click",originalEvent:n.event,point:n.point,simulated:!1,target:e})})))),this._positionHTMLElement(e),i.append(n),Object(b.m)(this._htmlEnabledContainers,e),n}},{key:"_positionHTMLElements",value:function(){var e=this;Object(b.Cb)(this._htmlEnabledContainers,(function(t){e._positionHTMLElement(t)}))}},{key:"_positionHTMLElement",value:function(e){var t=e.getPrivate("htmlElement");if(t){Object(b.Cb)(["paddingTop","paddingRight","paddingBottom","paddingLeft","minWidth","minHeight","maxWidth","maxHeight"],(function(i){var n=e.get(i);t.style[i]=n?n+"px":""}));var i=e.compositeOpacity();setTimeout((function(){t.style.opacity=i+""}),10);var n=e.isVisibleDeep();n&&(t.style.display="block");var a=e.globalBounds();t.style.top=a.top+"px",t.style.left=a.left+"px";var r=e.get("width"),o=e.get("height"),s=0,l=0;if(r&&(s=e.width()),o&&(l=e.height()),r&&o)e.removePrivate("minWidth"),e.removePrivate("minHeight");else{t.style.position="fixed",t.style.width="",t.style.height="";var u=t.getBoundingClientRect();t.style.position="absolute",s=u.width,l=u.height,e._adjustedLocalBounds={left:0,right:0,top:0,bottom:0},e.setPrivate("minWidth",s),e.setPrivate("minHeight",l)}s>0&&(t.style.minWidth=s+"px"),l>0&&(t.style.minHeight=l+"px"),n&&0!=i||(t.style.display="none")}}},{key:"_setHTMLContent",value:function(e,t){var i=e.getPrivate("htmlElement");i||(i=this._makeHTMLElement(e)),i.innerHTML!=t&&(i.innerHTML=t)}},{key:"_removeHTMLContent",value:function(e){var t=e.getPrivate("htmlElement");t&&this._htmlElementContainer.removeChild(t),Object(b.cb)(this._htmlEnabledContainers,e)}}],[{key:"new",value:function(t,i){var n=new e(t,i,!0);return n._init(),n}}]),e}();Object(b.hb)("AM5C241025748");var Ce="en-us",Ae=new Map([["ar",function(){return i.e(267).then(i.bind(null,2111))}],["bg-bg",function(){return i.e(271).then(i.bind(null,2112))}],["bs-ba",function(){return i.e(272).then(i.bind(null,2113))}],["ca-es",function(){return i.e(273).then(i.bind(null,2114))}],["cs-cz",function(){return i.e(274).then(i.bind(null,2115))}],["da-dk",function(){return i.e(275).then(i.bind(null,2116))}],["de-de",function(){return i.e(277).then(i.bind(null,2117))}],["de-ch",function(){return i.e(276).then(i.bind(null,2118))}],["el-gr",function(){return i.e(278).then(i.bind(null,2119))}],["en-us",function(){return i.e(280).then(i.bind(null,2120))}],["en-ca",function(){return i.e(279).then(i.bind(null,2121))}],["es-es",function(){return i.e(281).then(i.bind(null,2122))}],["et-ee",function(){return i.e(282).then(i.bind(null,2123))}],["fi-fi",function(){return i.e(283).then(i.bind(null,2124))}],["fr-fr",function(){return i.e(284).then(i.bind(null,2125))}],["he-il",function(){return i.e(285).then(i.bind(null,2126))}],["hr-hr",function(){return i.e(286).then(i.bind(null,2127))}],["hu-hu",function(){return i.e(287).then(i.bind(null,2128))}],["id-id",function(){return i.e(289).then(i.bind(null,2129))}],["it-it",function(){return i.e(290).then(i.bind(null,2130))}],["ja-jp",function(){return i.e(291).then(i.bind(null,2131))}],["ko-kr",function(){return i.e(292).then(i.bind(null,2132))}],["lt-lt",function(){return i.e(295).then(i.bind(null,2133))}],["lv-lv",function(){return i.e(296).then(i.bind(null,2134))}],["nb-no",function(){return i.e(297).then(i.bind(null,2135))}],["nl-nl",function(){return i.e(298).then(i.bind(null,2136))}],["pl-pl",function(){return i.e(300).then(i.bind(null,2137))}],["pt-br",function(){return i.e(301).then(i.bind(null,2138))}],["pt-pt",function(){return i.e(302).then(i.bind(null,2139))}],["ro-ro",function(){return i.e(303).then(i.bind(null,2140))}],["ru-ru",function(){return i.e(304).then(i.bind(null,2141))}],["sk-sk",function(){return i.e(305).then(i.bind(null,2142))}],["sl-sl",function(){return i.e(306).then(i.bind(null,2143))}],["sr-rs",function(){return i.e(307).then(i.bind(null,2144))}],["sv-se",function(){return i.e(308).then(i.bind(null,2145))}],["th-th",function(){return i.e(309).then(i.bind(null,2146))}],["tr-tr",function(){return i.e(310).then(i.bind(null,2147))}],["uk-ua",function(){return i.e(311).then(i.bind(null,2148))}],["vi-vn",function(){return i.e(312).then(i.bind(null,2149))}],["zh-cn",function(){return i.e(313).then(i.bind(null,2150))}],["zh-hk",function(){return i.e(68).then(i.bind(null,1733))}],["zh-tw",function(){return i.e(68).then(i.bind(null,1733))}]]);function Te(e){return e?Ae.has(e.toLowerCase())?e.toLowerCase():function(e){var t,i=e.split("-")[0].toLowerCase(),n=null,a=Object(r.a)(Ae.keys());try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o.startsWith(i)){n=o;break}}}catch(s){a.e(s)}finally{a.f()}return n}(e)||Ce:Ce}function Ie(e){return De.apply(this,arguments)}function De(){return De=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.length>1&&void 0!==r[1]?r[1]:Object(y.b)(),a=Pe.new(t),e.next=4,Ae.get(Te(i))();case 4:return a.locale=e.sent.default,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),De.apply(this,arguments)}var Fe=["#7ABEE5","#B39BD5","#F8AE83","#92E6E4","#FBC487","#EE967A","#CEA2D6","#89D594","#CEE68F","#F1A6D5"].map((function(e){return Object(b.J)(e)}))},1876:function(e,t,i){"use strict";i.r(t),i.d(t,"getPatternDescriptor",(function(){return T})),i.d(t,"getSizeFromOptions",(function(){return L})),i.d(t,"getSymbolLayerFill",(function(){return A})),i.d(t,"previewSymbol3D",(function(){return N}));var n=i(4),a=i(1),r=i(12),o=i(288),s=i(600),l=(i(93),i(101)),u=i(102),c=i(111),d=i(110),h=i(108),f=i(1025),b=i(1135),p=i(1138),v=i(1026),y=i(1178),g=i(739),m=i(303),_=v.a.size,O=v.a.maxSize,j=v.a.maxOutlineSize,w=v.a.lineWidth,k=v.a.tallSymbolWidth;function x(e){var t=e.outline,i=null!=e.material?e.material.color:null,n=null!=i?i.toHex():null;if(null==t||"pattern"in t&&null!=t.pattern&&"style"===t.pattern.type&&"none"===t.pattern.style)return"fill"===e.type&&"#ffffff"===n?{color:"#bdc3c7",width:.75}:null;var a=Object(h.c)(t.size)||0;return{color:"rgba("+(null!=t.color?t.color.toRgba():"255,255,255,1")+")",width:Math.min(a,j),style:"pattern"in t&&null!=t.pattern&&"style"===t.pattern.type?Object(f.b)(t.pattern.style):null,join:"butt",cap:"patternCap"in t?t.patternCap:"butt"}}function M(){return(M=Object(r.a)(Object(n.a)().mark((function e(t,i){var a,r,s,l,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=t.thumbnail)||void 0===a||!a.url){e.next=2;break}return e.abrupt("return",t.thumbnail.url);case 2:if("icon"!==i.type){e.next=6;break}if(!(null===i||void 0===i||null===(r=i.resource)||void 0===r?void 0:r.href)){e.next=6;break}return e.abrupt("return",Object(g.h)(i));case 6:if(s=Object(o.a)("esri/images/Legend/legend3dsymboldefault.png"),!t.styleOrigin||!t.styleOrigin.styleName&&!t.styleOrigin.styleUrl){e.next=13;break}return e.next=10,Object(m.resolveWebStyleSymbol)(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch((function(){return null}));case 10:if(!((u=e.sent)&&"thumbnail"in u&&null!==(l=u.thumbnail)&&void 0!==l&&l.url)){e.next=13;break}return e.abrupt("return",u.thumbnail.url);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e.a,n=Object(s.a)(e),a=n.h,r=n.s/t,o=100-(100-n.v)/t,l=Object(s.d)({h:a,s:r,v:o});return[l.r,l.g,l.b,i]}function C(e){return"water"===e.type?null==e.color?null:e.color:null==e.material||null==e.material.color?null:e.material.color}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=C(e);if(!i){if("fill"===e.type)return null;var n=f.a.r,a=Object(v.c)(n,t);return[a,a,a,100]}for(var r=i.toRgba(),o=0;o<3;o++)r[o]=Object(v.c)(r[o],t);return r}function T(e,t){return I.apply(this,arguments)}function I(){return(I=Object(r.a)(Object(n.a)().mark((function e(t,i){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("none"!==(a=t.style)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,Object(f.d)(Object(o.a)("esri/symbols/patterns/".concat(a,".png")),i.toCss(!0));case 5:return e.t0=e.sent,e.abrupt("return",{type:"pattern",x:0,y:0,src:e.t0,width:5,height:5});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return e.outline?x(e):{color:"rgba(0, 0, 0, 1)",width:1.5}}function F(e,t){var i=C(e);if(!i)return null;var n="rgba(";return n+=Object(v.c)(i.r,t)+",",n+=Object(v.c)(i.g,t)+",",(n+=Object(v.c)(i.b,t)+",")+i.a+");"}function E(e,t){var i=F(e,t);return i?"pattern"in e&&null!=e.pattern&&"style"===e.pattern.type&&"none"===e.pattern.style?null:{color:i,width:Math.min(e.size?Object(h.c)(e.size):.75,j),style:"pattern"in e&&null!=e.pattern&&"style"===e.pattern.type?Object(f.b)(e.pattern.style):null,cap:"cap"in e?e.cap:null,join:"join"in e?"miter"===e.join?Object(h.c)(2):e.join:null}:{}}function S(e,t,i){var n=null!=i?.75*i:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:e,offset:0},{color:t,offset:1}]}}function L(e){var t="number"==typeof(null===e||void 0===e?void 0:e.size)?null===e||void 0===e?void 0:e.size:null;return t?Object(h.c)(t):null}function B(e,t){var i,n,a=L(t),r=null!==t&&void 0!==t&&t.maxSize?Object(h.c)(t.maxSize):null,o=null!==(i=null===t||void 0===t?void 0:t.disableUpsampling)&&void 0!==i&&i,s=e.symbolLayers,l=[],c=0,f=0,g=s.at(-1);return g&&"icon"===g.type&&(n=g.size&&Object(h.c)(g.size)),s.forEach((function(i){if("icon"===i.type||"object"===i.type){var s="icon"===i.type?i.size&&Object(h.c)(i.size):0,u=a||s?Math.ceil(Math.min(a||s,r||O)):_;if(i&&i.resource&&i.resource.href){var d=function(e,t){return M.apply(this,arguments)}(e,i).then((function(e){var t=i.get("material.color"),n=function(e){return"icon"===e.type?"multiply":"tint"}(i);return Object(y.c)(e,u,t,n,o)})).then((function(e){var t=e.width,i=e.height;return c=Math.max(c,t),f=Math.max(f,i),[{shape:{type:"image",x:0,y:0,width:t,height:i,src:e.url},fill:null,stroke:null}]}));l.push(d)}else{var g,m=u;"icon"===i.type&&n&&a&&(m=u*(s/n));var j="tall"===(null===t||void 0===t?void 0:t.symbolConfig)||(null===t||void 0===t||null===(g=t.symbolConfig)||void 0===g?void 0:g.isTall)||"object"===i.type&&function(e){var t=e.depth,i=e.height,n=e.width;return 0!==n&&0!==t&&0!==i&&n===t&&null!=n&&null!=i&&n<i}(i);c=Math.max(c,j?k:m),f=Math.max(f,m),l.push(Promise.resolve(function(e,t,i){var n=[];if(!e)return n;switch(e.type){case"icon":var a=t,r=t;switch(e.resource&&e.resource.primitive||b.b){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:A(e,0),stroke:x(e)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[0,r]},{command:"L",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[a,r]},{command:"Z",values:[]}]},fill:A(e,0),stroke:x(e)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[0,r]},{command:"L",values:[.5*a,0]},{command:"L",values:[a,r]},{command:"Z",values:[]}]},fill:A(e,0),stroke:x(e)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[.5*a,r]},{command:"M",values:[0,.5*r]},{command:"L",values:[a,.5*r]}]},stroke:D(e)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,r]},{command:"M",values:[a,0]},{command:"L",values:[0,r]}]},stroke:D(e)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*r]},{command:"L",values:[.5*a,0]},{command:"L",values:[a,.5*r]},{command:"L",values:[.5*a,r]},{command:"Z",values:[]}]},fill:A(e,0),stroke:x(e)})}break;case"object":switch(e.resource&&e.resource.primitive||p.b){case"cone":var o=S(A(e,0),A(e,-.6),i?k:t),s=Object(v.d)(t,i);n.push({shape:s[0],fill:o}),n.push({shape:s[1],fill:o});break;case"inverted-cone":var l=A(e,0),u=S(l,A(e,-.6),t),c=Object(v.i)(t);n.push({shape:c[0],fill:u}),n.push({shape:c[1],fill:l});break;case"cube":var d=Object(v.e)(t,i);n.push({shape:d[0],fill:A(e,0)}),n.push({shape:d[1],fill:A(e,-.3)}),n.push({shape:d[2],fill:A(e,-.5)});break;case"cylinder":var h=S(A(e,0),A(e,-.6),i?k:t),f=Object(v.f)(t,i);n.push({shape:f[0],fill:h}),n.push({shape:f[1],fill:h}),n.push({shape:f[2],fill:A(e,0)});break;case"diamond":var y=Object(v.g)(t);n.push({shape:y[0],fill:A(e,-.3)}),n.push({shape:y[1],fill:A(e,0)}),n.push({shape:y[2],fill:A(e,-.3)}),n.push({shape:y[3],fill:A(e,-.7)});break;case"sphere":var g=S(A(e,0),A(e,-.6));g.x1=0,g.y1=0,g.x2=.25*t,g.y2=.25*t,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*t},fill:g});break;case"tetrahedron":var m=Object(v.k)(t);n.push({shape:m[0],fill:A(e,-.3)}),n.push({shape:m[1],fill:A(e,0)}),n.push({shape:m[2],fill:A(e,-.6)})}}return n}(i,m,j)))}}})),Object(d.e)(l).then((function(e){var i=[];return e.forEach((function(e){e.value?i.push(e.value):e.error&&u.a.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",e.error)})),Object(y.b)(i,[c,f],{node:t&&t.node,scale:!1,opacity:t&&t.opacity,ariaLabel:null===t||void 0===t?void 0:t.ariaLabel})}))}function R(){return(R=Object(r.a)(Object(n.a)().mark((function e(t,i){var r,o,s,l,u,d,f,b,p,g,m,j,w,k,M,I,D,F,S,B,R,N,z,H,V,W,U,Y,q,G,X,K,Z;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r="mesh-3d"===t.type,o=t.symbolLayers,s=L(i),l=i&&i.maxSize?Object(h.c)(i.maxSize):null,u=s||_,d=[],f=0,b=0,p=!1,g=0;case 3:if(!(g<o.length)){e.next=42;break}if(m=o.at(g),j=[],!r||"fill"===m.type){e.next=7;break}return e.abrupt("continue",39);case 7:w=v.m.fill[0],e.t0=m.type,e.next="fill"===e.t0?11:"line"===e.t0?22:"extrude"===e.t0?28:"water"===e.t0?33:38;break;case 11:if(k=x(m),M=Math.min(u,l||O),f=Math.max(f,M),b=Math.max(b,M),p=!0,I=A(m,0),D="pattern"in m?m.pattern:null,F=C(m),e.t1=!r&&null!=D&&"style"===D.type&&"solid"!==D.style&&F,!e.t1){e.next=20;break}return e.next=19,T(D,F);case 19:I=e.sent;case 20:return j.push({shape:w,fill:I,stroke:k}),e.abrupt("break",38);case 22:if(null!=(S=E(m,0))){e.next=25;break}return e.abrupt("break",38);case 25:return B={stroke:S,shape:w},f=Math.max(f,_),b=Math.max(b,_),j.push(B),e.abrupt("break",38);case 28:return R=Object(a.a)({join:"round",width:1},E(m,-.4)),N=A(m,0),z=A(m,-.2),H=Math.min(u,l||O),V=Object(v.h)(H),R.width=1,j.push({shape:V[0],fill:z,stroke:R}),j.push({shape:V[1],fill:z,stroke:R}),j.push({shape:V[2],fill:N,stroke:R}),W=_,U=.7*_+.5*H,f=Math.max(f,W),b=Math.max(b,U),e.abrupt("break",38);case 33:return Y=Object(c.m)(C(m)),q=P(Y),G=P(Y,2),X=P(Y,3),K=Object(v.l)(),p=!0,j.push({shape:K[0],fill:q}),j.push({shape:K[1],fill:G}),j.push({shape:K[2],fill:X}),Z=Math.min(u,l||O),f=Math.max(f,Z),b=Math.max(b,Z),e.abrupt("break",38);case 38:d.push(j);case 39:g++,e.next=3;break;case 42:return e.abrupt("return",Object(y.b)(d,[f,b],{node:i&&i.node,scale:p,opacity:i&&i.opacity,ariaLabel:null===i||void 0===i?void 0:i.ariaLabel}));case 43:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){if(0===e.symbolLayers.length)return Promise.reject(new l.a("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(e.type){case"point-3d":return B(e,t);case"line-3d":return function(e,t){var i,n=e.symbolLayers,r=[],o=Object(g.i)(e),s=L(t),l=(t&&t.maxSize?Object(h.c)(t.maxSize):null)||j,u=0,c=0;return n.forEach((function(e,t){if(e&&("line"===e.type||"path"===e.type)){var n=[];switch(e.type){case"line":var o=E(e,0);if(null==o)break;var d=o&&o.width||0;0===t&&(i=d);var h=Math.min(s||d,l),f=0===t?h:s?h*(d/i):h,b=f>w/2?2*f:w;c=Math.max(c,f),u=Math.max(u,b),o.width=f,n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[u,.5*c]}]},stroke:o});break;case"path":var p=Math.min(s||_,l),y=A(e,0),g=A(e,-.2),m=F(e,-.4),O=m?{color:m,width:1}:{};if("quad"===e.profile){var j=e.width,k=e.height,x=Object(v.j)(j&&k?j/k:1,0===k,0===j),M=Object(a.a)(Object(a.a)({},O),{},{join:"bevel"});n.push({shape:x[0],fill:g,stroke:M}),n.push({shape:x[1],fill:g,stroke:M}),n.push({shape:x[2],fill:y,stroke:M})}else n.push({shape:v.m.pathSymbol3DLayer[0],fill:g,stroke:O}),n.push({shape:v.m.pathSymbol3DLayer[1],fill:y,stroke:O});c=Math.max(c,p),u=c}r.push(n)}})),Promise.resolve(Object(y.b)(r,[u,c],{node:t&&t.node,scale:o,opacity:t&&t.opacity,ariaLabel:null===t||void 0===t?void 0:t.ariaLabel}))}(e,t);case"polygon-3d":case"mesh-3d":return function(e,t){return R.apply(this,arguments)}(e,t)}return Promise.reject(new l.a("symbolPreview: swatchInfo3D","symbol not supported."))}},2248:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return za}));var n=i(4),a=i(12),r=i(34),o=i(1),s=i(99),l=i(89),u=i(88),c=i(90),d=i(91),h=i(94),f=(i(462),i(145)),b=i(481),p=i(453),v=i(322),y=i(102),g=i(127),m=i(681),_=i(97),O=i(191),j=i(98),w=(i(93),i(95)),k=i(349),x=(i(96),i(101)),M=i(676),P=(i(719),i(141)),C=i(213),A=(i(194),i(502));new Map;var T=["B","kB","MB","GB","TB"];var I=i(172),D=i(126),F=i(649),E=i(672),S=i(112),L=i(455),B=i(195),R=i(395),N=i(879),z=i(207),H=y.a.getLogger("esri.widgets.Feature.support.featureUtils"),V=/href=(""|'')/gi,W=/(\{([^\{\r\n]+)\})/g,U=/\'/g,Y=/^\s*expression\//i,q=/(\n)/gi,G=/[\u00A0-\u9999<>\&]/gim,X=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,K=/^(?:mailto:|tel:)/,Z="relationships/",$=Object(L.a)("short-date-short-time");function Q(e){if(null!=e)return e.get("sourceLayer")||e.get("layer")}function J(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(a.a)(Object(n.a)().mark((function e(t,i){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","function"==typeof t?t(i):t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!K.test(e.trim().toLowerCase())}function ie(e){return!!e&&Y.test(e)}function ne(e,t){var i=function(e,t){if(!ie(t)||!e)return null;var i=t.replace(Y,"").toLowerCase(),n=null;return e.some((function(e){return e.name.toLowerCase()===i&&(n=e,!0)})),n}(t,null===e||void 0===e?void 0:e.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function ae(e,t){var i=re(t,e);return i?i.name:e}function re(e,t){var i;return e&&"function"==typeof e.getField&&t&&null!==(i=e.getField(t))&&void 0!==i?i:null}function oe(e){return"".concat(e).trim()}function se(e){var t=e.attributes,i=e.globalAttributes,n=e.layer,a=e.text,r=e.expressionAttributes,s=e.fieldInfoMap;return a?le({formattedAttributes:i,template:de(a,Object(o.a)(Object(o.a)(Object(o.a)({},i),r),t),n),fieldInfoMap:s}):""}function le(e){var t=e.formattedAttributes,i=e.template,n=e.fieldInfoMap;return oe(function(e){return e.replaceAll(V,"")}(Object(C.c)(Object(C.c)(i,(function(e){return function(e,t){var i=t.get(e.toLowerCase());return"{".concat(i&&i.fieldName||e,"}")}(e,n)})),t)))}function ue(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Object(o.a)({},e);return Object.keys(i).forEach((function(e){return function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t[e];if("string"==typeof n){var a=(i?encodeURIComponent(n):n).replaceAll(U,"%27");t[e]=a}}(e,i,t)})),i}function ce(e,t){return e.replaceAll(W,(function(e,i,n){var a=re(t,n);return a?"{".concat(a.name,"}"):i}))}function de(e,t,i){var n=ce(e,i);return n?n.replaceAll(X,(function(e,i,n){return function(e,t,i){var n=(t=oe(t))&&"{"!==t[0];return Object(C.c)(e,ue(i,n||!1))}(e,i||n,t)})):n}function he(e){return null!=e&&"object"==typeof e&&"layer"in e&&!!e.layer}function fe(e){return function(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&"feature"===e.type&&"when"in e}(e)&&function(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}(e)}function be(e,t){var i=t.fieldInfos,n=t.fieldName,a=t.preventPlacesFormatting,r=t.layer,s=pe(i,n),l=null===s||void 0===s?void 0:s.clone(),u=re(r,n);if(l&&!Object(B.w)(n)){var c,d=null===u||void 0===u?void 0:u.type;if("date"===d||"date-only"===d||"time-only"===d||"timestamp-offset"===d||null!==(c=l.format)&&void 0!==c&&c.dateFormat){var h,f,b=null!==(h=l.format)&&void 0!==h?h:new N.a;if(null!==(f=b.dateFormat)&&void 0!==f||(b.dateFormat="date-only"===d?"short-date":"short-date-short-time"),"number"==typeof e){var p=!he(r)&&Object(R.e)(r)&&r.datesInUnknownTimezone||he(r)&&function(e){return null!=e&&"object"==typeof e&&"type"in e&&"map-image"===e.type}(r.layer)&&r.layer.datesInUnknownTimezone;return b.formatDate(e,p)}switch(d){case"date-only":return b.formatDateOnly(e);case"time-only":return b.formatTimeOnly(e);case"timestamp-offset":return b.formatTimestamp(e)}}}var v=null===l||void 0===l?void 0:l.format;return"string"==typeof e&&Object(B.w)(n)&&v?v.formatRasterPixelValue(e):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var i=Number(e);if(!isNaN(i))return i}return e}(e,v))||null==e||null==v?ge(e):a?Object(A.b)(e,Object(o.a)(Object(o.a)({},Object(A.a)(v)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):v.formatNumber(e)}function pe(e,t){if(e&&e.length&&t)return e.find((function(e){var i;return(null===(i=e.fieldName)||void 0===i?void 0:i.toLowerCase())===t.toLowerCase()}))}function ve(e){var t=[];if(!e)return t;var i=e.fieldInfos,n=e.content;return i&&t.push.apply(t,Object(S.a)(i)),n&&Array.isArray(n)?(n.forEach((function(e){if("fields"===e.type){var i=e&&e.fieldInfos;i&&t.push.apply(t,Object(S.a)(i))}})),t):t}function ye(e){return e.replaceAll(G,(function(e){return"&#".concat(e.charCodeAt(0),";")}))}function ge(e){return"string"==typeof e?e.replaceAll(q,'<br class="esri-text-new-line" />'):e}function me(e){var t,i=e.value,n=e.fieldName,a=e.fieldInfos,r=e.fieldInfoMap,o=e.layer,s=e.graphic;if(null==i)return"";var l=function(e){var t=e.fieldName,i=e.value,n=e.graphic,a=e.layer;if(Pe(t))return null;if(!a||"function"!=typeof a.getFieldDomain)return null;var r=n&&a.getFieldDomain(t,{feature:n});return r&&"coded-value"===r.type?r.getName(i):null}({fieldName:n,value:i,graphic:s,layer:o});if(l)return l;var u=function(e){var t=e.fieldName,i=e.graphic,n=e.layer;if(Pe(t))return null;if(!n||"function"!=typeof n.getFeatureType)return null;var a=n.typeIdField;if(!a||t!==a)return null;var r=n.getFeatureType(i);return r?r.name:null}({fieldName:n,graphic:s,layer:o});if(u)return u;if(r.get(n.toLowerCase()))return be(i,{fieldInfos:a||Array.from(r.values()),fieldName:n,layer:o});switch(null===o||void 0===o||null===(t=o.fieldsIndex)||void 0===t||null===(t=t.get(n))||void 0===t?void 0:t.type){case"date":return Object(L.c)(i);case"date-only":return Object(L.d)(i);case"time-only":return Object(L.e)(i);case"timestamp-offset":return Object(L.f)(i)}return ge(i)}function _e(e){var t=e.fieldInfos,i=e.attributes,n=e.layer,a=e.graphic,r=e.fieldInfoMap,o=e.relatedInfos,s={};return null!==o&&void 0!==o&&o.forEach((function(e){return function(e){var t=e.attributes,i=e.relatedInfo,n=e.fieldInfoMap,a=e.fieldInfos,r=e.layer;t&&i&&(i.relatedFeatures&&i.relatedFeatures&&i.relatedFeatures.forEach((function(e){return Ce({attributes:t,graphic:e,relatedInfo:i,fieldInfoMap:n,fieldInfos:a,layer:r})})),i.relatedStatsFeatures&&i.relatedStatsFeatures&&i.relatedStatsFeatures.forEach((function(e){return Ce({attributes:t,graphic:e,relatedInfo:i,fieldInfoMap:n,fieldInfos:a,layer:r})})))}({attributes:s,relatedInfo:e,fieldInfoMap:r,fieldInfos:t,layer:n})})),i&&Object.keys(i).forEach((function(e){var o=i[e];s[e]=me({fieldName:e,fieldInfos:t,fieldInfoMap:r,layer:n,value:o,graphic:a})})),s}function Oe(e,t){return je.apply(this,arguments)}function je(){return(je=Object(a.a)(Object(n.a)().mark((function e(t,i){var a,r,o,s,l,u,c,d,h,f,b;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.layer,o=t.graphic,s=t.outFields,l=t.objectIds,u=t.returnGeometry,c=t.spatialReference,"number"==typeof(d=l[0])||"string"==typeof d){e.next=4;break}return"Could not query required fields for the specified feature. The feature's ID is invalid.",h={layer:r,graphic:o,objectId:d,requiredFields:s},e.abrupt("return",(H.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",h),null));case 4:if(null!==(a=Object(R.b)(r))&&void 0!==a&&null!==(a=a.operations)&&void 0!==a&&a.supportsQuery){e.next=7;break}return"The specified layer cannot be queried. The following fields will not be available.",f={layer:r,graphic:o,requiredFields:s,returnGeometry:u},e.abrupt("return",(H.warn("The specified layer cannot be queried. The following fields will not be available.",f),null));case 7:return(b=r.createQuery()).objectIds=l,b.outFields=null!==s&&void 0!==s&&s.length?s:[r.objectIdField],b.returnGeometry=!!u,b.returnZ=!!u,b.returnM=!!u,b.outSpatialReference=c,e.next=11,r.queryFeatures(b,i);case 11:return e.abrupt("return",e.sent.features[0]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=t.expressionInfos)&&void 0!==i&&i.length){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,Object(z.e)();case 4:return a=e.sent,r=a.arcadeUtils.hasGeometryFunctions,e.abrupt("return",r(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e,t){return Me.apply(this,arguments)}function Me(){return(Me=Object(a.a)(Object(n.a)().mark((function e(t,i){var a,r,s,l,u,c,d,h,f,b,p;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.graphic,r=t.popupTemplate,s=t.layer,l=t.spatialReference,s&&r){e.next=3;break}return e.abrupt("return");case 3:if(e.t0="function"==typeof s.load,!e.t0){e.next=7;break}return e.next=7,s.load(i);case 7:if(a.attributes){e.next=9;break}return e.abrupt("return");case 9:if(null!=(u=a.attributes[s.objectIdField])){e.next=12;break}return e.abrupt("return");case 12:return c=[u],e.next=15,r.getRequiredFields(s.fieldsIndex);case 15:if(d=e.sent,h=Object(B.k)(d,a),f=h?[]:d,e.t1=r.returnGeometry,e.t1){e.next=23;break}return e.next=22,we(r);case 22:e.t1=e.sent;case 23:if(b=e.t1,!h||b){e.next=26;break}return e.abrupt("return");case 26:return e.next=28,Oe({layer:s,graphic:a,outFields:f,objectIds:c,returnGeometry:b,spatialReference:l},i);case 28:(p=e.sent)&&(p.geometry&&(a.geometry=p.geometry),p.attributes&&(a.attributes=Object(o.a)(Object(o.a)({},a.attributes),p.attributes)));case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(Z)}function Ce(e){var t=e.attributes,i=e.graphic,n=e.relatedInfo,a=e.fieldInfos,r=e.fieldInfoMap,o=e.layer;t&&i&&n&&Object.keys(i.attributes).forEach((function(e){var s=function(e){return e?"".concat(Z).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:n.relation.id.toString(),fieldName:e}),l=i.attributes[e];t[s]=me({fieldName:s,fieldInfos:a,fieldInfoMap:r,layer:o,value:l,graphic:i})}))}var Ae=function(e){if(!e)return!1;var t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},Te=function(e){var t,i=e.layer,n=e.method,a=e.query,r=e.definitionExpression;if(null!==(t=i.capabilities)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.supportsCacheHint&&"attachments"!==n){var o=null!=a.where?a.where:null,s=null!=a.geometry?a.geometry:null;Ae(r)||Ae(o)||"extent"===(null===s||void 0===s?void 0:s.type)||"tile"===a.resultType||(a.cacheHint=!0)}};function Ie(e,t,i){return e.filter(fe).find((function(e){return e!==t&&e.url===t.url&&e.layerId===i.relatedTableId}))}var De={editing:!1,operations:{add:!0,update:!0,delete:!0}},Fe=f.a.ofType(F.a),Ee=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e))._getAttachmentsPromise=null,n._attachmentLayer=null,n.capabilities=Object(o.a)({},De),n.activeAttachmentInfo=null,n.activeFileInfo=null,n.attachmentInfos=new Fe,n.fileInfos=new f.a,n.graphic=null,n.mode="view",n.filesEnabled=!1,n.addHandles(Object(g.e)((function(){return n.graphic}),(function(){return n._graphicChanged()}),g.a)),n}return Object(u.a)(i,[{key:"destroy",value:function(){this._attachmentLayer=null,this.graphic=null}},{key:"castCapabilities",value:function(e){return Object(o.a)(Object(o.a)({},De),e)}},{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var e=this.graphic;if(!e)return!1;var t=e.layer||e.sourceLayer;return(null===t||void 0===t?void 0:t.loaded)&&"capabilities"in t&&t.capabilities&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}},{key:"getAttachments",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,r,o,s,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._attachmentLayer,i=this.attachmentInfos,t&&"function"==typeof t.queryAttachments){e.next=3;break}throw new x.a("invalid-layer","getAttachments(): A valid layer is required.");case 3:return a=this._getObjectId(),r=new E.a({objectIds:[a],returnMetadata:!0}),o=[],s=t.queryAttachments(r).then((function(e){return e[a]||o})).catch((function(){return o})),this._getAttachmentsPromise=s,this.notifyChange("state"),e.next=7,s;case 7:return l=e.sent,e.abrupt("return",(i.removeAll(),l.length&&i.addMany(l),this._getAttachmentsPromise=null,this.notifyChange("state"),l));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAttachment",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c=this,d=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>1&&void 0!==d[1]?d[1]:this.graphic,r=this._attachmentLayer,o=this.attachmentInfos,s=this.capabilities,a){e.next=4;break}throw new x.a("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:a});case 4:if(t){e.next=6;break}throw new x.a("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});case 6:if(null!==(i=s.operations)&&void 0!==i&&i.add){e.next=8;break}throw new x.a("invalid-capabilities","addAttachment(): add capabilities are required.");case 8:if(r&&"function"==typeof r.addAttachment){e.next=10;break}throw new x.a("invalid-layer","addAttachment(): A valid layer is required.");case 10:return l=r.addAttachment(a,t).then((function(e){return c._queryAttachment(e.objectId,a)})),e.next=13,l;case 13:return u=e.sent,e.abrupt("return",(o.add(u),u));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteAttachment",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this._attachmentLayer,r=this.attachmentInfos,o=this.graphic,s=this.capabilities,t){e.next=3;break}throw new x.a("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});case 3:if(null!==(i=s.operations)&&void 0!==i&&i.delete){e.next=5;break}throw new x.a("invalid-capabilities","deleteAttachment(): delete capabilities are required.");case 5:if(a&&"function"==typeof a.deleteAttachments){e.next=7;break}throw new x.a("invalid-layer","deleteAttachment(): A valid layer is required.");case 7:if(o){e.next=9;break}throw new x.a("invalid-graphic","deleteAttachment(): A graphic is required.");case 9:return l=a.deleteAttachments(o,[t.id]).then((function(){return t})),e.next=12,l;case 12:return u=e.sent,e.abrupt("return",(r.remove(u),u));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c,d,h=this,f=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=f.length>1&&void 0!==f[1]?f[1]:this.activeAttachmentInfo,r=this._attachmentLayer,o=this.attachmentInfos,s=this.graphic,l=this.capabilities,t){e.next=4;break}throw new x.a("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});case 4:if(a){e.next=6;break}throw new x.a("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:a});case 6:if(null!==(i=l.operations)&&void 0!==i&&i.update){e.next=8;break}throw new x.a("invalid-capabilities","updateAttachment(): Update capabilities are required.");case 8:if(u=o.findIndex((function(e){return e===a})),r&&"function"==typeof r.updateAttachment){e.next=11;break}throw new x.a("invalid-layer","updateAttachment(): A valid layer is required.");case 11:if(s){e.next=13;break}throw new x.a("invalid-graphic","updateAttachment(): A graphic is required.");case 13:return c=r.updateAttachment(s,a.id,t).then((function(e){return h._queryAttachment(e.objectId)})),e.next=16,c;case 16:return d=e.sent,e.abrupt("return",(o.splice(u,1,d),d));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"commitFiles",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.fileInfos.items.map((function(e){return t.addAttachment(e.form)})));case 2:return this.fileInfos.removeAll(),e.abrupt("return",this.getAttachments());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFile",value:function(e,t){if(!e||!t)return null;var i={file:e,form:t};return this.fileInfos.add(i),i}},{key:"updateFile",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.activeFileInfo;if(!e||!t||!i)return null;var n=this.fileInfos.findIndex((function(e){return i===e}));return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}},{key:"deleteFile",value:function(e){var t=this.fileInfos.find((function(t){return t.file===e}));return t?(this.fileInfos.remove(t),t):null}},{key:"_queryAttachment",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,i){var a,r,o;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this._attachmentLayer,t&&null!==a&&void 0!==a&&a.queryAttachments){e.next=3;break}throw new x.a("invalid-attachment-id","Could not query attachment.");case 3:return r=this._getObjectId(i),o=new E.a({objectIds:[r],attachmentsWhere:"AttachmentId=".concat(t),returnMetadata:!0}),e.abrupt("return",a.queryAttachments(o).then((function(e){return e[r][0]})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getObjectId",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.graphic;return null!==(e=null===t||void 0===t?void 0:t.getObjectId())&&void 0!==e?e:null}},{key:"_graphicChanged",value:function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((function(){})))}},{key:"_setAttachmentLayer",value:function(){var e=Q(this.graphic);this._attachmentLayer=e?"scene"===e.type&&null!=e.associatedLayer?e.associatedLayer:e:null}}]),i}(D.a);Object(h.a)([Object(_.b)()],Ee.prototype,"capabilities",void 0),Object(h.a)([Object(O.a)("capabilities")],Ee.prototype,"castCapabilities",null),Object(h.a)([Object(_.b)()],Ee.prototype,"activeAttachmentInfo",void 0),Object(h.a)([Object(_.b)()],Ee.prototype,"activeFileInfo",void 0),Object(h.a)([Object(_.b)({readOnly:!0,type:Fe})],Ee.prototype,"attachmentInfos",void 0),Object(h.a)([Object(_.b)()],Ee.prototype,"fileInfos",void 0),Object(h.a)([Object(_.b)({type:I.a})],Ee.prototype,"graphic",void 0),Object(h.a)([Object(_.b)()],Ee.prototype,"mode",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ee.prototype,"state",null),Object(h.a)([Object(_.b)()],Ee.prototype,"filesEnabled",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ee.prototype,"supportsResizeAttachments",null);var Se=Ee=Object(h.a)([Object(w.a)("esri.widgets.Attachments.AttachmentsViewModel")],Ee),Le=i(288);function Be(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}var Re=i(753),Ne=i(209),ze=i(371),He=i(283),Ve={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},We="esri-attachments",Ue="esri-button",Ye={base:We,loaderContainer:"".concat(We,"__loader-container"),loader:"".concat(We,"__loader"),fadeIn:"".concat(We,"--fade-in"),container:"".concat(We,"__container"),containerList:"".concat(We,"__container--list"),containerPreview:"".concat(We,"__container--preview"),actions:"".concat(We,"__actions"),deleteButton:"".concat(We,"__delete-button"),addAttachmentButton:"".concat(We,"__add-attachment-button"),errorMessage:"".concat(We,"__error-message"),items:"".concat(We,"__items"),item:"".concat(We,"__item"),itemButton:"".concat(We,"__item-button"),itemMask:"".concat(We,"__item-mask"),itemMaskIcon:"".concat(We,"__item-mask--icon"),itemImage:"".concat(We,"__image"),itemImageResizable:"".concat(We,"__image--resizable"),itemLabel:"".concat(We,"__label"),itemFilename:"".concat(We,"__filename"),itemChevronIcon:"".concat(We,"__item-chevron-icon"),itemLink:"".concat(We,"__item-link"),itemLinkOverlay:"".concat(We,"__item-link-overlay"),itemLinkOverlayIcon:"".concat(We,"__item-link-overlay-icon"),itemEditIcon:"".concat(We,"__item-edit-icon"),itemAddIcon:"".concat(We,"__item-add-icon"),itemAddButton:"".concat(We,"__item-add-button"),formNode:"".concat(We,"__form-node"),fileFieldset:"".concat(We,"__file-fieldset"),fileLabel:"".concat(We,"__file-label"),fileName:"".concat(We,"__file-name"),fileInput:"".concat(We,"__file-input"),metadata:"".concat(We,"__metadata"),metadataFieldset:"".concat(We,"__metadata-fieldset"),progressBar:"".concat(We,"__progress-bar"),esriWidget:"esri-widget",esriButton:Ue,buttonDisabled:"".concat(Ue,"--disabled"),esriButtonSecondary:"".concat(Ue,"--secondary"),esriButtonTertiary:"".concat(Ue,"--tertiary"),esriButtonThird:"".concat(Ue,"--third"),esriButtonSmall:"".concat(Ue,"--small"),esriButtonHalf:"".concat(Ue,"--half"),empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},qe=window.CSS,Ge=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e,i){var a;return Object(l.a)(this,n),(a=t.call(this,e,i)).displayType="auto",a.messages=null,a.messagesUnits=null,a.selectedFile=null,a.submitting=!1,a.viewModel=null,a.visibleElements=Object(o.a)({},Ve),a._supportsImageOrientation=qe&&qe.supports&&qe.supports("image-orientation","from-image"),a._addAttachmentForm=null,a._updateAttachmentForm=null,a}return Object(u.a)(n,[{key:"initialize",value:function(){var e=this;this.viewModel||(this.viewModel=new Se),this.addHandles([Object(g.b)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.attachmentInfos}),"change",(function(){return e.scheduleRender()})),Object(g.b)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.fileInfos}),"change",(function(){return e.scheduleRender()})),Object(g.e)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.mode}),(function(){return e._modeChanged()}),g.a)])}},{key:"loadDependencies",value:function(){return Object(Re.b)({icon:function(){return i.e(26).then(i.bind(null,2229))}})}},{key:"capabilities",get:function(){return this.viewModel.capabilities},set:function(e){this.viewModel.capabilities=e}},{key:"effectiveDisplayType",get:function(){var e=this.displayType;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"castVisibleElements",value:function(e){return Object(o.a)(Object(o.a)({},Ve),e)}},{key:"addAttachment",value:function(){var e=this,t=this._addAttachmentForm,i=this.viewModel;return this._set("submitting",!0),this._set("error",null),i.addAttachment(t).then((function(t){return e._set("submitting",!1),e._set("error",null),i.mode="view",t})).catch((function(t){throw e._set("submitting",!1),e._set("error",new x.a("attachments:add-attachment",e.messages.addErrorMessage,t)),t}))}},{key:"deleteAttachment",value:function(e){var t=this,i=this.viewModel;return this._set("submitting",!0),this._set("error",null),i.deleteAttachment(e).then((function(e){return t._set("submitting",!1),t._set("error",null),i.mode="view",e})).catch((function(e){throw t._set("submitting",!1),t._set("error",new x.a("attachments:delete-attachment",t.messages.deleteErrorMessage,e)),e}))}},{key:"updateAttachment",value:function(){var e=this,t=this.viewModel,i=this._updateAttachmentForm;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(i).then((function(i){return e._set("submitting",!1),e._set("error",null),t.mode="view",i})).catch((function(t){throw e._set("submitting",!1),e._set("error",new x.a("attachments:update-attachment",e.messages.updateErrorMessage,t)),t}))}},{key:"addFile",value:function(){var e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}},{key:"updateFile",value:function(){var e=this.viewModel,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}},{key:"deleteFile",value:function(e){var t,i=this.viewModel.deleteFile(e||(null===(t=this.viewModel.activeFileInfo)||void 0===t?void 0:t.file));return this.viewModel.mode="view",i}},{key:"render",value:function(){var e=this.submitting,t=this.viewModel.state;return Object(He.a)("div",{class:this.classes(Ye.base,Ye.esriWidget)},e?this.renderProgressBar():null,"loading"===t?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}},{key:"renderErrorMessage",value:function(){var e=this.error,t=this.visibleElements;return e&&t.errorMessage?Object(He.a)("div",{key:"error-message",class:Ye.errorMessage},e.message):null}},{key:"renderAttachments",value:function(){var e=this.viewModel,t=e.activeFileInfo,i=e.mode,n=e.activeAttachmentInfo;return"add"===i?this.renderAddForm():"edit"===i?this.renderDetailsForm(n||t):this.renderAttachmentContainer()}},{key:"renderLoading",value:function(){return Object(He.a)("div",{class:Ye.loaderContainer,key:"loader"},Object(He.a)("div",{class:Ye.loader}))}},{key:"renderProgressBar",value:function(){return this.visibleElements.progressBar?Object(He.a)("div",{class:Ye.progressBar,key:"progress-bar"}):null}},{key:"renderAddForm",value:function(){var e=this.submitting,t=this.selectedFile,i=e||!t,n=this.visibleElements.cancelAddButton?Object(He.a)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(Ye.esriButton,Ye.esriButtonTertiary,Ye.esriButtonSmall,Ye.esriButtonHalf,e&&Ye.buttonDisabled)},this.messages.cancel):null,a=this.visibleElements.addSubmitButton?Object(He.a)("button",{type:"submit",disabled:i,class:this.classes(Ye.esriButton,Ye.esriButtonSecondary,Ye.esriButtonSmall,Ye.esriButtonHalf,Object(r.a)({},Ye.buttonDisabled,i))},this.messages.add):null,o=t?Object(He.a)("span",{key:"file-name",class:Ye.fileName},t.name):null,s=Object(He.a)("form",{bind:this,afterCreate:Ne.h,afterRemoved:Ne.c,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},Object(He.a)("fieldset",{class:Ye.fileFieldset},o,Object(He.a)("label",{class:this.classes(Ye.fileLabel,Ye.esriButton,Ye.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,Object(He.a)("input",{class:Ye.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),a,n);return Object(He.a)("div",{key:"add-form-container",class:Ye.formNode},s)}},{key:"renderDetailsForm",value:function(e){var t,i,n,a,o,s,l,u,c=this,d=this.visibleElements,h=this.viewModel,f=this.selectedFile,b=this.submitting,p=h.capabilities,v=b||!f;f?(o=f.type,s=f.name,l=f.size):e&&"file"in e?(o=e.file.type,s=e.file.name,l=e.file.size):e&&"contentType"in e&&(o=e.contentType,s=e.name,l=e.size,u=e.url);var y=p.editing&&null!==(t=p.operations)&&void 0!==t&&t.delete&&d.deleteButton?Object(He.a)("button",{key:"delete-button",type:"button",disabled:b,bind:this,onclick:function(t){return c._submitDeleteAttachment(t,e)},class:this.classes(Ye.esriButton,Ye.esriButtonSmall,Ye.esriButtonTertiary,Ye.deleteButton,Object(r.a)({},Ye.buttonDisabled,b))},this.messages.delete):void 0,g=p.editing&&null!==(i=p.operations)&&void 0!==i&&i.update&&d.updateButton?Object(He.a)("button",{disabled:v,key:"update-button",type:"submit",class:this.classes(Ye.esriButton,Ye.esriButtonSmall,Ye.esriButtonThird,Object(r.a)({},Ye.buttonDisabled,v))},this.messages.update):void 0,m=this.visibleElements.cancelUpdateButton?Object(He.a)("button",{disabled:b,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(Ye.esriButton,Ye.esriButtonSmall,Ye.esriButtonTertiary,Ye.esriButtonThird,Object(r.a)({},Ye.buttonDisabled,b))},this.messages.cancel):void 0,_=p.editing&&null!==(n=p.operations)&&void 0!==n&&n.update?Object(He.a)("fieldset",{key:"file",class:Ye.fileFieldset},Object(He.a)("span",{key:"file-name",class:Ye.fileName},s),Object(He.a)("label",{class:this.classes(Ye.fileLabel,Ye.esriButton,Ye.esriButtonSecondary)},this.messages.changeFile,Object(He.a)("input",{class:Ye.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,O=Object(He.a)("fieldset",{key:"size",class:Ye.metadataFieldset},Object(He.a)("label",null,function(e,t){var i=0===t?0:Math.floor(Math.log(t)/Math.log(M.a.KILOBYTES));i=Object(P.e)(i,0,T.length-1);var n=Object(A.b)(t/Math.pow(M.a.KILOBYTES,i),{maximumFractionDigits:2});return Object(C.c)(e.units.bytes[T[i]],{fileSize:n})}(this.messagesUnits,null!==(a=l)&&void 0!==a?a:0))),j=Object(He.a)("fieldset",{key:"content-type",class:Ye.metadataFieldset},Object(He.a)("label",null,o)),w=null!=u?Object(He.a)("a",{class:Ye.itemLink,href:u,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),Object(He.a)("div",{class:Ye.itemLinkOverlay},Object(He.a)("span",{class:Ye.itemLinkOverlayIcon},Object(He.a)("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),k=Object(He.a)("form",{bind:this,afterCreate:Ne.h,afterRemoved:Ne.c,"data-node-ref":"_updateAttachmentForm",onsubmit:function(t){return c._submitUpdateAttachment(t,e)}},Object(He.a)("div",{class:Ye.metadata},O,j),_,Object(He.a)("div",{class:Ye.actions},y,m,g));return Object(He.a)("div",{key:"edit-form-container",class:Ye.formNode},w,k)}},{key:"renderImageMask",value:function(e,t){return e?"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t):null}},{key:"renderGenericImageMask",value:function(e,t){var i=this.viewModel.supportsResizeAttachments,n=function(e){var t=Object(Le.a)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):e.includes("image/")?"".concat(t,"image-32.svg"):e.includes("audio/")?"".concat(t,"sound-32.svg"):e.includes("video/")?"".concat(t,"video-32.svg"):e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?"".concat(t,"excel-32.svg"):e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?"".concat(t,"word-32.svg"):e.includes("powerpoint")||e.includes("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(t),a=Object(r.a)({},Ye.itemImageResizable,i);return Object(He.a)("div",{key:n,class:this.classes(Ye.itemMaskIcon,Ye.itemMask)},Object(He.a)("img",{title:e,alt:e,src:n,class:this.classes(a,Ye.itemImage)}))}},{key:"renderImageMaskForAttachment",value:function(e,t){var i=this.viewModel.supportsResizeAttachments;if(!e)return null;var n=e.contentType,a=e.name,o=e.url;if(!i||!Be(n))return this.renderGenericImageMask(a,n);var s=this._getCSSTransform(e),l=s?{transform:s,"image-orientation":"none"}:{},u="".concat(o).concat(null!==o&&void 0!==o&&o.includes("?")?"&":"?","w=").concat(t),c=Object(r.a)({},Ye.itemImageResizable,i);return Object(He.a)("div",{key:u,class:this.classes(Ye.itemMask)},Object(He.a)("img",{styles:l,alt:a,title:a,src:u,class:this.classes(c,Ye.itemImage)}))}},{key:"renderFile",value:function(e){var t=this,i=e.file;return Object(He.a)("li",{class:Ye.item,key:i},Object(He.a)("button",{key:"details-button",bind:this,class:Ye.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:function(){return t._startEditFile(e)},type:"button"},this.renderImageMask(e),Object(He.a)("label",{class:Ye.itemLabel},Object(He.a)("span",{class:Ye.itemFilename},i.name||this.messages.noTitle),Object(He.a)("span",{"aria-hidden":"true",class:this.classes(Ye.itemChevronIcon,Object(Ne.e)(this.container)?Ye.iconLeft:Ye.iconRight)}))))}},{key:"renderAttachmentInfo",value:function(e){var t=this,i=e.attachmentInfo,n=e.displayType,a=this.viewModel,r=this.effectiveDisplayType,o=a.capabilities,s=a.supportsResizeAttachments,l=i.contentType,u=i.name,c=i.url,d=this.renderImageMask(i,"list"===n?48:400),h=o.editing?Object(He.a)("span",{"aria-hidden":"true",class:this.classes(Ye.itemChevronIcon,Object(Ne.e)(this.container)?Ye.iconLeft:Ye.iconRight)}):null,f=[d,"preview"===r&&s&&Be(l)?null:Object(He.a)("label",{class:Ye.itemLabel},Object(He.a)("span",{class:Ye.itemFilename},u||this.messages.noTitle),h)],b=o.editing?Object(He.a)("button",{key:"details-button",bind:this,class:Ye.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":i.id,onclick:function(){return t._startEditAttachment(i)},type:"button"},f):Object(He.a)("a",{key:"details-link",class:Ye.itemButton,href:null!==c&&void 0!==c?c:void 0,target:"_blank"},f);return Object(He.a)("li",{class:Ye.item,key:i},b)}},{key:"renderAttachmentContainer",value:function(){var e,t,i=this,n=this.effectiveDisplayType,a=this.viewModel,o=this.visibleElements,s=a.attachmentInfos,l=a.capabilities,u=a.fileInfos,c=!(null===s||void 0===s||!s.length),d=!(null===u||void 0===u||!u.length),h=(e={},Object(r.a)(e,Ye.containerList,"preview"!==n),Object(r.a)(e,Ye.containerPreview,"preview"===n),e),f=l.editing&&null!==(t=l.operations)&&void 0!==t&&t.add&&o.addButton?Object(He.a)("button",{bind:this,onclick:function(){return i._startAddAttachment()},class:this.classes(Ye.esriButton,Ye.esriButtonTertiary,Ye.addAttachmentButton),type:"button"},Object(He.a)("span",{"aria-hidden":"true",class:this.classes(Ye.itemAddIcon,Ye.iconPlus)}),this.messages.add):void 0,b=c?Object(He.a)("ul",{key:"attachments-list",class:Ye.items},s.toArray().map((function(e){return i.renderAttachmentInfo({attachmentInfo:e,displayType:n})}))):void 0,p=d?Object(He.a)("ul",{key:"file-list",class:Ye.items},u.toArray().map((function(e){return i.renderFile(e)}))):void 0,v=d||c?void 0:Object(He.a)("div",{class:Ye.empty},this.messages.noAttachments);return Object(He.a)("div",{key:"attachments-container",class:this.classes(Ye.container,h)},b,p,v,f)}},{key:"_modeChanged",value:function(){this._set("error",null),this._set("selectedFile",null)}},{key:"_handleFileInputChange",value:function(e){var t=e.target,i=t&&t.files&&t.files.item(0);this._set("selectedFile",i)}},{key:"_submitDeleteAttachment",value:function(e,t){e.preventDefault(),t&&("file"in t?this.deleteFile(t.file):t&&this.deleteAttachment(t))}},{key:"_submitAddAttachment",value:function(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}},{key:"_submitUpdateAttachment",value:function(e,t){e.preventDefault(),t&&"file"in t?this.updateFile():this.updateAttachment()}},{key:"_startEditAttachment",value:function(e){var t=this.viewModel;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}},{key:"_startEditFile",value:function(e){var t=this.viewModel;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}},{key:"_startAddAttachment",value:function(){this.viewModel.mode="add"}},{key:"_cancelForm",value:function(e){e.preventDefault(),this.viewModel.mode="view"}},{key:"_getCSSTransform",value:function(e){var t=e.orientationInfo;return!this._supportsImageOrientation&&t?[t.rotation?"rotate(".concat(t.rotation,"deg)"):"",t.mirrored?"scaleX(-1)":""].join(" "):""}}]),n}(k.a);Object(h.a)([Object(_.b)()],Ge.prototype,"capabilities",null),Object(h.a)([Object(_.b)()],Ge.prototype,"displayType",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ge.prototype,"effectiveDisplayType",null),Object(h.a)([Object(_.b)()],Ge.prototype,"graphic",null),Object(h.a)([Object(_.b)()],Ge.prototype,"label",null),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/Attachments/t9n/Attachments")],Ge.prototype,"messages",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/core/t9n/Units")],Ge.prototype,"messagesUnits",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ge.prototype,"selectedFile",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ge.prototype,"submitting",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ge.prototype,"error",void 0),Object(h.a)([Object(_.b)({type:Se})],Ge.prototype,"viewModel",void 0),Object(h.a)([Object(_.b)()],Ge.prototype,"visibleElements",void 0),Object(h.a)([Object(O.a)("visibleElements")],Ge.prototype,"castVisibleElements",null);var Xe=Ge=Object(h.a)([Object(w.a)("esri.widgets.Attachments")],Ge),Ke=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).description=null,n.title=null,n}return Object(u.a)(i)}(Se);Object(h.a)([Object(_.b)()],Ke.prototype,"description",void 0),Object(h.a)([Object(_.b)()],Ke.prototype,"title",void 0);var Ze=Ke=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],Ke),$e=i(442),Qe=["level","class"],Je="esri-widget__heading";function et(e,t){var i=e.level,n=e.class,a=Object($e.a)(e,Qe),r=tt(i);return Object(He.a)("h".concat(r),Object(o.a)(Object(o.a)({},a),{},{class:Object(Ne.a)(Je,n),role:"heading","aria-level":String(r)}),t)}function tt(e){return Object(P.e)(Math.ceil(e),1,6)}var it="esri-feature-element-info",nt={base:it,title:"".concat(it,"__title"),description:"".concat(it,"__description")},at=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(l.a)(this,i),(a=t.call(this,e,n)).description=null,a.headingLevel=2,a.title=null,a}return Object(u.a)(i,[{key:"render",value:function(){return Object(He.a)("div",{class:nt.base},this.renderTitle(),this.renderDescription())}},{key:"renderTitle",value:function(){var e=this.title;return e?Object(He.a)(et,{level:this.headingLevel,class:nt.title},e):null}},{key:"renderDescription",value:function(){var e=this.description;return e?Object(He.a)("div",{key:"description",class:nt.description},e):null}}]),i}(k.a);Object(h.a)([Object(_.b)()],at.prototype,"description",void 0),Object(h.a)([Object(_.b)()],at.prototype,"headingLevel",void 0),Object(h.a)([Object(_.b)()],at.prototype,"title",void 0);var rt=at=Object(h.a)([Object(w.a)("esri.widgets.Feature.support.FeatureElementInfo")],at),ot="esri-feature-attachments",st=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(l.a)(this,i),(a=t.call(this,e,n))._featureElementInfo=null,a.attachmentsWidget=new Xe,a.headingLevel=2,a.viewModel=new Ze,a}return Object(u.a)(i,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new rt,this.addHandles([Object(g.e)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(i=e.viewModel)||void 0===i?void 0:i.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),g.a),Object(g.e)((function(){return e.viewModel}),(function(t){return e.attachmentsWidget.viewModel=t}),g.a)])}},{key:"destroy",value:function(){var e;this.attachmentsWidget.viewModel=null,this.attachmentsWidget.destroy(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"displayType",get:function(){return this.attachmentsWidget.displayType},set:function(e){this.attachmentsWidget.displayType=e}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"render",value:function(){var e,t=this.attachmentsWidget;return Object(He.a)("div",{class:ot},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,i=this.title,n=this.headingLevel;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i,headingLevel:n})}}]),i}(k.a);Object(h.a)([Object(_.b)({readOnly:!0})],st.prototype,"attachmentsWidget",void 0),Object(h.a)([Object(_.b)()],st.prototype,"description",null),Object(h.a)([Object(_.b)()],st.prototype,"displayType",null),Object(h.a)([Object(_.b)()],st.prototype,"graphic",null),Object(h.a)([Object(_.b)()],st.prototype,"headingLevel",void 0),Object(h.a)([Object(_.b)()],st.prototype,"title",null),Object(h.a)([Object(_.b)({type:Ze})],st.prototype,"viewModel",void 0);var lt=st=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureAttachments")],st),ut=i(189),ct=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e))._loadingPromise=null,n.created=null,n.creator=null,n.destroyer=null,n.graphic=null,n.handles.add(Object(g.e)((function(){return n.creator}),(function(e){n._destroyContent(),n._createContent(e)}),g.a)),n}return Object(u.a)(i,[{key:"destroy",value:function(){this._destroyContent()}},{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}},{key:"_destroyContent",value:function(){var e=this.created,t=this.graphic,i=this.destroyer;e&&t&&(J(i,{graphic:t}).catch((function(){return null})),this._set("created",null))}},{key:"_createContent",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=this.graphic)&&t){e.next=3;break}return e.abrupt("return");case 3:return a=J(t,{graphic:i}).catch((function(){return null})),this._loadingPromise=a,this.notifyChange("state"),e.next=7,a;case 7:r=e.sent,a===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",r));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),i}(Object(ut.b)(D.a));Object(h.a)([Object(_.b)({readOnly:!0})],ct.prototype,"created",void 0),Object(h.a)([Object(_.b)()],ct.prototype,"creator",void 0),Object(h.a)([Object(_.b)()],ct.prototype,"destroyer",void 0),Object(h.a)([Object(_.b)({type:I.a})],ct.prototype,"graphic",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],ct.prototype,"state",null);var dt=ct=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],ct),ht=i(1166),ft="esri-feature-content",bt={base:ft,loaderContainer:"".concat(ft,"__loader-container"),loader:"".concat(ft,"__loader")},pt=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(l.a)(this,i),(a=t.call(this,e,n)).viewModel=null,a._addTargetToAnchors=function(e){Array.from(e.querySelectorAll("a")).forEach((function(e){te(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))},a}return Object(u.a)(i,[{key:"creator",get:function(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.creator},set:function(e){this.viewModel&&(this.viewModel.creator=e)}},{key:"graphic",get:function(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.graphic},set:function(e){this.viewModel&&(this.viewModel.graphic=e)}},{key:"renderLoading",value:function(){return Object(He.a)("div",{class:bt.loaderContainer,key:"loader"},Object(He.a)("div",{class:bt.loader}))}},{key:"renderCreated",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?Object(He.a)("div",{key:t,bind:t,afterCreate:this._attachToNode}):Object(ht.b)(t)?Object(He.a)("div",{key:t},!t.destroyed&&t.render()):Object(He.a)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}},{key:"render",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return Object(He.a)("div",{class:bt.base},"loading"===t?this.renderLoading():this.renderCreated())}},{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),i}(k.a);Object(h.a)([Object(_.b)()],pt.prototype,"creator",null),Object(h.a)([Object(_.b)()],pt.prototype,"graphic",null),Object(h.a)([Object(_.b)({type:dt})],pt.prototype,"viewModel",void 0);var vt=pt=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureContent")],pt),yt=i(958),gt=i(655),mt=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).attributes=null,n.expressionInfos=null,n.description=null,n.fieldInfos=null,n.title=null,n}return Object(u.a)(i,[{key:"formattedFieldInfos",get:function(){var e=this.expressionInfos,t=this.fieldInfos,i=[];return null!==t&&void 0!==t&&t.forEach((function(t){if(!t.hasOwnProperty("visible")||t.visible){var n=t.clone();n.label=ne(n,e),i.push(n)}})),i}}]),i}(D.a);Object(h.a)([Object(_.b)()],mt.prototype,"attributes",void 0),Object(h.a)([Object(_.b)({type:[yt.a]})],mt.prototype,"expressionInfos",void 0),Object(h.a)([Object(_.b)()],mt.prototype,"description",void 0),Object(h.a)([Object(_.b)({type:[gt.a]})],mt.prototype,"fieldInfos",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],mt.prototype,"formattedFieldInfos",null),Object(h.a)([Object(_.b)()],mt.prototype,"title",void 0);var _t=mt=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],mt),Ot=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function jt(e,t){if("string"!=typeof t||!t)return t;var i=function(e){var t=null;return Ot.some((function(i){return i.pattern.test(e)&&(t=i),!!t})),t}(t);if(!i)return t;var n=t.match(i.pattern),a=n&&n[2],r=Object(C.c)(Object(C.c)(i.label,{messages:e,hierPart:a}),{appName:i.appName}),o=i.target?' target="'.concat(i.target,'"'):"",s="_blank"===i.target?' rel="noreferrer"':"";return t.replace(i.pattern,"<a".concat(o,' href="$1"').concat(s,">").concat(r,"</a>"))}var wt="esri-feature-fields",kt={base:wt,fieldHeader:"".concat(wt,"__field-header"),fieldData:"".concat(wt,"__field-data"),fieldDataDate:"".concat(wt,"__field-data--date"),esriTable:"esri-widget__table"},xt=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(l.a)(this,i),(a=t.call(this,e,n))._featureElementInfo=null,a.viewModel=new _t,a.messages=null,a.messagesURIUtils=null,a}return Object(u.a)(i,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new rt,this.addHandles(Object(g.e)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(i=e.viewModel)||void 0===i?void 0:i.title]}),(function(){return e._setupFeatureElementInfo()}),g.a))}},{key:"destroy",value:function(){var e;null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"expressionInfos",get:function(){return this.viewModel.expressionInfos},set:function(e){this.viewModel.expressionInfos=e}},{key:"fieldInfos",get:function(){return this.viewModel.fieldInfos},set:function(e){this.viewModel.fieldInfos=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"renderFieldInfo",value:function(e,t){var i=this.viewModel.attributes,n=e.fieldName,a=e.label||n,o=i?null==i[n]?"":i[n]:"",s=!(!e.format||!e.format.dateFormat),l="number"!=typeof o||s?jt(this.messagesURIUtils,o):this._forceLTR(o),u=Object(r.a)({},kt.fieldDataDate,s);return Object(He.a)("tr",{key:"fields-element-info-row-".concat(n,"-").concat(t)},Object(He.a)("th",{key:"fields-element-info-row-header-".concat(n,"-").concat(t),class:kt.fieldHeader,innerHTML:a}),Object(He.a)("td",{key:"fields-element-info-row-data-".concat(n,"-").concat(t),class:this.classes(kt.fieldData,u),innerHTML:l}))}},{key:"renderFields",value:function(){var e=this,t=this.viewModel.formattedFieldInfos;return null!==t&&void 0!==t&&t.length?Object(He.a)("table",{class:kt.esriTable,summary:this.messages.fieldsSummary},Object(He.a)("tbody",null,t.map((function(t,i){return e.renderFieldInfo(t,i)})))):null}},{key:"render",value:function(){var e;return Object(He.a)("div",{class:kt.base},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderFields())}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,i=this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}},{key:"_forceLTR",value:function(e){return"&lrm;".concat(e)}}]),i}(k.a);Object(h.a)([Object(_.b)()],xt.prototype,"attributes",null),Object(h.a)([Object(_.b)()],xt.prototype,"description",null),Object(h.a)([Object(_.b)()],xt.prototype,"expressionInfos",null),Object(h.a)([Object(_.b)()],xt.prototype,"fieldInfos",null),Object(h.a)([Object(_.b)()],xt.prototype,"title",null),Object(h.a)([Object(_.b)({type:_t,nonNullable:!0})],xt.prototype,"viewModel",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/Feature/t9n/Feature")],xt.prototype,"messages",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/support/t9n/uriUtils")],xt.prototype,"messagesURIUtils",void 0);var Mt=xt=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureFields")],xt),Pt=i(120),Ct=i(92),At=i(402);var Tt={maximumFractionDigits:20};function It(e){return Object(A.b)(e,Tt)}i(885);var Dt=i(739),Ft=i(143),Et=(i(177),i(346),"<"),St=">",Lt=Object(L.a)("short-date");var Bt=new Ft.a([64,64,64]);function Rt(e,t){var i=[],n=e.length-1;return 5===e.length?i.push(0,2,4):i.push(0,n),e.map((function(e,a){return i.includes(a)?function(e,t,i,n){var a="";return 0===t?a="".concat(Et," "):t===i&&(a="".concat(St," ")),a+(n?Object(L.c)(e,Lt):It(e))}(e,a,n,t):null}))}function Nt(e,t,i){return zt.apply(this,arguments)}function zt(){return zt=Object(a.a)(Object(n.a)().mark((function e(t,r,o){var s,l,u,c,d,h,f;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=!1,l=[],u=[],t.stops&&(c=t.stops,l=c.map((function(e){return e.value})),s=c.some((function(e){return!!e.label})),s&&(u=c.map((function(e){return e.label})))),d=l[0],h=l[l.length-1],null!=d||null!=h){e.next=5;break}return e.abrupt("return",null);case 5:return f=s?null:Rt(l,null!==o&&void 0!==o&&o),e.next=8,Promise.all(l.map(function(){var e=Object(a.a)(Object(n.a)().mark((function e(a,o){var l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a,"opacity"!==t.type){e.next=7;break}return e.next=4,Ht(a,t,r);case 4:e.t1=e.sent,e.next=10;break;case 7:return e.next=9,Promise.resolve().then(i.bind(null,982));case 9:e.t1=e.sent.getColor(t,a);case 10:return e.t2=e.t1,e.t3=s?u[o]:null!==(l=null===f||void 0===f?void 0:f[o])&&void 0!==l?l:"",e.abrupt("return",{value:e.t0,color:e.t2,label:e.t3});case 13:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}()));case 8:return e.abrupt("return",e.sent.reverse());case 9:case"end":return e.stop()}}),e)}))),zt.apply(this,arguments)}function Ht(e,t,i){return Vt.apply(this,arguments)}function Vt(){return(Vt=Object(a.a)(Object(n.a)().mark((function e(t,a,r){var o,s;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new Ft.a(null!==r&&void 0!==r?r:Bt),e.next=3,Promise.resolve().then(i.bind(null,982));case 3:return s=e.sent.getOpacity(a,t),e.abrupt("return",(null!=s&&(o.a=s),o));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Wt=i(1145);function Ut(e){if(!e.colorStops)return[];var t=Object(S.a)(e.colorStops).filter((function(e){var t;return(null===(t=e.color)||void 0===t?void 0:t.a)>0})),i=t.length-1;if(t&&t[0]){var n=t[i];n&&1!==n.ratio&&(t.push(new Wt.a({ratio:1,color:n.color})),i++)}return t.map((function(t,n){var a,r,o="";return 0===n?o=(null===(a=e.legendOptions)||void 0===a?void 0:a.minLabel)||"low":n===i&&(o=(null===(r=e.legendOptions)||void 0===r?void 0:r.maxLabel)||"high"),{color:t.color,label:o,ratio:t.ratio}})).reverse()}y.a.getLogger("esri.renderers.support.utils"),Object(L.a)("short-date");function Yt(e,t,i){return qt.apply(this,arguments)}function qt(){return(qt=Object(a.a)(Object(n.a)().mark((function e(t,i,a){var r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=Object(At.a)(t,i,(function(){return[]}))).push.apply(r,Object(S.a)(a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gt(e){return Xt.apply(this,arguments)}function Xt(){return(Xt=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,w,k,x,M,P,C,A,T,I,D;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Map,t){e.next=3;break}return e.abrupt("return",a);case 3:if(!("visualVariables"in t)||!t.visualVariables){e.next=34;break}r=t.visualVariables.filter((function(e){return"color"===e.type})),o=Object(Ct.a)(r),e.prev=6,o.s();case 8:if((s=o.n()).done){e.next=26;break}return u=s.value,e.next=12,Nt(u);case 12:if(e.t1=l=e.sent,e.t0=null!==e.t1,!e.t0){e.next=16;break}e.t0=void 0!==l;case 16:if(!e.t0){e.next=20;break}e.t2=l,e.next=21;break;case 20:e.t2=[];case 21:return c=e.t2.map((function(e){return e.color})),e.next=24,Yt(a,u.field||u.valueExpression,c);case 24:e.next=8;break;case 26:e.next=31;break;case 28:e.prev=28,e.t3=e.catch(6),o.e(e.t3);case 31:return e.prev=31,o.f(),e.finish(31);case 34:if("heatmap"!==t.type){e.next=40;break}return d=Ut(t).map((function(e){return e.color})),e.next=38,Yt(a,t.field||t.valueExpression,d);case 38:e.next=130;break;case 40:if("pie-chart"!==t.type){e.next=62;break}f=Object(Ct.a)(t.attributes),e.prev=42,f.s();case 44:if((b=f.n()).done){e.next=50;break}return p=b.value,e.next=48,Yt(a,p.field||p.valueExpression,[p.color]);case 48:e.next=44;break;case 50:e.next=55;break;case 52:e.prev=52,e.t4=e.catch(42),f.e(e.t4);case 55:return e.prev=55,f.f(),e.finish(55);case 58:return e.next=60,Yt(a,"default",[null===t||void 0===t||null===(h=t.othersCategory)||void 0===h?void 0:h.color,Object(Dt.g)(t.backgroundFillSymbol,null)]);case 60:e.next=130;break;case 62:if("dot-density"!==t.type){e.next=84;break}v=Object(Ct.a)(t.attributes),e.prev=64,v.s();case 66:if((y=v.n()).done){e.next=72;break}return g=y.value,e.next=70,Yt(a,g.field||g.valueExpression,[g.color]);case 70:e.next=66;break;case 72:e.next=77;break;case 74:e.prev=74,e.t5=e.catch(64),v.e(e.t5);case 77:return e.prev=77,v.f(),e.finish(77);case 80:return e.next=82,Yt(a,"default",[t.backgroundColor]);case 82:e.next=130;break;case 84:if("unique-value"!==t.type){e.next=120;break}if("predominance"!==(null===(i=t.authoringInfo)||void 0===i?void 0:i.type)){e.next=105;break}_=Object(Ct.a)(null!==(m=t.uniqueValueInfos)&&void 0!==m?m:[]),e.prev=87,_.s();case 89:if((O=_.n()).done){e.next=95;break}return w=O.value,e.next=93,Yt(a,w.value.toString(),[Object(Dt.g)(w.symbol,null)]);case 93:e.next=89;break;case 95:e.next=100;break;case 97:e.prev=97,e.t6=e.catch(87),_.e(e.t6);case 100:return e.prev=100,_.f(),e.finish(100);case 103:e.next=118;break;case 105:if(x=(null!==(k=t.uniqueValueInfos)&&void 0!==k?k:[]).map((function(e){return Object(Dt.g)(e.symbol,null)})),M=t.field,P=t.field2,C=t.field3,A=t.valueExpression,e.t7=M||A,!e.t7){e.next=110;break}return e.next=110,Yt(a,M||A,x);case 110:if(e.t8=P,!e.t8){e.next=114;break}return e.next=114,Yt(a,P,x);case 114:if(e.t9=C,!e.t9){e.next=118;break}return e.next=118,Yt(a,C,x);case 118:e.next=130;break;case 120:if("class-breaks"!==t.type){e.next=126;break}return T=t.classBreakInfos.map((function(e){return Object(Dt.g)(e.symbol,null)})),I=t.field,D=t.valueExpression,e.next=124,Yt(a,null!==I&&void 0!==I?I:D,T);case 124:e.next=130;break;case 126:if(e.t10="simple"===t.type,!e.t10){e.next=130;break}return e.next=130,Yt(a,"default",[Object(Dt.g)(t.symbol,null)]);case 130:if(e.t11="defaultSymbol"in t&&t.defaultSymbol,!e.t11){e.next=134;break}return e.next=134,Yt(a,"default",[Object(Dt.g)(t.defaultSymbol,null)]);case 134:return a.forEach((function(e,t){var i=Object(j.o)(e.filter(Boolean),(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));a.set(t,i)})),e.abrupt("return",a);case 136:case"end":return e.stop()}}),e,null,[[6,28,31,34],[42,52,55,58],[64,74,77,80],[87,97,100,103]])})))).apply(this,arguments)}var Kt=i(1134),Zt=i(129),$t=i(110),Qt=(i(555),i(572)),Jt=(i(187),i(277),i(128),i(132),i(168),i(130),i(214),i(363),i(135)),ei=(i(164),i(192),i(217),i(457),i(235),i(210)),ti=(i(119),i(593)),ii=(i(613),i(889)),ni=y.a.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),ai=new Map;function ri(e){if(!Pe(e))return null;var t=e.split("/").slice(1),i=Object(s.a)(t,2);return{layerId:i[0],fieldName:i[1]}}function oi(e){var t=e.originRelationship,i=e.relationships,n=e.layerId,a=null;return i&&i.some((function(e){return"".concat(e.relatedTableId)===n&&e.id===(null===t||void 0===t?void 0:t.id)&&(a=e),!!a})),a}function si(e,t){var i=t.toLowerCase();for(var n in e)if(n.toLowerCase()===i)return e[n];return null}function li(e,t){var i=function(e,t){if(!t.relationships)return null;var i=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(i=t,!0)})),i}(e,t);if(i)return{url:"".concat(t.url,"/").concat(i.relatedTableId),sourceSpatialReference:t.spatialReference,relation:i,relatedFields:[],outStatistics:[]}}function ui(e,t){if(t&&e){var i=e.features,n=e.statsFeatures,a=i&&i.value;t.relatedFeatures=a?a.features:[];var r=n&&n.value;t.relatedStatsFeatures=r?r.features:[]}}function ci(e,t,i,n){var a,r,o=new ti.default;return o.outFields=["*"],o.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),o.objectIds=[e.attributes[i.objectIdField]],null!==(a=null===(r=i.queryRelatedFeatures)||void 0===r?void 0:r.call(i,o,n))&&void 0!==a?a:Promise.resolve({})}function di(e,t,i){for(var n=0,a=[];n<t.length;)a.push("".concat(e," IN (").concat(t.slice(n,i+n),")")),n+=i;return a.join(" OR ")}function hi(){return(hi=Object(a.a)(Object(n.a)().mark((function e(t,i,a,r){var o,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,j,w,k;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.layerId.toString(),s=i.layerInfo,l=i.relation,u=i.relatedFields,c=i.outStatistics,d=i.url,h=i.sourceSpatialReference,s&&l){e.next=3;break}return e.abrupt("return",null);case 3:if(null===(f=oi({originRelationship:l,relationships:s.relationships,layerId:o}))||void 0===f||!f.relationshipTableId||!f.keyFieldInRelationshipTable){e.next=17;break}return e.next=7,ci(t,f,a,r);case 7:if(e.t0=t.attributes[a.objectIdField],b=e.sent[e.t0]){e.next=11;break}return e.abrupt("return",null);case 11:if(p=b.features.map((function(e){return e.attributes[s.objectIdField]})),null===c||void 0===c||!c.length||!s.supportsStatistics){e.next=17;break}return(v=new ei.a).where=di(s.objectIdField,p,1e3),v.outFields=u,v.outStatistics=c,v.sourceSpatialReference=h,y={features:Promise.resolve(b),statsFeatures:Object(Qt.a)(d,v)},e.abrupt("return",Object($t.e)(y));case 17:if(!(g=null===f||void 0===f?void 0:f.keyField)){e.next=21;break}return m=Object(B.v)(pi(s.fields,g)),_=si(t.attributes,l.keyField),O=m?"".concat(g,"=").concat(_):"".concat(g,"='").concat(_,"'"),j=Object(Qt.a)(d,new ei.a({where:O,outFields:i.relatedFields,sourceSpatialReference:h}),r),w=i.outStatistics&&i.outStatistics.length>0&&s.supportsStatistics?Object(Qt.a)(d,new ei.a({where:O,outFields:i.relatedFields,outStatistics:i.outStatistics,sourceSpatialReference:h}),r):null,k={features:j},e.abrupt("return",(w&&(k.statsFeatures=w),Object($t.e)(k)));case 21:return e.abrupt("return",null);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fi(e,t){var i=e.relatedInfos,n=e.layer,a={};return i.forEach((function(e,t){var i=e.relation;if(!i){var r=new x.a("relation-required","A relation is required on a layer to retrieve related records.");throw ni.error(r),r}var o=i.relatedTableId;if("number"!=typeof o){var s=new x.a("A related table ID is required on a layer to retrieve related records.");throw ni.error(s),s}var l="".concat(n.url,"/").concat(o),u=ai.get(l),c=null!==u&&void 0!==u?u:function(e,t){return Object(Zt.default)(e,{query:{f:"json"},signal:t&&t.signal})}(l);u||ai.set(l,c),a[t]=c})),Object($t.r)(Object($t.e)(a),t)}function bi(e,t){var i=e.graphic,n=e.relatedInfos,a=e.layer,r={};return n.forEach((function(e,n){e.layerInfo&&(r[n]=function(e,t,i,n){return hi.apply(this,arguments)}(i,e,a,t))})),Object($t.e)(r)}function pi(e,t){if(null!=e){t=t.toLowerCase();var i,n=Object(Ct.a)(e);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a&&a.name.toLowerCase()===t)return a}}catch(r){n.e(r)}finally{n.f()}}return null}var vi={chartAnimation:!0},yi=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).abilities=Object(o.a)({},vi),n.activeMediaInfoIndex=0,n.attributes=null,n.description=null,n.fieldInfoMap=null,n.formattedAttributes=null,n.expressionAttributes=null,n.isAggregate=!1,n.layer=null,n.mediaInfos=null,n.popupTemplate=null,n.relatedInfos=null,n.title=null,n}return Object(u.a)(i,[{key:"castAbilities",value:function(e){return Object(o.a)(Object(o.a)({},vi),e)}},{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}},{key:"setActiveMedia",value:function(e){this._setContentElementMedia(e)}},{key:"next",value:function(){this._pageContentElementMedia(1)}},{key:"previous",value:function(){this._pageContentElementMedia(-1)}},{key:"_setContentElementMedia",value:function(e){var t=this.formattedMediaInfoCount,i=(e+t)%t;this.activeMediaInfoIndex=i}},{key:"_pageContentElementMedia",value:function(e){var t=this.activeMediaInfoIndex+e;this._setContentElementMedia(t)}},{key:"_formatMediaInfos",value:function(){var e,t,i,n,a,r=this,o=this.mediaInfos,s=this.layer,l=null!==(e=this.attributes)&&void 0!==e?e:{},u=null!==(t=this.formattedAttributes)&&void 0!==t?t:{},c=null!==(i=this.expressionAttributes)&&void 0!==i?i:{},d=null!==(n=this.fieldInfoMap)&&void 0!==n?n:new Map;return null!==(a=null===o||void 0===o?void 0:o.map((function(e){var t=null===e||void 0===e?void 0:e.clone();if(!t)return null;if(t.title=se({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.title}),t.caption=se({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.caption}),t.altText=se({attributes:l,fieldInfoMap:d,globalAttributes:u,expressionAttributes:c,layer:s,text:t.altText}),"image"===t.type){var i=t.value;return r._setImageValue({value:i,formattedAttributes:u,layer:s}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){var n=t.value;return r._setChartValue({value:n,chartType:t.type,attributes:l,formattedAttributes:u,layer:s,expressionAttributes:c}),t}return null})).filter(j.i))&&void 0!==a?a:[]}},{key:"_setImageValue",value:function(e){var t,i=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,n=e.value,a=e.formattedAttributes,r=e.layer,o=n.linkURL,s=n.sourceURL;if(s){var l=ce(s,r);n.sourceURL=le({formattedAttributes:a,template:l,fieldInfoMap:i})}if(o){var u=ce(o,r);n.linkURL=le({formattedAttributes:a,template:u,fieldInfoMap:i})}}},{key:"_setChartValue",value:function(e){var t,i=this,n=e.value,a=e.attributes,r=e.formattedAttributes,o=e.chartType,s=e.layer,l=e.expressionAttributes,u=this.popupTemplate,c=this.relatedInfos,d=n.fields,h=n.normalizeField,f=s;if(n.fields=function(e,t){return e&&e.map((function(e){return ae(e,t)}))}(d,f),h&&(n.normalizeField=ae(h,f)),d.some((function(e){return!!(null!=r[e]||Pe(e)&&null!==c&&void 0!==c&&c.size)}))){var b=null!==(t=null===u||void 0===u?void 0:u.fieldInfos)&&void 0!==t?t:[];d.forEach((function(e){if(Pe(e))n.series=[].concat(Object(S.a)(n.series),Object(S.a)(i._getRelatedChartInfos({fieldInfos:b,fieldName:e,formattedAttributes:r,chartType:o,value:n})));else{var t=i._getChartOption({value:n,attributes:a,chartType:o,formattedAttributes:r,expressionAttributes:l,fieldName:e,fieldInfos:b});n.series.push(t)}}))}}},{key:"_getRelatedChartInfos",value:function(e){var t,i=this,n=e.fieldInfos,a=e.fieldName,r=e.formattedAttributes,o=e.chartType,s=e.value,l=[],u=ri(a),c=u&&(null===(t=this.relatedInfos)||void 0===t?void 0:t.get(u.layerId.toString()));if(!c)return l;var d=c.relatedFeatures,h=c.relation;if(!h||!d)return l;var f=h.cardinality;return d.forEach((function(e){var t=e.attributes;t&&Object.keys(t).forEach((function(e){e===u.fieldName&&l.push(i._getChartOption({value:s,attributes:t,formattedAttributes:r,fieldName:a,chartType:o,relatedFieldName:e,hasMultipleRelatedFeatures:(null===d||void 0===d?void 0:d.length)>1,fieldInfos:n}))}))})),"one-to-many"===f||"many-to-many"===f?l:[l[0]]}},{key:"_getTooltip",value:function(e){var t=e.label,i=e.value;return"pie-chart"===e.chartType?"".concat(t):"".concat(t,": ").concat(i)}},{key:"_getChartOption",value:function(e){var t,i,n=e.value,a=e.attributes,r=e.formattedAttributes,o=e.expressionAttributes,s=e.fieldName,l=e.relatedFieldName,u=e.fieldInfos,c=e.chartType,d=e.hasMultipleRelatedFeatures,h=this.layer,f=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,b=n.normalizeField,p=n.tooltipField,v=b?Pe(b)?a[ri(b).fieldName]:a[b]:null,y=ie(s)&&o&&void 0!==o[s]?o[s]:l&&void 0!==a[l]?a[l]:void 0!==a[s]?a[s]:r[s],g=new Kt.a({fieldName:s,value:void 0===y?null:y&&v?y/v:y});if(Pe(s)){var m,_,O,j,w,k=f.get(s.toLowerCase()),x=p&&f.get(p.toLowerCase()),M=null!==(m=null===k||void 0===k?void 0:k.fieldName)&&void 0!==m?m:s,P=d&&p?ri(p).fieldName:null!==(_=null===x||void 0===x?void 0:x.fieldName)&&void 0!==_?_:p,C=d&&P?a[P]:null!==(O=null!==(j=null!==(w=r[P])&&void 0!==w?w:null===k||void 0===k?void 0:k.label)&&void 0!==j?j:null===k||void 0===k?void 0:k.fieldName)&&void 0!==O?O:l,A=d&&l?a[l]:r[M];return g.tooltip=this._getTooltip({label:C,value:A,chartType:c}),g}var T=pe(u,s),I=ae(s,h),D=p&&void 0!==r[p]?r[p]:ne(T||new gt.a({fieldName:I}),null===(i=this.popupTemplate)||void 0===i?void 0:i.expressionInfos),F=r[I];return g.tooltip=this._getTooltip({label:D,value:F,chartType:c}),g}}]),i}(D.a);Object(h.a)([Object(_.b)()],yi.prototype,"abilities",void 0),Object(h.a)([Object(O.a)("abilities")],yi.prototype,"castAbilities",null),Object(h.a)([Object(_.b)()],yi.prototype,"activeMediaInfoIndex",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],yi.prototype,"activeMediaInfo",null),Object(h.a)([Object(_.b)()],yi.prototype,"attributes",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"description",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"fieldInfoMap",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"formattedAttributes",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"expressionAttributes",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],yi.prototype,"formattedMediaInfos",null),Object(h.a)([Object(_.b)()],yi.prototype,"isAggregate",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"layer",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],yi.prototype,"formattedMediaInfoCount",null),Object(h.a)([Object(_.b)()],yi.prototype,"mediaInfos",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"popupTemplate",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"relatedInfos",void 0),Object(h.a)([Object(_.b)()],yi.prototype,"title",void 0);var gi=yi=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],yi),mi=i(1875),_i=i(540),Oi=i(504),ji="esri-feature-media",wi={base:ji,mediaContainer:"".concat(ji,"__container"),mediaItemContainer:"".concat(ji,"__item-container"),mediaItem:"".concat(ji,"__item"),mediaItemText:"".concat(ji,"__item-text"),mediaItemTitle:"".concat(ji,"__item-title"),mediaItemCaption:"".concat(ji,"__item-caption"),mediaNavigation:"".concat(ji,"__item-navigation"),mediaPagination:"".concat(ji,"__pagination"),mediaPaginationText:"".concat(ji,"__pagination-text"),mediaPrevious:"".concat(ji,"__previous"),mediaPreviousIconLTR:"".concat(ji,"__previous-icon"),mediaPreviousIconRTL:"".concat(ji,"__previous-icon--rtl"),mediaNext:"".concat(ji,"__next"),mediaNextIconLTR:"".concat(ji,"__next-icon"),mediaNextIconRTL:"".concat(ji,"__next-icon--rtl"),mediaChart:"".concat(ji,"__chart"),mediaPaginationButton:"".concat(ji,"__pagination-button"),mediaPaginationIcon:"".concat(ji,"__pagination-icon"),mediaChartRendered:"".concat(ji,"__chart--rendered")},ki="category",xi="value",Mi=function(e){Object(c.a)(o,e);var t=Object(d.a)(o);function o(e,r){var s;return Object(l.a)(this,o),(s=t.call(this,e,r))._refreshTimer=null,s._refreshIntervalInfo=null,s._featureElementInfo=null,s._chartRootMap=new WeakMap,s.viewModel=new gi,s.messages=null,s._disposeChart=function(e){var t;null!==(t=s._chartRootMap.get(e))&&void 0!==t&&t.dispose(),s._chartRootMap.delete(e)},s._createChart=function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var a,r,o,l,u,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(Pt.a)(s),r=a.destroyed,o=a.viewModel,!r&&o&&t){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Promise.resolve().then(i.bind(null,1875));case 5:return l=e.sent,u=l.createRoot,e.next=9,u(t);case 9:c=e.sent,s._chartRootMap.set(t,c),s._renderChart({mediaInfo:o.activeMediaInfo,root:c});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s}return Object(u.a)(o,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new rt,this.addHandles([Object(g.e)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.activeMediaInfo,null===(i=e.viewModel)||void 0===i?void 0:i.activeMediaInfoIndex]}),(function(){return e._setupMediaRefreshTimer()}),g.a),Object(g.e)((function(){var t,i;return[null===(t=e.viewModel)||void 0===t?void 0:t.description,null===(i=e.viewModel)||void 0===i?void 0:i.title]}),(function(){return e._setupFeatureElementInfo()}),g.a)])}},{key:"loadDependencies",value:function(){return Object(Re.b)({icon:function(){return i.e(26).then(i.bind(null,2229))}})}},{key:"destroy",value:function(){var e;this._clearMediaRefreshTimer(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}},{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"activeMediaInfoIndex",get:function(){return this.viewModel.activeMediaInfoIndex},set:function(e){this.viewModel.activeMediaInfoIndex=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"fieldInfoMap",get:function(){return this.viewModel.fieldInfoMap},set:function(e){this.viewModel.fieldInfoMap=e}},{key:"layer",get:function(){return this.viewModel.layer},set:function(e){this.viewModel.layer=e}},{key:"mediaInfos",get:function(){return this.viewModel.mediaInfos},set:function(e){this.viewModel.mediaInfos=e}},{key:"popupTemplate",get:function(){return this.viewModel.popupTemplate},set:function(e){this.viewModel.popupTemplate=e}},{key:"relatedInfos",get:function(){return this.viewModel.relatedInfos},set:function(e){this.viewModel.relatedInfos=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"render",value:function(){var e;return Object(He.a)("div",{bind:this,class:wi.base,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this.renderMedia())}},{key:"renderMedia",value:function(){var e=this.viewModel,t=e.formattedMediaInfoCount,i=e.activeMediaInfoIndex,n=this.renderMediaText();return t?Object(He.a)("div",{key:"media-element-container",class:wi.mediaContainer},this.renderMediaInfo(),Object(He.a)("div",{class:wi.mediaNavigation},n,Object(He.a)("div",{class:wi.mediaPagination},this.renderMediaPageButton("previous"),Object(He.a)("span",{class:wi.mediaPaginationText},Object(Oi.a)(this.messages.pageText,{index:i+1,total:t})),this.renderMediaPageButton("next")))):null}},{key:"renderMediaText",value:function(){var e=this.viewModel.activeMediaInfo;if(!e)return null;var t=e&&e.title?Object(He.a)("div",{key:"media-title",class:wi.mediaItemTitle,innerHTML:e.title}):null,i=e&&e.caption?Object(He.a)("div",{key:"media-caption",class:wi.mediaItemCaption,innerHTML:e.caption}):null;return t||i?Object(He.a)("div",{key:"media-text",class:wi.mediaItemText},t,i):null}},{key:"renderImageMediaInfo",value:function(e){var t,i=this._refreshIntervalInfo,n=this.viewModel,a=n.activeMediaInfoIndex,r=n.formattedMediaInfoCount,o=e.value,s=e.refreshInterval,l=e.altText,u=e.title,c=e.type,d=o.sourceURL,h=o.linkURL,f=te(null!==h&&void 0!==h?h:void 0)?"_blank":"_self",b="_blank"===f?"noreferrer":"",p=s?i:null,v=p?p.timestamp:0,y=p?p.sourceURL:d,g=Object(He.a)("img",{alt:l||u,key:"media-".concat(c,"-").concat(a,"-").concat(r,"-").concat(v),src:null!==y&&void 0!==y?y:void 0});return null!==(t=h?Object(He.a)("a",{title:u,href:h,rel:b,target:f},g):null)&&void 0!==t?t:g}},{key:"renderChartMediaInfo",value:function(e){var t=this.viewModel,i=t.activeMediaInfoIndex,n=t.formattedMediaInfoCount;return Object(He.a)("div",{key:"media-".concat(e.type,"-").concat(i,"-").concat(n),bind:this,class:wi.mediaChart,afterCreate:this._createChart,afterRemoved:this._disposeChart})}},{key:"renderMediaInfoType",value:function(){var e=this.viewModel.activeMediaInfo;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}},{key:"renderMediaInfo",value:function(){return this.viewModel.activeMediaInfo?Object(He.a)("div",{key:"media-container",class:wi.mediaItemContainer},Object(He.a)("div",{key:"media-item-container",class:wi.mediaItem},this.renderMediaInfoType())):null}},{key:"renderMediaPageButton",value:function(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,i=t?this.messages.previous:this.messages.next,n=t?"chevron-left":"chevron-right",a=t?"media-previous":"media-next",r=t?this._previous:this._next;return Object(He.a)("button",{type:"button",key:a,title:i,"aria-label":i,tabIndex:0,class:wi.mediaPaginationButton,bind:this,onclick:r},Object(He.a)("calcite-icon",{class:wi.mediaPaginationIcon,scale:"s",icon:n}))}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.description,i=this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}},{key:"_next",value:function(){this.viewModel.next()}},{key:"_previous",value:function(){this.viewModel.previous()}},{key:"_getRenderer",value:function(){if(this.viewModel){var e=this.viewModel,t=e.isAggregate,i=e.layer;return t&&null!==i&&void 0!==i&&i.featureReduction&&"renderer"in i.featureReduction?i.featureReduction.renderer:null===i||void 0===i?void 0:i.renderer}}},{key:"_getRendererColors",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,a,r,o,s,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(10).then(i.bind(null,2231));case 2:if(t=e.sent,a=t.colorAm5,r=new Map,o=this._getRenderer(),s="default",o){e.next=9;break}return e.abrupt("return",r);case 9:return e.next=11,Gt(o);case 11:return(l=e.sent).delete(s),e.abrupt("return",Array.from(l.values()).every((function(e){return 1===(null===e||void 0===e?void 0:e.length)}))?(Array.from(l.keys()).forEach((function(e){var t,i=null===(t=l.get(e))||void 0===t||null===(t=t[0])||void 0===t?void 0:t.toCss(!0);i&&r.set(e,a(i))})),r):r);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_handleMediaKeyup",value:function(e){var t=Object(p.a)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}},{key:"_canAnimateChart",value:function(){return!!this.viewModel&&!!this.viewModel.abilities.chartAnimation&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches}},{key:"_getChartAnimationMS",value:function(){return this._canAnimateChart()?250:0}},{key:"_getChartSeriesAnimationMS",value:function(){return this._canAnimateChart()?500:0}},{key:"_renderChart",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var a,o,s,l,u,c,d,h,f,b,p,v,y,g,m;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.root,o=t.mediaInfo,s=o.value,l=o.type,e.next=6,i.e(10).then(i.bind(null,2231));case 6:return u=e.sent,c=u.ResponsiveThemeAm5,d=u.DarkThemeAm5,h=u.AnimatedThemeAm5,f=u.ColorSetAm5,b=u.ThemeAm5,(p=b.new(a)).rule("ColorSet").set("colors",mi.esriChartColorSet),v=[c.new(a),p],Object(_i.a)()&&v.push(d.new(a)),this._canAnimateChart()&&v.push(h.new(a)),a.setThemes(v),e.next=18,this._getRendererColors();case 18:y=e.sent,g=f.new(a,{}),m=s.series.map((function(e,t){var i,n=y.get(e.fieldName)||g.getIndex(t);return i={},Object(r.a)(i,ki,e.tooltip),Object(r.a)(i,xi,e.value),Object(r.a)(i,"columnSettings",{fill:n,stroke:n}),i})).filter((function(e){return"pie-chart"!==l||null!=e.value&&e.value>0})),"pie-chart"===l?this._createPieChart(t,m):this._createXYChart(t,m);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getDirection",value:function(){return Object(Ne.e)(this.container)?"rtl":"ltr"}},{key:"_isInversed",value:function(){return!!Object(Ne.e)(this.container)}},{key:"_customizeChartTooltip",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var a,r,o,s,l=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:"horizontal",e.next=3,i.e(10).then(i.bind(null,2231));case 3:o=e.sent,s=o.colorAm5,t.setAll({pointerOrientation:r}),null!==(a=t.get("background"))&&void 0!==a&&a.setAll({stroke:s("rgba(50, 50, 50, 1)")}),t.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPieChart",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,a){var r,o,s,l,u,c,d,h,f,b,p,v,y;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(10).then(i.bind(null,2231));case 2:return r=e.sent,o=r.TooltipAm5,e.next=6,Promise.all([i.e(17),i.e(338)]).then(i.bind(null,2232));case 6:s=e.sent,l=s.PieChartAm5,u=s.PieSeriesAm5,c=t.mediaInfo,d=t.root,h=c.title,5,f=(null===c||void 0===c?void 0:c.altText)||(null===c||void 0===c?void 0:c.title)||"",b=d.container.children.push(l.new(d,{ariaLabel:f,focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5})),p="{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",v=o.new(d,{labelText:p}),(y=b.series.push(u.new(d,{name:h,valueField:xi,categoryField:ki,tooltip:v}))).ticks.template.set("forceHidden",!0),y.labels.template.set("forceHidden",!0),y.slices.template.states.create("active",{shiftRadius:5}),this._customizeChartTooltip(v),y.slices.template.setAll({ariaLabel:p,focusable:!0,templateField:"columnSettings"}),y.data.setAll(a),y.appear(this._getChartSeriesAnimationMS()),b.appear(this._getChartAnimationMS()),b.root.dom.classList.toggle(wi.mediaChartRendered,!0);case 19:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getMinSeriesValue",value:function(e){var t=0;return e.forEach((function(e){return t=Math.min(e.value,t)})),t}},{key:"_createColumnChart",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,a,r){var o,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,j,w;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(10).then(i.bind(null,2231));case 2:return o=e.sent,s=o.TooltipAm5,l=o.ScrollbarAm5,e.next=7,Promise.all([i.e(17),i.e(27)]).then(i.bind(null,2233));case 7:u=e.sent,c=u.CategoryAxisAm5,d=u.AxisRendererXAm5,h=u.ValueAxisAm5,f=u.AxisRendererYAm5,b=u.ColumnSeriesAm5,p=a.mediaInfo,v=a.root,y=p.value,g=p.title,t.setAll({wheelX:"panX",wheelY:"zoomX"}),(m=t.xAxes.push(c.new(v,{renderer:d.new(v,{inversed:this._isInversed()}),categoryField:ki}))).get("renderer").labels.template.setAll({forceHidden:!0}),(_=t.yAxes.push(h.new(v,{renderer:f.new(v,{inside:!1}),min:this._getMinSeriesValue(y.series)}))).get("renderer").labels.template.setAll({direction:this._getDirection()}),O="{categoryX}",j=s.new(v,{labelText:O}),w=t.series.push(b.new(v,{name:g,xAxis:m,yAxis:_,valueYField:xi,categoryXField:ki,tooltip:j})),this._customizeChartTooltip(j),w.columns.template.setAll({ariaLabel:O,focusable:!0,templateField:"columnSettings"}),y.series.length>15&&t.set("scrollbarX",l.new(v,{orientation:"horizontal"})),m.data.setAll(r),w.data.setAll(r),w.appear(this._getChartSeriesAnimationMS()),t.appear(this._getChartAnimationMS());case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_createBarChart",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,a,r){var o,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,j,w;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(10).then(i.bind(null,2231));case 2:return o=e.sent,s=o.TooltipAm5,l=o.ScrollbarAm5,e.next=7,Promise.all([i.e(17),i.e(27)]).then(i.bind(null,2233));case 7:u=e.sent,c=u.CategoryAxisAm5,d=u.AxisRendererXAm5,h=u.ValueAxisAm5,f=u.AxisRendererYAm5,b=u.ColumnSeriesAm5,p=a.mediaInfo,v=a.root,y=p.value,g=p.title,t.setAll({wheelX:"panY",wheelY:"zoomY"}),(m=t.yAxes.push(c.new(v,{renderer:f.new(v,{inversed:!0}),categoryField:ki}))).get("renderer").labels.template.setAll({forceHidden:!0}),(_=t.xAxes.push(h.new(v,{renderer:d.new(v,{inside:!1,inversed:this._isInversed()}),min:this._getMinSeriesValue(y.series)}))).get("renderer").labels.template.setAll({direction:this._getDirection()}),O="{categoryY}",j=s.new(v,{labelText:O}),w=t.series.push(b.new(v,{name:g,xAxis:_,yAxis:m,valueXField:xi,categoryYField:ki,tooltip:j})),this._customizeChartTooltip(j,"vertical"),w.columns.template.setAll({ariaLabel:O,focusable:!0,templateField:"columnSettings"}),y.series.length>15&&t.set("scrollbarY",l.new(v,{orientation:"vertical"})),m.data.setAll(r),w.data.setAll(r),w.appear(this._getChartSeriesAnimationMS()),t.appear(this._getChartAnimationMS());case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_createLineChart",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,a,r){var o,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,j;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(10).then(i.bind(null,2231));case 2:return o=e.sent,s=o.TooltipAm5,l=o.ScrollbarAm5,e.next=7,Promise.all([i.e(17),i.e(27)]).then(i.bind(null,2233));case 7:u=e.sent,c=u.CategoryAxisAm5,d=u.AxisRendererXAm5,h=u.ValueAxisAm5,f=u.AxisRendererYAm5,b=u.LineSeriesAm5,p=a.root,v=a.mediaInfo,y=v.value,g=v.title,t.setAll({wheelX:"panX",wheelY:"zoomX"}),(m=t.xAxes.push(c.new(p,{renderer:d.new(p,{inversed:this._isInversed()}),categoryField:ki}))).get("renderer").labels.template.setAll({forceHidden:!0}),(_=t.yAxes.push(h.new(p,{renderer:f.new(p,{inside:!1}),min:this._getMinSeriesValue(y.series)}))).get("renderer").labels.template.setAll({direction:this._getDirection()}),"{categoryX}",O=s.new(p,{labelText:"{categoryX}"}),j=t.series.push(b.new(p,{name:g,xAxis:m,yAxis:_,valueYField:xi,categoryXField:ki,tooltip:O})),this._customizeChartTooltip(O,"vertical"),y.series.length>15&&t.set("scrollbarX",l.new(p,{orientation:"horizontal"})),m.data.setAll(r),j.data.setAll(r),j.appear(this._getChartSeriesAnimationMS()),t.appear(this._getChartAnimationMS());case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_createXYChart",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,a){var r,o,s,l,u,c,d,h;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e(17),i.e(27)]).then(i.bind(null,2233));case 2:if(r=e.sent,o=r.XYChartAm5,s=r.XYCursorAm5,l=t.root,u=t.mediaInfo,c=u.type,d=(null===u||void 0===u?void 0:u.altText)||(null===u||void 0===u?void 0:u.title)||"",(h=l.container.children.push(o.new(l,{ariaLabel:d,focusable:!0,panX:!0,panY:!0}))).set("cursor",s.new(l,{})),e.t0="column-chart"===c,!e.t0){e.next=15;break}return e.next=15,this._createColumnChart(h,t,a);case 15:if(e.t1="bar-chart"===c,!e.t1){e.next=19;break}return e.next=19,this._createBarChart(h,t,a);case 19:if(e.t2="line-chart"===c,!e.t2){e.next=23;break}return e.next=23,this._createLineChart(h,t,a);case 23:h.root.dom.classList.toggle(wi.mediaChartRendered,!0);case 24:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_clearMediaRefreshTimer",value:function(){var e=this._refreshTimer;e&&(clearTimeout(e),this._refreshTimer=null)}},{key:"_updateMediaInfoTimestamp",value:function(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:e&&this._getImageSource(e,t)}}},{key:"_setupMediaRefreshTimer",value:function(){this._clearMediaRefreshTimer();var e=this.viewModel.activeMediaInfo;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}},{key:"_setRefreshTimeout",value:function(e){var t=this,i=e.refreshInterval,n=e.value;if(i){var a=6e4*i;this._updateMediaInfoTimestamp(n.sourceURL);var r=setInterval((function(){t._updateMediaInfoTimestamp(n.sourceURL)}),a);this._refreshTimer=r}}},{key:"_getImageSource",value:function(e,t){var i=e.includes("?")?"&":"?",n=e.split("#"),a=Object(s.a)(n,2),r=a[0],o=a[1],l=void 0===o?"":o;return"".concat(r).concat(i,"timestamp=").concat(t).concat(l?"#":"").concat(l)}}]),o}(k.a);Object(h.a)([Object(_.b)()],Mi.prototype,"_refreshIntervalInfo",void 0),Object(h.a)([Object(_.b)()],Mi.prototype,"attributes",null),Object(h.a)([Object(_.b)()],Mi.prototype,"activeMediaInfoIndex",null),Object(h.a)([Object(_.b)()],Mi.prototype,"description",null),Object(h.a)([Object(_.b)()],Mi.prototype,"fieldInfoMap",null),Object(h.a)([Object(_.b)()],Mi.prototype,"layer",null),Object(h.a)([Object(_.b)()],Mi.prototype,"mediaInfos",null),Object(h.a)([Object(_.b)()],Mi.prototype,"popupTemplate",null),Object(h.a)([Object(_.b)()],Mi.prototype,"relatedInfos",null),Object(h.a)([Object(_.b)()],Mi.prototype,"title",null),Object(h.a)([Object(_.b)({type:gi})],Mi.prototype,"viewModel",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/Feature/t9n/Feature")],Mi.prototype,"messages",void 0);var Pi=Mi=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureMedia")],Mi),Ci=(i(624),i(377),i(625),i(626),i(627)),Ai=i(628),Ti=(i(629),i(587)),Ii=i(1133),Di=i(412),Fi=["$datastore","$map","$layer","$aggregatedfeatures"],Ei=y.a.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function Si(e){return"string"==typeof e?ge(ye(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((function(e){return"<li>".concat("string"==typeof e?ge(ye(e)):e,"</li>")})).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){return'<table class="esri-widget__table">'.concat(e.keys().map((function(t){var i=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof i?ge(ye(i)):i,"</td></tr>")})).join(""),"</table>")}(e):e}function Li(e){var t=e.aggregatedFeatures,i=e.arcadeUtils,n=e.featureSetVars,a=e.context,r=e.viewInfo,s=e.map,l=e.graphic,u=e.interceptor;n.forEach((function(e){var n=e.toLowerCase(),c=r.sr,d={map:s,spatialReference:c,interceptor:u};if("$map"===n&&(a.vars[n]=i.convertMapToFeatureSetCollection(d)),"$layer"===n&&(a.vars[n]=i.convertFeatureLayerToFeatureSet({layer:l.sourceLayer,spatialReference:c,interceptor:u})),"$datastore"===n&&(a.vars[n]=i.convertServiceUrlToWorkspace({url:l.sourceLayer.url,spatialReference:c,interceptor:u})),"$aggregatedfeatures"===n){var h=l.layer,f=h.fields,b=h.objectIdField,p=h.geometryType,v=h.spatialReference,y=h.displayField,g=new Di.default(Object(o.a)(Object(o.a)({fields:f,objectIdField:b,geometryType:p,spatialReference:v,displayField:y},"feature"===h.type?{templates:h.templates,typeIdField:h.typeIdField,types:h.types}:null),{},{source:t}));a.vars[n]=i.convertFeatureLayerToFeatureSet({layer:g,spatialReference:v,interceptor:u})}}))}function Bi(){return i.e(45).then(i.bind(null,1765))}function Ri(e){return"createQuery"in e&&"queryFeatures"in e}function Ni(e){return zi.apply(this,arguments)}function zi(){return(zi=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.graphic,a=t.view,r=i.isAggregate,o=i.layer,r&&o&&"2d"===(null===a||void 0===a?void 0:a.type)){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,a.whenLayerView(o);case 6:if(Ri(s=e.sent)){e.next=9;break}return e.abrupt("return",[]);case 9:return l=s.createQuery(),u=i.getObjectId(),l.aggregateIds=null!=u?[u]:[],e.next=13,s.queryFeatures(l);case 13:return c=e.sent,d=c.features,e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Hi(e){return Vi.apply(this,arguments)}function Vi(){return(Vi=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,l,u,c,d,h,f,b,p,v,y,g;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.expressionInfo,a=t.arcadeUtils,r=t.interceptor,o=t.spatialReference,l=t.map,u=t.graphic,c=t.view,i&&i.expression){e.next=3;break}return e.abrupt("return",null);case 3:return d=a.createSyntaxTree(i.expression),h=Fi.filter((function(e){return a.hasVariable(d,e)})),e.next=7,Promise.all([Ni({graphic:u,view:c}),a.loadScriptDependencies(d,!0,h)]);case 7:return f=e.sent,b=Object(s.a)(f,1),p=b[0],v=a.getViewInfo({spatialReference:o}),(y=a.createExecContext(u,v)).interceptor=r,y.useAsync=!0,Li({aggregatedFeatures:p,arcadeUtils:a,featureSetVars:h,context:y,viewInfo:v,map:l,graphic:u,interceptor:r}),g=a.createFunction(d,y),e.abrupt("return",a.executeAsyncFunction(g,y).catch((function(e){return Ei.error("arcade-execution-error",{error:e,graphic:u,expressionInfo:i})})));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wi(e){return Ui.apply(this,arguments)}function Ui(){return(Ui=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c,d,h,f,b,p,v;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.expressionInfos,a=t.spatialReference,r=t.graphic,o=t.interceptor,s=t.map,l=t.view,i&&i.length){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,Bi();case 5:u=e.sent,c={},d=Object(Ct.a)(i);try{for(d.s();!(h=d.n()).done;)f=h.value,c["expression/".concat(f.name)]=Hi({expressionInfo:f,arcadeUtils:u,interceptor:o,spatialReference:a,map:s,graphic:r,view:l})}catch(n){d.e(n)}finally{d.f()}return e.next=11,Object($t.e)(c);case 11:for(v in b=e.sent,p={},b)p[v]=Si(b[v].value);return e.abrupt("return",p);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Yi=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var r;return Object(l.a)(this,i),(r=t.call(this,e))._abortController=null,r.expressionInfo=null,r.graphic=null,r.contentElement=null,r.contentElementViewModel=null,r.interceptor=null,r.view=null,r._cancelQuery=function(){var e=Object(Pt.a)(r)._abortController;e&&e.abort(),r._abortController=null},r._createVM=function(){var e,t,i=null===(e=r.contentElement)||void 0===e?void 0:e.type;null===(t=r.contentElementViewModel)||void 0===t||t.destroy();var n="fields"===i?new _t:"media"===i?new gi:"text"===i?new dt:null;r._set("contentElementViewModel",n)},r._compile=Object(a.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._cancelQuery(),t=new AbortController,r._abortController=t,e.next=5,r._compileExpression();case 5:r._abortController===t&&(r._abortController=null);case 6:case"end":return e.stop()}}),e)}))),r._compileThrottled=Object(m.a)(r._compile,1,Object(Pt.a)(r)),r._compileExpression=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,o,s,l,u,c,d,h,f,b,p;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(Pt.a)(r),i=t.expressionInfo,a=t.graphic,o=t.interceptor,s=t.spatialReference,l=t.map,u=t.view,c=t._abortController,i&&a&&s&&l){e.next=3;break}return e.abrupt("return",void r._set("contentElement",null));case 3:return e.next=5,Bi();case 5:if(d=e.sent,c===r._abortController){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Hi({arcadeUtils:d,expressionInfo:i,graphic:a,interceptor:o,map:l,spatialReference:s,view:u});case 10:if((h=e.sent)&&"esri.arcade.Dictionary"===h.declaredClass){e.next=13;break}return e.abrupt("return",void r._set("contentElement",null));case 13:return e.next=15,h.castAsJsonAsync(null===c||void 0===c?void 0:c.signal);case 15:f=e.sent,b=null===f||void 0===f?void 0:f.type,p="media"===b?Ai.a.fromJSON(f):"text"===b?Ti.a.fromJSON(f):"fields"===b?Ci.a.fromJSON(f):null,r._set("contentElement",p);case 19:case"end":return e.stop()}}),e)}))),r.handles.add([Object(g.e)((function(){return[r.expressionInfo,r.graphic,r.map,r.spatialReference,r.view]}),(function(){return r._compileThrottled()}),g.a),Object(g.e)((function(){return[r.contentElement]}),(function(){return r._createVM()}),g.a)]),r}return Object(u.a)(i,[{key:"initialize",value:function(){this.addHandles(this._compileThrottled)}},{key:"destroy",value:function(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"state",get:function(){var e=this._abortController,t=this.contentElement,i=this.contentElementViewModel;return e?"loading":t||i?"ready":"disabled"}},{key:"map",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.map)&&void 0!==e?e:null},set:function(e){this._override("map",e)}}]),i}(Object(ut.b)(D.a));Object(h.a)([Object(_.b)()],Yi.prototype,"_abortController",void 0),Object(h.a)([Object(_.b)({type:Ii.a})],Yi.prototype,"expressionInfo",void 0),Object(h.a)([Object(_.b)({type:I.a})],Yi.prototype,"graphic",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Yi.prototype,"contentElement",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Yi.prototype,"contentElementViewModel",void 0),Object(h.a)([Object(_.b)()],Yi.prototype,"interceptor",void 0),Object(h.a)([Object(_.b)()],Yi.prototype,"spatialReference",null),Object(h.a)([Object(_.b)({readOnly:!0})],Yi.prototype,"state",null),Object(h.a)([Object(_.b)()],Yi.prototype,"map",null),Object(h.a)([Object(_.b)()],Yi.prototype,"view",void 0);var qi=Yi=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Yi),Gi="esri-icon-loading-indicator esri-rotating",Xi="esri-feature-expression",Ki="esri-feature__loading-container",Zi="esri-feature__loading-spinner",$i=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(l.a)(this,i),(a=t.call(this,e,n))._contentWidget=null,a.viewModel=new qi,a}return Object(u.a)(i,[{key:"initialize",value:function(){var e=this;this.addHandles(Object(g.e)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentElementViewModel}),(function(){return e._setupExpressionWidget()}),g.a))}},{key:"destroy",value:function(){this._destroyContentWidget()}},{key:"renderLoading",value:function(){return Object(He.a)("div",{key:"loading-container",class:Ki},Object(He.a)("span",{class:this.classes(Gi,Zi)}))}},{key:"render",value:function(){var e,t=this.viewModel.state;return Object(He.a)("div",{class:Xi},"loading"===t?this.renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}},{key:"_destroyContentWidget",value:function(){var e=this._contentWidget;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}},{key:"_setupExpressionWidget",value:function(){var e=this.viewModel,t=e.contentElementViewModel,i=e.contentElement,n=null===i||void 0===i?void 0:i.type;this._destroyContentWidget();var a=t?"fields"===n?new Mt({viewModel:t}):"media"===n?new Pi({viewModel:t}):"text"===n?new vt({viewModel:t}):null:null;this._contentWidget=a,this.scheduleRender()}}]),i}(k.a);Object(h.a)([Object(_.b)({type:qi})],$i.prototype,"viewModel",void 0);var Qi=$i=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureExpression")],$i),Ji=i(111),en=i(165),tn=i(234);i(1132);function nn(e,t,i){var n,a,r=Object.keys(t).filter((function(t){return Object(C.e)(e,t)})),o=r.map((function(e){return t[e]})),l=r.map((function(e){return i.get(e)})).filter(j.i);return n=e,a=an(o,l),Object(C.c)(Object(C.c)(n,(function(e){return"{".concat(e.toLowerCase(),"}")})),Object.fromEntries(Object.entries(a).map((function(e){var t=Object(s.a)(e,2),i=t[0],n=t[1];return[i.toLowerCase(),n]}))))}function an(e,t){var i=t.map((function(t,i){var n=e[i];if(t.domain&&"coded-value"===t.domain.type){var a=t.domain.codedValues.find((function(e){return e.code===n}));(null===a||void 0===a?void 0:a.name)&&(n=a.name)}return Object(B.s)(t)&&(n=function(e,t){if(!e||null==t)return null;switch(e.type){case"date":return Object(L.c)(t);case"date-only":return Object(L.d)(t);case"time-only":return Object(L.e)(t);case"timestamp-offset":return Object(L.f)(t);default:return null}}(t,n)),[t.name,n]}));return Object.fromEntries(i)}new Set(["date-only","time-only","timestamp-offset"]);var rn;(rn||(rn={})).TOO_SHORT="length-validation-error::too-short";var on=function(e){var t=[];if(e.formTemplate){var i,n=e.formTemplate,a=n.description,r=n.title;null===(i=e.fields)||void 0===i||i.forEach((function(e){var i=r&&Object(C.e)(r,e.name),n=a&&Object(C.e)(a,e.name);(i||n)&&t.push(e.name)}))}return t};var sn=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var r;return Object(l.a)(this,i),(r=t.call(this,e))._loaded=!1,r._queryAbortController=null,r._queryPageAbortController=null,r._queryFeatureCountAbortController=null,r.featuresPerPage=10,r.description=null,r.graphic=null,r.layer=null,r.map=null,r.orderByFields=null,r.featureCount=0,r.relationshipId=null,r.showAllEnabled=!1,r.title=null,r._cancelQuery=function(){var e=Object(Pt.a)(r)._queryAbortController;e&&e.abort(),r._queryAbortController=null},r._cancelQueryFeatureCount=function(){var e=Object(Pt.a)(r)._queryFeatureCountAbortController;e&&e.abort(),r._queryFeatureCountAbortController=null},r._cancelQueryPage=function(){var e=Object(Pt.a)(r)._queryPageAbortController;e&&e.abort(),r._queryPageAbortController=null},r._queryController=Object(a.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._cancelQuery(),t=new AbortController,r._queryAbortController=t,e.next=5,Object($t.g)(r._query());case 5:r._queryAbortController===t&&(r._queryAbortController=null);case 6:case"end":return e.stop()}}),e)}))),r._queryFeatureCountController=Object(a.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._loaded=!1,r._cancelQueryFeatureCount(),t=new AbortController,r._queryFeatureCountAbortController=t,e.next=5,Object($t.g)(r._queryFeatureCount());case 5:r._queryFeatureCountAbortController===t&&(r._queryFeatureCountAbortController=null),r._loaded=!0;case 7:case"end":return e.stop()}}),e)}))),r._queryPageController=Object(a.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,r._queryPageAbortController=t,e.next=4,Object($t.g)(r._queryPage());case 4:r._queryPageAbortController===t&&(r._queryPageAbortController=null);case 5:case"end":return e.stop()}}),e)}))),r._queryDebounced=Object($t.d)(r._queryController,100),r._queryFeatureCountDebounced=Object($t.d)(r._queryFeatureCountController,100),r._queryPageDebounced=Object($t.d)(r._queryPageController,100),r._query=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(Pt.a)(r),i=t._queryAbortController,a=t.relatedFeatures,e.t0=r.featureCount,!e.t0){e.next=15;break}if(r._destroyRelatedFeatureViewModels(),r.featurePage=1,a.removeAll(),e.t1=r.destroyed,e.t1){e.next=15;break}return e.t2=a,e.t3=r,e.next=12,r._queryRelatedFeatures({signal:null===i||void 0===i?void 0:i.signal});case 12:e.t4=e.sent,e.t5=e.t3._sliceFeatures.call(e.t3,e.t4),e.t2.addMany.call(e.t2,e.t5);case 15:case"end":return e.stop()}}),e)}))),r.handles.add([Object(g.e)((function(){var e;return[r.displayCount,r.graphic,r.layer,null===(e=r.layer)||void 0===e?void 0:e.loaded,r.map,r.orderByFields,r.relationshipId,r.featuresPerPage,r.showAllEnabled,r.canQuery,r.featureCount]}),(function(){return r._queryDebounced()}),g.a),Object(g.e)((function(){return[r.featurePage,r.showAllEnabled]}),(function(){return r._queryPageDebounced()})),Object(g.e)((function(){return[r.layer,r.relationshipId,r.objectId,r.canQuery]}),(function(){return r._queryFeatureCountDebounced()}))]),r}return Object(u.a)(i,[{key:"destroy",value:function(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}},{key:"featurePage",get:function(){return this._get("featurePage")},set:function(e){var t=this.featuresPerPage,i=this.featureCount,n=Math.ceil(i/t)||1;this._set("featurePage",Math.min(Math.max(e,1),n))}},{key:"orderByFieldsFixedCasing",get:function(){var e=this.orderByFields,t=this.relatedLayer;return e&&null!==t&&void 0!==t&&t.loaded?e.map((function(e){var i=e.clone();return i.field=ae(e.field,t),i})):null!==e&&void 0!==e?e:[]}},{key:"supportsCacheHint",get:function(){var e;return!(null===(e=this.layer)||void 0===e||null===(e=e.capabilities)||void 0===e||null===(e=e.queryRelated)||void 0===e||!e.supportsCacheHint)}},{key:"canLoad",get:function(){return!!this.map&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId}},{key:"canQuery",get:function(){var e,t=null===(e=this.layer)||void 0===e||null===(e=e.capabilities)||void 0===e?void 0:e.queryRelated;return!!(this.relatedLayer&&this.relationship&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId&&null!==t&&void 0!==t&&t.supportsCount&&null!==t&&void 0!==t&&t.supportsPagination)}},{key:"itemDescriptionFieldName",get:function(){var e;return(null===(e=this.orderByFieldsFixedCasing[0])||void 0===e?void 0:e.field)||null}},{key:"displayCount",get:function(){return this._get("displayCount")},set:function(e){this._set("displayCount",Math.min(Math.max(e,0),10))}},{key:"objectId",get:function(){var e,t;return null!==(e=this.objectIdField&&(null===(t=this.graphic)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t[this.objectIdField]))&&void 0!==e?e:null}},{key:"objectIdField",get:function(){var e;return(null===(e=this.layer)||void 0===e?void 0:e.objectIdField)||null}},{key:"relatedFeatures",get:function(){return this._get("relatedFeatures")||new f.a}},{key:"relatedFeatureInfos",get:function(){var e=this.itemDescriptionFieldName,t=this.relatedFeatures,i=this.relatedLayer;if(!t.length||!i)return[];var n=i&&"formTemplate"in i&&i.formTemplate,a=n&&(null===n||void 0===n?void 0:n.title)||void 0;return t.map((function(t){var n;if(e){var r=t.getAttribute(e),o=i.fieldsIndex.get(e);if(o){var s=an([r],[o])[e];null!=s&&(n=s.toString())}}return{feature:t,description:n,title:a?nn(a,t.attributes,i.fieldsIndex):void 0}})).toArray()}},{key:"relatedLayer",get:function(){var e,t=this.layer,i=this.map,n=this.relationship;return null!==t&&void 0!==t&&t.loaded&&i&&n&&null!==(e=function(e,t,i){return e&&t&&i?Ie(e.allLayers,t,i)||Ie(e.allTables,t,i):null}(i,t,n))&&void 0!==e?e:null}},{key:"relationship",get:function(){var e,t,i=this.relationshipId,n=this.layer;return"number"==typeof i&&null!==(e=null===n||void 0===n||null===(t=n.relationships)||void 0===t?void 0:t.find((function(e){return e.id===i})))&&void 0!==e?e:null}},{key:"relatedFeatureViewModels",get:function(){return this._get("relatedFeatureViewModels")||new f.a}},{key:"state",get:function(){var e=this._queryAbortController,t=this._queryFeatureCountAbortController,i=this._queryPageAbortController,n=this.canQuery,a=this._loaded,r=this.canLoad;return t||r&&!a?"loading":e||i?"querying":n?"ready":"disabled"}},{key:"getRelatedFeatureByObjectId",value:function(e){return this.relatedFeatures.find((function(t){return t.getObjectId()===e}))}},{key:"_destroyRelatedFeatureViewModels",value:function(){var e;null!==(e=this.relatedFeatureViewModels)&&void 0!==e&&e.forEach((function(e){return!e.destroyed&&e.destroy()})),this.relatedFeatureViewModels.removeAll()}},{key:"_queryFeatureCount",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,r,o,s,l,u,c,d,h;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.layer,a=this.relatedLayer,r=this.relationshipId,o=this.objectId,s=this._queryFeatureCountAbortController,l=this.canQuery,u=this.supportsCacheHint,e.next=3,null===i||void 0===i?void 0:i.load();case 3:return e.next=5,null===a||void 0===a?void 0:a.load();case 5:if(l&&i&&a){e.next=7;break}return e.abrupt("return",void this._set("featureCount",0));case 7:return c=a.createQuery(),d=new ti.default({cacheHint:u,relationshipId:r,returnGeometry:!1,objectIds:[o],where:null!==(t=c.where)&&void 0!==t?t:void 0}),e.next=11,i.queryRelatedFeaturesCount(d,{signal:null===s||void 0===s?void 0:s.signal});case 11:h=e.sent,this._set("featureCount",h[o]||0);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_sliceFeatures",value:function(e){var t=this.showAllEnabled,i=this.displayCount;return t?e:i?e.slice(0,i):[]}},{key:"_queryPage",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,r,o;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.relatedFeatures,i=this.featurePage,a=this.showAllEnabled,r=this._queryPageAbortController,o=this.featureCount,e.t0=!a||i<2||!o,e.t0){e.next=8;break}return e.t1=t,e.next=6,this._queryRelatedFeatures({signal:null===r||void 0===r?void 0:r.signal});case 6:e.t2=e.sent,e.t1.addMany.call(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryRelatedFeatures",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,w,k,x,M;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.orderByFieldsFixedCasing,o=this.showAllEnabled,s=this.featuresPerPage,l=this.displayCount,u=this.layer,c=this.relationshipId,d=this.featurePage,h=this.featureCount,f=this.relatedLayer,b=this.supportsCacheHint,p=this.canQuery,v=this.objectId,p&&u&&f){e.next=3;break}return e.abrupt("return",[]);case 3:return y=o?((d-1)*s+h)%h:0,g=o?s:l,m=f.objectIdField,_=[].concat(Object(S.a)(r.map((function(e){return e.field}))),Object(S.a)(on(f)),[m]).filter(j.i),O=r.map((function(e){return"".concat(e.field," ").concat(e.order)})),w=f.createQuery(),k=new ti.default({orderByFields:O,start:y,num:g,outFields:_,cacheHint:b,relationshipId:c,returnGeometry:!1,objectIds:[v],where:null!==(i=w.where)&&void 0!==i?i:void 0}),e.next=12,u.queryRelatedFeatures(k,{signal:null===t||void 0===t?void 0:t.signal});case 12:return x=e.sent,M=(null===(a=x[v])||void 0===a?void 0:a.features)||[],e.abrupt("return",(M.forEach((function(e){e.sourceLayer=f,e.layer=f})),M));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),i}(Object(en.b)(Object(tn.a)(Object(ut.b)(D.a))));Object(h.a)([Object(_.b)()],sn.prototype,"_loaded",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"_queryAbortController",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"_queryPageAbortController",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"_queryFeatureCountAbortController",void 0),Object(h.a)([Object(_.b)({value:1})],sn.prototype,"featurePage",null),Object(h.a)([Object(_.b)()],sn.prototype,"featuresPerPage",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"orderByFieldsFixedCasing",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"supportsCacheHint",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"canLoad",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"canQuery",null),Object(h.a)([Object(_.b)()],sn.prototype,"description",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"itemDescriptionFieldName",null),Object(h.a)([Object(_.b)({value:3})],sn.prototype,"displayCount",null),Object(h.a)([Object(_.b)({type:I.a})],sn.prototype,"graphic",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"layer",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"map",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"objectId",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"objectIdField",null),Object(h.a)([Object(_.b)()],sn.prototype,"orderByFields",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"relatedFeatures",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"relatedFeatureInfos",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"relatedLayer",null),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"relationship",null),Object(h.a)([Object(_.b)()],sn.prototype,"featureCount",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],sn.prototype,"relatedFeatureViewModels",null),Object(h.a)([Object(_.b)()],sn.prototype,"relationshipId",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"showAllEnabled",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"state",null),Object(h.a)([Object(_.b)()],sn.prototype,"title",void 0),Object(h.a)([Object(_.b)()],sn.prototype,"getRelatedFeatureByObjectId",null);var ln=sn=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],sn),un="esri-feature",cn="".concat(un,"-relationship"),dn={base:cn,esriWidget:"esri-widget",listContainer:"".concat(cn,"__list"),listItem:"".concat(cn,"__list-item"),listItemHidden:"".concat(cn,"__list-item--hidden"),listContainerQuerying:"".concat(cn,"__list--querying"),featureObserver:"".concat(un,"__feature-observer"),stickySpinnerContainer:"".concat(un,"__sticky-loading-container"),loadingSpinnerContainer:"".concat(un,"__loading-container"),spinner:"".concat(un,"__loading-spinner"),iconLoading:"esri-icon-loading-indicator esri-rotating"},hn={title:!0,description:!0},fn=function(e){Object(c.a)(h,e);var t=Object(d.a)(h);function h(e,i){var n;return Object(l.a)(this,h),(n=t.call(this,e,i))._featureElementInfo=null,n._relatedFeatureIntersectionObserverNode=null,n._relatedFeatureIntersectionObserver=new IntersectionObserver((function(e){var t=Object(s.a)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&n._increaseFeaturePage()}),{root:window.document}),n.headingLevel=2,n.viewModel=new ln,n.messages=null,n.messagesCommon=null,n.visibleElements=Object(o.a)({},hn),n._increaseFeaturePage=function(){var e=n.viewModel,t=e.state,i=e.showAllEnabled,a=e.relatedFeatures,r=e.featuresPerPage,o=e.featurePage;"ready"===t&&i&&a.length>=r*o&&n.viewModel.featurePage++},n}return Object(u.a)(h,[{key:"initialize",value:function(){var e=this;this._featureElementInfo=new rt,this.addHandles([Object(g.e)((function(){return[e.viewModel.description,e.viewModel.title,e.headingLevel]}),(function(){return e._setupFeatureElementInfo()}),g.a),Object(g.e)((function(){return[e.viewModel.state,e.viewModel.showAllEnabled,e._relatedFeatureIntersectionObserverNode]}),(function(){return e._handleRelatedFeatureObserverChange()})),Object(g.b)((function(){return e.viewModel.relatedFeatureViewModels}),"change",(function(){return e._setupRelatedFeatureViewModels()}))])}},{key:"loadDependencies",value:function(){return Object(Re.b)({icon:function(){return i.e(26).then(i.bind(null,2229))},list:function(){return Promise.all([i.e(14),i.e(192)]).then(i.bind(null,2259))},"list-item":function(){return Promise.all([i.e(14),i.e(38),i.e(258)]).then(i.bind(null,2287))},notice:function(){return Promise.all([i.e(14),i.e(66)]).then(i.bind(null,2269))}})}},{key:"destroy",value:function(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=Object(Ji.e)(this._featureElementInfo)}},{key:"displayShowAllButton",get:function(){var e=this.viewModel,t=e.showAllEnabled,i=e.featureCount,n=e.displayCount,a=e.state;return!t&&!!i&&"ready"===a&&(i>n||0===n)}},{key:"displayListItems",get:function(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"featureCountDescription",get:function(){var e=this.messages,t=this.viewModel.featureCount;return Object(Oi.a)(null===e||void 0===e?void 0:e.numberRecords,{number:t})}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"castVisibleElements",value:function(e){return Object(o.a)(Object(o.a)({},hn),e)}},{key:"renderStickyLoading",value:function(){return"querying"===this.viewModel.state?Object(He.a)("div",{key:"sticky-loader",class:dn.stickySpinnerContainer},this.renderLoadingIcon()):null}},{key:"renderLoadingIcon",value:function(){return Object(He.a)("span",{class:this.classes(dn.iconLoading,dn.spinner)})}},{key:"renderLoading",value:function(){return Object(He.a)("div",{key:"loading-container",class:dn.loadingSpinnerContainer},this.renderLoadingIcon())}},{key:"renderShowAllIconNode",value:function(){return Object(He.a)("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}},{key:"renderChevronIconNode",value:function(){var e=Object(Ne.e)(this.container)?"chevron-left":"chevron-right";return Object(He.a)("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}},{key:"renderRelatedFeature",value:function(e){var t,i,n=this,a=this.viewModel.itemDescriptionFieldName,o=e.title;e.description=a&&(null===(t=e.formattedAttributes)||void 0===t?void 0:t.global[a]);var s="loading"===e.state;return Object(He.a)("calcite-list-item",{class:this.classes(dn.listItem,Object(r.a)({},dn.listItemHidden,s)),key:e.uid,label:o,description:null!==(i=e.description)&&void 0!==i?i:"",onCalciteListItemSelect:function(){return n.emit("select-record",{featureViewModel:e})}},this.renderChevronIconNode())}},{key:"renderShowAllListItem",value:function(){var e,t=this;return this.displayShowAllButton?Object(He.a)("calcite-list-item",{key:"show-all-item",label:null===(e=this.messages)||void 0===e?void 0:e.showAll,description:this.featureCountDescription,onCalciteListItemSelect:function(){return t.emit("show-all-records")}},this.renderShowAllIconNode()):null}},{key:"renderNoRelatedFeaturesMessage",value:function(){var e;return Object(He.a)("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,kind:"brand",scale:"s",width:"full"},Object(He.a)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.noRelatedFeatures))}},{key:"renderFeatureObserver",value:function(){return Object(He.a)("div",{key:"feature-observer",class:dn.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}},{key:"renderList",value:function(){var e=this,t=this.viewModel.relatedFeatureViewModels;return Object(He.a)("calcite-list",null,t.toArray().map((function(t){return e.renderRelatedFeature(t)})),this.renderShowAllListItem())}},{key:"renderRelatedFeatures",value:function(){var e=this.displayListItems,t=this.viewModel.state;return Object(He.a)("div",{key:"list-container",class:this.classes(dn.listContainer,Object(r.a)({},dn.listContainerQuerying,"querying"===t))},e?this.renderList():"ready"===t?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}},{key:"renderRelationshipNotFound",value:function(){var e;return Object(He.a)("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,kind:"danger",scale:"s",width:"full"},Object(He.a)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.relationshipNotFound))}},{key:"render",value:function(){var e,t=this.viewModel.state;return Object(He.a)("div",{class:this.classes(dn.base,dn.esriWidget)},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),"loading"===t?this.renderLoading():"disabled"===t?this.renderRelationshipNotFound():this.renderRelatedFeatures())}},{key:"_setupRelatedFeatureViewModels",value:function(){var e=this,t=this.viewModel.relatedFeatureViewModels,i="related-feature-viewmodels";this.removeHandles(i),null!==t&&void 0!==t&&t.forEach((function(t){e.addHandles(Object(g.e)((function(){return[t.title,t.state]}),(function(){return e.scheduleRender()}),g.a),i)})),this.scheduleRender()}},{key:"_setupFeatureElementInfo",value:function(){var e,t=this.headingLevel,i=this.visibleElements,n=i.description&&this.description,a=i.title&&this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:n,title:a,headingLevel:t})}},{key:"_handleRelatedFeatureObserverChange",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._unobserveRelatedFeatureObserver(),t=this.viewModel,i=t.state,a=t.showAllEnabled,e.next=4,Object($t.a)(0);case 4:this._relatedFeatureIntersectionObserverNode&&"ready"===i&&a&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_relatedFeatureIntersectionObserverCreated",value:function(e){this._relatedFeatureIntersectionObserverNode=e}},{key:"_unobserveRelatedFeatureObserver",value:function(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}}]),h}(k.a);Object(h.a)([Object(_.b)()],fn.prototype,"_relatedFeatureIntersectionObserverNode",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],fn.prototype,"displayShowAllButton",null),Object(h.a)([Object(_.b)({readOnly:!0})],fn.prototype,"displayListItems",null),Object(h.a)([Object(_.b)()],fn.prototype,"description",null),Object(h.a)([Object(_.b)({readOnly:!0})],fn.prototype,"featureCountDescription",null),Object(h.a)([Object(_.b)()],fn.prototype,"headingLevel",void 0),Object(h.a)([Object(_.b)()],fn.prototype,"title",null),Object(h.a)([Object(_.b)({type:ln})],fn.prototype,"viewModel",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/Feature/t9n/Feature")],fn.prototype,"messages",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/t9n/common")],fn.prototype,"messagesCommon",void 0),Object(h.a)([Object(_.b)()],fn.prototype,"visibleElements",void 0),Object(h.a)([Object(O.a)("visibleElements")],fn.prototype,"castVisibleElements",null);var bn,pn=fn=Object(h.a)([Object(w.a)("esri.widgets.Feature.FeatureRelationship")],fn),vn=Object(u.a)((function e(t,i){Object(l.a)(this,e),this.preLayerQueryCallback=t,this.preRequestCallback=i,this.preLayerQueryCallback||(this.preLayerQueryCallback=function(e){}),this.preRequestCallback||(this.preLayerQueryCallback=function(e){})})),yn="content-view-models",gn="relationship-view-models",mn={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0},_n=bn=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e))._handles=new v.a,n._error=null,n._featureAbortController=null,n._graphicChangedThrottled=Object(m.a)(n._graphicChanged,1,Object(Pt.a)(n)),n._expressionAttributes=null,n._graphicExpressionAttributes=null,n.abilities=Object(o.a)({},mn),n.content=null,n.contentViewModels=[],n.description=null,n.defaultPopupTemplateEnabled=!1,n.formattedAttributes=null,n.lastEditInfo=null,n.relatedInfos=new Map,n.title="",n.view=null,n._isAllowedContentType=function(e){var t=Object(Pt.a)(n).abilities;return"attachments"===e.type&&!!t.attachmentsContent||"custom"===e.type&&!!t.customContent||"fields"===e.type&&!!t.fieldsContent||"media"===e.type&&!!t.mediaContent||"text"===e.type&&!!t.textContent||"expression"===e.type&&!!t.expressionContent||"relationship"===e.type&&!!t.relationshipContent},n._handles.add(Object(g.e)((function(){return[n.graphic,n._effectivePopupTemplate,n.abilities]}),(function(){return n._graphicChangedThrottled()}),g.a)),n}return Object(u.a)(i,[{key:"initialize",value:function(){this.addHandles(this._graphicChangedThrottled)}},{key:"destroy",value:function(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}},{key:"_effectivePopupTemplate",get:function(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return function(e,t){var i=new Map;return e?(e.forEach((function(e){var n=ae(e.fieldName,t);e.fieldName=n,i.set(n.toLowerCase(),e)})),i):i}(ve(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return Q(this.graphic)}},{key:"castAbilities",value:function(e){return Object(o.a)(Object(o.a)({},mn),e)}},{key:"isTable",get:function(){var e;return(null===(e=this._sourceLayer)||void 0===e?void 0:e.isTable)||!1}},{key:"state",get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(e){this._set("graphic",e?e.clone():null)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"map",get:function(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null},set:function(e){this._override("map",e)}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}},{key:"setActiveMedia",value:function(e,t){var i=this.contentViewModels[e];i instanceof gi&&i.setActiveMedia(t)}},{key:"nextMedia",value:function(e){var t=this.contentViewModels[e];t instanceof gi&&t.next()}},{key:"previousMedia",value:function(e){var t=this.contentViewModels[e];t instanceof gi&&t.previous()}},{key:"updateGeometry",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,r,o,s,l,u,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.graphic,a=this.spatialReference,r=this._sourceLayer,e.next=3,null===r||void 0===r?void 0:r.load();case 3:if((o=null===r||void 0===r?void 0:r.objectIdField)&&i&&r){e.next=6;break}return e.abrupt("return");case 6:if(null!=(s=null===i||void 0===i||null===(t=i.attributes)||void 0===t?void 0:t[o])){e.next=9;break}return e.abrupt("return");case 9:if(l=[s],i.geometry){e.next=16;break}return e.next=13,Oe({layer:r,graphic:i,outFields:[],objectIds:l,returnGeometry:!0,spatialReference:a});case 13:u=e.sent,(c=null===u||void 0===u?void 0:u.geometry)&&(i.geometry=c);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_clear",value:function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}},{key:"_graphicChanged",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cancelFeatureQuery(),this._error=null,this._clear(),t=this.graphic){e.next=4;break}return e.abrupt("return");case 4:return i=new AbortController,this._featureAbortController=i,e.prev=6,e.next=9,this._queryFeature({signal:i.signal});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),Object($t.h)(e.t0)||(this._error=e.t0,y.a.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:e.t0,graphic:t,popupTemplate:this._effectivePopupTemplate}));case 14:this._featureAbortController===i&&(this._featureAbortController=null);case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cancelFeatureQuery",value:function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null}},{key:"_compileContentElement",value:function(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):"relationship"===e.type?this._compileRelationship(e,t):void 0}},{key:"_compileContent",value:function(e){var t=this;if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map((function(e,i){return t._compileContentElement(e,i)})).filter(j.i):"string"==typeof e?this._compileText(new Ti.a({text:e}),0).text:e}},{key:"_destroyContentViewModels",value:function(){var e,t;null!==(e=this._handles)&&void 0!==e&&e.remove(gn),null!==(t=this._handles)&&void 0!==t&&t.remove(yn),this.contentViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("contentViewModels",[])}},{key:"_matchesFeature",value:function(e,t){var i,n=null===e||void 0===e||null===(i=e.graphic)||void 0===i?void 0:i.getObjectId(),a=null===t||void 0===t?void 0:t.getObjectId();return null!=n&&null!=a&&n===a}},{key:"_setRelatedFeaturesViewModels",value:function(e){var t=this,i=e.relatedFeatureViewModels,n=e.relatedFeatures,a=e.map,r=this.view,o=this.spatialReference;null!==n&&void 0!==n&&n.filter(Boolean).forEach((function(e){i.find((function(i){return t._matchesFeature(i,e)}))||i.add(new bn({abilities:{relationshipContent:!1},map:a,view:r,spatialReference:o,graphic:e}))})),i.forEach((function(e){var a=null===n||void 0===n?void 0:n.find((function(i){return t._matchesFeature(e,i)}));a||i.remove(e)}))}},{key:"_setExpressionContentVM",value:function(e,t){var i=this.formattedAttributes,n=e.contentElement,a=e.contentElementViewModel,r=null===n||void 0===n?void 0:n.type;a&&r&&("fields"===r&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),a.set(this._createFieldsVMParams(n,t))),"media"===r&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),a.set(this._createMediaVMParams(n,t))),"text"===r&&a.set(this._createTextVMParams(n)))}},{key:"_compileRelationship",value:function(e,t){var i=this,n=e.displayCount,a=e.orderByFields,r=e.relationshipId,s=e.title,l=e.description,u=this._sourceLayer,c=this.graphic,d=this.map;if(fe(u)){var h=new ln(Object(o.a)({displayCount:n,graphic:c,orderByFields:a,relationshipId:r,layer:u,map:d},this._compileTitleAndDesc({title:s,description:l})));return this.contentViewModels[t]=h,this._handles.add(Object(g.b)((function(){return h.relatedFeatures}),"change",(function(){return i._setRelatedFeaturesViewModels(h)})),gn),e}}},{key:"_compileExpression",value:function(e,t){var i=this,n=e.expressionInfo,a=this.graphic,r=this.map,o=this.spatialReference,s=this.view,l=new qi({expressionInfo:n,graphic:a,interceptor:bn.interceptor,map:r,spatialReference:o,view:s});return this.contentViewModels[t]=l,this._handles.add(Object(g.e)((function(){return l.contentElementViewModel}),(function(){return i._setExpressionContentVM(l,t)}),g.a),yn),e}},{key:"_compileAttachments",value:function(e,t){var i=this.graphic,n=e.description,a=e.title;return this.contentViewModels[t]=new Ze(Object(o.a)({graphic:i},this._compileTitleAndDesc({title:a,description:n}))),e}},{key:"_compileCustom",value:function(e,t){var i=this.graphic,n=e.creator,a=e.destroyer;return this.contentViewModels[t]=new dt({graphic:i,creator:n,destroyer:a}),e}},{key:"_compileTitleAndDesc",value:function(e){var t=e.title,i=e.description,n=this._fieldInfoMap,a=this._sourceLayer,r=this.graphic,o=this.formattedAttributes,s=null===r||void 0===r?void 0:r.attributes,l=this._expressionAttributes,u=o.global;return{title:se({attributes:s,fieldInfoMap:n,globalAttributes:u,expressionAttributes:l,layer:a,text:t}),description:se({attributes:s,fieldInfoMap:n,globalAttributes:u,expressionAttributes:l,layer:a,text:i})}}},{key:"_createFieldsVMParams",value:function(e,t){var i=this._effectivePopupTemplate,n=this.formattedAttributes,a=Object(o.a)(Object(o.a)({},null===n||void 0===n?void 0:n.global),null===n||void 0===n?void 0:n.content[t]),r=(null===e||void 0===e?void 0:e.fieldInfos)||(null===i||void 0===i?void 0:i.fieldInfos),s=null===r||void 0===r?void 0:r.filter((function(e){var t=e.fieldName;return ie(t)||Pe(t)||a.hasOwnProperty(t)})),l=null===i||void 0===i?void 0:i.expressionInfos,u=e.description,c=e.title;return Object(o.a)({attributes:a,expressionInfos:l,fieldInfos:s},this._compileTitleAndDesc({title:c,description:u}))}},{key:"_compileFields",value:function(e,t){var i=e.clone(),n=new _t(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=n,i.fieldInfos=n.formattedFieldInfos.slice(0),i}},{key:"_createMediaVMParams",value:function(e,t){var i,n=this.abilities,a=this.graphic,r=this._fieldInfoMap,s=this._effectivePopupTemplate,l=this.relatedInfos,u=this._sourceLayer,c=this._expressionAttributes,d=this.formattedAttributes,h=null!==(i=null===a||void 0===a?void 0:a.attributes)&&void 0!==i?i:{},f=e.description,b=e.mediaInfos,p=e.title;return Object(o.a)({abilities:{chartAnimation:n.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:h,isAggregate:null===a||void 0===a?void 0:a.isAggregate,layer:u,fieldInfoMap:r,formattedAttributes:Object(o.a)(Object(o.a)({},null===d||void 0===d?void 0:d.global),null===d||void 0===d?void 0:d.content[t]),expressionAttributes:c,mediaInfos:b,popupTemplate:s,relatedInfos:l},this._compileTitleAndDesc({title:p,description:f}))}},{key:"_compileMedia",value:function(e,t){var i=e.clone(),n=new gi(this._createMediaVMParams(e,t));return i.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[t]=n,i}},{key:"_createTextVMParams",value:function(e){var t=this.graphic,i=this._fieldInfoMap,n=this._sourceLayer,a=this._expressionAttributes;if(e&&e.text){var r,o,s,l=null!==(r=null===t||void 0===t?void 0:t.attributes)&&void 0!==r?r:{},u=null!==(o=null===(s=this.formattedAttributes)||void 0===s?void 0:s.global)&&void 0!==o?o:{};e.text=se({attributes:l,fieldInfoMap:i,globalAttributes:u,expressionAttributes:a,layer:n,text:e.text})}return{graphic:t,creator:e.text}}},{key:"_compileText",value:function(e,t){var i=e.clone();return this.contentViewModels[t]=new dt(this._createTextVMParams(i)),i}},{key:"_compileLastEditInfo",value:function(){var e=this._effectivePopupTemplate,t=this._sourceLayer,i=this.graphic;if(e){var n=e.lastEditInfoEnabled,a=null===t||void 0===t?void 0:t.editFieldsInfo;return n&&a?function(e,t){var i=e.creatorField,n=e.creationDateField,a=e.editorField,r=e.editDateField;if(t){var o=t[r];if("number"==typeof o){var s=t[a];return{type:"edit",date:Object(L.c)(o,$),user:s}}var l=t[n];if("number"==typeof l){var u=t[i];return{type:"create",date:Object(L.c)(l,$),user:u}}return null}}(a,null===i||void 0===i?void 0:i.attributes):void 0}}},{key:"_compileTitle",value:function(e){var t,i,n,a=this._fieldInfoMap,r=this._sourceLayer,o=this.graphic,s=this._expressionAttributes;return se({attributes:null!==(t=null===o||void 0===o?void 0:o.attributes)&&void 0!==t?t:{},fieldInfoMap:a,globalAttributes:null!==(i=null===(n=this.formattedAttributes)||void 0===n?void 0:n.global)&&void 0!==i?i:{},expressionAttributes:s,layer:r,text:e})}},{key:"_getTitle",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._effectivePopupTemplate,i=this.graphic){e.next=3;break}return e.abrupt("return",null);case 3:return a=null===t||void 0===t?void 0:t.title,e.abrupt("return",J(a,{graphic:i}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getContent",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._effectivePopupTemplate,i=this.graphic){e.next=3;break}return e.abrupt("return",null);case 3:return a=null===t||void 0===t?void 0:t.content,e.abrupt("return",J(a,{graphic:i}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_queryFeature",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,s,l,u,c,d,h,f,b,p;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._featureAbortController,a=this._sourceLayer,r=this.graphic,s=this._effectivePopupTemplate,l=this.map,u=this.view,c=this.spatialReference,i===this._featureAbortController&&r){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,xe({graphic:r,popupTemplate:s,layer:a,spatialReference:c},t);case 5:return e.next=7,Object($t.e)({content:this._getContent(),title:this._getTitle()});case 7:return d=e.sent,h=d.content.value,f=d.title.value,e.next=12,Object($t.e)({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:Wi({expressionInfos:null===s||void 0===s?void 0:s.expressionInfos,spatialReference:c,graphic:r,map:l,interceptor:bn.interceptor,view:u})});case 12:b=e.sent,p=b.expressionAttributes.value,i===this._featureAbortController&&r&&(this._expressionAttributes=p,this._graphicExpressionAttributes=Object(o.a)(Object(o.a)({},r.attributes),p),this._set("formattedAttributes",this._createFormattedAttributes(h)),this._set("title",this._compileTitle(f)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(h)||null));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createMediaFormattedAttributes",value:function(e){var t=e.contentElement,i=e.contentElementIndex,n=e.formattedAttributes,a=this._effectivePopupTemplate,r=this.graphic,s=this.relatedInfos,l=this._sourceLayer,u=this._fieldInfoMap,c=this._graphicExpressionAttributes;n.content[i]=_e({fieldInfos:null===a||void 0===a?void 0:a.fieldInfos,graphic:r,attributes:Object(o.a)(Object(o.a)({},c),t.attributes),layer:l,fieldInfoMap:u,relatedInfos:s})}},{key:"_createFieldsFormattedAttributes",value:function(e){var t=e.contentElement,i=e.contentElementIndex,n=e.formattedAttributes;if(t.fieldInfos){var a=this.graphic,r=this.relatedInfos,s=this._sourceLayer,l=this._fieldInfoMap,u=this._graphicExpressionAttributes;n.content[i]=_e({fieldInfos:t.fieldInfos,graphic:a,attributes:Object(o.a)(Object(o.a)({},u),t.attributes),layer:s,fieldInfoMap:l,relatedInfos:r})}}},{key:"_createFormattedAttributes",value:function(e){var t=this,i=this._effectivePopupTemplate,n=this.graphic,a=this.relatedInfos,r=this._sourceLayer,o=this._fieldInfoMap,s=this._graphicExpressionAttributes,l={global:_e({fieldInfos:null===i||void 0===i?void 0:i.fieldInfos,graphic:n,attributes:s,layer:r,fieldInfoMap:o,relatedInfos:a}),content:[]};return Array.isArray(e)&&e.forEach((function(e,i){"fields"===e.type&&t._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:i,formattedAttributes:l}),"media"===e.type&&t._createMediaFormattedAttributes({contentElement:e,contentElementIndex:i,formattedAttributes:l})})),l}},{key:"_checkForRelatedFeatures",value:function(e){var t=this.graphic,i=this._effectivePopupTemplate;return this._queryRelatedInfos(t,ve(i),e)}},{key:"_queryRelatedInfos",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,i,a){var r,o,s,l,u,c,d=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.relatedInfos,o=this._sourceLayer,r.clear(),null==(null===o||void 0===o?void 0:o.associatedLayer)){e.next=8;break}return e.next=5,null===o||void 0===o?void 0:o.associatedLayer.load(a);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=o;case 9:if((s=e.t0)&&t){e.next=12;break}return e.abrupt("return");case 12:if(l=i.filter((function(e){return e&&Pe(e.fieldName)})),l&&l.length){e.next=15;break}return e.abrupt("return");case 15:return i.forEach((function(e){return d._configureRelatedInfo(e,s)})),e.next=18,fi({relatedInfos:r,layer:s},a);case 18:return u=e.sent,Object.keys(u).forEach((function(e){var t,i=r.get(e.toString()),n=null===(t=u[e])||void 0===t?void 0:t.value;i&&n&&(i.layerInfo=n.data)})),e.next=22,bi({graphic:t,relatedInfos:r,layer:s},a);case 22:c=e.sent,Object.keys(c).forEach((function(e){var t;ui(null===(t=c[e])||void 0===t?void 0:t.value,r.get(e.toString()))}));case 24:case"end":return e.stop()}}),e,this)})));return function(t,i,n){return e.apply(this,arguments)}}()},{key:"_configureRelatedInfo",value:function(e,t){var i=this.relatedInfos,n=ri(e.fieldName);if(n){var a=n.layerId,r=n.fieldName;if(a){var o=i.get(a.toString())||li(a,t);o&&(function(e){var t,i=e.relatedInfo,n=e.fieldName,a=e.fieldInfo;if(null!==(t=i.relatedFields)&&void 0!==t&&t.push(n),a.statisticType){var r,o=new ii.a({statisticType:a.statisticType,onStatisticField:n,outStatisticFieldName:n});null===(r=i.outStatistics)||void 0===r||r.push(o)}}({relatedInfo:o,fieldName:r,fieldInfo:e}),this.relatedInfos.set(a,o))}}}}]),i}(Object(tn.a)(D.a));_n.interceptor=new vn((function(e){var t=e.query,i=e.layer,n=e.method;Te({layer:i,method:n,query:t,definitionExpression:"".concat(i.definitionExpression," ").concat(i.serviceDefinitionExpression)})}),(function(e){var t=e.queryPayload,i=e.layer,n=e.method;Te({layer:i,method:n,query:t,definitionExpression:"".concat(i.definitionExpression," ").concat(i.serviceDefinitionExpression)})})),Object(h.a)([Object(_.b)()],_n.prototype,"_error",void 0),Object(h.a)([Object(_.b)()],_n.prototype,"_featureAbortController",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"_effectivePopupTemplate",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"_fieldInfoMap",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"_sourceLayer",null),Object(h.a)([Object(_.b)()],_n.prototype,"abilities",void 0),Object(h.a)([Object(O.a)("abilities")],_n.prototype,"castAbilities",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"content",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"contentViewModels",void 0),Object(h.a)([Object(_.b)()],_n.prototype,"description",void 0),Object(h.a)([Object(_.b)({type:Boolean})],_n.prototype,"defaultPopupTemplateEnabled",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"isTable",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"state",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"formattedAttributes",void 0),Object(h.a)([Object(_.b)({type:I.a,value:null})],_n.prototype,"graphic",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"lastEditInfo",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"relatedInfos",void 0),Object(h.a)([Object(_.b)()],_n.prototype,"spatialReference",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"title",void 0),Object(h.a)([Object(_.b)()],_n.prototype,"map",null),Object(h.a)([Object(_.b)({readOnly:!0})],_n.prototype,"waitingForContent",null),Object(h.a)([Object(_.b)()],_n.prototype,"view",void 0);var On,jn=_n=bn=Object(h.a)([Object(w.a)("esri.widgets.FeatureViewModel")],_n),wn="esri-feature",kn={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:wn,container:"".concat(wn,"__size-container"),title:"".concat(wn,"__title"),main:"".concat(wn,"__main-container"),btn:"".concat(wn,"__button"),icon:"".concat(wn,"__icon"),content:"".concat(wn,"__content"),contentNode:"".concat(wn,"__content-node"),contentElement:"".concat(wn,"__content-element"),text:"".concat(wn,"__text"),lastEditedInfo:"".concat(wn,"__last-edited-info"),fields:"".concat(wn,"__fields"),fieldHeader:"".concat(wn,"__field-header"),fieldData:"".concat(wn,"__field-data"),fieldDataDate:"".concat(wn,"__field-data--date"),loadingSpinnerContainer:"".concat(wn,"__loading-container"),spinner:"".concat(wn,"__loading-spinner")},xn=function(e){var t=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(){var e;return Object(l.a)(this,i),(e=t.apply(this,arguments)).renderNodeContent=function(t){return Object(ht.b)(t)&&!t.destroyed?Object(He.a)("div",{class:kn.contentNode,key:t},t.render()):t instanceof HTMLElement?Object(He.a)("div",{class:kn.contentNode,key:t,bind:t,afterCreate:e._attachToNode}):Object(ht.a)(t)?Object(He.a)("div",{class:kn.contentNode,key:t,bind:t.domNode,afterCreate:e._attachToNode}):null},e}return Object(u.a)(i,[{key:"_attachToNode",value:function(e){e.appendChild(this)}}]),i}(e);return t=Object(h.a)([Object(w.a)("esri.widgets.Feature.ContentMixin")],t)},Mn={title:!0,content:!0,lastEditedInfo:!0},Pn="relationship-handles",Cn=On=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e,i){var a;return Object(l.a)(this,n),(a=t.call(this,e,i))._contentWidgets=[],a.flowItems=null,a.headingLevel=2,a.messages=null,a.messagesCommon=null,a.messagesURIUtils=null,a.visibleElements=Object(o.a)({},Mn),a.viewModel=new jn,a}return Object(u.a)(n,[{key:"initialize",value:function(){var e=this;this.addHandles(Object(g.e)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.contentViewModels}),(function(){return e._setupContentWidgets()}),g.a))}},{key:"loadDependencies",value:function(){return Object(Re.b)({notice:function(){return Promise.all([i.e(14),i.e(66)]).then(i.bind(null,2269))}})}},{key:"destroy",value:function(){this._destroyContentWidgets()}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(e){this.viewModel.graphic=e}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(e){this.viewModel.defaultPopupTemplateEnabled=e}},{key:"isTable",get:function(){return this.viewModel.isTable}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(e){this.viewModel.spatialReference=e}},{key:"title",get:function(){return this.viewModel.title}},{key:"castVisibleElements",value:function(e){return Object(o.a)(Object(o.a)({},Mn),e)}},{key:"map",get:function(){return this.viewModel.map},set:function(e){this.viewModel.map=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"render",value:function(){var e=this.viewModel.state,t=Object(He.a)("div",{class:kn.container,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return Object(He.a)("div",{class:this.classes(kn.base,kn.esriWidget)},t)}},{key:"setActiveMedia",value:function(e,t){return this.viewModel.setActiveMedia(e,t)}},{key:"nextMedia",value:function(e){return this.viewModel.nextMedia(e)}},{key:"previousMedia",value:function(e){return this.viewModel.previousMedia(e)}},{key:"renderError",value:function(){var e=this.messagesCommon,t=this.messages,i=this.visibleElements;return Object(He.a)("calcite-notice",{open:!0,kind:"danger",icon:"exclamation-mark-circle",scale:"s"},i.title?Object(He.a)("div",{key:"error-title",slot:"title"},e.errorMessage):null,Object(He.a)("div",{key:"error-message",slot:"message"},t.loadingError))}},{key:"renderLoading",value:function(){return Object(He.a)("div",{key:"loading-container",class:kn.loadingSpinnerContainer},Object(He.a)("span",{class:this.classes(kn.iconLoading,kn.spinner)}))}},{key:"renderContentContainer",value:function(){return this.visibleElements.content?Object(He.a)("div",{class:kn.main},[this.renderContent(),this.renderLastEditInfo()]):null}},{key:"renderTitle",value:function(){var e=this.visibleElements,t=this.title;return e.title?Object(He.a)(et,{level:this.headingLevel,class:kn.title,innerHTML:t}):null}},{key:"renderContent",value:function(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?Object(He.a)("div",{class:kn.contentNode,key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var i=this._contentWidgets[0];return!i||i.destroyed?null:Object(He.a)("div",{class:kn.contentNode,key:"".concat(t,"-content")},i.render())}return this.renderNodeContent(e)}},{key:"renderContentElement",value:function(e,t){var i,n=this.visibleElements;if("boolean"!=typeof n.content&&(null===(i=n.content)||void 0===i||!i[e.type]))return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);case"relationship":return this.renderRelationship(t);default:return null}}},{key:"renderAttachments",value:function(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var i=t.viewModel,n=i.state,a=i.attachmentInfos;return"loading"===n||a.length>0?Object(He.a)("div",{key:this._buildKey("attachments-element",e),class:this.classes(kn.contentElement)},t.render()):null}},{key:"renderRelationship",value:function(e){var t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?Object(He.a)("div",{key:this._buildKey("relationship-element",e),class:kn.contentElement},t.render()):null}},{key:"renderExpression",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(He.a)("div",{key:this._buildKey("expression-element",e),class:kn.contentElement},t.render())}},{key:"renderCustom",value:function(e,t){var i=e.creator,n=this._contentWidgets[t];return!n||n.destroyed?null:i?Object(He.a)("div",{key:this._buildKey("custom-element",t),class:kn.contentElement},n.render()):null}},{key:"renderFields",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(He.a)("div",{key:this._buildKey("fields-element",e),class:kn.contentElement},t.render())}},{key:"renderMedia",value:function(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(He.a)("div",{key:this._buildKey("media-element",e),class:kn.contentElement},t.render())}},{key:"renderLastEditInfo",value:function(){var e=this.visibleElements,t=this.messages,i=this.viewModel.lastEditInfo;if(!i||!e.lastEditedInfo)return null;var n=i.date,a=i.user,r="edit"===i.type?a?t.lastEditedByUser:t.lastEdited:a?t.lastCreatedByUser:t.lastCreated,o=Object(Oi.a)(r,{date:n,user:a});return Object(He.a)("div",{key:"edit-info-element",class:this.classes(kn.lastEditedInfo,kn.contentElement)},o)}},{key:"renderText",value:function(e,t){var i=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:i?Object(He.a)("div",{key:this._buildKey("text-element",t),class:this.classes(kn.contentElement,kn.text)},n.render()):null}},{key:"_buildKey",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(i.join("-"))}},{key:"_destroyContentWidget",value:function(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}},{key:"_destroyContentWidgets",value:function(){var e=this;this.removeHandles(Pn),this._contentWidgets.forEach((function(t){return e._destroyContentWidget(t)})),this._contentWidgets=[]}},{key:"_addFeatureRelationshipHandles",value:function(e){var t=this,i=this.flowItems,n=this.visibleElements;this.addHandles([Object(g.b)((function(){return e}),"select-record",(function(e){var t=e.featureViewModel;i&&(t.abilities={relationshipContent:!0},i.push(new On({flowItems:i,viewModel:t,visibleElements:n})))})),Object(g.b)((function(){return e}),"show-all-records",(function(){if(i){var n=e.viewModel;n.showAllEnabled=!0;var a=new pn({visibleElements:{title:!1,description:!1},viewModel:n});t._addFeatureRelationshipHandles(a),i.push(a)}}))],Pn)}},{key:"_setupContentWidgets",value:function(){var e=this;this._destroyContentWidgets();var t=this.headingLevel,i=this.visibleElements,n=this.get("viewModel.content"),a=this.viewModel.contentViewModels;if(Array.isArray(n))n.forEach((function(n,r){if("attachments"===n.type&&(e._contentWidgets[r]=new lt({displayType:n.displayType,headingLevel:i.title?t+1:t,viewModel:a[r]})),"fields"===n.type&&(e._contentWidgets[r]=new Mt({viewModel:a[r]})),"media"===n.type&&(e._contentWidgets[r]=new Pi({viewModel:a[r]})),"text"===n.type&&(e._contentWidgets[r]=new vt({viewModel:a[r]})),"custom"===n.type&&(e._contentWidgets[r]=new vt({viewModel:a[r]})),"expression"===n.type&&(e._contentWidgets[r]=new Qi({viewModel:a[r]})),"relationship"===n.type){var o=new pn({viewModel:a[r]});e._addFeatureRelationshipHandles(o),e._contentWidgets[r]=o}}),this);else{var r=a[0];r&&!r.destroyed&&(this._contentWidgets[0]=new vt({viewModel:r}))}this.scheduleRender()}}]),n}(xn(k.a));Object(h.a)([Object(_.b)()],Cn.prototype,"graphic",null),Object(h.a)([Object(_.b)()],Cn.prototype,"defaultPopupTemplateEnabled",null),Object(h.a)([Object(_.b)()],Cn.prototype,"flowItems",void 0),Object(h.a)([Object(_.b)()],Cn.prototype,"headingLevel",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Cn.prototype,"isTable",null),Object(h.a)([Object(_.b)()],Cn.prototype,"label",null),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/Feature/t9n/Feature")],Cn.prototype,"messages",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/t9n/common")],Cn.prototype,"messagesCommon",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/support/t9n/uriUtils")],Cn.prototype,"messagesURIUtils",void 0),Object(h.a)([Object(_.b)()],Cn.prototype,"spatialReference",null),Object(h.a)([Object(_.b)({readOnly:!0})],Cn.prototype,"title",null),Object(h.a)([Object(_.b)()],Cn.prototype,"visibleElements",void 0),Object(h.a)([Object(O.a)("visibleElements")],Cn.prototype,"castVisibleElements",null),Object(h.a)([Object(_.b)()],Cn.prototype,"map",null),Object(h.a)([Object(_.b)()],Cn.prototype,"view",null),Object(h.a)([Object(_.b)({type:jn})],Cn.prototype,"viewModel",void 0);var An,Tn=Cn=On=Object(h.a)([Object(w.a)("esri.widgets.Feature")],Cn),In=i(193),Dn=Symbol("anchorHandles"),Fn=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e))[An]=new v.a,n.location=null,n.screenLocationEnabled=!1,n.view=null,n[Dn].add([Object(g.f)((function(){return Object(Ji.b)(n.screenLocationEnabled?n.view:null,(function(e){return[e.size,"3d"===e.type?e.camera:e.viewpoint]}))}),(function(){return n.notifyChange("screenLocation")})),Object(g.e)((function(){return n.screenLocation}),(function(e,t){null!=e&&null!=t&&n.emit("view-change")}))]),n}return Object(u.a)(i,[{key:"destroy",value:function(){this.view=null,this[Dn]=Object(Ji.e)(this[Dn])}},{key:"screenLocation",get:function(){var e,t=this.location,i=this.view;return this.screenLocationEnabled&&null!=t&&null!=i&&i.ready?null===(e=i.toScreen)||void 0===e?void 0:e.call(i,t):null}}]),i}(In.a.EventedAccessor);An=Dn,Object(h.a)([Object(_.b)()],Fn.prototype,"location",void 0),Object(h.a)([Object(_.b)()],Fn.prototype,"screenLocation",null),Object(h.a)([Object(_.b)()],Fn.prototype,"screenLocationEnabled",void 0),Object(h.a)([Object(_.b)()],Fn.prototype,"view",void 0);var En=Fn=Object(h.a)([Object(w.a)("esri.widgets.support.AnchorElementViewModel")],Fn),Sn=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).visible=!1,n}return Object(u.a)(i)}(En);Object(h.a)([Object(_.b)()],Sn.prototype,"visible",void 0);var Ln=Sn=Object(h.a)([Object(w.a)("esri.widgets.CompassViewModel")],Sn),Bn="esri-spinner",Rn={base:Bn,spinnerStart:"".concat(Bn,"--start"),spinnerFinish:"".concat(Bn,"--finish")},Nn=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e,n){var a;return Object(l.a)(this,i),(a=t.call(this,e,n))._animationDelay=500,a._animationPromise=null,a.viewModel=new Ln,a}return Object(u.a)(i,[{key:"initialize",value:function(){var e=this;this.addHandles(Object(g.e)((function(){return e.visible}),(function(t){return e._visibleChange(t)})))}},{key:"destroy",value:function(){this._animationPromise=null}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"show",value:function(e){var t=this,i=null!==e&&void 0!==e?e:{},n=i.location,a=i.promise;n&&(this.viewModel.location=n),this.visible=!0;a&&a.catch((function(){})).then((function(){return t.hide()}))}},{key:"hide",value:function(){this.visible=!1}},{key:"render",value:function(){var e,t=this.visible,i=!!this.viewModel.screenLocation,n=t&&i,a=!t&&i,o=(e={},Object(r.a)(e,Rn.spinnerStart,n),Object(r.a)(e,Rn.spinnerFinish,a),e),s=this._getPositionStyles();return Object(He.a)("div",{class:this.classes(Rn.base,o),styles:s})}},{key:"_visibleChange",value:function(e){var t=this;if(e)this.viewModel.screenLocationEnabled=!0;else{var i=Object($t.a)(this._animationDelay);this._animationPromise=i,i.catch((function(){})).then((function(){t._animationPromise===i&&(t.viewModel.screenLocationEnabled=!1,t._animationPromise=null)}))}}},{key:"_getPositionStyles",value:function(){var e=this.viewModel,t=e.screenLocation,i=e.view;if(null==i||null==t)return{};var n=i.padding;return{left:t.x-n.left+"px",top:t.y-n.top+"px"}}}]),i}(k.a);Object(h.a)([Object(_.b)()],Nn.prototype,"location",null),Object(h.a)([Object(_.b)()],Nn.prototype,"view",null),Object(h.a)([Object(_.b)({type:Ln})],Nn.prototype,"viewModel",void 0),Object(h.a)([Object(_.b)()],Nn.prototype,"visible",null);var zn=Nn=Object(h.a)([Object(w.a)("esri.widgets.Spinner")],Nn),Hn=i(959),Vn=i(960),Wn="esri-icon-zoom-in-magnifying-glass",Un="esri-icon-trash",Yn="esri-icon-table",qn=new Hn.a({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:Wn}),Gn=new Hn.a({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:Un}),Xn=new Hn.a({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:Wn}),Kn=new Vn.a({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:Yn,value:!1}),Zn=y.a.getLogger("esri.widgets.Popup.PopupViewModel"),$n=function(e){var t=e.event,i=e.view,n=e.viewModel,a=t.action;if(!a)return Promise.reject(new x.a("trigger-action:missing-arguments","Event has no action"));var r=a.disabled,o=a.id;if(!o)return Promise.reject(new x.a("trigger-action:invalid-action","action.id is missing"));if(r)return Promise.reject(new x.a("trigger-action:invalid-action","Action is disabled"));if(o===qn.id)return function(e){return ia.apply(this,arguments)}(n).catch($t.o);if(o===Xn.id)return function(e){return na.apply(this,arguments)}(n);if(o===Kn.id)return n.browseClusterEnabled=!n.browseClusterEnabled,n.featureMenuOpen=n.browseClusterEnabled,Promise.resolve();if(o===Gn.id){n.visible=!1;var s=n.selectedFeature;if(!s)return Promise.reject(new x.a("trigger-action:".concat(Gn.id),"selectedFeature is required",{selectedFeature:s}));var l=s.sourceLayer;return l?l.remove(s):null===i||void 0===i||i.graphics.remove(s),Promise.resolve()}return Promise.resolve()};function Qn(e){var t,i=e.selectedFeature,n=e.location,a=e.view;return a?"3d"===a.type?null!==(t=null!==i&&void 0!==i?i:n)&&void 0!==t?t:null:e.get("selectedFeature.geometry")||n:null}function Jn(e){var t;return!!e&&e.isAggregate&&"cluster"===(null===(t=e.sourceLayer)||void 0===t||null===(t=t.featureReduction)||void 0===t?void 0:t.type)}function ea(e,t){return ta.apply(this,arguments)}function ta(){return ta=Object(a.a)(Object(n.a)().mark((function e(t,i){var a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("3d"===(null===i||void 0===i?void 0:i.type)&&t&&"esri.Graphic"===t.declaredClass){e.next=2;break}return e.abrupt("return",!0);case 2:if(!(a=i.getViewForGraphic(t))||!("whenGraphicBounds"in a)){e.next=13;break}return e.prev=4,e.next=7,a.whenGraphicBounds(t,{useViewElevation:!0});case 7:r=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return e.abrupt("return",!r||!r.boundingBox||r.boundingBox[0]===r.boundingBox[3]&&r.boundingBox[1]===r.boundingBox[4]&&r.boundingBox[2]===r.boundingBox[5]);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,null,[[4,10]])}))),ta.apply(this,arguments)}function ia(){return(ia=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,s,l,u,c,d,h,f,b;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.location,r=t.selectedFeature,o=t.view,s=t.zoomFactor,l=Qn(t),o&&l){e.next=4;break}throw u=new x.a("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:l,view:o}),Zn.error(u),u;case 4:if(c=o.scale/s,d=null===(i=t.selectedFeature)||void 0===i?void 0:i.geometry,h=null!==d&&void 0!==d?d:a,e.t0=null!=h&&"point"===h.type,!e.t0){e.next=12;break}return e.next=11,ea(r,o);case 11:e.t0=e.sent;case 12:return f=e.t0,qn.active=!0,qn.disabled=!0,e.prev=14,e.next=17,t.zoomTo({target:{target:l,scale:f?c:void 0}});case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(14),b=new x.a("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:r}),Zn.error(b);case 23:return e.prev=23,qn.active=!1,qn.disabled=!1,t.zoomToLocation=null,f&&(t.location=h),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[14,19,23,26]])})))).apply(this,arguments)}function na(){return(na=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,l,u,c,d,h,f;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.selectedFeature,"2d"===(null===(a=t.view)||void 0===a?void 0:a.type)){e.next=4;break}throw r=new x.a("zoomToCluster:invalid-view","View must be 2d MapView.",{view:a}),Zn.error(r),r;case 4:if(i&&Jn(i)){e.next=7;break}throw o=new x.a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:i}),Zn.error(o),o;case 7:return e.next=9,la(a,i);case 9:return l=e.sent,u=Object(s.a)(l,2),c=u[0],d=u[1],Xn.active=!0,Xn.disabled=!0,e.next=16,c.queryExtent(d);case 16:return h=e.sent,f=h.extent,e.next=20,t.zoomTo({target:f});case 20:Xn.active=!1,Xn.disabled=!1;case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aa(e){return ra.apply(this,arguments)}function ra(){return ra=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,l,u,c,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.view,a=t.selectedFeature,i&&a){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,la(i,a);case 5:return r=e.sent,o=Object(s.a)(r,2),l=o[0],u=o[1],e.next=11,l.queryExtent(u);case 11:c=e.sent,d=c.extent,t.selectedClusterBoundaryFeature.geometry=d,i.graphics.add(t.selectedClusterBoundaryFeature);case 14:case"end":return e.stop()}}),e)}))),ra.apply(this,arguments)}function oa(e){return sa.apply(this,arguments)}function sa(){return sa=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o,l,u,c,d;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.selectedFeature,(a=t.view)&&i){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,la(a,i);case 5:return r=e.sent,o=Object(s.a)(r,2),l=o[0],u=o[1],Kn.active=!0,Kn.disabled=!0,e.next=12,l.queryFeatures(u);case 12:c=e.sent,d=c.features,Kn.active=!1,Kn.disabled=!1,Kn.value=!0,null===t||void 0===t||t.open({features:[i].concat(d),featureMenuOpen:!0});case 15:case"end":return e.stop()}}),e)}))),sa.apply(this,arguments)}function la(e,t){return ua.apply(this,arguments)}function ua(){return ua=Object(a.a)(Object(n.a)().mark((function e(t,i){var a,r,o;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.whenLayerView(i.sourceLayer);case 2:return a=e.sent,r=a.createQuery(),o=i.getObjectId(),e.abrupt("return",(r.aggregateIds=null!=o?[o]:[],[a,r]));case 6:case"end":return e.stop()}}),e)}))),ua.apply(this,arguments)}function ca(e){var t;if(null==e)return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}var da="esri-popup",ha="".concat(da,"__header"),fa="".concat(da,"--is-docked"),ba={calciteThemeLight:"calcite-mode-light",calciteThemeDark:"calcite-mode-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:da,widget:"esri-widget",main:"".concat(da,"__main-container"),loadingContainer:"".concat(da,"__loading-container"),isCollapsible:"".concat(da,"--is-collapsible"),isCollapsed:"".concat(da,"--is-collapsed"),shadow:"".concat(da,"--shadow"),isDocked:fa,isDockedTopLeft:"".concat(fa,"-top-left"),isDockedTopCenter:"".concat(fa,"-top-center"),isDockedTopRight:"".concat(fa,"-top-right"),isDockedBottomLeft:"".concat(fa,"-bottom-left"),isDockedBottomCenter:"".concat(fa,"-bottom-center"),isDockedBottomRight:"".concat(fa,"-bottom-right"),alignTopCenter:"".concat(da,"--aligned-top-center"),alignBottomCenter:"".concat(da,"--aligned-bottom-center"),alignTopLeft:"".concat(da,"--aligned-top-left"),alignBottomLeft:"".concat(da,"--aligned-bottom-left"),alignTopRight:"".concat(da,"--aligned-top-right"),alignBottomRight:"".concat(da,"--aligned-bottom-right"),isFeatureMenuOpen:"".concat(da,"--feature-menu-open"),isActionsMenuOpen:"".concat(da,"--actions-menu-open"),hasFeatureUpdated:"".concat(da,"--feature-updated"),header:ha,headerButtons:"".concat(ha,"-buttons"),headerContainer:"".concat(ha,"-container"),headerContainerButton:"".concat(ha,"-container--button"),headerTitle:"".concat(ha,"-title"),content:"".concat(da,"__content"),contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"".concat(da,"__footer"),footerHasPagination:"".concat(da,"__footer--has-pagination"),footerHasActions:"".concat(da,"__footer--has-actions"),footerHasActionsMenu:"".concat(da,"__footer--has-actions-menu"),button:"".concat(da,"__button"),buttonDisabled:"".concat(da,"__button--disabled"),buttonDock:"".concat(da,"__button--dock"),icon:"".concat(da,"__icon"),iconDock:"".concat(da,"__icon--dock-icon"),inlineActionsContainer:"".concat(da,"__inline-actions-container"),actionsMenuButton:"".concat(da,"__actions-menu-button"),actions:"".concat(da,"__actions"),action:"".concat(da,"__action"),actionImage:"".concat(da,"__action-image"),actionText:"".concat(da,"__action-text"),actionToggle:"".concat(da,"__action-toggle"),actionToggleOn:"".concat(da,"__action-toggle--on"),actionExit:"".concat(da,"__action--exit"),actionSelectFeature:"".concat(da,"__action--select-feature"),pointer:"".concat(da,"__pointer"),pointerDirection:"".concat(da,"__pointer-direction"),navigation:"".concat(da,"__navigation"),paginationIcon:"".concat(da,"__pagination-icon"),paginationPrevious:"".concat(da,"__pagination-previous"),paginationNext:"".concat(da,"__pagination-next"),featureMenu:"".concat(da,"__feature-menu"),featureMenuList:"".concat(da,"__feature-menu-list"),featureMenuItem:"".concat(da,"__feature-menu-item"),featureMenuViewport:"".concat(da,"__feature-menu-viewport"),featureMenuHeader:"".concat(da,"__feature-menu-header"),featureMenuNote:"".concat(da,"__feature-menu-note"),featureMenuSelected:"".concat(da,"__feature-menu-item--selected"),featureMenuButton:"".concat(da,"__feature-menu-button"),featureMenuButtonIcon:"".concat(da,"__feature-menu-button-icon"),featureMenuTitle:"".concat(da,"__feature-menu-title"),featureMenuObserver:"".concat(da,"__feature-menu-observer"),featureMenuLoader:"".concat(da,"__feature-menu-loader"),collapseButton:"".concat(da,"__collapse-button"),collapseIcon:"".concat(da,"__collapse-icon")},pa=i(233),va=i(259),ya=i(717),ga=(i(1025),i(1026),i(1178),i(1666),"esri-relationship-ramp"),ma="".concat(ga,"--diamond"),_a="".concat(ga,"--square");"".concat(ma,"__container"),"".concat(ma,"__left-column"),"".concat(ma,"__right-column"),"".concat(ma,"__middle-column"),"".concat(ma,"__middle-column--label"),"".concat(ma,"__middle-column--ramp"),"".concat(_a,"__table"),"".concat(_a,"__table-row"),"".concat(_a,"__table-cell"),"".concat(_a,"__table-label"),"".concat(_a,"__table-label--left-bottom"),"".concat(_a,"__table-label--right-bottom"),"".concat(_a,"__table-label--left-top"),"".concat(_a,"__table-label--right-top");i(116),i(1876);function Oa(e){return e&&"opacity"in e?e.opacity*Oa(e.parent):1}function ja(e,t){return wa.apply(this,arguments)}function wa(){return(wa=Object(a.a)(Object(n.a)().mark((function e(t,a){var r,s,l,u,c,d,h,f,b,p,v,y,g,m,_,O,j,w,k,x,M,P,C,A,T,I,D,F,E;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(l=t.sourceLayer,u=null!==(r=null!=a&&a.useSourceLayer?l:t.layer)&&void 0!==r?r:l,c=Oa(u),null==t.symbol||null!=a&&!0===a.ignoreGraphicSymbol){e.next=13;break}if("web-style"!==t.symbol.type){e.next=10;break}return e.next=7,Object(Dt.e)(t.symbol,Object(o.a)(Object(o.a)({},a),{},{cache:null!=a?a.webStyleCache:null}));case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=t.symbol.clone();case 11:return d=e.t0,e.abrupt("return",(Object(Dt.a)(d,null,c),d));case 13:if(!(h=null!==(s=null!=a?a.renderer:null)&&void 0!==s?s:u&&"renderer"in u?u.renderer:null)||!("getSymbolAsync"in h)){e.next=20;break}return e.next=17,h.getSymbolAsync(t,a);case 17:e.t1=e.sent,e.next=21;break;case 20:e.t1=null;case 21:if(f=e.t1){e.next=24;break}return e.abrupt("return");case 24:if("web-style"!==f.type){e.next=30;break}return e.next=27,f.fetchSymbol(Object(o.a)(Object(o.a)({},a),{},{cache:null!=a?a.webStyleCache:null}));case 27:e.t2=e.sent,e.next=31;break;case 30:e.t2=f.clone();case 31:if(f=e.t2,h&&"visualVariables"in h&&h.visualVariables&&h.visualVariables.length){e.next=34;break}return e.abrupt("return",(Object(Dt.a)(f,null,c),f));case 34:if(!("arcadeRequiredForVisualVariables"in h)||!h.arcadeRequiredForVisualVariables||null!=a&&null!=a.arcade){e.next=40;break}return b=Object(o.a)({},a),e.next=38,Object(z.e)();case 38:b.arcade=e.sent,a=b;case 40:return e.next=42,Promise.resolve().then(i.bind(null,982));case 42:p=e.sent,v=p.getColor,y=p.getOpacity,g=p.getAllSizes,m=p.getRotationAngle,_=[],O=[],j=[],w=[],k=Object(Ct.a)(h.visualVariables),e.prev=52,k.s();case 54:if((x=k.n()).done){e.next=68;break}M=x.value,e.t3=M.type,e.next="color"===e.t3?59:"opacity"===e.t3?61:"rotation"===e.t3?63:"size"===e.t3?65:66;break;case 59:return _.push(M),e.abrupt("break",66);case 61:return O.push(M),e.abrupt("break",66);case 63:return w.push(M),e.abrupt("break",66);case 65:M.target||j.push(M);case 66:e.next=54;break;case 68:e.next=73;break;case 70:e.prev=70,e.t4=e.catch(52),k.e(e.t4);case 73:return e.prev=73,k.f(),e.finish(73);case 76:if(P=!!_.length&&_[_.length-1],C=P?v(P,t,a):null,A=!!O.length&&O[O.length-1],T=A?y(A,t,a):null,null!=c&&(T=null!=T?T*c:c),Object(Dt.a)(f,C,T),!j.length){e.next=82;break}return I=g(j,t,a),e.next=82,Object(Dt.d)(f,I);case 82:for(D=0,F=w;D<F.length;D++)E=F[D],Object(Dt.c)(f,m(E,t,a),E.axis);return e.abrupt("return",f);case 84:case"end":return e.stop()}}),e,null,[[52,70,73,76]])})))).apply(this,arguments)}var ka=i(1151),xa=i(884),Ma=i(444),Pa=f.a.ofType({key:"type",defaultKeyValue:"button",base:ya.a,typeMap:{button:Hn.a,toggle:Vn.a}}),Ca=function(e){Object(c.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e))._handles=new v.a,n._pendingPromises=new Set,n._fetchFeaturesController=null,n._highlightSelectedFeaturePromise=null,n._highlightActiveFeaturePromise=null,n._selectedClusterFeature=null,n.featurePage=null,n.actions=new Pa,n.activeFeature=null,n.defaultPopupTemplateEnabled=!1,n.autoCloseEnabled=!1,n.autoOpenEnabled=!0,n.browseClusterEnabled=!1,n.content=null,n.featuresPerPage=20,n.featureMenuOpen=!1,n.featureViewModelAbilities=null,n.featureViewModels=[],n.highlightEnabled=!0,n.includeDefaultActions=!0,n.selectedClusterBoundaryFeature=new I.a({symbol:new Ma.a({outline:{width:1.5,color:"cyan"},style:"none"})}),n.title=null,n.updateLocationEnabled=!1,n.view=null,n.visible=!1,n.zoomFactor=4,n.zoomToLocation=null,n}return Object(u.a)(i,[{key:"isLoadingFeature",get:function(){return this.featureViewModels.some((function(e){return e.waitingForContent}))}},{key:"initialize",value:function(){var e=this;this._handles.add([this.on("view-change",(function(){return e._autoClose()})),Object(g.e)((function(){return[e.highlightEnabled,e.selectedFeature,e.visible,e.view]}),(function(){return e._highlightSelectedFeature()})),Object(g.e)((function(){return[e.highlightEnabled,e.activeFeature,e.visible,e.view]}),(function(){return e._highlightActiveFeature()})),Object(g.e)((function(){var t;return null===(t=e.view)||void 0===t||null===(t=t.animation)||void 0===t?void 0:t.state}),(function(t){return e._animationStateChange(t)})),Object(g.e)((function(){return e.location}),(function(t){return e._locationChange(t)})),Object(g.e)((function(){return e.selectedFeature}),(function(t){return e._selectedFeatureChange(t)})),Object(g.e)((function(){return[e.selectedFeatureIndex,e.featureCount,e.featuresPerPage]}),(function(){return e._selectedFeatureIndexChange()})),Object(g.e)((function(){return[e.featurePage,e.selectedFeatureIndex,e.featureCount,e.featuresPerPage,e.featureViewModels]}),(function(){return e._setGraphicOnFeatureViewModels()})),Object(g.e)((function(){return e.featureViewModels}),(function(){return e._featureViewModelsChange()})),this.on("trigger-action",(function(t){return $n({event:t,viewModel:e,view:e.view})})),Object(g.f)((function(){return!e.waitingForResult}),(function(){return e._waitingForResultChange()}),g.c),Object(g.e)((function(){var t,i;return[e.features,null===(t=e.view)||void 0===t?void 0:t.map,null===(i=e.view)||void 0===i?void 0:i.spatialReference]}),(function(){return e._updateFeatureVMs()})),Object(g.e)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.scale}),(function(){return e._viewScaleChange()})),Object(g.f)((function(){return!e.visible}),(function(){return e.browseClusterEnabled=!1})),Object(g.e)((function(){return e.browseClusterEnabled}),(function(t){return t?e.enableClusterBrowsing():e.disableClusterBrowsing()}))])}},{key:"destroy",value:function(){this._cancelFetchingFeatures(),this._handles.destroy(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}},{key:"active",get:function(){return!(!this.visible||this.waitingForResult)}},{key:"allActions",get:function(){var e=this._get("allActions")||new Pa;e.removeAll();var t=this.actions,i=this.defaultActions,n=this.defaultPopupTemplateEnabled,a=this.includeDefaultActions,r=this.selectedFeature,o=a?i.concat(t):t,s=r&&("function"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(n)||r.popupTemplate),l=s&&s.actions,u=s&&s.overwriteActions?l:l?l.concat(o):o;return u&&u.filter(Boolean).forEach((function(t){return e.add(t)})),e}},{key:"defaultActions",get:function(){var e=this._get("defaultActions")||new Pa;return e.removeAll(),e.addMany(Jn(this.selectedFeature)?[Xn.clone(),Kn.clone()]:[qn.clone()]),e}},{key:"featureCount",get:function(){return this.features.length}},{key:"features",get:function(){return this._get("features")||[]},set:function(e){var t=e||[];this._set("features",t);var i=this.pendingPromisesCount,n=this.promiseCount,a=this.selectedFeatureIndex,r=n&&t.length;r&&i&&-1===a?this.selectedFeatureIndex=0:r&&-1!==a||(this.selectedFeatureIndex=t.length?0:-1)}},{key:"location",get:function(){return this._get("location")||null},set:function(e){var t,i,n=e,a=null===(t=this.view)||void 0===t||null===(t=t.spatialReference)||void 0===t?void 0:t.isWebMercator;e&&null!==e&&void 0!==e&&null!==(i=e.spatialReference)&&void 0!==i&&i.isWGS84&&a&&(n=Object(pa.b)(e)),this._set("location",n)}},{key:"pendingPromisesCount",get:function(){return this._pendingPromises.size}},{key:"waitingForResult",get:function(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}},{key:"promiseCount",get:function(){return this.promises.length}},{key:"promises",get:function(){return this._get("promises")||[]},set:function(e){var t=this;if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((function(e){t._pendingPromises.add(e);e.then((function(i){t._pendingPromises.has(e)&&t._updateFeatures(i),t._updatePendingPromises(e)}),(function(){return t._updatePendingPromises(e)}))})),this.notifyChange("pendingPromisesCount")}},{key:"selectedFeature",get:function(){var e=this.features,t=this.selectedFeatureIndex;return-1===t?null:e[t]||null}},{key:"selectedFeatureIndex",get:function(){var e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1},set:function(e){var t=this.featureCount;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}},{key:"selectedFeatureViewModel",get:function(){return this.featureViewModels[this.selectedFeatureIndex]||null}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}},{key:"centerAtLocation",value:function(){var e=this.view,t=Qn(this);return t&&e?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new x.a("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}},{key:"zoomTo",value:function(e){return this.callGoTo(e)}},{key:"clear",value:function(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}},{key:"fetchFeatures",value:function(e,t){var i=this.view;if(!i||!e)throw new x.a("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return i.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}},{key:"open",value:function(e){var t=Object(o.a)(Object(o.a)({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{},{visible:!0}),i=t.fetchFeatures;delete t.fetchFeatures,i&&this._setFetchFeaturesPromises(t.location);for(var n=0,a=["actionsMenuOpen","collapsed"];n<a.length;n++){delete t[a[n]]}this.set(t)}},{key:"triggerAction",value:function(e){var t=this.allActions.at(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}},{key:"next",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}},{key:"previous",value:function(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}},{key:"disableClusterBrowsing",value:function(){(function(e){Kn.value=!1;var t=e.features.filter((function(e){return Jn(e)}));t.length&&(e.features=t)})(this),this._clearBrowsedClusterGraphics()}},{key:"enableClusterBrowsing",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.view,i=this.selectedFeature,"2d"!==(null===t||void 0===t?void 0:t.type)){e.next=12;break}if(!Jn(i)){e.next=9;break}return e.next=5,aa(this);case 5:return e.next=7,oa(this);case 7:e.next=10;break;case 9:y.a.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",i);case 10:e.next=13;break;case 12:y.a.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",i);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleViewClick",value:function(e){this.autoOpenEnabled&&this._fetchFeaturesAndOpen(e)}},{key:"_animationStateChange",value:function(e){this.zoomToLocation||(qn.disabled="waiting-for-target"===e)}},{key:"_clearBrowsedClusterGraphics",value:function(){var e,t=null===(e=this.view)||void 0===e?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),this._selectedClusterFeature&&t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}},{key:"_viewScaleChange",value:function(){if(Jn(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}},{key:"_locationChange",value:function(e){var t=this.selectedFeature;this.updateLocationEnabled&&e&&(!t||t.geometry)&&this.centerAtLocation()}},{key:"_selectedFeatureIndexChange",value:function(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}},{key:"_featureViewModelsChange",value:function(){this.featurePage=this.featureCount>1?1:null}},{key:"_setGraphicOnFeatureViewModels",value:function(){var e=this.features,t=this.featureCount,i=this.featurePage,n=this.featuresPerPage,a=this.featureViewModels;if(null!==i){var r=((i-1)*n+t)%t,o=r+n;a.slice(r,o).forEach((function(t,i){t&&!t.graphic&&(t.graphic=e[r+i])}))}}},{key:"_selectedFeatureChange",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r,o=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.location,a=this.updateLocationEnabled,r=this.view,!t||!r){e.next=11;break}if(!this.browseClusterEnabled){e.next=10;break}if(this._selectedClusterFeature&&(r.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),!Jn(t)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,ja(t);case 7:return t.symbol=e.sent,this._selectedClusterFeature=t,e.abrupt("return",void r.graphics.add(this._selectedClusterFeature));case 10:!a&&i||!t.geometry?a&&!t.geometry&&this.centerAtLocation().then((function(){var e,t=null===(e=r.center)||void 0===e?void 0:e.clone();t&&(o.location=t)})):this.location=ca(t.geometry);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_waitingForResultChange",value:function(){!this.featureCount&&this.promises&&(this.visible=!1)}},{key:"_setFetchFeaturesPromises",value:function(e){var t=this;return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((function(e){var i=e.clientOnlyGraphics,n=e.promisesPerLayerView,a=Promise.resolve(i),r=n.map((function(e){return e.promise}));t.promises=[a].concat(Object(S.a)(r))}))}},{key:"_destroyFeatureVMs",value:function(){this.featureViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",[])}},{key:"_updateFeatureVMs",value:function(){var e=this,t=this.selectedFeature,i=this.features,n=this.featureViewModels;if(Jn(t)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),i&&i.length){var a=n.slice(0),r=[];i.forEach((function(i,n){if(i){var o=null;if(a.some((function(e,t){return e&&e.graphic===i&&(o=e,a.splice(t,1)),!!o})),o)r[n]=o;else{var s,l,u=new jn({abilities:e.featureViewModelAbilities,defaultPopupTemplateEnabled:e.defaultPopupTemplateEnabled,spatialReference:null===(s=e.view)||void 0===s?void 0:s.spatialReference,graphic:i===t?i:null,map:null===(l=e.view)||void 0===l?void 0:l.map,view:e.view});r[n]=u}}})),a.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",r)}}},{key:"_getScreenPoint",value:function(e){var t=this.view;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}},{key:"_cancelFetchingFeatures",value:function(){var e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}},{key:"_fetchFeaturesWithController",value:function(e,t){var i=this;this._cancelFetchingFeatures();var n=new AbortController,a=n.signal;this._fetchFeaturesController=n,this.notifyChange("waitingForResult");var r=this.fetchFeatures(e,{signal:a,event:t});return r.catch((function(){})).then((function(){i._fetchFeaturesController=null,i.notifyChange("waitingForResult")})),r}},{key:"_fetchFeaturesAndOpen",value:function(e){var t=e.screenPoint,i=e.mapPoint,n=this.view;this._fetchFeaturesWithController(t,e).then((function(e){var t=e.clientOnlyGraphics,a=e.promisesPerLayerView,r=e.location,o=[Promise.resolve(t)].concat(Object(S.a)(a.map((function(e){return e.promise}))));return null!==n&&void 0!==n&&n.popup&&"open"in n.popup&&n.popup.open({location:r||i,promises:o}),e}))}},{key:"_updatePendingPromises",value:function(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}},{key:"_autoClose",value:function(){this.autoCloseEnabled&&(this.visible=!1)}},{key:"_getLayerView",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t,i){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.when();case 2:return e.abrupt("return",t.whenLayerView(i));case 3:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_getHighlightLayer",value:function(e){var t=e.layer,i=e.sourceLayer;return i&&"layer"in i&&i.layer?i.layer:"map-notes"===(null===i||void 0===i?void 0:i.type)||"subtype-group"===(null===i||void 0===i?void 0:i.type)?i:t}},{key:"_getHighlightTarget",value:function(e,t){var i="imagery"===t.type?void 0:"objectIdField"in t?t.objectIdField||"OBJECTID":null,n=e.attributes;return n&&i&&n[i]||e}},{key:"_highlightActiveFeature",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,r,o,s,l,u,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-active-feature",this._handles.remove(t),i=this.highlightEnabled,a=this.view,r=this.activeFeature,o=this.visible,r&&a&&i&&o){e.next=5;break}return e.abrupt("return");case 5:if((s=this._getHighlightLayer(r))&&s instanceof va.a){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(a,s),this._highlightActiveFeaturePromise=l,e.next=12,l;case 12:if((u=e.sent)&&Object(ka.a)(u)&&this._highlightActiveFeaturePromise===l&&this.activeFeature&&this.highlightEnabled){e.next=15;break}return e.abrupt("return");case 15:c=u.highlight(this._getHighlightTarget(r,s)),this._handles.add(c,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_highlightSelectedFeature",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(){var t,i,a,r,o,s,l,u,c;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-selected-feature",this._handles.remove(t),i=this.selectedFeature,a=this.highlightEnabled,r=this.view,o=this.visible,i&&r&&a&&o){e.next=5;break}return e.abrupt("return");case 5:if((s=this._getHighlightLayer(i))&&s instanceof va.a){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(r,s),this._highlightSelectedFeaturePromise=l,e.next=12,l;case 12:if((u=e.sent)&&Object(ka.a)(u)&&this._highlightSelectedFeaturePromise===l&&this.selectedFeature&&this.highlightEnabled&&this.visible){e.next=15;break}return e.abrupt("return");case 15:c=u.highlight(this._getHighlightTarget(i,s)),this._handles.add(c,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateFeatures",value:function(e){var t=this.features;if(e&&e.length)if(t.length){var i=e.filter((function(e){return!t.includes(e)}));this.features=t.concat(i)}else this.features=e}}]),i}(Object(xa.a)(En));Object(h.a)([Object(_.b)()],Ca.prototype,"featurePage",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"isLoadingFeature",null),Object(h.a)([Object(_.b)({type:Pa})],Ca.prototype,"actions",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"active",null),Object(h.a)([Object(_.b)()],Ca.prototype,"activeFeature",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"allActions",null),Object(h.a)([Object(_.b)({type:Boolean})],Ca.prototype,"defaultPopupTemplateEnabled",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"autoCloseEnabled",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"autoOpenEnabled",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"browseClusterEnabled",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"content",void 0),Object(h.a)([Object(_.b)({type:Pa,readOnly:!0})],Ca.prototype,"defaultActions",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"featureCount",null),Object(h.a)([Object(_.b)()],Ca.prototype,"features",null),Object(h.a)([Object(_.b)()],Ca.prototype,"featuresPerPage",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"featureMenuOpen",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"featureViewModelAbilities",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"featureViewModels",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"highlightEnabled",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"includeDefaultActions",void 0),Object(h.a)([Object(_.b)({type:Jt.a})],Ca.prototype,"location",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"pendingPromisesCount",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"selectedClusterBoundaryFeature",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"waitingForResult",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"promiseCount",null),Object(h.a)([Object(_.b)()],Ca.prototype,"promises",null),Object(h.a)([Object(_.b)({value:null,readOnly:!0})],Ca.prototype,"selectedFeature",null),Object(h.a)([Object(_.b)({value:-1})],Ca.prototype,"selectedFeatureIndex",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"selectedFeatureViewModel",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ca.prototype,"state",null),Object(h.a)([Object(_.b)()],Ca.prototype,"title",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"updateLocationEnabled",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"view",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"visible",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"zoomFactor",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"zoomToLocation",void 0),Object(h.a)([Object(_.b)()],Ca.prototype,"centerAtLocation",null);var Aa=Ca=Object(h.a)([Object(w.a)("esri.widgets.Popup.PopupViewModel")],Ca),Ta=i(484),Ia=i(728),Da="selected-index",Fa="popup-spinner",Ea={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},Sa="esri-popup";function La(e,t){return void 0===t?"".concat(Sa,"__").concat(e):"".concat(Sa,"__").concat(e,"-").concat(t)}var Ba={closeButton:!0,featureNavigation:!0},Ra=function(e){Object(c.a)(h,e);var t=Object(d.a)(h);function h(e,i){var n;return Object(l.a)(this,h),(n=t.call(this,e,i))._blurClose=!1,n._blurContainer=!1,n._containerNode=null,n._mainContainerNode=null,n._featureMenuNode=null,n._actionsMenuNode=null,n._focusClose=!1,n._focusContainer=!1,n._focusDockButton=!1,n._focusFeatureMenuButton=!1,n._focusActionsMenuButton=!1,n._focusFirstFeature=!1,n._focusFirstAction=!1,n._handles=new v.a,n._pointerOffsetInPx=16,n._spinner=null,n._feature=null,n._featureMenuIntersectionObserverNode=null,n._featureMenuViewportNode=null,n._rootFlowItemNode=null,n._featureMenuIntersectionObserverCallback=function(e){var t=Object(s.a)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&null!=n.viewModel.featurePage&&n.viewModel.featurePage++},n._featureMenuIntersectionObserver=new IntersectionObserver(n._featureMenuIntersectionObserverCallback,{root:window.document}),n._displaySpinnerThrottled=Object(m.a)((function(){return n._displaySpinner()}),0),n._exitRelatedRecordsActions=new WeakMap,n._featureSelectionActions=new WeakMap,n._flowItems=new f.a,n.alignment="auto",n.collapsed=!1,n.collapseEnabled=!0,n.dockEnabled=!1,n.headingLevel=2,n.maxInlineActions=3,n.messages=null,n.messagesCommon=null,n.spinnerEnabled=!0,n.viewModel=new Aa,n.visibleElements=Object(o.a)({},Ba),n._handleOpenRelatedFeature=function(e){n._openRelatedFeature(e)},n._addSelectedFeatureIndexHandle(),n.addHandles([n._displaySpinnerThrottled,Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.screenLocation}),(function(){return n._positionContainer()})),Object(g.e)((function(){var e;return[null===(e=n.viewModel)||void 0===e?void 0:e.active,n.dockEnabled]}),(function(){return n._toggleScreenLocationEnabled()})),Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.screenLocation}),(function(e,t){!!e!=!!t&&n.reposition()})),Object(g.e)((function(){var e,t,i,a;return[null===(e=n.viewModel)||void 0===e||null===(e=e.view)||void 0===e?void 0:e.padding,null===(t=n.viewModel)||void 0===t||null===(t=t.view)||void 0===t?void 0:t.size,null===(i=n.viewModel)||void 0===i?void 0:i.active,null===(a=n.viewModel)||void 0===a?void 0:a.location,n.alignment]}),(function(){return n.reposition()})),Object(g.e)((function(){return n.spinnerEnabled}),(function(e){return n._spinnerEnabledChange(e)})),Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e||null===(e=e.view)||void 0===e?void 0:e.size}),(function(e,t){return n._updateDockEnabledForViewSize(e,t)})),Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.view}),(function(e,t){return n._viewChange(e,t)})),Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e||null===(e=e.view)||void 0===e?void 0:e.ready}),(function(e,t){return n._viewReadyChange(null!==e&&void 0!==e&&e,null!==t&&void 0!==t&&t)})),Object(g.e)((function(){var e,t;return[null===(e=n.viewModel)||void 0===e?void 0:e.waitingForResult,null===(t=n.viewModel)||void 0===t?void 0:t.location]}),(function(){n._hideSpinner(),n._displaySpinnerThrottled()})),Object(g.e)((function(){return n.selectedFeatureWidget}),(function(){return n._destroyFlowItemWidgets()})),Object(g.e)((function(){var e,t;return[null===(e=n.selectedFeatureWidget)||void 0===e||null===(e=e.viewModel)||void 0===e?void 0:e.title,null===(t=n.selectedFeatureWidget)||void 0===t||null===(t=t.viewModel)||void 0===t?void 0:t.state]}),(function(){return n._setTitleFromFeatureWidget()})),Object(g.e)((function(){var e,t;return[null===(e=n.selectedFeatureWidget)||void 0===e||null===(e=e.viewModel)||void 0===e?void 0:e.content,null===(t=n.selectedFeatureWidget)||void 0===t||null===(t=t.viewModel)||void 0===t?void 0:t.state]}),(function(){return n._setContentFromFeatureWidget()})),Object(g.f)((function(){return!n.collapsed}),(function(){var e;"xsmall"===(null===(e=n.viewModel)||void 0===e||null===(e=e.view)||void 0===e?void 0:e.widthBreakpoint)&&n.viewModel.active&&n.collapseEnabled&&n.viewModel.centerAtLocation()})),Object(g.b)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.allActions}),"change",(function(){return n._watchActions()})),Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.allActions}),(function(){return n._watchActions()}),g.a),Object(g.e)((function(){var e;return null===(e=n.viewModel)||void 0===e?void 0:e.featureViewModels}),(function(){return n._featureMenuViewportScrollTop()})),Object(g.b)((function(){return n._flowItems}),"change",(function(){n.notifyChange("_activeFlowItemWidget"),n.scheduleRender()})),Object(g.e)((function(){var e,t;return[null===(e=n._activeFlowItemWidget)||void 0===e||null===(e=e.viewModel)||void 0===e?void 0:e.state,null===(t=n._activeFlowItemWidget)||void 0===t||null===(t=t.viewModel)||void 0===t?void 0:t.title]}),(function(){return n.scheduleRender()}))]),n}return Object(u.a)(h,[{key:"loadDependencies",value:function(){return Object(Re.b)({action:function(){return Promise.all([i.e(14),i.e(38),i.e(339)]).then(i.bind(null,2227))},flow:function(){return i.e(244).then(i.bind(null,2228))},"flow-item":function(){return Promise.all([i.e(14),i.e(38),i.e(60),i.e(257)]).then(i.bind(null,2261))},icon:function(){return i.e(26).then(i.bind(null,2229))},tooltip:function(){return Promise.all([i.e(60),i.e(340)]).then(i.bind(null,2230))}})}},{key:"initialize",value:function(){this.addHandles(this._displaySpinnerThrottled)}},{key:"destroy",value:function(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),null!==(e=this._handles)&&void 0!==e&&e.destroy(),this._unobserveFeatureMenuObserver(),null===(t=this._featureMenuIntersectionObserver)||void 0===t||t.disconnect()}},{key:"actionsMenuId",get:function(){return"".concat(this.id,"-actions-menu")}},{key:"actionsMenuButtonId",get:function(){return"".concat(this.id,"-actions-menu-button")}},{key:"featureMenuId",get:function(){return"".concat(this.id,"-feature-menu")}},{key:"titleId",get:function(){return"".concat(this.id,"-popup-title")}},{key:"contentId",get:function(){return"".concat(this.id,"-popup-content")}},{key:"hasContent",get:function(){var e=this.selectedFeatureWidget,t=this.viewModel;if(!e)return!(null===t||void 0===t||!t.content);var i=e.viewModel;if(null!==i&&void 0!==i&&i.waitingForContent||"error"===(null===i||void 0===i?void 0:i.state))return!0;var n=null===i||void 0===i?void 0:i.content;return Array.isArray(n)?!!n.length:!!n}},{key:"featureNavigationVisible",get:function(){return this.viewModel.active&&this.viewModel.featureCount>1&&!!this.visibleElements.featureNavigation}},{key:"collapsible",get:function(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}},{key:"featureMenuVisible",get:function(){return this.featureNavigationVisible&&this.featureMenuOpen}},{key:"contentCollapsed",get:function(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}},{key:"dividedActions",get:function(){return this._divideActions()}},{key:"_activeFlowItemWidget",get:function(){var e;return null!==(e=this._flowItems.at(-1))&&void 0!==e?e:null}},{key:"actions",get:function(){return this.viewModel.actions},set:function(e){this.viewModel.actions=e}},{key:"actionsMenuOpen",get:function(){return!!this.viewModel.active&&this._get("actionsMenuOpen")},set:function(e){this._set("actionsMenuOpen",!!e)}},{key:"autoCloseEnabled",get:function(){return this.viewModel.autoCloseEnabled},set:function(e){this.viewModel.autoCloseEnabled=e}},{key:"autoOpenEnabled",get:function(){return Object(b.b)(y.a.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"}),this.viewModel.autoOpenEnabled},set:function(e){Object(b.b)(y.a.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"}),this.viewModel.autoOpenEnabled=e}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(e){this.viewModel.defaultPopupTemplateEnabled=e}},{key:"content",get:function(){return this.viewModel.content},set:function(e){this.viewModel.content=e}},{key:"currentAlignment",get:function(){return this._getCurrentAlignment()}},{key:"currentDockPosition",get:function(){return this._getCurrentDockPosition()}},{key:"dockOptions",get:function(){return this._get("dockOptions")||Ea},set:function(e){var t,i=Object(o.a)({},Ea),n=null===(t=this.viewModel)||void 0===t||null===(t=t.view)||void 0===t?void 0:t.breakpoints,a={};n&&(a.width=n.xsmall,a.height=n.xsmall);var r=Object(o.a)(Object(o.a)({},i),e),s=Object(o.a)(Object(o.a)({},i.breakpoint),a),l=r.breakpoint;"object"==typeof l?r.breakpoint=Object(o.a)(Object(o.a)({},s),l):l&&(r.breakpoint=s),this._set("dockOptions",r),this._setCurrentDockPosition(),this.reposition()}},{key:"featureCount",get:function(){return this.viewModel.featureCount}},{key:"featureMenuOpen",get:function(){return this.viewModel.featureMenuOpen},set:function(e){this.viewModel.featureMenuOpen=e}},{key:"features",get:function(){return this.viewModel.features},set:function(e){this.viewModel.features=e}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"highlightEnabled",get:function(){return this.viewModel.highlightEnabled},set:function(e){this.viewModel.highlightEnabled=e}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"promises",get:function(){return this.viewModel.promises},set:function(e){this.viewModel.promises=e}},{key:"selectedFeature",get:function(){return this.viewModel.selectedFeature}},{key:"selectedFeatureIndex",get:function(){return this.viewModel.selectedFeatureIndex},set:function(e){this.viewModel.selectedFeatureIndex=e}},{key:"selectedFeatureWidget",get:function(){var e=this._feature,t=this.visibleElements,i=this.headingLevel,n=this._flowItems,a=this.viewModel.selectedFeatureViewModel,r=Object(o.a)(Object(o.a)({},t),{},{title:!1});return a?(e?(e.viewModel=a,e.visibleElements=r):this._feature=new Tn({flowItems:n,headingLevel:i+1,viewModel:a,visibleElements:r}),this._feature):null}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"updateLocationEnabled",get:function(){return this.viewModel.updateLocationEnabled},set:function(e){this.viewModel.updateLocationEnabled=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"castVisibleElements",value:function(e){return Object(o.a)(Object(o.a)({},Ba),e)}},{key:"blur",value:function(){this.viewModel.active||y.a.getLogger(this).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}},{key:"clear",value:function(){return this.viewModel.clear()}},{key:"close",value:function(){this.visible=!1}},{key:"fetchFeatures",value:function(e,t){return this.viewModel.fetchFeatures(e,t)}},{key:"focus",value:function(){this.viewModel.active||y.a.getLogger(this).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}},{key:"next",value:function(){return this.viewModel.next()}},{key:"open",value:function(e){var t;this._handles.remove(Da);var i=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,a={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:i};"xsmall"===(null===(t=this.viewModel)||void 0===t||null===(t=t.view)||void 0===t?void 0:t.widthBreakpoint)&&(a.collapsed=!0),this.set(a),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}},{key:"previous",value:function(){return this.viewModel.previous()}},{key:"reposition",value:function(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}},{key:"triggerAction",value:function(e){return this.viewModel.triggerAction(e)}},{key:"render",value:function(){var e,t,i,n=this.actionsMenuOpen,a=this.dockEnabled,o=this.featureMenuVisible,s=this.dividedActions,l=this.currentAlignment,u=this.currentDockPosition,c=this.viewModel.active,d=s.menuActions,h=c&&d.length>1&&n,f=c&&a,b=c&&!a,p=null===(e=this.selectedFeature)||void 0===e||null===(e=e.layer)||void 0===e?void 0:e.title,v=null===(t=this.selectedFeature)||void 0===t||null===(t=t.layer)||void 0===t?void 0:t.id,y=(i={},Object(r.a)(i,ba.alignTopCenter,"top-center"===l),Object(r.a)(i,ba.alignBottomCenter,"bottom-center"===l),Object(r.a)(i,ba.alignTopLeft,"top-left"===l),Object(r.a)(i,ba.alignBottomLeft,"bottom-left"===l),Object(r.a)(i,ba.alignTopRight,"top-right"===l),Object(r.a)(i,ba.alignBottomRight,"bottom-right"===l),Object(r.a)(i,ba.isDocked,f),Object(r.a)(i,ba.shadow,b),Object(r.a)(i,ba.isDockedTopLeft,"top-left"===u),Object(r.a)(i,ba.isDockedTopCenter,"top-center"===u),Object(r.a)(i,ba.isDockedTopRight,"top-right"===u),Object(r.a)(i,ba.isDockedBottomLeft,"bottom-left"===u),Object(r.a)(i,ba.isDockedBottomCenter,"bottom-center"===u),Object(r.a)(i,ba.isDockedBottomRight,"bottom-right"===u),Object(r.a)(i,ba.isFeatureMenuOpen,o),Object(r.a)(i,ba.isActionsMenuOpen,h),i);return Object(He.a)("div",{class:this.classes(ba.base,y),role:"presentation","data-layer-title":p,"data-layer-id":v,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}},{key:"renderLoadingIcon",value:function(){return Object(He.a)("span",{"aria-hidden":"true",class:this.classes(ba.icon,ba.iconLoading,ba.rotating)})}},{key:"renderNavigationLoading",value:function(){var e=this.messagesCommon;return this.viewModel.pendingPromisesCount?Object(He.a)("div",{key:La("loading-container"),role:"presentation",class:ba.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}},{key:"renderPreviousButton",value:function(){var e=this.messages;return Object(He.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(ba.button,ba.paginationPrevious),"aria-label":e.previous,title:e.previous},Object(He.a)("calcite-icon",{icon:"chevron-left",scale:"s",class:ba.paginationIcon}))}},{key:"renderNextButton",value:function(){var e=this.messages;return Object(He.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(ba.button,ba.paginationNext),"aria-label":e.next,title:e.next},Object(He.a)("calcite-icon",{icon:"chevron-right",scale:"s",class:ba.paginationIcon}))}},{key:"renderFeatureMenuButton",value:function(){var e=this.featureMenuOpen,t=this.featureMenuId,i=this.messagesCommon,n=this.viewModel,a=n.featureCount,r=n.selectedFeatureIndex;return Object(He.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:ba.featureMenuButton,"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},Object(He.a)("calcite-icon",{icon:"list-bullet",scale:"s",class:ba.featureMenuButtonIcon}),this._getPageText(a,r))}},{key:"renderNavigationButtons",value:function(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNextButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton()]:[]}},{key:"renderDockIcon",value:function(){var e,t=this.dockEnabled,i=this._wouldDockTo(),n=(e={},Object(r.a)(e,ba.iconUndock,t),Object(r.a)(e,ba.iconDock,!t),Object(r.a)(e,ba.iconDockToRight,!t&&("top-right"===i||"bottom-right"===i)),Object(r.a)(e,ba.iconDockToLeft,!t&&("top-left"===i||"bottom-left"===i)),Object(r.a)(e,ba.iconDockToTop,!t&&"top-center"===i),Object(r.a)(e,ba.iconDockToBottom,!t&&"bottom-center"===i),e);return Object(He.a)("span",{"aria-hidden":"true",class:this.classes(n,ba.icon)})}},{key:"renderDockButton",value:function(){var e,t,i=this.dockEnabled,n=this.messages,a=null===(e=this.viewModel)||void 0===e||null===(e=e.view)||void 0===e?void 0:e.widthBreakpoint,r=i?n.undock:n.dock;return"xsmall"!==a&&null!==(t=this.dockOptions)&&void 0!==t&&t.buttonEnabled?Object(He.a)("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(ba.button,ba.buttonDock)},this.renderDockIcon()):null}},{key:"renderTitle",value:function(){var e=this.viewModel.title,t=this.titleId,i=this.collapsible,n=this.contentCollapsed,a=this.messagesCommon,o=Object(r.a)({},ba.headerContainerButton,i),s=Object(He.a)(et,{level:this.headingLevel,class:ba.headerTitle,innerHTML:null!==e&&void 0!==e?e:""}),l=i?Object(He.a)("button",{key:"".concat(e,"--collapsible"),id:t,title:n?a.expand:a.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(ba.headerContainer,o),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},s,Object(He.a)("calcite-icon",{class:ba.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):Object(He.a)("div",{key:null!==e&&void 0!==e?e:"title",id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(ba.headerContainer,o)},s);return e?l:null}},{key:"renderCloseIcon",value:function(){return Object(He.a)("span",{"aria-hidden":"true",class:this.classes(ba.icon,ba.iconClose)})}},{key:"renderCloseButton",value:function(){var e=this.visibleElements,t=this.messagesCommon;return e.closeButton?Object(He.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:ba.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}},{key:"renderHeader",value:function(){return Object(He.a)("header",{class:ba.header},this.renderTitle(),Object(He.a)("div",{class:ba.headerButtons},this.renderDockButton(),this.renderCloseButton()))}},{key:"renderContentContainer",value:function(){var e=this,t=this.contentId,i=this.hasContent,n=this.contentCollapsed,a=this._flowItems,o=this.viewModel.content,s=a.toArray(),l=Object(r.a)({},ba.contentHasFlows,!!s.length);return i&&!n?Object(He.a)("div",{key:null!==o&&void 0!==o?o:"content",enterAnimation:this._createFeatureUpdatedAnimation(),id:t,class:this.classes(ba.content,l)},Object(He.a)("calcite-flow",{bind:this},Object(He.a)("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode",afterCreate:Ne.h,key:"root-flow-item",onCalciteFlowItemBack:this._handleBackClick},this.renderContent()),s.map((function(t){return e.renderFlowItem(t)}))),s.map((function(t){return e.renderFlowItemTooltips(t)}))):null}},{key:"renderFlowItem",value:function(e){var t,i,n,a=this,o=this.messages,s=Object(_i.a)(),l="graphic"in e&&!e.isTable;return Object(He.a)("calcite-flow-item",{bind:this,class:this.classes((t={},Object(r.a)(t,ba.calciteThemeDark,!s),Object(r.a)(t,ba.calciteThemeLight,s),t)),heading:null!==(i=e.title)&&void 0!==i?i:"",description:this._getFlowItemDescription(e),onCalciteFlowItemBack:this._handleBackClick,key:"flow-item-".concat(e.viewModel.uid)},Object(He.a)("calcite-action",{class:ba.actionExit,icon:"move-up",label:null===o||void 0===o?void 0:o.exitRelatedRecords,text:null===o||void 0===o?void 0:o.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:function(t){return a._storeExitRelatedRecordsAction(e,t)},onclick:this._destroyFlowItemWidgets}),l?Object(He.a)("calcite-action",{class:ba.actionSelectFeature,icon:"zoom-to-object",label:null===o||void 0===o?void 0:o.selectFeature,text:null===o||void 0===o?void 0:o.selectFeature,slot:"header-actions-end",bind:this,afterCreate:function(t){return a._storeFeatureSelectionAction(e,t)},onclick:function(){return a._handleOpenRelatedFeature(e)}}):null,Object(He.a)("div",{class:this.classes(ba.contentFlowItem,(n={},Object(r.a)(n,ba.calciteThemeDark,s),Object(r.a)(n,ba.calciteThemeLight,!s),n))},e.render()))}},{key:"renderFlowItemTooltips",value:function(e){var t,i,n=this.messages,a=this._exitRelatedRecordsActions,o=this._featureSelectionActions,s=Object(_i.a)(),l=o.get(e);return[Object(He.a)("calcite-tooltip",{class:this.classes((t={},Object(r.a)(t,ba.calciteThemeDark,!s),Object(r.a)(t,ba.calciteThemeLight,s),t)),key:"exit-related-records-tooltip-".concat(e.viewModel.uid),label:null===n||void 0===n?void 0:n.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:a.get(e),placement:"top"},null===n||void 0===n?void 0:n.exitRelatedRecords),l?Object(He.a)("calcite-tooltip",{class:this.classes((i={},Object(r.a)(i,ba.calciteThemeDark,!s),Object(r.a)(i,ba.calciteThemeLight,s),i)),key:"select-related-record-tooltip-".concat(e.viewModel.uid),label:null===n||void 0===n?void 0:n.selectFeature,overlayPositioning:"fixed",referenceElement:l,placement:"top"},null===n||void 0===n?void 0:n.selectFeature):null]}},{key:"renderActionsMenuButton",value:function(){var e=this.actionsMenuId,t=this.actionsMenuButtonId,i=this.actionsMenuOpen,n=this.dividedActions,a=this.messagesCommon,r=i?a.close:a.open;return n.menuActions.length?Object(He.a)("div",{key:La("actions-menu-button"),class:this.classes(ba.button,ba.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":r,title:r},Object(He.a)("span",{"aria-hidden":"true",class:ba.iconActionsMenu})):null}},{key:"renderMenuActions",value:function(){var e=this,t=this.actionsMenuId,i=this.actionsMenuButtonId,n=this.actionsMenuOpen,a=this.dividedActions.menuActions;return a.length&&n?Object(He.a)("ul",{id:t,role:"menu","aria-labelledby":i,key:La("actions"),class:ba.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},a.toArray().map((function(t){return e.renderAction({action:t,type:"menu-item"})}))):null}},{key:"renderInlineActions",value:function(){var e=this,t=this.dividedActions.inlineActions;return t.length?t.toArray().map((function(t){return e.renderAction({action:t,type:"inline"})})):[]}},{key:"renderInlineActionsContainer",value:function(){var e=this.dividedActions,t=e.inlineActions,i=e.menuActions,n=!!t.length,a=!!i.length;return n||a?Object(He.a)("div",{key:"inline-actions-container","data-inline-actions":n.toString(),"data-menu-actions":a.toString(),class:ba.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}},{key:"renderNavigation",value:function(){return this.featureNavigationVisible?Object(He.a)("section",{key:La("navigation"),class:this.classes(ba.navigation)},this.renderNavigationButtons()):null}},{key:"renderFooter",value:function(){var e,t=this.featureNavigationVisible,i=this.dividedActions,n=i.inlineActions,a=i.menuActions,o=!!n.length,s=!!a.length,l=(e={},Object(r.a)(e,ba.footerHasPagination,t),Object(r.a)(e,ba.footerHasActions,o),Object(r.a)(e,ba.footerHasActionsMenu,s),e);return t||o?Object(He.a)("div",{key:La("feature-buttons"),class:this.classes(ba.footer,l)},this.renderInlineActionsContainer(),this.renderNavigation()):null}},{key:"renderFeatureMenuContainer",value:function(){var e=this.messages,t=this.viewModel,i=t.featureViewModels,n=t.isLoadingFeature,a=Object(Oi.a)(e.selectedFeatures,{total:i.length});return Object(He.a)("section",{key:La("menu"),class:ba.featureMenu},Object(He.a)("strong",{class:ba.featureMenuHeader},a),Object(He.a)("nav",{bind:this,class:ba.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:Ne.h},this.renderFeatureMenu(),Object(He.a)("div",{class:ba.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),n?Object(He.a)("div",{class:ba.featureMenuLoader},this.renderLoadingIcon()):null))}},{key:"renderPointer",value:function(){return this.dockEnabled?null:Object(He.a)("div",{key:La("pointer"),class:ba.pointer,role:"presentation"},Object(He.a)("div",{class:this.classes(ba.pointerDirection,ba.shadow)}))}},{key:"renderMainContainer",value:function(){var e,t=this.dockEnabled,i=this.currentAlignment,n=this.currentDockPosition,a=this.titleId,o=this.contentId,s=this.collapsible,l=this.hasContent,u=this.contentCollapsed,c=this.visibleElements,d=this.viewModel.title,h="bottom-left"===i||"bottom-center"===i||"bottom-right"===i||"top-left"===n||"top-center"===n||"top-right"===n,f="top-left"===i||"top-center"===i||"top-right"===i||"bottom-left"===n||"bottom-center"===n||"bottom-right"===n,b=(e={},Object(r.a)(e,ba.shadow,t),Object(r.a)(e,ba.isCollapsible,s),Object(r.a)(e,ba.isCollapsed,u),e);return Object(He.a)("div",{class:this.classes(ba.main,ba.widget,b),tabIndex:c.closeButton?void 0:-1,role:"dialog","aria-live":"polite","aria-labelledby":d?a:"","aria-describedby":l&&!u?o:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},h?this.renderFooter():null,h?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),f?this.renderFooter():null,f?this.renderFeatureMenuContainer():null)}},{key:"renderContent",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.content;return t?"string"==typeof t?Object(He.a)("div",{class:kn.contentNode,key:t,innerHTML:t}):this.renderNodeContent(t):null}},{key:"renderActionText",value:function(e){return Object(He.a)("span",{key:"text",class:ba.actionText},e)}},{key:"renderActionCalciteIcon",value:function(e,t){return Object(He.a)("calcite-icon",{scale:"s",key:"calcite-icon-".concat(t),icon:e,class:ba.icon})}},{key:"renderActionIcon",value:function(e){var t,i=this._getActionClass(e),n=this._getActionImage(e),a=(t={},Object(r.a)(t,ba.iconLoading,e.active),Object(r.a)(t,ba.rotating,e.active),Object(r.a)(t,ba.icon,!!i),Object(r.a)(t,ba.actionImage,!e.active&&!!n),t);return i&&(a[i]=!e.active),Object(He.a)("span",{key:"icon","aria-hidden":"true",class:this.classes(ba.icon,a),styles:this._getIconStyles(n)})}},{key:"renderAction",value:function(e){var t,i=e.action,n=e.type,a=this._getActionTitle(i),o=(t={},Object(r.a)(t,ba.action,"toggle"!==i.type),Object(r.a)(t,ba.actionToggle,"toggle"===i.type),Object(r.a)(t,ba.actionToggleOn,"toggle"===i.type&&i.value),Object(r.a)(t,ba.buttonDisabled,i.disabled),t),s=[i.icon&&!i.active?this.renderActionCalciteIcon(i.icon,i.uid):this.renderActionIcon(i),this.renderActionText(a)],l="menu-item"===n?Object(He.a)("li",{key:i.uid,role:"menuitem",tabIndex:0,title:a,"aria-label":a,class:this.classes(ba.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":i.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},s):Object(He.a)("div",{key:i.uid,role:"button",tabIndex:0,title:a,"aria-label":a,class:this.classes(ba.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":i.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},s);return i.visible?l:null}},{key:"renderFeatureMenuItem",value:function(e,t){var i=this.messages,n=this.messagesCommon,a=this.viewModel,o=a.selectedFeatureIndex,s=e===a.selectedFeatureViewModel,l=Object(r.a)({},ba.featureMenuSelected,s),u=s?Object(He.a)("span",{key:La("feature-menu-selected-feature-".concat(o)),title:i.selectedFeature,"aria-label":i.selectedFeature,class:ba.iconCheckMark}):null,c=Object(He.a)("span",{innerHTML:e.title||n.untitled});return Object(He.a)("li",{role:"menuitem",tabIndex:-1,key:La("feature-menu-feature-".concat(o)),class:this.classes(l,ba.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},Object(He.a)("span",{class:ba.featureMenuTitle},c,u))}},{key:"renderFeatureMenu",value:function(){var e=this,t=this.featureMenuId,i=this.viewModel.featureViewModels;return i.length>1?Object(He.a)("ol",{class:ba.featureMenuList,id:t,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},i.filter((function(e){return!!e.graphic})).map((function(t,i){return e.renderFeatureMenuItem(t,i)}))):null}},{key:"_storeFeatureSelectionAction",value:function(e,t){this._featureSelectionActions.set(e,t),this.scheduleRender()}},{key:"_storeExitRelatedRecordsAction",value:function(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}},{key:"_getFlowItemDescription",value:function(e){var t;return"featureCountDescription"in e?e.featureCountDescription:null!==(t=e.viewModel.description)&&void 0!==t?t:""}},{key:"_openRelatedFeature",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i,a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.viewModel.updateGeometry();case 2:if(i=t.graphic,null!=(a=null===i||void 0===i?void 0:i.geometry)&&null!=i){e.next=5;break}return e.abrupt("return");case 5:return this._destroyFlowItemWidgets(),e.next=8,this.viewModel.zoomTo({target:a});case 8:r=ca(a),this.open({features:[i],location:null!=r?r:void 0});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_destroyFlowItemWidgets",value:function(){this._flowItems.removeAll().forEach((function(e){"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()}))}},{key:"_handleBackClick",value:function(){var e=this._flowItems.pop();e&&(this._exitRelatedRecordsActions.delete(e),this._featureSelectionActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy()))}},{key:"_getActionTitle",value:function(e){var t,i=this.messages,n=this.selectedFeature,a=this.messagesCommon,r=e.id,o=null===n||void 0===n?void 0:n.attributes,s=null!==(t=e.title)&&void 0!==t?t:"",l="zoom-to-feature"===r?Object(Oi.a)(s,{messages:i}):"remove-selected-feature"===r?Object(Oi.a)(s,{messages:a}):"zoom-to-clustered-features"===r||"browse-clustered-features"===r?Object(Oi.a)(s,{messages:i}):e.title;return l&&o?Object(Oi.a)(l,o):null!==l&&void 0!==l?l:""}},{key:"_getActionClass",value:function(e){var t=this.selectedFeature,i=null===t||void 0===t?void 0:t.attributes,n=e.className,a=e.image||n?n:ba.iconDefaultAction;return a&&i?Object(Oi.a)(a,i):null!==a&&void 0!==a?a:""}},{key:"_getActionImage",value:function(e){if(e.active)return"";var t=this.selectedFeature,i=null===t||void 0===t?void 0:t.attributes,n=e.image;return n&&i?Object(Oi.a)(n,i):null!==n&&void 0!==n?n:""}},{key:"_createFeatureUpdatedAnimation",value:function(){return Object(Ne.b)("enter",ba.hasFeatureUpdated)}},{key:"_getInlineActionCount",value:function(){var e=this.maxInlineActions,t=this.featureNavigationVisible;if("number"!=typeof e)return null;var i=Math.round(e);return Math.max(t?i-1:i,0)}},{key:"_watchActions",value:function(){var e=this,t=this.viewModel.allActions;this.notifyChange("dividedActions");var i="actions";this._handles.remove(i),t&&t.forEach((function(t){e._handles.add(Object(g.e)((function(){return[t.uid,t.active,t.className,t.disabled,t.id,t.title,t.image,t.visible]}),(function(){return e.scheduleRender()})),i)}))}},{key:"_divideActions",value:function(){var e=this.viewModel.allActions.filter((function(e){return e.visible})),t=this._getInlineActionCount(),i=null===t,n=0===t;return{inlineActions:i?e.slice(0):n?new f.a:e.slice(0,t),menuActions:i?new f.a:n?e.slice(0):e.slice(t)}}},{key:"_featureMenuOpenChanged",value:function(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}},{key:"_actionsMenuOpenChanged",value:function(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}},{key:"_setTitleFromFeatureWidget",value:function(){var e,t,i=this.selectedFeatureWidget,n=this.messagesCommon;i&&(this.viewModel.title="error"===(null===(e=i.viewModel)||void 0===e?void 0:e.state)?n.errorMessage:(null===(t=i.viewModel)||void 0===t?void 0:t.title)||"")}},{key:"_setContentFromFeatureWidget",value:function(){var e=this.selectedFeatureWidget;e&&(this.viewModel.content=e)}},{key:"_unobserveFeatureMenuObserver",value:function(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}},{key:"_featureMenuIntersectionObserverCreated",value:function(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}},{key:"_handleFeatureMenuKeyup",value:function(e){"Escape"===Object(p.a)(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}},{key:"_handleActionMenuKeyup",value:function(e){"Escape"===Object(p.a)(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}},{key:"_setActiveFeature",value:function(e){var t=this.viewModel,i=Na(e.currentTarget);t.activeFeature=t.features[i]||null}},{key:"_removeActiveFeature",value:function(){this.viewModel.activeFeature=null}},{key:"_handleFeatureMenuItemKeyup",value:function(e){var t=Object(p.a)(e),i=this._featureMenuNode,n=Na(e.currentTarget);if(i){var a=i.querySelectorAll("li"),r=a.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),a[a.length-1].focus()):(e.stopPropagation(),a[0].focus()):(e.stopPropagation(),a[(n+1+r)%r].focus()):(e.stopPropagation(),a[(n-1+r)%r].focus())}}},{key:"_handleActionMenuItemKeyup",value:function(e){var t=Object(p.a)(e),i=this._actionsMenuNode,n=e.currentTarget.dataset.actionUid,a=this.dividedActions.menuActions.findIndex((function(e){return e.uid===n}));if(i){var r=i.querySelectorAll("li"),o=r.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),r[r.length-1].focus()):(e.stopPropagation(),r[0].focus()):(e.stopPropagation(),r[(a+1+o)%o].focus()):(e.stopPropagation(),r[(a-1+o)%o].focus())}}},{key:"_handleMainKeyup",value:function(e){var t=Object(p.a)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next())}},{key:"_spinnerEnabledChange",value:function(e){if(this._destroySpinner(),e){var t=this.get("viewModel.view");this._createSpinner(t)}}},{key:"_hideSpinner",value:function(){var e=this._spinner;e&&(e.location=null,e.hide())}},{key:"_displaySpinner",value:function(){var e=this._spinner;if(e){var t=this.viewModel,i=t.location;t.waitingForResult&&i?e.show({location:i}):e.hide()}}},{key:"_getIconStyles",value:function(e){return{"background-image":e?"url(".concat(e,")"):""}}},{key:"_shouldFocus",value:function(){var e=Object(a.a)(Object(n.a)().mark((function e(t){var i=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null===t||void 0===t?void 0:t.shouldFocus,!e.t0){e.next=5;break}return e.next=4,Object(g.g)((function(){var e;return!0===(null===(e=i.viewModel)||void 0===e?void 0:e.active)}));case 4:this.focus();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addSelectedFeatureIndexHandle",value:function(){var e=this,t=Object(g.e)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.selectedFeatureIndex}),(function(t,i){return e._selectedFeatureIndexUpdated(t,i)}));this._handles.add(t,Da)}},{key:"_selectedFeatureIndexUpdated",value:function(e,t){this.featureCount&&e!==t&&-1!==e&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}},{key:"_destroySelectedFeatureWidget",value:function(){var e=this._feature;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}},{key:"_isScreenLocationWithinView",value:function(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}},{key:"_isOutsideView",value:function(e){var t=e.popupHeight,i=e.popupWidth,n=e.screenLocation,a=e.side,r=e.view;if(isNaN(i)||isNaN(t)||!r||!n)return!1;var o=r.padding;return"right"===a&&n.x+i/2>r.width-o.right||"left"===a&&n.x-i/2<o.left||"top"===a&&n.y-t<o.top||"bottom"===a&&n.y+t>r.height-o.bottom}},{key:"_calculateAutoAlignment",value:function(e){if("auto"!==e)return e;var t=this._pointerOffsetInPx,i=this._containerNode,n=this._mainContainerNode,a=this.viewModel,r=a.screenLocation,o=a.view;if(null==r||!o||!i)return"top-center";if(!this._isScreenLocationWithinView(r,o))return this._get("currentAlignment")||"top-center";function s(e){return parseInt(e.replaceAll(/[^-\d\.]/g,""),10)}var l=n?window.getComputedStyle(n,null):null,u=l?s(l.getPropertyValue("max-height")):0,c=l?s(l.getPropertyValue("height")):0,d=i.getBoundingClientRect(),h=d.height,f=d.width+t,b=Math.max(h,u,c)+t,p=this._isOutsideView({popupHeight:b,popupWidth:f,screenLocation:r,side:"right",view:o}),v=this._isOutsideView({popupHeight:b,popupWidth:f,screenLocation:r,side:"left",view:o}),y=this._isOutsideView({popupHeight:b,popupWidth:f,screenLocation:r,side:"top",view:o}),g=this._isOutsideView({popupHeight:b,popupWidth:f,screenLocation:r,side:"bottom",view:o});return v?y?"bottom-right":"top-right":p?y?"bottom-left":"top-left":y?g?"top-center":"bottom-center":"top-center"}},{key:"_callCurrentAlignment",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getCurrentAlignment",value:function(){var e=this.alignment;return this.dockEnabled||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}},{key:"_setCurrentAlignment",value:function(){this._set("currentAlignment",this._getCurrentAlignment())}},{key:"_setCurrentDockPosition",value:function(){this._set("currentDockPosition",this._getCurrentDockPosition())}},{key:"_calculatePositionResult",value:function(e){var t=["left","right"];return Object(Ne.e)(this.container)&&t.reverse(),null===e||void 0===e?void 0:e.replace(/leading/gi,t[0]).replaceAll(/trailing/gi,t[1])}},{key:"_callDockPosition",value:function(e){return"function"==typeof e?e.call(this):e}},{key:"_getDockPosition",value:function(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null===(e=this.dockOptions)||void 0===e?void 0:e.position)))}},{key:"_getCurrentDockPosition",value:function(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}},{key:"_wouldDockTo",value:function(){return this.dockEnabled?null:this._getDockPosition()}},{key:"_calculateAutoDockPosition",value:function(e){var t;if("auto"!==e)return e;var i=null===(t=this.viewModel)||void 0===t?void 0:t.view,n=Object(Ne.e)(this.container)?"top-left":"top-right";if(!i)return n;var a=i.padding||{left:0,right:0,top:0,bottom:0},r=i.width-a.left-a.right,o=i.breakpoints;return o&&r<=o.xsmall?"bottom-center":n}},{key:"_positionContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._containerNode;if(e&&(this._containerNode=e),this._containerNode){var t=this.viewModel.screenLocation,i=this._containerNode.getBoundingClientRect().width,n=this._calculatePositionStyle(t,i);n&&Object.assign(this._containerNode.style,n)}}},{key:"_calculateFullWidth",value:function(e){var t=this.currentAlignment,i=this._pointerOffsetInPx;return"top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}},{key:"_calculateAlignmentPosition",value:function(e,t,i,n){var a=this.currentAlignment,r=this._pointerOffsetInPx;if(i){var o=i.padding,s=n/2,l=i.height-t,u=i.width-e;return"bottom-center"===a?{top:t+r-o.top,left:e-s-o.left}:"top-left"===a?{bottom:l+r-o.bottom,right:u+r-o.right}:"bottom-left"===a?{top:t+r-o.top,right:u+r-o.right}:"top-right"===a?{bottom:l+r-o.bottom,left:e+r-o.left}:"bottom-right"===a?{top:t+r-o.top,left:e+r-o.left}:"top-center"===a?{bottom:l+r-o.bottom,left:e-s-o.left}:void 0}}},{key:"_calculatePositionStyle",value:function(e,t){var i=this.dockEnabled,n=this.view;if(n){if(i)return{left:"",top:"",right:"",bottom:""};if(null!=e&&t){var a=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,n,a);return r?{top:void 0!==r.top?"".concat(r.top,"px"):"auto",left:void 0!==r.left?"".concat(r.left,"px"):"auto",bottom:void 0!==r.bottom?"".concat(r.bottom,"px"):"auto",right:void 0!==r.right?"".concat(r.right,"px"):"auto"}:void 0}}}},{key:"_viewChange",value:function(e,t){e&&t&&(this.close(),this.clear())}},{key:"_viewReadyChange",value:function(e,t){if(e){var i=this.get("viewModel.view");this._wireUpView(i)}else t&&(this.close(),this.clear())}},{key:"_wireUpView",value:function(e){(this._destroySpinner(),e)&&(this.spinnerEnabled&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions))}},{key:"_dockingThresholdCrossed",value:function(e,t,i){var n=Object(s.a)(e,2),a=n[0],r=n[1],o=Object(s.a)(t,2),l=o[0],u=o[1],c=null!==i&&void 0!==i?i:{},d=c.width,h=void 0===d?0:d,f=c.height,b=void 0===f?0:f;return a<=h&&l>h||a>h&&l<=h||r<=b&&u>b||r>b&&u<=b}},{key:"_updateDockEnabledForViewSize",value:function(e,t){if(e&&t){var i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=i.left+i.right,a=i.top+i.bottom,r=[],o=[];r[0]=e[0]-n,r[1]=e[1]-a,o[0]=t[0]-n,o[1]=t[1]-a;var s=this.dockOptions,l=s.breakpoint;this._dockingThresholdCrossed(r,o,l)&&this._setDockEnabledForViewSize(s),this._setCurrentDockPosition()}}},{key:"_focusDockButtonNode",value:function(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}},{key:"_closeButtonNodeUpdated",value:function(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}},{key:"_mainContainerNodeUpdated",value:function(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}},{key:"_featureMenuNodeUpdated",value:function(e){if(this._featureMenuNode=e,e&&this._focusFirstFeature){this._focusFirstFeature=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_actionsMenuNodeUpdated",value:function(e){if(this._actionsMenuNode=e,e&&this._focusFirstAction){this._focusFirstAction=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}},{key:"_focusFeatureMenuButtonNode",value:function(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}},{key:"_focusActionsMenuButtonNode",value:function(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}},{key:"_featureMenuViewportScrollTop",value:function(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}},{key:"_toggleScreenLocationEnabled",value:function(){var e=this.dockEnabled,t=this.viewModel;if(t){var i=t.active&&!e;t.screenLocationEnabled=i}}},{key:"_shouldDockAtCurrentViewSize",value:function(e){var t,i,n,a=e.breakpoint,r=null===(t=this.viewModel)||void 0===t||null===(t=t.view)||void 0===t?void 0:t.ui;if(!r)return!1;var o=r.width,s=r.height;if(isNaN(o)||isNaN(s))return!1;if(!a)return!1;var l=a.hasOwnProperty("width")&&o<=(null!==(i=a.width)&&void 0!==i?i:0),u=a.hasOwnProperty("height")&&s<=(null!==(n=a.height)&&void 0!==n?n:0);return l||u}},{key:"_setDockEnabledForViewSize",value:function(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}},{key:"_getPageText",value:function(e,t){return this.featureNavigationVisible?Object(Oi.a)(this.messages.pageText,{index:t+1,total:e}):null}},{key:"_destroySpinner",value:function(){var e;this._spinner&&(null!==(e=this.view)&&void 0!==e&&null!==(e=e.ui)&&void 0!==e&&e.remove(this._spinner,Fa),this._spinner.destroy(),this._spinner=null)}},{key:"_createSpinner",value:function(e){e&&(this._spinner=new zn({view:e}),e.ui.add(this._spinner,{key:Fa,position:"manual",internal:!0}))}},{key:"_toggleCollapsed",value:function(){this.collapsed=!this.collapsed}},{key:"_close",value:function(){this.close(),this.view&&this.view.focus()}},{key:"_toggleDockEnabled",value:function(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}},{key:"_toggleFeatureMenu",value:function(){var e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}},{key:"_toggleActionsMenu",value:function(){var e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}},{key:"_triggerAction",value:function(e){var t=e.currentTarget.dataset.actionUid,i=this.viewModel.allActions,n=i.findIndex((function(e){return e.uid===t})),a=i.at(n);a&&"toggle"===a.type&&(a.value=!a.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}},{key:"_selectFeature",value:function(e){var t=Na(e.currentTarget);null==t||isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}},{key:"_next",value:function(){this.next()}},{key:"_previous",value:function(){this.previous()}}]),h}(xn(k.a));function Na(e){return null===e||void 0===e?void 0:e["data-feature-index"]}Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"actionsMenuId",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"actionsMenuButtonId",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"featureMenuId",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"titleId",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"contentId",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"hasContent",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"featureNavigationVisible",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"collapsible",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"featureMenuVisible",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"contentCollapsed",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"dividedActions",null),Object(h.a)([Object(_.b)({readOnly:!0,dependsOn:["_flowItems.length"]})],Ra.prototype,"_activeFlowItemWidget",null),Object(h.a)([Object(_.b)()],Ra.prototype,"actions",null),Object(h.a)([Object(_.b)()],Ra.prototype,"actionsMenuOpen",null),Object(h.a)([Object(_.b)()],Ra.prototype,"alignment",void 0),Object(h.a)([Object(_.b)()],Ra.prototype,"autoCloseEnabled",null),Object(h.a)([Object(_.b)()],Ra.prototype,"autoOpenEnabled",null),Object(h.a)([Object(_.b)()],Ra.prototype,"defaultPopupTemplateEnabled",null),Object(h.a)([Object(_.b)()],Ra.prototype,"content",null),Object(h.a)([Object(_.b)()],Ra.prototype,"collapsed",void 0),Object(h.a)([Object(_.b)()],Ra.prototype,"collapseEnabled",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"currentAlignment",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"currentDockPosition",null),Object(h.a)([Object(_.b)()],Ra.prototype,"dockOptions",null),Object(h.a)([Object(_.b)()],Ra.prototype,"dockEnabled",void 0),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"featureCount",null),Object(h.a)([Object(_.b)()],Ra.prototype,"featureMenuOpen",null),Object(h.a)([Object(_.b)()],Ra.prototype,"features",null),Object(h.a)([Object(_.b)()],Ra.prototype,"goToOverride",null),Object(h.a)([Object(_.b)()],Ra.prototype,"headingLevel",void 0),Object(h.a)([Object(_.b)()],Ra.prototype,"highlightEnabled",null),Object(h.a)([Object(_.b)()],Ra.prototype,"location",null),Object(h.a)([Object(_.b)()],Ra.prototype,"label",null),Object(h.a)([Object(_.b)()],Ra.prototype,"maxInlineActions",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/widgets/Popup/t9n/Popup")],Ra.prototype,"messages",void 0),Object(h.a)([Object(_.b)(),Object(ze.a)("esri/t9n/common")],Ra.prototype,"messagesCommon",void 0),Object(h.a)([Object(_.b)()],Ra.prototype,"promises",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"selectedFeature",null),Object(h.a)([Object(_.b)()],Ra.prototype,"selectedFeatureIndex",null),Object(h.a)([Object(_.b)({readOnly:!0})],Ra.prototype,"selectedFeatureWidget",null),Object(h.a)([Object(_.b)()],Ra.prototype,"spinnerEnabled",void 0),Object(h.a)([Object(_.b)()],Ra.prototype,"title",null),Object(h.a)([Object(_.b)()],Ra.prototype,"updateLocationEnabled",null),Object(h.a)([Object(_.b)()],Ra.prototype,"view",null),Object(h.a)([Object(_.b)({type:Aa}),Object(Ia.a)(["triggerAction","trigger-action"])],Ra.prototype,"viewModel",void 0),Object(h.a)([Object(_.b)()],Ra.prototype,"visible",null),Object(h.a)([Object(_.b)()],Ra.prototype,"visibleElements",void 0),Object(h.a)([Object(O.a)("visibleElements")],Ra.prototype,"castVisibleElements",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_close",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_toggleDockEnabled",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_toggleFeatureMenu",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_toggleActionsMenu",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_triggerAction",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_selectFeature",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_next",null),Object(h.a)([Object(Ta.a)()],Ra.prototype,"_previous",null);var za=Ra=Object(h.a)([Object(w.a)("esri.widgets.Popup")],Ra)},238:function(e,t,i){"use strict";function n(e){return e=e||globalThis.location.hostname,u.some((function(t){var i;return null!=(null===(i=e)||void 0===i?void 0:i.match(t))}))}function a(e,t){return e&&(t=t||globalThis.location.hostname)?null!=t.match(r)||null!=t.match(s)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(o)||null!=t.match(l)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}));var r=/^devext.arcgis.com$/,o=/^qaext.arcgis.com$/,s=/^[\w-]*\.mapsdevext.arcgis.com$/,l=/^[\w-]*\.mapsqa.arcgis.com$/,u=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,r,o,/^jsapps.esri.com$/,s,l]},303:function(e,t,i){"use strict";i.r(t),i.d(t,"fetchSymbolFromStyle",(function(){return v})),i.d(t,"getStyleItemFromStyle",(function(){return p})),i.d(t,"resolveWebStyleSymbol",(function(){return b}));var n=i(177),a=i(238),r=i(101),o=i(111),s=i(128),l=i(197),u=i(215),c=i(413),d=i(429),h=i(293),f=i(405);function b(e,t,i,n){var a=e.name;return null==a?Promise.reject(new r.a("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,i){var n=h.a.replaceAll(/\{SymbolName\}/gi,e),a=null!=t.portal?t.portal:l.a.getDefault();return Object(h.d)(n,i).then((function(e){var t=Object(h.c)(e.data);return Object(c.a)(t,{portal:a,url:Object(s.Q)(Object(s.L)(n)),origin:"portal-item"})}))}(a,t,n):Object(h.b)(e,t,n).then((function(e){return v(Object(o.m)(e),a,t,i,h.e,n)}))}function p(e,t){return t.items.find((function(t){return t.name===e}))}function v(e,t,i,o,b,v){var y,g,m,_=i&&null!=i.portal?i.portal:l.a.getDefault(),O={portal:_,url:Object(s.Q)(e.baseUrl),origin:"portal-item"},j=p(t,e.data);if(!j){var w="The symbol name '".concat(t,"' could not be found");return Promise.reject(new r.a("symbolstyleutils:symbol-name-not-found",w,{symbolName:t}))}var k=Object(u.d)(b(j,o),O),x=null!==(y=null===(g=j.thumbnail)||void 0===g?void 0:g.href)&&void 0!==y?y:null,M=j.thumbnail&&j.thumbnail.imageData;Object(a.b)()&&(k=null!==(m=Object(a.a)(k))&&void 0!==m?m:"",x=Object(a.a)(x));var P={portal:_,url:Object(s.Q)(Object(s.L)(k)),origin:"portal-item"};return Object(h.d)(k,v).then((function(a){var r="cimRef"===o?Object(h.c)(a.data):a.data,s=Object(c.a)(r,P);if(s&&Object(n.c)(s)){if(x){var l=Object(u.d)(x,O);s.thumbnail=new f.a({url:l})}else M&&(s.thumbnail=new f.a({url:"data:image/png;base64,".concat(M)}));e.styleUrl?s.styleOrigin=new d.a({portal:i.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(s.styleOrigin=new d.a({portal:i.portal,styleName:e.styleName,name:t}))}return s}))}},529:function(e,t,i){"use strict";i.d(t,"a",(function(){return Nt})),i.d(t,"b",(function(){return H})),i.d(t,"c",(function(){return x})),i.d(t,"d",(function(){return Ue})),i.d(t,"e",(function(){return z})),i.d(t,"f",(function(){return jt})),i.d(t,"g",(function(){return be})),i.d(t,"h",(function(){return W})),i.d(t,"i",(function(){return he})),i.d(t,"j",(function(){return ve})),i.d(t,"k",(function(){return I})),i.d(t,"l",(function(){return F})),i.d(t,"m",(function(){return D})),i.d(t,"n",(function(){return V})),i.d(t,"o",(function(){return Tt})),i.d(t,"p",(function(){return A})),i.d(t,"q",(function(){return w})),i.d(t,"r",(function(){return Z})),i.d(t,"s",(function(){return $})),i.d(t,"t",(function(){return at})),i.d(t,"u",(function(){return Ht})),i.d(t,"v",(function(){return pe})),i.d(t,"w",(function(){return N})),i.d(t,"x",(function(){return ge})),i.d(t,"y",(function(){return rt})),i.d(t,"z",(function(){return Qe})),i.d(t,"A",(function(){return we})),i.d(t,"B",(function(){return U})),i.d(t,"C",(function(){return j})),i.d(t,"D",(function(){return Rt})),i.d(t,"E",(function(){return zt})),i.d(t,"F",(function(){return ft})),i.d(t,"G",(function(){return qt})),i.d(t,"H",(function(){return Q})),i.d(t,"I",(function(){return St})),i.d(t,"J",(function(){return We})),i.d(t,"K",(function(){return Et})),i.d(t,"L",(function(){return ce})),i.d(t,"M",(function(){return de})),i.d(t,"N",(function(){return Ot})),i.d(t,"O",(function(){return B})),i.d(t,"P",(function(){return Xe})),i.d(t,"Q",(function(){return G})),i.d(t,"R",(function(){return Je})),i.d(t,"S",(function(){return yt})),i.d(t,"T",(function(){return fe})),i.d(t,"U",(function(){return Se})),i.d(t,"V",(function(){return b})),i.d(t,"W",(function(){return Oe})),i.d(t,"X",(function(){return et})),i.d(t,"Y",(function(){return He})),i.d(t,"Z",(function(){return ee})),i.d(t,"ab",(function(){return pt})),i.d(t,"bb",(function(){return re})),i.d(t,"cb",(function(){return T})),i.d(t,"db",(function(){return xe})),i.d(t,"eb",(function(){return Vt})),i.d(t,"fb",(function(){return Gt})),i.d(t,"gb",(function(){return me})),i.d(t,"hb",(function(){return bt})),i.d(t,"ib",(function(){return tt})),i.d(t,"jb",(function(){return ze})),i.d(t,"kb",(function(){return Xt})),i.d(t,"lb",(function(){return Kt})),i.d(t,"mb",(function(){return ct})),i.d(t,"nb",(function(){return J})),i.d(t,"ob",(function(){return ut})),i.d(t,"pb",(function(){return ye})),i.d(t,"qb",(function(){return _e})),i.d(t,"rb",(function(){return $e})),i.d(t,"sb",(function(){return it})),i.d(t,"tb",(function(){return nt})),i.d(t,"ub",(function(){return Ft})),i.d(t,"vb",(function(){return st})),i.d(t,"wb",(function(){return X})),i.d(t,"xb",(function(){return Mt})),i.d(t,"yb",(function(){return q})),i.d(t,"zb",(function(){return te})),i.d(t,"Ab",(function(){return ke})),i.d(t,"Bb",(function(){return k})),i.d(t,"Cb",(function(){return P})),i.d(t,"Db",(function(){return ie})),i.d(t,"Eb",(function(){return O})),i.d(t,"Fb",(function(){return Ee})),i.d(t,"Gb",(function(){return _})),i.d(t,"Hb",(function(){return Fe})),i.d(t,"Ib",(function(){return R})),i.d(t,"Jb",(function(){return De})),i.d(t,"Kb",(function(){return Pe})),i.d(t,"Lb",(function(){return y})),i.d(t,"Mb",(function(){return se})),i.d(t,"Nb",(function(){return je})),i.d(t,"Ob",(function(){return Te})),i.d(t,"Pb",(function(){return Ce})),i.d(t,"Qb",(function(){return Ae})),i.d(t,"Rb",(function(){return Ie})),i.d(t,"Sb",(function(){return p})),i.d(t,"Tb",(function(){return Me})),i.d(t,"Ub",(function(){return ne})),i.d(t,"Vb",(function(){return M})),i.d(t,"Wb",(function(){return le})),i.d(t,"Xb",(function(){return oe}));var n=i(367),a=i(112),r=i(107),o=i(106),s=i(4),l=i(120),u=i(90),c=i(91),d=i(89),h=i(88),f=i(94);function b(e){return Number(e)!==e}function p(e){if(null!=e&&!O(e)){var t=Number(e);return b(t)&&_(e)&&""!=e?p(e.replace(/[^0-9.\-]+/g,"")):t}return e}function v(e){if(m(e))return new Date(e);if(O(e))return new Date(e);var t=Number(e);return O(t)?new Date(t):new Date(e)}function y(e){if(b(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(0===e&&1/e==-1/0)return"-0";var t=e<0;e=Math.abs(e);var i,n=/^([0-9]+)(?:\.([0-9]+))?(?:e[\+\-]([0-9]+))?$/.exec(""+e),a=n[1],r=n[2]||"";if(void 0===n[3])i=""===r?a:a+"."+r;else{var o=+n[3];if(e<1)i="0."+g("0",o-1)+a+r;else{var s=o-r.length;i=0===s?a+r:s<0?a+r.slice(0,s)+"."+r.slice(s):a+r+g("0",s)}}return t?"-"+i:i}function g(e,t){return new Array(t+1).join(e)}function m(e){return"[object Date]"===function(e){return{}.toString.call(e)}(e)}function _(e){return"string"==typeof e}function O(e){return"number"==typeof e&&Number(e)==e}function j(e){return"object"==typeof e&&null!==e}var w="__\xa7\xa7\xa7__",k="__\xa7\xa7\xa7\xa7__";function x(e,t){for(var i=e.length,n=0;n<i;++n)if(e[n]===t)return n;return-1}function M(e,t){for(var i=e.length,n=new Array(i),a=0;a<i;++a)n[a]=t(e[a],a);return n}function P(e,t){for(var i=e.length,n=0;n<i;++n)t(e[n],n)}function C(e,t){for(var i=e.length;i>0;)t(e[--i],i)}function A(e,t){for(var i=e.length,n=0;n<i&&t(e[n],n);++n);}function T(e,t){for(var i=!1,n=0;;){if(-1===(n=e.indexOf(t,n)))return i;i=!0,e.splice(n,1)}}function I(e,t){var i=e.indexOf(t);return-1!==i&&(e.splice(i,1),!0)}function D(e,t){-1===e.indexOf(t)&&e.push(t)}function F(e){for(var t=e.length,i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function E(e,t,i){e.splice(t,0,i)}function S(e,t){e.splice(t,1)}function L(e,t){for(var i=e.length,n=0;n<i;++n)if(t(e[n],n))return n;return-1}function B(e,t){var i=L(e,t);if(-1!==i)return e[i]}function R(e,t){for(var i=e.length;i>0;)t(e[--i])||e.splice(i,1)}var N=function(){function e(){Object(d.a)(this,e),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1}return Object(h.a)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._dispose())}}]),e}(),z=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dispose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1,this._dispose=t}return Object(h.a)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._dispose())}}]),e}(),H=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),e}return Object(h.a)(i,[{key:"_dispose",value:function(){P(this._disposers,(function(e){e.dispose()}))}}]),i}(N),V=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(e){var n;return Object(d.a)(this,i),n=t.call(this),Object.defineProperty(Object(l.a)(n),"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n._disposers=e,n}return Object(h.a)(i,[{key:"_dispose",value:function(){P(this._disposers,(function(e){e.dispose()}))}}]),i}(N),W=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_counter",{enumerable:!0,configurable:!0,writable:!0,value:0}),e}return Object(h.a)(i,[{key:"increment",value:function(){var e=this;return++this._counter,new z((function(){--e._counter,0===e._counter&&e.dispose()}))}}]),i}(z),U=function(){function e(){Object(d.a)(this,e),Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_killed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iterating",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}return Object(h.a)(e,[{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){if(!this._disposed){this._disposed=!0;var e=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{P(e,(function(e){e.disposer.dispose()}))}finally{this._killed=null,this._iterating=null}}}},{key:"hasListeners",value:function(){return 0!==this._listeners.length}},{key:"hasListenersByType",value:function(e){return function(e,t){for(var i=e.length,n=0;n<i;++n)if(t(e[n]))return!0;return!1}(this._listeners,(function(t){return(null===t.type||t.type===e)&&!t.killed}))}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1}},{key:"enableType",value:function(e){delete this._disabled[e]}},{key:"disableType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;this._disabled[e]=t}},{key:"_removeListener",value:function(e){if(0===this._iterating){var t=this._listeners.indexOf(e);if(-1===t)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)}},{key:"_removeExistingListener",value:function(e,t,i,n){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((function(a){a.once!==e||a.type!==t||void 0!==i&&a.callback!==i||a.context!==n||a.disposer.dispose()}))}},{key:"isEnabled",value:function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&void 0===this._disabled[e]}},{key:"removeType",value:function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((function(t){t.type===e&&t.disposer.dispose()}))}},{key:"has",value:function(e,t,i){return-1!==L(this._listeners,(function(n){return!0!==n.once&&n.type===e&&(void 0===t||n.callback===t)&&n.context===i}))}},{key:"_shouldDispatch",value:function(e){if(this._disposed)throw new Error("EventDispatcher is disposed");var t=this._disabled[e];return O(t)?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled}},{key:"_eachListener",value:function(e){var t=this;++this._iterating;try{P(this._listeners,e)}finally{--this._iterating,0===this._iterating&&0!==this._killed.length&&(P(this._killed,(function(e){t._removeListener(e)})),this._killed.length=0)}}},{key:"dispatch",value:function(e,t){this._shouldDispatch(e)&&this._eachListener((function(i){i.killed||null!==i.type&&i.type!==e||i.dispatch(e,t)}))}},{key:"_on",value:function(e,t,i,n,a,r){var o=this;if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,n);var s={type:t,callback:i,context:n,shouldClone:a,dispatch:r,killed:!1,once:e,disposer:new z((function(){s.killed=!0,o._removeListener(s)}))};return this._listeners.push(s),s}},{key:"onAll",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this._on(!1,null,e,t,i,(function(i,n){return e.call(t,n)})).disposer}},{key:"on",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this._on(!1,e,t,i,n,(function(e,n){return t.call(i,n)})).disposer}},{key:"once",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._on(!0,e,t,i,n,(function(e,n){a.disposer.dispose(),t.call(i,n)}));return a.disposer}},{key:"off",value:function(e,t,i){this._removeExistingListener(!1,e,t,i)}},{key:"copyFrom",value:function(e){var t=this;if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");var i=[];return P(e._listeners,(function(e){!e.killed&&e.shouldClone&&(null===e.type?i.push(t.onAll(e.callback,e.context)):e.once?i.push(t.once(e.type,e.callback,e.context)):i.push(t.on(e.type,e.callback,e.context)))})),new V(i)}}]),e}();function Y(e,t){if(!(e>=0&&e<t))throw new Error("Index out of bounds: "+e)}var q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(d.a)(this,t),Object.defineProperty(this,"_values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new U}),this._values=e}return Object(h.a)(t,[{key:"values",get:function(){return this._values}},{key:"contains",value:function(e){return-1!==this._values.indexOf(e)}},{key:"removeValue",value:function(e){for(var t=0,i=this._values.length;t<i;)this._values[t]===e?(this.removeIndex(t),--i):++t}},{key:"indexOf",value:function(e){return x(this._values,e)}},{key:"length",get:function(){return this._values.length}},{key:"hasIndex",value:function(e){return e>=0&&e<this._values.length}},{key:"getIndex",value:function(e){return this._values[e]}},{key:"_onPush",value:function(e){this.events.isEnabled("push")&&this.events.dispatch("push",{type:"push",target:this,newValue:e})}},{key:"_onInsertIndex",value:function(e,t){this.events.isEnabled("insertIndex")&&this.events.dispatch("insertIndex",{type:"insertIndex",target:this,index:e,newValue:t})}},{key:"_onSetIndex",value:function(e,t,i){this.events.isEnabled("setIndex")&&this.events.dispatch("setIndex",{type:"setIndex",target:this,index:e,oldValue:t,newValue:i})}},{key:"_onRemoveIndex",value:function(e,t){this.events.isEnabled("removeIndex")&&this.events.dispatch("removeIndex",{type:"removeIndex",target:this,index:e,oldValue:t})}},{key:"_onMoveIndex",value:function(e,t,i){this.events.isEnabled("moveIndex")&&this.events.dispatch("moveIndex",{type:"moveIndex",target:this,oldIndex:e,newIndex:t,value:i})}},{key:"_onClear",value:function(e){this.events.isEnabled("clear")&&this.events.dispatch("clear",{type:"clear",target:this,oldValues:e})}},{key:"setIndex",value:function(e,t){Y(e,this._values.length);var i=this._values[e];return i!==t&&(this._values[e]=t,this._onSetIndex(e,i,t)),i}},{key:"insertIndex",value:function(e,t){return Y(e,this._values.length+1),E(this._values,e,t),this._onInsertIndex(e,t),t}},{key:"swap",value:function(e,t){var i=this._values.length;if(Y(e,i),Y(t,i),e!==t){var n=this._values[e],a=this._values[t];this._values[e]=a,this._onSetIndex(e,n,a),this._values[t]=n,this._onSetIndex(t,a,n)}}},{key:"removeIndex",value:function(e){Y(e,this._values.length);var t=this._values[e];return S(this._values,e),this._onRemoveIndex(e,t),t}},{key:"moveValue",value:function(e,t){var i=this.indexOf(e);if(-1!==i)if(S(this._values,i),null==t){var n=this._values.length;this._values.push(e),this._onMoveIndex(i,n,e)}else E(this._values,t,e),this._onMoveIndex(i,t,e);else null==t?(this._values.push(e),this._onPush(e)):(E(this._values,t,e),this._onInsertIndex(t,e));return e}},{key:"push",value:function(e){return this._values.push(e),this._onPush(e),e}},{key:"unshift",value:function(e){return this.insertIndex(0,e),e}},{key:"pushAll",value:function(e){var t=this;P(e,(function(e){t.push(e)}))}},{key:"copyFrom",value:function(e){this.pushAll(e._values)}},{key:"pop",value:function(){return this._values.length-1<0?void 0:this.removeIndex(this._values.length-1)}},{key:"shift",value:function(){return this._values.length?this.removeIndex(0):void 0}},{key:"setAll",value:function(e){var t=this,i=this._values;this._values=[],this._onClear(i),P(e,(function(e){t._values.push(e),t._onPush(e)}))}},{key:"clear",value:function(){this.setAll([])}},{key:e,value:Object(s.a)().mark((function e(){var t,i;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._values.length,i=0;case 2:if(!(i<t)){e.next=8;break}return e.next=5,this._values[i];case 5:++i,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"each",value:function(e){P(this._values,e)}},{key:"eachReverse",value:function(e){C(this._values,e)}}]),t}(Symbol.iterator),G=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"autoDispose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(l.a)(e),"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return Object(h.a)(i,[{key:"_onSetIndex",value:function(e,t,n){this.autoDispose&&t.dispose(),Object(r.a)(Object(o.a)(i.prototype),"_onSetIndex",this).call(this,e,t,n)}},{key:"_onRemoveIndex",value:function(e,t){this.autoDispose&&t.dispose(),Object(r.a)(Object(o.a)(i.prototype),"_onRemoveIndex",this).call(this,e,t)}},{key:"_onClear",value:function(e){this.autoDispose&&P(e,(function(e){e.dispose()})),Object(r.a)(Object(o.a)(i.prototype),"_onClear",this).call(this,e)}},{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this.autoDispose&&P(this._values,(function(e){e.dispose()})))}}]),i}(q),X=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(e,n){var a;return Object(d.a)(this,i),a=t.call(this),Object.defineProperty(Object(l.a)(a),"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(a),"make",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.template=e,a.make=n,a}return Object(h.a)(i)}(G),K=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(e){var n;return Object(d.a)(this,i),n=t.call(this),Object.defineProperty(Object(l.a)(n),"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(n),"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(n),"_events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n._container=e,n._events=n.events.onAll((function(e){if("clear"===e.type)P(e.oldValues,(function(e){n._onRemoved(e)}));else if("push"===e.type)n._onInserted(e.newValue);else if("setIndex"===e.type)n._onRemoved(e.oldValue),n._onInserted(e.newValue,e.index);else if("insertIndex"===e.type)n._onInserted(e.newValue,e.index);else if("removeIndex"===e.type)n._onRemoved(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IListEvent type");n._onRemoved(e.value),n._onInserted(e.value,e.newIndex)}})),n}return Object(h.a)(i,[{key:"_onInserted",value:function(e,t){e._setParent(this._container,!0);var i=this._container._childrenDisplay;void 0===t?i.addChild(e._display):i.addChildAt(e._display,t)}},{key:"_onRemoved",value:function(e){this._container._childrenDisplay.removeChild(e._display),this._container.markDirtyBounds(),this._container.markDirty()}},{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._events.dispose(),P(this.values,(function(e){e.dispose()})))}}]),i}(q),Z=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=t}return Object(h.a)(e,[{key:"value",get:function(){return this._value/100}},{key:"percent",get:function(){return this._value}},{key:"toString",value:function(){return this._value+"%"}},{key:"interpolate",value:function(e,t){return e+this.value*(t-e)}}],[{key:"normalize",value:function(t,i,n){return t instanceof e?t:new e(i===n?0:100*Math.min(Math.max(1/(n-i)*(t-i),0),1))}}]),e}();function $(e){return new Z(e)}$(0);var Q=$(100),J=$(50);function ee(e){return Object.keys(e)}function te(e){return Object.assign({},e)}function ie(e,t){ee(e).forEach((function(i){t(i,e[i])}))}function ne(e,t){for(var i in e)if(ae(e,i)&&!t(i,e[i]))break}function ae(e,t){return{}.hasOwnProperty.call(e,t)}function re(e){e.parentNode&&e.parentNode.removeChild(e)}function oe(e,t,i,n){return e.addEventListener(t,i,n||!1),new z((function(){e.removeEventListener(t,i,n||!1)}))}function se(e){return oe(window,"resize",(function(t){e()}))}function le(e){switch(e){case"touchevents":return window.hasOwnProperty("TouchEvent");case"pointerevents":return window.hasOwnProperty("PointerEvent");case"mouseevents":return window.hasOwnProperty("MouseEvent");case"wheelevents":return window.hasOwnProperty("WheelEvent");case"keyboardevents":return window.hasOwnProperty("KeyboardEvent")}return!1}function ue(e){return e.pointerId||0}function ce(){if(document.activeElement&&document.activeElement!=document.body)if(document.activeElement.blur)document.activeElement.blur();else{var e=document.createElement("button");e.style.position="fixed",e.style.top="0px",e.style.left="-10000px",document.body.appendChild(e),e.focus(),e.blur(),document.body.removeChild(e)}}function de(e){e&&e.focus()}function he(e){if(le("pointerevents"))return e;if(le("touchevents"))switch(e){case"pointerover":case"pointerdown":return"touchstart";case"pointerout":case"pointerup":return"touchend";case"pointermove":return"touchmove";case"click":return"click";case"dblclick":return"dblclick"}else if(le("mouseevents"))switch(e){case"pointerover":return"mouseover";case"pointerout":return"mouseout";case"pointerdown":return"mousedown";case"pointermove":return"mousemove";case"pointerup":return"mouseup";case"click":return"click";case"dblclick":return"dblclick"}return e}function fe(e){if("undefined"!=typeof Touch&&e instanceof Touch)return!0;if("undefined"!=typeof PointerEvent&&e instanceof PointerEvent&&null!=e.pointerType)switch(e.pointerType){case"touch":case"pen":case 2:return!0;case"mouse":case 4:return!1;default:return!(e instanceof MouseEvent)}else if(null!=e.type&&e.type.match(/^mouse/))return!1;return!0}function be(e,t,i){e.style[t]=i}function pe(e,t){return e.style[t]}function ve(e){if(e.composedPath){var t=e.composedPath();return 0===t.length?null:t[0]}return e.target}function ye(e,t){return e.target&&function(e,t){for(var i=t;;){if(e===i)return!0;if(null===i.parentNode){if(null==i.host)return!1;i=i.host}else i=i.parentNode}}(t.root.dom,e.target)}function ge(e,t){e.style.pointerEvents=t?"auto":"none"}function me(){return/apple/i.test(navigator.vendor)&&"ontouchend"in document?1:void 0}function _e(e,t){return O(e)?e:null!=e&&O(e.value)&&O(t)?t*e.value:0}function Oe(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return"string"!=typeof e&&(e=e.toString()),t>e.length?Array(t-e.length+1).join(i)+e:e}function we(e){return function(e){return e.replace(/^[\s]*/,"")}(function(e){return e.replace(/[\s]*$/,"")}(e))}function ke(e){return e.replace(/\/(date|number|duration)$/i,"")}function xe(e){return e?e.replace(/<[^>]*>/g,""):e}function Me(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Pe(e){var t=new Date(e.getFullYear(),0,0),i=e.getTime()-t.getTime()+60*(t.getTimezoneOffset()-e.getTimezoneOffset())*1e3;return Math.floor(i/864e5)}function Ce(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);var n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)}function Ae(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;return t.setUTCDate(t.getUTCDate()+4-i),new Date(Date.UTC(t.getUTCFullYear(),0,1)).getFullYear()}function Te(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Ce(new Date(e.getFullYear(),e.getMonth(),1),t),n=Ce(e,t);return 1==n&&(n=53),n-i+1}function Ie(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Date(t,0,4,0,0,0,0);return n&&a.setUTCFullYear(t),7*e+i-((a.getDay()||7)+3)}function De(e,t){return e>12?e-=12:0===e&&(e=12),null!=t?e+(t-1):e}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(arguments.length>3&&void 0!==arguments[3]&&arguments[3])return t?"Coordinated Universal Time":"UTC";var n=e.toLocaleString("UTC"),a=e.toLocaleString("UTC",{timeZoneName:t?"long":"short"}).substr(n.length);return!1===i&&(a=a.replace(/ (standard|daylight|summer|winter) /i," ")),a}function Ee(e){var t=new Date(Date.UTC(2012,0,1,0,0,0,0)),i=new Date(t.toLocaleString("en-US",{timeZone:"UTC"}));return(new Date(t.toLocaleString("en-US",{timeZone:e})).getTime()-i.getTime())/6e4*-1}function Se(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Le(e){var t,i,n,a=e.h,r=e.s,o=e.l;if(0==r)t=i=n=o;else{var s=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},l=o<.5?o*(1+r):o+r-o*r,u=2*o-l;t=s(u,l,a+1/3),i=s(u,l,a),n=s(u,l,a-1/3)}return{r:Math.round(255*t),g:Math.round(255*i),b:Math.round(255*n)}}function Be(e){var t=e.r/255,i=e.g/255,n=e.b/255,a=Math.max(t,i,n),r=Math.min(t,i,n),o=0,s=0,l=(a+r)/2;if(a===r)o=s=0;else{var u=a-r;switch(s=l>.5?u/(2-a-r):u/(a+r),a){case t:o=(i-n)/u+(i<n?6:0);break;case i:o=(n-t)/u+2;break;case n:o=(t-i)/u+4}o/=6}return{h:o,s:s,l:l}}function Re(e,t){var i=t>0?255-e:e;return Math.round(i*t)}function Ne(e){return(299*e.r+587*e.g+114*e.b)/1e3>=128}function ze(e,t){return e||(e=[]),[].concat(Object(a.a)(e),Object(a.a)(t)).filter((function(e,t,i){return i.indexOf(e)===t}))}function He(e,t){return!!t&&e.left==t.left&&e.right==t.right&&e.top==t.top&&e.bottom==t.bottom}function Ve(e){return"#"===e[0]&&(e=e.substr(1)),3==e.length&&(e=e[0].repeat(2)+e[1].repeat(2)+e[2].repeat(2)),parseInt(e,16)}function We(e){return Ue.fromAny(e)}var Ue=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"_hex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hex=0|t}return Object(h.a)(e,[{key:"hex",get:function(){return this._hex}},{key:"r",get:function(){return this._hex>>>16}},{key:"g",get:function(){return this._hex>>8&255}},{key:"b",get:function(){return 255&this._hex}},{key:"toCSS",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"}},{key:"toCSSHex",value:function(){return"#"+je(this.r.toString(16),2)+je(this.g.toString(16),2)+je(this.b.toString(16),2)}},{key:"toHSL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Be({r:this.r,g:this.g,b:this.b,a:e})}},{key:"toString",value:function(){return this.toCSSHex()}}],[{key:"fromHSL",value:function(e,t,i){var n=Le({h:e,s:t,l:i});return this.fromRGB(n.r,n.g,n.b)}},{key:"fromHex",value:function(t){return new e(t)}},{key:"fromRGB",value:function(t,i,n){return new e((0|n)+(i<<8)+(t<<16))}},{key:"fromString",value:function(t){return new e(Ve(t))}},{key:"fromCSS",value:function(t){return new e(function(e){var t=(e=e.replace(/[ ]/g,"")).match(/^rgb\(([0-9]*),([0-9]*),([0-9]*)\)/i);if(t)t.push("1");else if(!(t=e.match(/^rgba\(([0-9]*),([0-9]*),([0-9]*),([.0-9]*)\)/i)))return 0;for(var i="",n=1;n<=3;n++){var a=parseInt(t[n]).toString(16);1==a.length&&(a="0"+a),i+=a}return Ve(i)}(t))}},{key:"fromAny",value:function(t){if(_(t)){if("#"==t[0])return e.fromString(t);if("rgb"==t.substr(0,3))return e.fromCSS(t)}else{if(O(t))return e.fromHex(t);if(t instanceof e)return e.fromHex(t.hex)}throw new Error("Unknown color syntax: "+t)}},{key:"alternative",value:function(e,t,i){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{r:255,g:255,b:255},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{r:255,g:255,b:255},n=t,a=i;return Ne(i)&&(n=i,a=t),Ne(e)?a:n}({r:e.r,g:e.g,b:e.b},t?{r:t.r,g:t.g,b:t.b}:void 0,i?{r:i.r,g:i.g,b:i.b}:void 0);return this.fromRGB(n.r,n.g,n.b)}},{key:"interpolate",value:function(t,i,n){if("hsl"==(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb")){var a=i.toHSL(),r=n.toHSL();return e.fromHSL(qe(t,a.h,r.h),qe(t,a.s,r.s),qe(t,a.l,r.l))}return e.fromRGB(qe(t,i.r,n.r),qe(t,i.g,n.g),qe(t,i.b,n.b))}},{key:"lighten",value:function(t,i){var n=function(e,t){return e?{r:Math.max(0,Math.min(255,e.r+Re(e.r,t))),g:Math.max(0,Math.min(255,e.g+Re(e.g,t))),b:Math.max(0,Math.min(255,e.b+Re(e.b,t))),a:e.a}:e}({r:t.r,g:t.g,b:t.b},i);return e.fromRGB(n.r,n.g,n.b)}},{key:"brighten",value:function(t,i){var n=function(e,t){if(e){var i=Re(Math.min(Math.max(e.r,e.g,e.b),230),t);return{r:Math.max(0,Math.min(255,Math.round(e.r+i))),g:Math.max(0,Math.min(255,Math.round(e.g+i))),b:Math.max(0,Math.min(255,Math.round(e.b+i))),a:e.a}}return e}({r:t.r,g:t.g,b:t.b},i);return e.fromRGB(n.r,n.g,n.b)}},{key:"saturate",value:function(t,i){var n=function(e,t){if(void 0===e||1==t)return e;var i=Be(e);return i.s=t,Le(i)}({r:t.r,g:t.g,b:t.b},i);return e.fromRGB(n.r,n.g,n.b)}}]),e}();function Ye(e){return Object(f.b)(this,void 0,void 0,Object(s.a)().mark((function t(){var i;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e){t.next=5;break}return i=[],ie(e,(function(e,t){i.push(t.waitForStop())})),t.next=5,Promise.all(i);case 5:case"end":return t.stop()}}),t)})))}function qe(e,t,i){return t+e*(i-t)}function Ge(e,t,i){return e>=1?i:t}function Xe(e,t,i){return new Z(qe(e,t.percent,i.percent))}function Ke(e,t,i){return Ue.interpolate(e,t,i)}var Ze=Math.PI,$e=Ze/180,Qe=180/Ze;function Je(e,t,i){if(!O(t)||t<=0){var n=Math.round(e);return i&&n-e==.5&&n--,n}var a=Math.pow(10,t);return Math.round(e*a)/a}function et(e,t){if(!O(t)||t<=0)return Math.ceil(e);var i=Math.pow(10,t);return Math.ceil(e*i)/i}function tt(e,t,i){return Math.min(Math.max(e,t),i)}function it(e){return Math.sin($e*e)}function nt(e){return Math.cos($e*e)}function at(e){return(e%=360)<0&&(e+=360),e}function rt(e,t,i,n,a){var r=Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=-Number.MAX_VALUE,u=[];u.push(ot(a,i)),u.push(ot(a,n));for(var c=Math.min(90*Math.floor(i/90),90*Math.floor(n/90)),d=Math.max(90*Math.ceil(i/90),90*Math.ceil(n/90)),h=c;h<=d;h+=90)h>=i&&h<=n&&u.push(ot(a,h));for(var f=0;f<u.length;f++){var b=u[f];b.x<r&&(r=b.x),b.y<o&&(o=b.y),b.x>s&&(s=b.x),b.y>l&&(l=b.y)}return{left:e+r,top:t+o,right:e+s,bottom:t+l}}function ot(e,t){return{x:e*nt(t),y:e*it(t)}}function st(e){var t=e.length;if(t>0){var i=e[0],n=i.left,a=i.top,r=i.right,o=i.bottom;if(t>1)for(var s=1;s<t;s++)i=e[s],n=Math.min(i.left,n),r=Math.max(i.right,r),a=Math.min(i.top,a),o=Math.max(i.bottom,o);return{left:n,right:r,top:a,bottom:o}}return{left:0,right:0,top:0,bottom:0}}function lt(e){return e}function ut(e){return e*e*e}function ct(e){return function(t){return 1-e(1-t)}}var dt=function(){function e(t,i){var n=this;Object(d.a)(this,e),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=t,this._settings=i,ie(i,(function(e){n._userSettings[e]=!0}))}return Object(h.a)(e,[{key:"get",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"setRaw",value:function(e,t){this._settings[e]=t}},{key:"set",value:function(e,t){this._userSettings[e]=!0,this.setRaw(e,t)}},{key:"remove",value:function(e){delete this._userSettings[e],delete this._settings[e]}},{key:"setAll",value:function(e){var t=this;ee(e).forEach((function(i){t.set(i,e[i])}))}},{key:"_eachSetting",value:function(e){ie(this._settings,e)}},{key:"apply",value:function(){var e=this,t={stateAnimationEasing:!0,stateAnimationDuration:!0},i=this._entity.states.lookup("default");this._eachSetting((function(n,a){t[n]||(t[n]=!0,e!==i&&(n in i._settings||(i._settings[n]=e._entity.get(n))),e._entity.set(n,a))}))}},{key:"applyAnimate",value:function(e){var t=this;null==e&&(e=this._settings.stateAnimationDuration),null==e&&(e=this.get("stateAnimationDuration",this._entity.get("stateAnimationDuration",0)));var i=this._settings.stateAnimationEasing;null==i&&(i=this.get("stateAnimationEasing",this._entity.get("stateAnimationEasing",ut)));var n=this._entity.states.lookup("default"),a={stateAnimationEasing:!0,stateAnimationDuration:!0},r={};return this._eachSetting((function(o,s){if(!a[o]){a[o]=!0,t!=n&&(o in n._settings||(n._settings[o]=t._entity.get(o)));var l=t._entity.animate({key:o,to:s,duration:e,easing:i});l&&(r[o]=l)}})),r}}]),e}(),ht=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._entity=t}return Object(h.a)(e,[{key:"lookup",value:function(e){return this._states[e]}},{key:"create",value:function(e,t){var i=this._states[e];if(i)return i.setAll(t),i;var n=new dt(this._entity,t);return this._states[e]=n,n}},{key:"remove",value:function(e){delete this._states[e]}},{key:"apply",value:function(e){var t=this._states[e];t&&t.apply(),this._entity._applyState(e)}},{key:"applyAnimate",value:function(e,t){var i,n=this._states[e];return n&&(i=n.applyAnimate(t)),this._entity._applyStateAnimated(e,t),i}}]),e}(),ft=new(Object(h.a)((function e(){Object(d.a)(this,e),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.3.12"}),Object.defineProperty(this,"licenses",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"entitiesById",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"rootElements",{enumerable:!0,configurable:!0,writable:!0,value:[]})})));function bt(e){ft.licenses.push(e)}function pt(e,t){return e===t?0:e<t?-1:1}function vt(e,t,i){for(var n=e.length,a=t.length,r=Math.min(n,a),o=0;o<r;++o){var s=i(e[o],t[o]);if(0!==s)return s}return pt(n,a)}function yt(e,t){return e===t?0:e<t?-1:1}var gt=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=t}return Object(h.a)(e,[{key:"add",value:function(e,t){var i=this,n=this._callbacks[e];return void 0===n&&(n=this._callbacks[e]=[]),n.push(t),this._entity._markDirtyKey(e),new z((function(){I(n,t)&&i._entity._markDirtyKey(e)}))}},{key:"remove",value:function(e){var t=this._callbacks[e];void 0!==t&&(delete this._callbacks[e],0!==t.length&&this._entity._markDirtyKey(e))}},{key:"enable",value:function(e){this._disabled[e]&&(delete this._disabled[e],this._entity._markDirtyKey(e))}},{key:"disable",value:function(e){this._disabled[e]||(this._disabled[e]=!0,this._entity._markDirtyKey(e))}},{key:"fold",value:function(e,t){if(!this._disabled[e]){var i=this._callbacks[e];if(void 0!==i)for(var n=0,a=i.length;n<a;++n)t=i[n](t,this._entity,e)}return t}}]),e}(),mt=function(){function e(t,i,n,a,r,o,s){Object(d.a)(this,e),Object.defineProperty(this,"_animation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_from",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_to",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_duration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_loops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interpolate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_oldTime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_time",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_stopped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_playing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new U}),this._animation=t,this._from=i,this._to=n,this._duration=a,this._easing=r,this._loops=o,this._interpolate=function(e,t){return"number"==typeof e&&"number"==typeof t?qe:e instanceof Z&&t instanceof Z?Xe:e instanceof Ue&&t instanceof Ue?Ke:Ge}(i,n),this._oldTime=s}return Object(h.a)(e,[{key:"to",get:function(){return this._to}},{key:"from",get:function(){return this._from}},{key:"playing",get:function(){return this._playing}},{key:"stopped",get:function(){return this._stopped}},{key:"stop",value:function(){this._stopped||(this._stopped=!0,this._playing=!1,this.events.isEnabled("stopped")&&this.events.dispatch("stopped",{type:"stopped",target:this}))}},{key:"pause",value:function(){this._playing=!1,this._oldTime=null}},{key:"play",value:function(){this._stopped||this._playing||(this._playing=!0,this._animation._startAnimation())}},{key:"percentage",get:function(){return this._time/this._duration}},{key:"waitForStop",value:function(){var e=this;return new Promise((function(t,i){if(e._stopped)t();else var n=e.events.on("stopped",(function(){n.dispose(),t()}))}))}},{key:"_checkEnded",value:function(){return!(this._loops>1)||(--this._loops,!1)}},{key:"_run",value:function(e){null!==this._oldTime&&(this._time+=e-this._oldTime,this._time>this._duration&&(this._time=this._duration)),this._oldTime=e}},{key:"_reset",value:function(e){this._oldTime=e,this._time=0}},{key:"_value",value:function(e){return this._interpolate(this._easing(e),this._from,this._to)}}]),e}(),_t=0,Ot=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:++_t}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_userProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._settings=t}return Object(h.a)(e,[{key:"_checkDirty",value:function(){var e=this;ee(this._settings).forEach((function(t){e._userProperties[t]=!0,e._markDirtyKey(t)}))}},{key:"resetUserSettings",value:function(){this._userProperties={}}},{key:"_runAnimation",value:function(e){var t=this;if(this.isDisposed())return!1;var i=!1;return ie(this._animatingSettings,(function(n,a){if(a._stopped)t._stopAnimation(n);else if(a._playing){a._run(e);var r=a.percentage;r>=1?a._checkEnded()?t.set(n,a._value(1)):(i=!0,a._reset(e),t._set(n,a._value(1))):(i=!0,t._set(n,a._value(r)))}})),ie(this._animatingPrivateSettings,(function(n,a){if(a._stopped)t._stopAnimationPrivate(n);else if(a._playing){a._run(e);var r=a.percentage;r>=1?a._checkEnded()?t.setPrivate(n,a._value(1)):(i=!0,a._reset(e),t._setPrivate(n,a._value(1))):(i=!0,t._setPrivate(n,a._value(r)))}})),i}},{key:"_markDirtyKey",value:function(e){this.markDirty()}},{key:"_markDirtyPrivateKey",value:function(e){this.markDirty()}},{key:"on",value:function(e,t){var i=this,n=this._settingEvents[e];return void 0===n&&(n=this._settingEvents[e]=[]),n.push(t),new z((function(){I(n,t),0===n.length&&delete i._settingEvents[e]}))}},{key:"onPrivate",value:function(e,t){var i=this,n=this._privateSettingEvents[e];return void 0===n&&(n=this._privateSettingEvents[e]=[]),n.push(t),new z((function(){I(n,t),0===n.length&&delete i._privateSettingEvents[e]}))}},{key:"getRaw",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"get",value:function(e,t){return this.getRaw(e,t)}},{key:"_sendKeyEvent",value:function(e,t){var i=this,n=this._settingEvents[e];void 0!==n&&P(n,(function(n){n(t,i,e)}))}},{key:"_sendPrivateKeyEvent",value:function(e,t){var i=this,n=this._privateSettingEvents[e];void 0!==n&&P(n,(function(n){n(t,i,e)}))}},{key:"_setRaw",value:function(e,t,i){this._prevSettings[e]=t,this._sendKeyEvent(e,i)}},{key:"setRaw",value:function(e,t){var i=this._settings[e];this._settings[e]=t,i!==t&&this._setRaw(e,i,t)}},{key:"_set",value:function(e,t){var i=this._settings[e];this._settings[e]=t,i!==t&&(this._setRaw(e,i,t),this._markDirtyKey(e))}},{key:"_stopAnimation",value:function(e){var t=this._animatingSettings[e];t&&(delete this._animatingSettings[e],t.stop())}},{key:"set",value:function(e,t){return this._set(e,t),this._stopAnimation(e),t}},{key:"remove",value:function(e){e in this._settings&&(this._prevSettings[e]=this._settings[e],delete this._settings[e],this._sendKeyEvent(e,void 0),this._markDirtyKey(e)),this._stopAnimation(e)}},{key:"removeAll",value:function(){var e=this;P(ee(this._settings),(function(t){e.remove(t)}))}},{key:"getPrivate",value:function(e,t){var i=this._privateSettings[e];return void 0!==i?i:t}},{key:"_setPrivateRaw",value:function(e,t,i){this._prevPrivateSettings[e]=t,this._sendPrivateKeyEvent(e,i)}},{key:"setPrivateRaw",value:function(e,t){var i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&this._setPrivateRaw(e,i,t)}},{key:"_setPrivate",value:function(e,t){var i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&(this._setPrivateRaw(e,i,t),this._markDirtyPrivateKey(e))}},{key:"_stopAnimationPrivate",value:function(e){var t=this._animatingPrivateSettings[e];t&&(t.stop(),delete this._animatingPrivateSettings[e])}},{key:"setPrivate",value:function(e,t){return this._setPrivate(e,t),this._stopAnimationPrivate(e),t}},{key:"removePrivate",value:function(e){e in this._privateSettings&&(this._prevPrivateSettings[e]=this._privateSettings[e],delete this._privateSettings[e],this._markDirtyPrivateKey(e)),this._stopAnimationPrivate(e)}},{key:"setAll",value:function(e){var t=this;ie(e,(function(e,i){t.set(e,i)}))}},{key:"animate",value:function(e){var t=e.key,i=e.to,n=e.duration||0,a=e.loops||1,r=void 0===e.from?this.get(t):e.from,o=void 0===e.easing?lt:e.easing;if(0===n)this.set(t,i);else{if(void 0!==r&&r!==i){this.set(t,r);var s=this._animatingSettings[t]=new mt(this,r,i,n,o,a,this._animationTime());return this._startAnimation(),s}this.set(t,i)}var l=new mt(this,r,i,n,o,a,null);return l.stop(),l}},{key:"animatePrivate",value:function(e){var t=e.key,i=e.to,n=e.duration||0,a=e.loops||1,r=void 0===e.from?this.getPrivate(t):e.from,o=void 0===e.easing?lt:e.easing;if(0===n)this.setPrivate(t,i);else{if(void 0!==r&&r!==i){this.setPrivate(t,r);var s=this._animatingPrivateSettings[t]=new mt(this,r,i,n,o,a,this._animationTime());return this._startAnimation(),s}this.setPrivate(t,i)}var l=new mt(this,r,i,n,o,a,null);return l.stop(),l}},{key:"_dispose",value:function(){}},{key:"isDisposed",value:function(){return this._disposed}},{key:"dispose",value:function(){this._disposed||(this._disposed=!0,this._dispose())}}]),e}(),jt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(e,a,r){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(Object(d.a)(this,i),o=t.call(this,a),Object.defineProperty(Object(l.a)(o),"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(o),"_user_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(o),"states",{enumerable:!0,configurable:!0,writable:!0,value:new ht(Object(l.a)(o))}),Object.defineProperty(Object(l.a)(o),"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new gt(Object(l.a)(o))}),Object.defineProperty(Object(l.a)(o),"events",{enumerable:!0,configurable:!0,writable:!0,value:o._createEvents()}),Object.defineProperty(Object(l.a)(o),"_userPrivateProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(l.a)(o),"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(l.a)(o),"_dirtyPrivate",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(l.a)(o),"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(o),"_templates",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(l.a)(o),"_internalTemplates",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(o),"_defaultThemes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(l.a)(o),"_templateDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(l.a)(o),"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(l.a)(o),"_runSetup",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(Object(l.a)(o),"_disposerProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),!r)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");return o._root=e,o._internalTemplates=s,a.id&&o._registerId(a.id),Object(n.a)(o)}return Object(h.a)(i,[{key:"_afterNew",value:function(){var e=this;this._checkDirty();var t=!1,i=this._template;i&&(t=!0,i._setObjectTemplate(this)),P(this._internalTemplates,(function(i){t=!0,i._setObjectTemplate(e)})),t&&this._applyTemplates(!1),this.states.create("default",{}),this._setDefaults()}},{key:"_afterNewApplyThemes",value:function(){var e=this;this._checkDirty();var t=this._template;t&&t._setObjectTemplate(this),P(this._internalTemplates,(function(t){t._setObjectTemplate(e)})),this.states.create("default",{}),this._setDefaults(),this._applyThemes()}},{key:"_createEvents",value:function(){return new U}},{key:"classNames",get:function(){return this.constructor.classNames}},{key:"className",get:function(){return this.constructor.className}},{key:"_setDefaults",value:function(){}},{key:"_setDefault",value:function(e,t){e in this._settings||Object(r.a)(Object(o.a)(i.prototype),"set",this).call(this,e,t)}},{key:"_setRawDefault",value:function(e,t){e in this._settings||Object(r.a)(Object(o.a)(i.prototype),"setRaw",this).call(this,e,t)}},{key:"_clearDirty",value:function(){var e=this;ee(this._dirty).forEach((function(t){e._dirty[t]=!1})),ee(this._dirtyPrivate).forEach((function(t){e._dirtyPrivate[t]=!1}))}},{key:"isDirty",value:function(e){return!!this._dirty[e]}},{key:"isPrivateDirty",value:function(e){return!!this._dirtyPrivate[e]}},{key:"_markDirtyKey",value:function(e){this._dirty[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"_markDirtyKey",this).call(this,e)}},{key:"_markDirtyPrivateKey",value:function(e){this._dirtyPrivate[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"_markDirtyKey",this).call(this,e)}},{key:"isType",value:function(e){return-1!==this.classNames.indexOf(e)}},{key:"_pushPropertyDisposer",value:function(e,t){var i=this._disposerProperties[e];return void 0===i&&(i=this._disposerProperties[e]=[]),i.push(t),t}},{key:"_disposeProperty",value:function(e){var t=this._disposerProperties[e];void 0!==t&&(P(t,(function(e){e.dispose()})),delete this._disposerProperties[e])}},{key:"template",get:function(){return this._template},set:function(e){var t=this._template;t!==e&&(this._template=e,t&&t._removeObjectTemplate(this),e&&e._setObjectTemplate(this),this._applyTemplates())}},{key:"markDirty",value:function(){this._root._addDirtyEntity(this)}},{key:"_startAnimation",value:function(){this._root._addAnimation(this)}},{key:"_animationTime",value:function(){return this._root.animationTime}},{key:"_applyState",value:function(e){}},{key:"_applyStateAnimated",value:function(e,t){}},{key:"get",value:function(e,t){var i=this.adapters.fold(e,this._settings[e]);return void 0!==i?i:t}},{key:"isUserSetting",value:function(e){return this._userProperties[e]||!1}},{key:"set",value:function(e,t){return this._userProperties[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"set",this).call(this,e,t)}},{key:"setRaw",value:function(e,t){this._userProperties[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"setRaw",this).call(this,e,t)}},{key:"_setSoft",value:function(e,t){return this._userProperties[e]?t:Object(r.a)(Object(o.a)(i.prototype),"set",this).call(this,e,t)}},{key:"remove",value:function(e){delete this._userProperties[e],this._removeTemplateProperty(e)}},{key:"setPrivate",value:function(e,t){return this._userPrivateProperties[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"setPrivate",this).call(this,e,t)}},{key:"setPrivateRaw",value:function(e,t){this._userPrivateProperties[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"setPrivateRaw",this).call(this,e,t)}},{key:"removePrivate",value:function(e){delete this._userPrivateProperties[e],this._removeTemplatePrivateProperty(e)}},{key:"_setTemplateProperty",value:function(e,t,n){this._userProperties[t]||e===this._findTemplateByKey(t)&&Object(r.a)(Object(o.a)(i.prototype),"set",this).call(this,t,n)}},{key:"_setTemplatePrivateProperty",value:function(e,t,n){this._userPrivateProperties[t]||e===this._findTemplateByPrivateKey(t)&&Object(r.a)(Object(o.a)(i.prototype),"setPrivate",this).call(this,t,n)}},{key:"_removeTemplateProperty",value:function(e){if(!this._userProperties[e]){var t=this._findTemplateByKey(e);t?Object(r.a)(Object(o.a)(i.prototype),"set",this).call(this,e,t._settings[e]):Object(r.a)(Object(o.a)(i.prototype),"remove",this).call(this,e)}}},{key:"_removeTemplatePrivateProperty",value:function(e){if(!this._userPrivateProperties[e]){var t=this._findTemplateByPrivateKey(e);t?Object(r.a)(Object(o.a)(i.prototype),"setPrivate",this).call(this,e,t._privateSettings[e]):Object(r.a)(Object(o.a)(i.prototype),"removePrivate",this).call(this,e)}}},{key:"_walkParents",value:function(e){e(this._root._rootContainer),e(this)}},{key:"_applyStateByKey",value:function(e){var t=this.states.create(e,{}),i={};this._eachTemplate((function(n){var a=n.states.lookup(e);a&&a._apply(t,i)})),ie(t._settings,(function(e){i[e]||t._userSettings[e]||t.remove(e)}))}},{key:"_applyTemplate",value:function(e,t){var n=this;this._templateDisposers.push(e._apply(this,t)),ie(e._settings,(function(e,a){t.settings[e]||n._userProperties[e]||(t.settings[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"set",n).call(n,e,a))})),ie(e._privateSettings,(function(e,a){t.privateSettings[e]||n._userPrivateProperties[e]||(t.privateSettings[e]=!0,Object(r.a)(Object(o.a)(i.prototype),"setPrivate",n).call(n,e,a))})),this._runSetup&&e.setup&&(this._runSetup=!1,e.setup(this))}},{key:"_findStaticTemplate",value:function(e){if(this._template&&e(this._template))return this._template}},{key:"_eachTemplate",value:function(e){this._findStaticTemplate((function(t){return e(t),!1})),C(this._internalTemplates,e),P(this._templates,e)}},{key:"_applyTemplates",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&this._disposeTemplates();var n={settings:{},privateSettings:{},states:{}};this._eachTemplate((function(t){e._applyTemplate(t,n)})),t&&(ie(this._settings,(function(t){e._userProperties[t]||n.settings[t]||Object(r.a)(Object(o.a)(i.prototype),"remove",e).call(e,t)})),ie(this._privateSettings,(function(t){e._userPrivateProperties[t]||n.privateSettings[t]||Object(r.a)(Object(o.a)(i.prototype),"removePrivate",e).call(e,t)})))}},{key:"_findTemplate",value:function(e){var t=this._findStaticTemplate(e);if(void 0===t){var i=function(e,t){var i=function(e,t){for(var i=e.length;i>0;)if(t(e[--i],i))return i;return-1}(e,t);if(-1!==i)return e[i]}(this._internalTemplates,e);return void 0===i?B(this._templates,e):i}return t}},{key:"_findTemplateByKey",value:function(e){return this._findTemplate((function(t){return e in t._settings}))}},{key:"_findTemplateByPrivateKey",value:function(e){return this._findTemplate((function(t){return e in t._privateSettings}))}},{key:"_disposeTemplates",value:function(){P(this._templateDisposers,(function(e){e.dispose()})),this._templateDisposers.length=0}},{key:"_removeTemplates",value:function(){var e=this;P(this._templates,(function(t){t._removeObjectTemplate(e)})),this._templates.length=0}},{key:"_applyThemes",value:function(){var e=this,t=!1,i=[],n=[],a=new Set,r=this.get("themeTagsSelf");return r&&P(r,(function(e){a.add(e)})),this._walkParents((function(r){r===e._root._rootContainer&&(t=!0),r._defaultThemes.length>0&&i.push(r._defaultThemes);var o=r.get("themes");o&&n.push(o);var s=r.get("themeTags");s&&P(s,(function(e){a.add(e)}))})),n=i.concat(n),this._removeTemplates(),t&&C(this.classNames,(function(t){var i=[];P(n,(function(e){P(e,(function(e){var n=e._lookupRules(t);n&&C(n,(function(e){if(e.tags.every((function(e){return a.has(e)}))){var t=function(e,t){for(var i=0,n=e.length,a=!1;i<n;){var r=i+n>>1,o=t(e[r]);o<0?i=r+1:0===o?(a=!0,n=r):n=r}return{found:a,index:i}}(i,(function(t){var i=pt(e.tags.length,t.tags.length);return 0===i?vt(e.tags,t.tags,pt):i}));i.splice(t.index,0,e)}}))}))})),P(i,(function(t){e._templates.push(t.template),t.template._setObjectTemplate(e)}))})),this._applyTemplates(),t&&(this._runSetup=!1),t}},{key:"_changed",value:function(){}},{key:"_beforeChanged",value:function(){if(this.isDirty("id")){var e=this.get("id");e&&this._registerId(e);var t=this._prevSettings.id;t&&delete ft.entitiesById[t]}}},{key:"_registerId",value:function(e){if(ft.entitiesById[e]&&ft.entitiesById[e]!==this)throw new Error('An entity with id "'+e+'" already exists.');ft.entitiesById[e]=this}},{key:"_afterChanged",value:function(){}},{key:"addDisposer",value:function(e){return this._disposers.push(e),e}},{key:"_dispose",value:function(){var e=this;Object(r.a)(Object(o.a)(i.prototype),"_dispose",this).call(this);var t=this._template;t&&t._removeObjectTemplate(this),P(this._internalTemplates,(function(t){t._removeObjectTemplate(e)})),this._removeTemplates(),this._disposeTemplates(),this.events.dispose(),this._disposers.forEach((function(e){e.dispose()})),ie(this._disposerProperties,(function(e,t){P(t,(function(e){e.dispose()}))}));var n=this.get("id");n&&delete ft.entitiesById[n]}},{key:"setTimeout",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var i=this,n=setTimeout((function(){i.removeDispose(a),e()}),t),a=new z((function(){clearTimeout(n)}));return this._disposers.push(a),a}))},{key:"removeDispose",value:function(e){if(!this.isDisposed()){var t=x(this._disposers,e);t>-1&&this._disposers.splice(t,1)}e.dispose()}},{key:"hasTag",value:function(e){return-1!==x(this.get("themeTags",[]),e)}},{key:"addTag",value:function(e){if(!this.hasTag(e)){var t=this.get("themeTags",[]);t.push(e),this.set("themeTags",t)}}},{key:"removeTag",value:function(e){if(this.hasTag(e)){var t=this.get("themeTags",[]);T(t,e),this.set("themeTags",t)}}},{key:"_t",value:function(e,t){for(var i,n=arguments.length,a=new Array(n>2?n-2:0),r=2;r<n;r++)a[r-2]=arguments[r];return(i=this._root.language).translate.apply(i,[e,t].concat(a))}},{key:"root",get:function(){return this._root}}],[{key:"new",value:function(e,t,i){var n=new this(e,t,!0);return n._template=i,n._afterNew(),n}},{key:"_new",value:function(e,t){var i=new this(e,t,!0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]);return i._afterNew(),i}}]),i}(Ot);Object.defineProperty(jt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Entity"}),Object.defineProperty(jt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:["Entity"]});var wt=function(){function e(t,i,n){Object(d.a)(this,e),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._name=t,this._template=i,this._settings=n}return Object(h.a)(e,[{key:"get",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"set",value:function(e,t){this._settings[e]=t,this._template._stateChanged(this._name)}},{key:"remove",value:function(e){delete this._settings[e],this._template._stateChanged(this._name)}},{key:"setAll",value:function(e){var t=this;ee(e).forEach((function(i){t._settings[i]=e[i]})),this._template._stateChanged(this._name)}},{key:"_apply",value:function(e,t){ie(this._settings,(function(i,n){t[i]||e._userSettings[i]||(t[i]=!0,e.setRaw(i,n))}))}}]),e}(),kt=function(){function e(t){Object(d.a)(this,e),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._template=t}return Object(h.a)(e,[{key:"lookup",value:function(e){return this._states[e]}},{key:"create",value:function(e,t){var i=this._states[e];if(i)return i.setAll(t),i;var n=new wt(e,this._template,t);return this._states[e]=n,this._template._stateChanged(e),n}},{key:"remove",value:function(e){delete this._states[e],this._template._stateChanged(e)}},{key:"_apply",value:function(e,t){ie(this._states,(function(i,n){var a=t.states[i];null==a&&(a=t.states[i]={});var r=e.states.create(i,{});n._apply(r,a)}))}}]),e}(),xt=function(){function e(){Object(d.a)(this,e),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}return Object(h.a)(e,[{key:"add",value:function(e,t){var i=this,n=this._callbacks[e];return void 0===n&&(n=this._callbacks[e]=[]),n.push(t),new z((function(){I(n,t),0===n.length&&delete i._callbacks[e]}))}},{key:"remove",value:function(e){void 0!==this._callbacks[e]&&delete this._callbacks[e]}},{key:"_apply",value:function(e){var t=[];return ie(this._callbacks,(function(i,n){P(n,(function(n){t.push(e.adapters.add(i,n))}))})),new V(t)}}]),e}(),Mt=function(){function e(t,i){if(Object(d.a)(this,e),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entities",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new kt(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new xt}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new U}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=t}return Object(h.a)(e,[{key:"entities",get:function(){return this._entities}},{key:"get",value:function(e,t){var i=this._settings[e];return void 0!==i?i:t}},{key:"setRaw",value:function(e,t){this._settings[e]=t}},{key:"set",value:function(e,t){var i=this;this._settings[e]!==t&&(this.setRaw(e,t),this._entities.forEach((function(n){n._setTemplateProperty(i,e,t)})))}},{key:"remove",value:function(e){e in this._settings&&(delete this._settings[e],this._entities.forEach((function(t){t._removeTemplateProperty(e)})))}},{key:"removeAll",value:function(){var e=this;ie(this._settings,(function(t,i){e.remove(t)}))}},{key:"getPrivate",value:function(e,t){var i=this._privateSettings[e];return void 0!==i?i:t}},{key:"setPrivateRaw",value:function(e,t){return this._privateSettings[e]=t,t}},{key:"setPrivate",value:function(e,t){var i=this;return this._privateSettings[e]!==t&&(this.setPrivateRaw(e,t),this._entities.forEach((function(n){n._setTemplatePrivateProperty(i,e,t)}))),t}},{key:"removePrivate",value:function(e){e in this._privateSettings&&(delete this._privateSettings[e],this._entities.forEach((function(t){t._removeTemplatePrivateProperty(e)})))}},{key:"setAll",value:function(e){var t=this;ie(e,(function(e,i){t.set(e,i)}))}},{key:"on",value:function(e,t){var i=this,n=this._settingEvents[e];return void 0===n&&(n=this._settingEvents[e]=[]),n.push(t),new z((function(){I(n,t),0===n.length&&delete i._settingEvents[e]}))}},{key:"onPrivate",value:function(e,t){var i=this,n=this._privateSettingEvents[e];return void 0===n&&(n=this._privateSettingEvents[e]=[]),n.push(t),new z((function(){I(n,t),0===n.length&&delete i._privateSettingEvents[e]}))}},{key:"_apply",value:function(e,t){var i=[];return ie(this._settingEvents,(function(t,n){P(n,(function(n){i.push(e.on(t,n))}))})),ie(this._privateSettingEvents,(function(t,n){P(n,(function(n){i.push(e.onPrivate(t,n))}))})),this.states._apply(e,t),i.push(this.adapters._apply(e)),i.push(e.events.copyFrom(this.events)),new V(i)}},{key:"_setObjectTemplate",value:function(e){this._entities.push(e)}},{key:"_removeObjectTemplate",value:function(e){T(this._entities,e)}},{key:"_stateChanged",value:function(e){this._entities.forEach((function(t){t._applyStateByKey(e)}))}}],[{key:"new",value:function(t){return new e(t,!0)}}]),e}(),Pt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(e){var n;return Object(d.a)(this,i),n=t.call(this),Object.defineProperty(Object(l.a)(n),"_sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(n),"_rendererDisposers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(l.a)(n),"_dispatchParents",{enumerable:!0,configurable:!0,writable:!0,value:!0}),n._sprite=e,n}return Object(h.a)(i,[{key:"_makePointerEvent",value:function(e,t){return{type:e,originalEvent:t.event,point:t.point,simulated:t.simulated,native:t.native,target:this._sprite}}},{key:"_onRenderer",value:function(e,t){var i=this;this._sprite.set("interactive",!0),this._sprite._display.interactive=!0;var n=this._rendererDisposers[e];if(void 0===n){var a=this._sprite._display.on(e,(function(e){t.call(i,e)}));n=this._rendererDisposers[e]=new W((function(){delete i._rendererDisposers[e],a.dispose()}))}return n.increment()}},{key:"_on",value:function(e,t,n,a,s,l){var u=Object(r.a)(Object(o.a)(i.prototype),"_on",this).call(this,e,t,n,a,s,l),c=i.RENDERER_EVENTS[t];return void 0!==c&&(u.disposer=new V([u.disposer,this._onRenderer(t,c)])),u}},{key:"stopParentDispatch",value:function(){this._dispatchParents=!1}},{key:"dispatchParents",value:function(e,t){var i=this._dispatchParents;this._dispatchParents=!0;try{this.dispatch(e,t),this._dispatchParents&&this._sprite.parent&&this._sprite.parent.events.dispatchParents(e,t)}finally{this._dispatchParents=i}}}]),i}(U);Object.defineProperty(Pt,"RENDERER_EVENTS",{enumerable:!0,configurable:!0,writable:!0,value:{click:function(e){this.isEnabled("click")&&!this._sprite.isDragging()&&this._sprite._hasDown()&&!this._sprite._hasMoved(this._makePointerEvent("click",e))&&this.dispatch("click",this._makePointerEvent("click",e))},rightclick:function(e){this.isEnabled("rightclick")&&this.dispatch("rightclick",this._makePointerEvent("rightclick",e))},middleclick:function(e){this.isEnabled("middleclick")&&this.dispatch("middleclick",this._makePointerEvent("middleclick",e))},dblclick:function(e){this.dispatchParents("dblclick",this._makePointerEvent("dblclick",e))},pointerover:function(e){this.isEnabled("pointerover")&&this.dispatch("pointerover",this._makePointerEvent("pointerover",e))},pointerout:function(e){this.isEnabled("pointerout")&&this.dispatch("pointerout",this._makePointerEvent("pointerout",e))},pointerdown:function(e){this.dispatchParents("pointerdown",this._makePointerEvent("pointerdown",e))},pointerup:function(e){this.isEnabled("pointerup")&&this.dispatch("pointerup",this._makePointerEvent("pointerup",e))},globalpointerup:function(e){this.isEnabled("globalpointerup")&&this.dispatch("globalpointerup",this._makePointerEvent("globalpointerup",e))},globalpointermove:function(e){this.isEnabled("globalpointermove")&&this.dispatch("globalpointermove",this._makePointerEvent("globalpointermove",e))},wheel:function(e){this.dispatchParents("wheel",{type:"wheel",target:this._sprite,originalEvent:e.event,point:e.point})}}});var Ct=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_adjustedLocalBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(Object(l.a)(e),"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(Object(l.a)(e),"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_dataItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_templateField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_sizeDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_dragEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_dragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_isHidden",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_isShowing",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_isHiding",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_isDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_downPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_downPoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(Object(l.a)(e),"_toggleDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_dragDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_tooltipDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_hoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_focusDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_tooltipMoveDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_tooltipPointerDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_statesHandled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return Object(h.a)(i,[{key:"_afterNew",value:function(){this.setPrivateRaw("visible",!0),Object(r.a)(Object(o.a)(i.prototype),"_afterNew",this).call(this)}},{key:"_markDirtyKey",value:function(e){Object(r.a)(Object(o.a)(i.prototype),"_markDirtyKey",this).call(this,e),"x"!=e&&"y"!=e&&"dx"!=e&&"dy"!=e||(this.markDirtyBounds(),this._addPercentagePositionChildren(),this.markDirtyPosition())}},{key:"_markDirtyPrivateKey",value:function(e){Object(r.a)(Object(o.a)(i.prototype),"_markDirtyPrivateKey",this).call(this,e),"x"!=e&&"y"!=e||this.markDirtyPosition()}},{key:"_removeTemplateField",value:function(){this._templateField&&this._templateField._removeObjectTemplate(this)}},{key:"_createEvents",value:function(){return new Pt(this)}},{key:"_processTemplateField",value:function(){var e,t=this.get("templateField");if(t){var i=this.dataItem;if(i){var n=i.dataContext;n&&((e=n[t])instanceof Mt||!e||(e=Mt.new(e)))}}this._templateField!==e&&(this._removeTemplateField(),this._templateField=e,e&&e._setObjectTemplate(this),this._applyTemplates())}},{key:"_setDataItem",value:function(e){var t=this._dataItem;this._dataItem=e,this._processTemplateField();var i="dataitemchanged";e!=t&&this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this,oldDataItem:t,newDataItem:e})}},{key:"dataItem",get:function(){if(this._dataItem)return this._dataItem;for(var e=this._parent;e;){if(e._dataItem)return e._dataItem;e=e._parent}},set:function(e){this._setDataItem(e)}},{key:"_addPercentageSizeChildren",value:function(){var e=this.parent;e&&(this.get("width")instanceof Z||this.get("height")instanceof Z?D(e._percentageSizeChildren,this):I(e._percentageSizeChildren,this))}},{key:"_addPercentagePositionChildren",value:function(){var e=this.parent;e&&(this.get("x")instanceof Z||this.get("y")instanceof Z?D(e._percentagePositionChildren,this):I(e._percentagePositionChildren,this))}},{key:"markDirtyPosition",value:function(){this._root._addDirtyPosition(this)}},{key:"updatePivotPoint",value:function(){var e=this._localBounds;if(e){var t=this.get("centerX");null!=t&&(this._display.pivot.x=e.left+_e(t,e.right-e.left));var i=this.get("centerY");null!=i&&(this._display.pivot.y=e.top+_e(i,e.bottom-e.top))}}},{key:"_beforeChanged",value:function(){var e=this;if(Object(r.a)(Object(o.a)(i.prototype),"_beforeChanged",this).call(this),this._handleStates(),this.isDirty("tooltip")){var t=this._prevSettings.tooltip;t&&t.dispose()}if((this.isDirty("layer")||this.isDirty("layerMargin"))&&(this._display.setLayer(this.get("layer"),this.get("layerMargin")),this.markDirtyLayer()),this.isDirty("tooltipPosition")){var n=this._tooltipMoveDp;n&&(n.dispose(),this._tooltipMoveDp=void 0);var a=this._tooltipPointerDp;a&&(a.dispose(),this._tooltipPointerDp=void 0),"pointer"==this.get("tooltipPosition")&&(this._tooltipPointerDp=new V([this.events.on("pointerover",(function(){e._tooltipMoveDp=e.events.on("globalpointermove",(function(t){e.showTooltip(t.point)}))})),this.events.on("pointerout",(function(){var t=e._tooltipMoveDp;t&&(t.dispose(),e._tooltipMoveDp=void 0)}))]))}}},{key:"_handleStates",value:function(){this._statesHandled||(this.isDirty("active")&&(this.get("active")?(this.states.applyAnimate("active"),this.set("ariaChecked",!0)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!1)),this.markDirtyAccessibility()),this.isDirty("disabled")&&(this.get("disabled")?(this.states.applyAnimate("disabled"),this.set("ariaChecked",!1)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!0)),this.markDirtyAccessibility()),this._statesHandled=!0)}},{key:"_changed",value:function(){var e=this;Object(r.a)(Object(o.a)(i.prototype),"_changed",this).call(this);var t=this._display,n=this.events;if(this.isDirty("draggable")){var a=this.get("draggable");a?(this.set("interactive",!0),this._dragDp=new V([n.on("pointerdown",(function(t){e.dragStart(t)})),n.on("globalpointermove",(function(t){e.dragMove(t)})),n.on("globalpointerup",(function(t){e.dragStop(t)}))])):this._dragDp&&(this._dragDp.dispose(),this._dragDp=void 0),t.cancelTouch=!!a}if(this.isDirty("tooltipText")||this.isDirty("tooltipHTML")||this.isDirty("showTooltipOn")){var s=this.get("tooltipText"),l=this.get("tooltipHTML"),u=this.get("showTooltipOn","hover");this._tooltipDp&&(this._tooltipDp.dispose(),this._tooltipDp=void 0),(s||l)&&("click"==u?this._tooltipDp=new V([n.on("click",(function(){e.setTimeout((function(){return e.showTooltip()}),10)})),oe(document,"click",(function(t){e.hideTooltip()}))]):"always"==u||(this._tooltipDp=new V([n.on("pointerover",(function(){e.showTooltip()})),n.on("pointerout",(function(){e.hideTooltip()}))])))}if(this.isDirty("toggleKey")){var c=this.get("toggleKey");c&&"none"!=c?this._toggleDp=n.on("click",(function(){e._isDragging||e.set(c,!e.get(c))})):this._toggleDp&&(this._toggleDp.dispose(),this._toggleDp=void 0)}if(this.isDirty("opacity")&&(t.alpha=Math.max(0,this.get("opacity",1))),this.isDirty("rotation")&&(this.markDirtyBounds(),t.angle=this.get("rotation",0)),this.isDirty("scale")&&(this.markDirtyBounds(),t.scale=this.get("scale",0)),(this.isDirty("centerX")||this.isDirty("centerY"))&&(this.markDirtyBounds(),this.updatePivotPoint()),(this.isDirty("visible")||this.isPrivateDirty("visible")||this.isDirty("forceHidden"))&&(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?t.visible=!0:(t.visible=!1,this.hideTooltip()),this.markDirtyBounds(),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("width")||this.isDirty("height")){this.markDirtyBounds(),this._addPercentageSizeChildren();var d=this.parent;d&&(this.isDirty("width")&&this.get("width")instanceof Z||this.isDirty("height")&&this.get("height")instanceof Z)&&(d.markDirty(),d._prevWidth=0),this._sizeDirty=!0}if((this.isDirty("maxWidth")||this.isDirty("maxHeight")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("minWidth")||this.isDirty("minHeight")||this.isPrivateDirty("maxWidth")||this.isPrivateDirty("maxHeight")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&(this.markDirtyBounds(),this._sizeDirty=!0),this._sizeDirty&&this._updateSize(),this.isDirty("wheelable")){var h=this.get("wheelable");h&&this.set("interactive",!0),t.wheelable=!!h}if((this.isDirty("tabindexOrder")||this.isDirty("focusableGroup"))&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this)),this.isDirty("filter")&&(t.filter=this.get("filter")),this.isDirty("cursorOverStyle")&&(t.cursorOverStyle=this.get("cursorOverStyle")),this.isDirty("hoverOnFocus")&&(this.get("hoverOnFocus")?this._focusDp=new V([n.on("focus",(function(){e.showTooltip()})),n.on("blur",(function(){e.hideTooltip()}))]):this._focusDp&&(this._focusDp.dispose(),this._focusDp=void 0)),this.isDirty("focusable")&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this),this.markDirtyAccessibility()),(this.isDirty("role")||this.isDirty("ariaLive")||this.isDirty("ariaChecked")||this.isDirty("ariaHidden")||this.isDirty("ariaOrientation")||this.isDirty("ariaValueNow")||this.isDirty("ariaValueMin")||this.isDirty("ariaValueMax")||this.isDirty("ariaValueText")||this.isDirty("ariaLabel")||this.isDirty("ariaControls"))&&this.markDirtyAccessibility(),this.isDirty("exportable")&&(t.exportable=this.get("exportable")),this.isDirty("interactive")){var f=this.events;this.get("interactive")?this._hoverDp=new V([f.on("click",(function(t){fe(t.originalEvent)&&(e.getPrivate("touchHovering")||e.setTimeout((function(){e._handleOver(),(e.get("tooltipText")||e.get("tooltipHTML"))&&e.showTooltip(),e.setPrivateRaw("touchHovering",!0),e.events.dispatch("pointerover",{type:"pointerover",target:t.target,originalEvent:t.originalEvent,point:t.point,simulated:t.simulated})}),10))})),f.on("globalpointerup",(function(t){fe(t.originalEvent)&&e.getPrivate("touchHovering")&&(e._handleOut(),(e.get("tooltipText")||e.get("tooltipHTML"))&&e.hideTooltip(),e.setPrivateRaw("touchHovering",!1),e.events.dispatch("pointerout",{type:"pointerout",target:t.target,originalEvent:t.originalEvent,point:t.point,simulated:t.simulated})),e._isDown&&e._handleUp(t)})),f.on("pointerover",(function(){e._handleOver()})),f.on("pointerout",(function(){e._handleOut()})),f.on("pointerdown",(function(t){e._handleDown(t)}))]):(this._display.interactive=!1,this._hoverDp&&(this._hoverDp.dispose(),this._hoverDp=void 0))}this.isDirty("forceInactive")&&(this._display.inactive=this.get("forceInactive",!1)),"always"==this.get("showTooltipOn")&&this._display.visible&&this.showTooltip()}},{key:"dragStart",value:function(e){this._dragEvent=e,this.events.stopParentDispatch()}},{key:"dragStop",value:function(e){if(this._dragEvent=void 0,this._dragPoint=void 0,this.events.stopParentDispatch(),this._isDragging){this._isDragging=!1;var t="dragstop";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}},{key:"_handleOver",value:function(){this.isHidden()||(this.get("active")&&this.states.lookup("hoverActive")?this.states.applyAnimate("hoverActive"):this.get("disabled")&&this.states.lookup("hoverDisabled")?this.states.applyAnimate("hoverDisabled"):this.states.applyAnimate("hover"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}},{key:"_handleOut",value:function(){this.isHidden()||(this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):(this.states.lookup("hover")||this.states.lookup("hoverActive"))&&this.states.applyAnimate("default"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}},{key:"_handleUp",value:function(e){if(!this.isHidden()){this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):this.states.lookup("down")&&(this.isHover()?this.states.applyAnimate("hover"):this.states.applyAnimate("default")),this._downPoint=void 0;var t=ue(e.originalEvent);delete this._downPoints[t],0==ee(this._downPoints).length&&(this._isDown=!1)}}},{key:"_hasMoved",value:function(e){var t=ue(e.originalEvent),i=this._downPoints[t];if(i){var n=Math.abs(i.x-e.point.x),a=Math.abs(i.y-e.point.y);return n>5||a>5}return!1}},{key:"_hasDown",value:function(){return ee(this._downPoints).length>0}},{key:"_handleDown",value:function(e){var t=this.parent;if(t&&!this.get("draggable")&&t._handleDown(e),this.get("interactive")&&!this.isHidden()){this.states.lookup("down")&&this.states.applyAnimate("down"),this._downPoint={x:e.point.x,y:e.point.y},this._isDown=!0;var i=ue(e.originalEvent);this._downPoints[i]={x:e.point.x,y:e.point.y}}}},{key:"dragMove",value:function(e){var t=this._dragEvent;if(t){if(t.simulated&&!e.simulated)return!0;for(var i=0,n=this.parent;null!=n;)i+=n.get("rotation",0),n=n.parent;var a=e.point.x-t.point.x,r=e.point.y-t.point.y,o=this.events;if(t.simulated&&!this._isDragging){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};var s="dragstart";o.isEnabled(s)&&o.dispatch(s,{type:s,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}if(this._isDragging){var l=this._dragPoint;this.set("x",l.x+a*nt(i)+r*it(i)),this.set("y",l.y+r*nt(i)-a*it(i));var u="dragged";o.isEnabled(u)&&o.dispatch(u,{type:u,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}else if(Math.hypot(a,r)>5){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};var c="dragstart";o.isEnabled(c)&&o.dispatch(c,{type:c,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}}},{key:"_updateSize",value:function(){}},{key:"_getBounds",value:function(){this._localBounds=this._display.getLocalBounds()}},{key:"depth",value:function(){for(var e=this.parent,t=0;;){if(!e)return t;++t,e=e.parent}}},{key:"markDirtySize",value:function(){this._sizeDirty=!0,this.markDirty()}},{key:"markDirtyBounds",value:function(){if(this.get("isMeasured")){var e=this._display;this._root._addDirtyBounds(this),e.isMeasured=!0,e.invalidateBounds();var t=this.parent;t&&"absolute"!=this.get("position")&&(null==t.get("width")||null==t.get("height")||t.get("layout"))&&t.markDirtyBounds(),this.get("focusable")&&this.isFocus()&&this.markDirtyAccessibility()}}},{key:"markDirtyAccessibility",value:function(){this._root._invalidateAccessibility(this)}},{key:"markDirtyLayer",value:function(){this._display.markDirtyLayer(!0)}},{key:"markDirty",value:function(){Object(r.a)(Object(o.a)(i.prototype),"markDirty",this).call(this),this.markDirtyLayer()}},{key:"_updateBounds",value:function(){var e,t=this._adjustedLocalBounds;if(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?(this._getBounds(),this._fixMinBounds(this._localBounds),this.updatePivotPoint(),this._adjustedLocalBounds=this._display.getAdjustedBounds(this._localBounds),e=this._adjustedLocalBounds):(e={left:0,right:0,top:0,bottom:0},this._localBounds=e,this._adjustedLocalBounds=e),!t||t.left!==e.left||t.top!==e.top||t.right!==e.right||t.bottom!==e.bottom){var i="boundschanged";this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this}),this.parent&&(this.parent.markDirty(),this.parent.markDirtyBounds())}}},{key:"_fixMinBounds",value:function(e){var t=this.get("minWidth",this.getPrivate("minWidth")),i=this.get("minHeight",this.getPrivate("minHeight"));O(t)&&e.right-e.left<t&&(e.right=e.left+t),O(i)&&e.bottom-e.top<i&&(e.bottom=e.top+i);var n=this.getPrivate("width"),a=this.getPrivate("height");O(n)&&(n>0?e.right=e.left+n:e.left=e.right+n),O(a)&&(a>0?e.bottom=e.top+a:e.top=e.bottom+a)}},{key:"_removeParent",value:function(e){e&&(e.children.removeValue(this),I(e._percentageSizeChildren,this),I(e._percentagePositionChildren,this))}},{key:"_clearDirty",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_clearDirty",this).call(this),this._sizeDirty=!1,this._statesHandled=!1}},{key:"hover",value:function(){this.showTooltip(),this._handleOver()}},{key:"unhover",value:function(){this.hideTooltip(),this._handleOut()}},{key:"showTooltip",value:function(e){var t=this.getTooltip(),i=this.get("tooltipText"),n=this.get("tooltipHTML");if((i||n)&&t){var a=this.get("tooltipPosition"),r=this.getPrivate("tooltipTarget",this);"fixed"!=a&&e||(this._display._setMatrix(),e=this.toGlobal(r._getTooltipPoint())),t.set("pointTo",e),t.set("tooltipTarget",r),t.get("x")||t.set("x",e.x),t.get("y")||t.set("y",e.y),i&&t.label.set("text",i),n&&t.label.set("html",n);var o=this.dataItem;if(o&&t.label._setDataItem(o),"always"==this.get("showTooltipOn")&&(e.x<0||e.x>this._root.width()||e.y<0||e.y>this._root.height()))return void this.hideTooltip();t.label.text.markDirtyText();var s=t.show();return this.setPrivateRaw("showingTooltip",!0),s}}},{key:"hideTooltip",value:function(){var e=this.getTooltip();if(e&&e.get("tooltipTarget")==this.getPrivate("tooltipTarget",this)){var t=e.get("keepTargetHover")&&0==e.get("stateAnimationDuration",0)?400:void 0,i=e.hide(t);return this.setPrivateRaw("showingTooltip",!1),i}}},{key:"_getTooltipPoint",value:function(){var e=this._localBounds;if(e){var t=0,i=0;return this.get("isMeasured")?(t=e.left+_e(this.get("tooltipX",0),e.right-e.left),i=e.top+_e(this.get("tooltipY",0),e.bottom-e.top)):(t=_e(this.get("tooltipX",0),this.width()),i=_e(this.get("tooltipY",0),this.height())),{x:t,y:i}}return{x:0,y:0}}},{key:"getTooltip",value:function(){var e=this.get("tooltip");if(e)return e;var t=this.parent;return t?t.getTooltip():void 0}},{key:"_updatePosition",value:function(){var e=this.parent,t=this.get("dx",0),i=this.get("dy",0),n=this.get("x"),a=this.getPrivate("x"),r=0,o=0,s=this.get("position");n instanceof Z&&(n=e?e.innerWidth()*n.value+e.get("paddingLeft",0):0),O(n)?r=n+t:null!=a?r=a:e&&"relative"==s&&(r=e.get("paddingLeft",0)+t);var l=this.get("y"),u=this.getPrivate("y");l instanceof Z&&(l=e?e.innerHeight()*l.value+e.get("paddingTop",0):0),O(l)?o=l+i:null!=u?o=u:e&&"relative"==s&&(o=e.get("paddingTop",0)+i);var c=this._display;if(c.x!=r||c.y!=o){c.invalidateBounds(),c.x=r,c.y=o;var d="positionchanged";this.events.isEnabled(d)&&this.events.dispatch(d,{type:d,target:this})}this.getPrivate("showingTooltip")&&this.showTooltip()}},{key:"x",value:function(){var e=this.get("x"),t=this.getPrivate("x"),i=this.parent;return i?e instanceof Z?_e(e,i.innerWidth())+i.get("paddingLeft",0):O(e)?e:null!=t?t:i.get("paddingLeft",this._display.x):this._display.x}},{key:"y",value:function(){var e=this.getPrivate("y");if(null!=e)return e;var t=this.get("y"),i=this.parent;return i?t instanceof Z?_e(t,i.innerHeight())+i.get("paddingTop",0):O(t)?t:null!=e?e:i.get("paddingTop",this._display.y):this._display.y}},{key:"_dispose",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_dispose",this).call(this),this._display.dispose(),this._removeTemplateField(),this._removeParent(this.parent),this._root._removeFocusElement(this);var e=this.get("tooltip");e&&e.dispose(),this.markDirty()}},{key:"adjustedLocalBounds",value:function(){return this._fixMinBounds(this._adjustedLocalBounds),this._adjustedLocalBounds}},{key:"localBounds",value:function(){return this._localBounds}},{key:"bounds",value:function(){var e=this._adjustedLocalBounds,t=this.x(),i=this.y();return{left:e.left+t,right:e.right+t,top:e.top+i,bottom:e.bottom+i}}},{key:"globalBounds",value:function(){var e=this.localBounds(),t=this.toGlobal({x:e.left,y:e.top}),i=this.toGlobal({x:e.right,y:e.top}),n=this.toGlobal({x:e.right,y:e.bottom}),a=this.toGlobal({x:e.left,y:e.bottom});return{left:Math.min(t.x,i.x,n.x,a.x),top:Math.min(t.y,i.y,n.y,a.y),right:Math.max(t.x,i.x,n.x,a.x),bottom:Math.max(t.y,i.y,n.y,a.y)}}},{key:"_onShow",value:function(e){}},{key:"_onHide",value:function(e){}},{key:"appear",value:function(e,t){return Object(f.b)(this,void 0,void 0,Object(s.a)().mark((function i(){var n=this;return Object(s.a)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.hide(0);case 2:return i.abrupt("return",t?new Promise((function(i,a){n.setTimeout((function(){i(n.show(e))}),t)})):this.show(e));case 3:case"end":return i.stop()}}),i,this)})))}},{key:"show",value:function(e){return Object(f.b)(this,void 0,void 0,Object(s.a)().mark((function t(){var i;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isShowing){t.next=6;break}return this._isHidden=!1,this._isShowing=!0,this._isHiding=!1,this.states.lookup("default").get("visible")&&this.set("visible",!0),this._onShow(e),i=this.states.applyAnimate("default",e),t.next=5,Ye(i);case 5:this._isShowing=!1;case 6:case"end":return t.stop()}}),t,this)})))}},{key:"hide",value:function(e){return Object(f.b)(this,void 0,void 0,Object(s.a)().mark((function t(){var i;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._isHiding||this._isHidden){t.next=8;break}return this._isHiding=!0,this._isShowing=!1,this.states.lookup("hidden")||this.states.create("hidden",{opacity:0,visible:!1}),this._isHidden=!0,this._onHide(e),i=this.states.applyAnimate("hidden",e),t.next=7,Ye(i);case 7:this._isHiding=!1;case 8:case"end":return t.stop()}}),t,this)})))}},{key:"isHidden",value:function(){return this._isHidden}},{key:"isShowing",value:function(){return this._isShowing}},{key:"isHiding",value:function(){return this._isHiding}},{key:"isHover",value:function(){return this._display.hovering()}},{key:"isFocus",value:function(){return this._root.focused(this)}},{key:"isDragging",value:function(){return this._isDragging}},{key:"isVisible",value:function(){return!(!this.get("visible")||!this.getPrivate("visible")||this.get("forceHidden"))}},{key:"isVisibleDeep",value:function(){return this._parent?this._parent.isVisibleDeep()&&this.isVisible():this.isVisible()}},{key:"compositeOpacity",value:function(){var e=this.get("opacity",1);return this._parent?this._parent.compositeOpacity()*e:e}},{key:"width",value:function(){var e=this.get("width"),t=this.get("maxWidth",this.getPrivate("maxWidth")),i=this.get("minWidth",this.getPrivate("minWidth")),n=this.getPrivate("width"),a=0;if(O(n))a=n;else if(null==e)this._adjustedLocalBounds&&(a=this._adjustedLocalBounds.right-this._adjustedLocalBounds.left);else if(e instanceof Z){var r=this.parent;a=r?r.innerWidth()*e.value:this._root.width()*e.value}else O(e)&&(a=e);return O(i)&&(a=Math.max(i,a)),O(t)&&(a=Math.min(t,a)),a}},{key:"maxWidth",value:function(){var e=this.get("maxWidth",this.getPrivate("maxWidth"));if(O(e))return e;var t=this.get("width");if(O(t))return t;var i=this.parent;return i?i.innerWidth():this._root.width()}},{key:"maxHeight",value:function(){var e=this.get("maxHeight",this.getPrivate("maxHeight"));if(O(e))return e;var t=this.get("height");if(O(t))return t;var i=this.parent;return i?i.innerHeight():this._root.height()}},{key:"height",value:function(){var e=this.get("height"),t=this.get("maxHeight",this.getPrivate("maxHeight")),i=this.get("minHeight",this.getPrivate("minHeight")),n=this.getPrivate("height"),a=0;if(O(n))a=n;else if(null==e)this._adjustedLocalBounds&&(a=this._adjustedLocalBounds.bottom-this._adjustedLocalBounds.top);else if(e instanceof Z){var r=this.parent;a=r?r.innerHeight()*e.value:this._root.height()*e.value}else O(e)&&(a=e);return O(i)&&(a=Math.max(i,a)),O(t)&&(a=Math.min(t,a)),a}},{key:"_findStaticTemplate",value:function(e){return this._templateField&&e(this._templateField)?this._templateField:Object(r.a)(Object(o.a)(i.prototype),"_findStaticTemplate",this).call(this,e)}},{key:"_walkParents",value:function(e){this._parent&&this._walkParent(e)}},{key:"_walkParent",value:function(e){this._parent&&this._parent._walkParent(e),e(this)}},{key:"parent",get:function(){return this._parent}},{key:"_setParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._parent;e!==i&&(this.markDirtyBounds(),e.markDirty(),this._parent=e,t&&(this._removeParent(i),e&&(this._addPercentageSizeChildren(),this._addPercentagePositionChildren())),this.markDirtyPosition(),this._applyThemes())}},{key:"getNumberFormatter",value:function(){return this.get("numberFormatter",this._root.numberFormatter)}},{key:"getDateFormatter",value:function(){return this.get("dateFormatter",this._root.dateFormatter)}},{key:"getDurationFormatter",value:function(){return this.get("durationFormatter",this._root.durationFormatter)}},{key:"toGlobal",value:function(e){return this._display.toGlobal(e)}},{key:"toLocal",value:function(e){return this._display.toLocal(e)}},{key:"_getDownPoint",value:function(){var e=this._getDownPointId();if(e)return this._downPoints[e]}},{key:"_getDownPointId",value:function(){if(this._downPoints)return function(e,t){return ee(e).sort(t)}(this._downPoints,(function(e,t){return e>t?1:e<t?-1:0}))[0]}},{key:"toFront",value:function(){var e=this.parent;e&&e.children.moveValue(this,e.children.length-1)}},{key:"toBack",value:function(){var e=this.parent;e&&e.children.moveValue(this,0)}}]),i}(jt);Object.defineProperty(Ct,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sprite"}),Object.defineProperty(Ct,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jt.classNames.concat([Ct.className])});var At=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeGraphics()}),Object.defineProperty(Object(l.a)(e),"_backgroundDisplay",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeGraphics()}),Object.defineProperty(Object(l.a)(e),"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(Object(l.a)(e),"_pattern",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return Object(h.a)(i,[{key:"_afterNew",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_afterNewApplyThemes",this).call(this)}},{key:"pattern",get:function(){return this._pattern}},{key:"_draw",value:function(){}},{key:"_beforeChanged",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("repetition")||this.isDirty("width")||this.isDirty("height")||this.isDirty("rotation")||this.isDirty("color")||this.isDirty("strokeWidth")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("colorOpacity")||this.isDirty("fill")||this.isDirty("fillOpacity"))&&(this._clear=!0)}},{key:"_changed",value:function(){if(Object(r.a)(Object(o.a)(i.prototype),"_changed",this).call(this),this._clear){var e=this.get("repetition",""),t=this.get("width",100),n=this.get("height",100),a=this.get("fill"),s=this.get("fillOpacity",1);this._display.clear(),this._backgroundDisplay.clear(),a&&s>0&&(this._backgroundDisplay.beginFill(a,s),this._backgroundDisplay.drawRect(0,0,t,n),this._backgroundDisplay.endFill()),this._display.angle=this.get("rotation",0),this._draw(),this._pattern=this._root._renderer.createPattern(this._display,this._backgroundDisplay,e,t,n)}}}]),i}(jt);Object.defineProperty(At,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Pattern"}),Object.defineProperty(At,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jt.classNames.concat([At.className])});var Tt,It,Dt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return Object(h.a)(i,[{key:"_beforeChanged",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_beforeChanged",this).call(this),this._clear=!0,this.isDirty("src")&&this._load()}},{key:"_draw",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_draw",this).call(this);var e=this._image;if(e){var t=this.get("width",100),n=this.get("height",100),a=this.get("fit","image"),s=0,l=0;"pattern"==a?(s=t,l=n):(s=e.width,l=e.height,"image"==a&&(this.set("width",s),this.set("height",l)));var u=0,c=0;this.get("centered",!0)&&(u=t/2-s/2,c=n/2-l/2),this._display.image(e,s,l,u,c)}}},{key:"_load",value:function(){var e=this,t=this.get("src");if(t){var i=new Image;i.src=t,i.decode().then((function(){e._image=i,e._draw(),e.events.isEnabled("loaded")&&e.events.dispatch("loaded",{type:"loaded",target:e})})).catch((function(e){}))}}}]),i}(At);Object.defineProperty(Dt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PicturePattern"}),Object.defineProperty(Dt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:At.classNames.concat([Dt.className])}),(It=Tt||(Tt={})).ADD="lighter",It.COLOR="color",It.COLOR_BURN="color-burn",It.COLOR_DODGE="color-dodge",It.DARKEN="darken",It.DIFFERENCE="difference",It.DST_OVER="destination-over",It.EXCLUSION="exclusion",It.HARD_LIGHT="hard-light",It.HUE="hue",It.LIGHTEN="lighten",It.LUMINOSITY="luminosity",It.MULTIPLY="multiply",It.NORMAL="source-over",It.OVERLAY="overlay",It.SATURATION="saturation",It.SCREEN="screen",It.SOFT_LIGHT="soft-light",It.SRC_ATOP="source-atop",It.XOR="xor";var Ft=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","fillPattern","strokePattern","fillGradient","strokeGradient","strokeDasharray","strokeDashoffset"],Et=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeGraphics()}),Object.defineProperty(Object(l.a)(e),"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e}return Object(h.a)(i,[{key:"_beforeChanged",value:function(){var e=this;if(Object(r.a)(Object(o.a)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("draw")||this.isDirty("svgPath"))&&this.markDirtyBounds(),(this.isDirty("fill")||this.isDirty("stroke")||this.isDirty("visible")||this.isDirty("forceHidden")||this.isDirty("scale")||this.isDirty("fillGradient")||this.isDirty("strokeGradient")||this.isDirty("fillPattern")||this.isDirty("strokePattern")||this.isDirty("fillOpacity")||this.isDirty("strokeOpacity")||this.isDirty("strokeWidth")||this.isDirty("draw")||this.isDirty("blendMode")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("svgPath")||this.isDirty("lineJoin")||this.isDirty("shadowColor")||this.isDirty("shadowBlur")||this.isDirty("shadowOffsetX")||this.isDirty("shadowOffsetY"))&&(this._clear=!0),this._display.crisp=this.get("crisp",!1),this.isDirty("fillGradient")){var t=this.get("fillGradient");if(t){this._display.isMeasured=!0;var n=t.get("target");n&&(this._disposers.push(n.events.on("boundschanged",(function(){e._markDirtyKey("fill")}))),this._disposers.push(n.events.on("positionchanged",(function(){e._markDirtyKey("fill")}))))}}if(this.isDirty("strokeGradient")){var a=this.get("strokeGradient");if(a){this._display.isMeasured=!0;var s=a.get("target");s&&(this._disposers.push(s.events.on("boundschanged",(function(){e._markDirtyKey("stroke")}))),this._disposers.push(s.events.on("positionchanged",(function(){e._markDirtyKey("stroke")}))))}}}},{key:"_changed",value:function(){if(Object(r.a)(Object(o.a)(i.prototype),"_changed",this).call(this),this._clear){this.markDirtyBounds(),this.markDirtyLayer(),this._display.clear();var e=this.get("strokeDasharray");O(e)&&(e=e<.5?[0]:[e]),this._display.setLineDash(e);var t=this.get("strokeDashoffset");t&&this._display.setLineDashOffset(t);var n=this.get("blendMode",Tt.NORMAL);this._display.blendMode=n;var a=this.get("draw");a&&a(this._display,this);var s=this.get("svgPath");null!=s&&this._display.svgPath(s)}}},{key:"_afterChanged",value:function(){var e=this;if(Object(r.a)(Object(o.a)(i.prototype),"_afterChanged",this).call(this),this._clear){var t=this.get("fill"),n=this.get("fillGradient"),a=this.get("fillPattern"),s=this.get("fillOpacity"),l=this.get("stroke"),u=this.get("strokeGradient"),c=this.get("strokePattern"),d=this.get("shadowColor"),h=this.get("shadowBlur"),f=this.get("shadowOffsetX"),b=this.get("shadowOffsetY"),p=this.get("shadowOpacity");if(d&&(h||f||b)&&this._display.shadow(d,h,f,b,p),a){var v=!1;!t||a.get("fill")&&!a.get("fillInherited")||(a.set("fill",t),a.set("fillInherited",!0),v=!0),!l||a.get("color")&&!a.get("colorInherited")||(a.set("color",l),a.set("colorInherited",!0),v=!0),v&&a._changed();var y=a.pattern;y&&(this._display.beginFill(y,s),this._display.endFill(),a instanceof Dt&&a.events.once("loaded",(function(){e._clear=!0,e.markDirty()})))}else if(n){if(t){var g=n.get("stops",[]);g.length&&P(g,(function(e){e.color&&!e.colorInherited||!t||(e.color=t,e.colorInherited=!0),(null==e.opacity||e.opacityInherited)&&(e.opacity=s,e.opacityInherited=!0)}))}var m=n.getFill(this);m&&(this._display.beginFill(m,s),this._display.endFill())}else t&&(this._display.beginFill(t,s),this._display.endFill());if(l||u||c){var _=this.get("strokeOpacity"),O=this.get("strokeWidth",1);this.get("nonScalingStroke")&&(O/=this.get("scale",1)),this.get("crisp")&&(O/=this._root._renderer.resolution);var j=this.get("lineJoin");if(c){var w=!1;!l||c.get("color")&&!c.get("colorInherited")||(c.set("color",l),c.set("colorInherited",!0),w=!0),w&&c._changed();var k=c.pattern;k&&(this._display.lineStyle(O,k,_,j),this._display.endStroke(),c instanceof Dt&&c.events.once("loaded",(function(){e._clear=!0,e.markDirty()})))}else if(u){var x=u.get("stops",[]);x.length&&P(x,(function(e){e.color&&!e.colorInherited||!l||(e.color=l,e.colorInherited=!0),(null==e.opacity||e.opacityInherited)&&(e.opacity=_,e.opacityInherited=!0)}));var M=u.getFill(this);M&&(this._display.lineStyle(O,M,_,j),this._display.endStroke())}else l&&(this._display.lineStyle(O,l,_,j),this._display.endStroke())}this.getPrivate("showingTooltip")&&this.showTooltip()}this._clear=!1}}]),i}(Ct);Object.defineProperty(Et,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Graphics"}),Object.defineProperty(Et,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ct.classNames.concat([Et.className])});var St=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){return Object(d.a)(this,i),t.apply(this,arguments)}return Object(h.a)(i,[{key:"_beforeChanged",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_beforeChanged",this).call(this),(this.isDirty("width")||this.isDirty("height")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}},{key:"_changed",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_changed",this).call(this),this._clear&&!this.get("draw")&&this._draw()}},{key:"_draw",value:function(){this._display.drawRect(0,0,this.width(),this.height())}},{key:"_updateSize",value:function(){this.markDirty(),this._clear=!0}}]),i}(Et);function Lt(e,t){e.get("reverseChildren",!1)?e.children.eachReverse(t):e.children.each(t)}Object.defineProperty(St,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Rectangle"}),Object.defineProperty(St,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Et.classNames.concat([St.className])});var Bt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){return Object(d.a)(this,i),t.apply(this,arguments)}return Object(h.a)(i)}(jt);Object.defineProperty(Bt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Layout"}),Object.defineProperty(Bt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jt.classNames.concat([Bt.className])});var Rt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){return Object(d.a)(this,i),t.apply(this,arguments)}return Object(h.a)(i,[{key:"updateContainer",value:function(e){var t=e.get("paddingLeft",0),i=e.innerWidth(),n=0;Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("width");if(t instanceof Z){n+=t.value;var a=i*t.value,r=e.get("minWidth",e.getPrivate("minWidth",-1/0));r>a&&(i-=r,n-=t.value);var o=e.get("maxWidth",e.getPrivate("maxWidth",1/0));a>o&&(i-=o,n-=t.value)}else O(t)||(t=e.width()),i-=t+e.get("marginLeft",0)+e.get("marginRight",0)}})),(i<=0||i==1/0)&&(i=.1),Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("width");if(t instanceof Z){var a=i*t.value/n-e.get("marginLeft",0)-e.get("marginRight",0),r=e.get("minWidth",e.getPrivate("minWidth",-1/0)),o=e.get("maxWidth",e.getPrivate("maxWidth",1/0));a=Math.min(Math.max(r,a),o),e.setPrivate("width",a)}}}));var a=t;Lt(e,(function(e){if("relative"==e.get("position"))if(e.isVisible()){var t=e.adjustedLocalBounds(),i=e.get("marginLeft",0),n=e.get("marginRight",0),r=e.get("maxWidth"),o=t.left,s=t.right;r&&s-o>r&&(s=o+r);var l=a+i-o;e.setPrivate("x",l),a=l+s+n}else e.setPrivate("x",void 0)}))}}]),i}(Bt);Object.defineProperty(Rt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"HorizontalLayout"}),Object.defineProperty(Rt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Bt.classNames.concat([Rt.className])});var Nt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){return Object(d.a)(this,i),t.apply(this,arguments)}return Object(h.a)(i,[{key:"updateContainer",value:function(e){var t=e.get("paddingTop",0),i=e.innerHeight(),n=0;Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("height");if(t instanceof Z){n+=t.value;var a=i*t.value,r=e.get("minHeight",e.getPrivate("minHeight",-1/0));r>a&&(i-=r,n-=t.value);var o=e.get("maxHeight",e.getPrivate("maxHeight",1/0));a>o&&(i-=o,n-=t.value)}else O(t)||(t=e.height()),i-=t+e.get("marginTop",0)+e.get("marginBottom",0)}})),(i<=0||i==1/0)&&(i=.1),Lt(e,(function(e){if(e.isVisible()&&"relative"==e.get("position")){var t=e.get("height");if(t instanceof Z){var a=i*t.value/n-e.get("marginTop",0)-e.get("marginBottom",0),r=e.get("minHeight",e.getPrivate("minHeight",-1/0)),o=e.get("maxHeight",e.getPrivate("maxHeight",1/0));a=Math.min(Math.max(r,a),o),e.setPrivate("height",a)}}}));var a=t;Lt(e,(function(e){if("relative"==e.get("position"))if(e.isVisible()){var t=e.adjustedLocalBounds(),i=e.get("marginTop",0),n=t.top,r=t.bottom,o=e.get("maxHeight");o&&r-n>o&&(r=n+o);var s=e.get("marginBottom",0),l=a+i-n;e.setPrivate("y",l),a=l+r+s}else e.setPrivate("y",void 0)}))}}]),i}(Bt);Object.defineProperty(Nt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"VerticalLayout"}),Object.defineProperty(Nt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Bt.classNames.concat([Nt.className])});var zt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){return Object(d.a)(this,i),t.apply(this,arguments)}return Object(h.a)(i,[{key:"_afterNew",value:function(){this._setRawDefault("maxColumns",Number.MAX_VALUE),Object(r.a)(Object(o.a)(i.prototype),"_afterNew",this).call(this)}},{key:"updateContainer",value:function(e){var t=e.get("paddingLeft",0),i=e.get("paddingRight",0),n=e.get("paddingTop",0),a=e.maxWidth()-t-i,r=a,o=1;Lt(e,(function(e){if(e.get("visible")&&e.getPrivate("visible")&&!e.get("forceHidden")&&"absolute"!=e.get("position")){var t=e.width();t<r&&(r=t),t>o&&(o=t)}})),r=tt(r,1,a),o=tt(o,1,a);var s=1;s=this.get("fixedWidthGrid")?a/o:a/r,s=Math.max(1,Math.floor(s)),s=Math.min(this.get("maxColumns",Number.MAX_VALUE),s);var l=this.getColumnWidths(e,s,o,a),u=n,c=0,d=0;s=l.length;var h=t;Lt(e,(function(e){if("relative"==e.get("position")&&e.isVisible()){var i=e.get("marginTop",0),n=e.get("marginBottom",0),a=e.adjustedLocalBounds(),r=e.get("marginLeft",0),o=e.get("marginRight",0),f=h+r-a.left,b=u+i-a.top;e.setPrivate("x",f),e.setPrivate("y",b),h+=l[c]+o,d=Math.max(d,e.height()+i+n),++c>=s&&(c=0,h=t,u+=d)}}))}},{key:"getColumnWidths",value:function(e,t,i,n){var a=this,r=0,o=[],s=0;return Lt(e,(function(n){var r=n.adjustedLocalBounds();"absolute"!=n.get("position")&&n.isVisible()&&(a.get("fixedWidthGrid")?o[s]=i:o[s]=Math.max(0|o[s],r.right-r.left+n.get("marginLeft",0)+n.get("marginRight",0)),s<e.children.length-1&&(++s==t&&(s=0)))})),P(o,(function(e){r+=e})),r>n?t>2?(t-=1,this.getColumnWidths(e,t,i,n)):[n]:o}}]),i}(Bt);Object.defineProperty(zt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"GridLayout"}),Object.defineProperty(zt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Bt.classNames.concat([zt.className])});var Ht=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"escape",value:function(e){return e.replace(/\[\[/g,this.prefix+"1").replace(/([^\/\]]{1})\]\]/g,"$1"+this.prefix+"2").replace(/\]\]/g,this.prefix+"2").replace(/\{\{/g,this.prefix+"3").replace(/\}\}/g,this.prefix+"4").replace(/\'\'/g,this.prefix+"5")}},{key:"unescape",value:function(e){return e.replace(new RegExp(this.prefix+"1","g"),"[[").replace(new RegExp(this.prefix+"2","g"),"]]").replace(new RegExp(this.prefix+"3","g"),"{{").replace(new RegExp(this.prefix+"4","g"),"}}").replace(new RegExp(this.prefix+"5","g"),"''")}},{key:"cleanUp",value:function(e){return e.replace(/\[\[/g,"[").replace(/\]\]/g,"]").replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\'\'/g,"'")}},{key:"chunk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];e=this.escape(e);for(var a=t?e.split("'"):[e],r=0;r<a.length;r++){var o=a[r];if(""!==o)if(r%2==0)for(var s=(o=(o=o.replace(/\]\[/g,"]"+w+"[")).replace(/\[\]/g,"[ ]")).split(/[\[\]]+/),l=0;l<s.length;l++){var u=this.cleanUp(this.unescape(s[l]));u!==w&&""!==u&&(l%2==0?n.push({type:"value",text:u}):n.push({type:i?"value":"format",text:"["+u+"]"}))}else for(var c=o.split(/[\[\]]+/),d=0;d<c.length;d++){var h=this.cleanUp(this.unescape(c[d]));""!==h&&(d%2==0?n.push({type:"text",text:h}):this.isImage(h)?n.push({type:"image",text:"["+h+"]"}):n.push({type:"format",text:"["+h+"]"}))}}return n}},{key:"isImage",value:function(e){return!!e.match(/img[ ]?:/)}},{key:"getTextStyle",value:function(e){var t={};if(""==e||"[ ]"==e)return{};var i=e.match(/('[^']*')|("[^"]*")/gi);if(i)for(var n=0;n<i.length;n++)e=e.replace(i[n],i[n].replace(/['"]*/g,"").replace(/[ ]+/g,"+"));var a=e.match(/([\w\-]*:[\s]?[^;\s\]]*)|(\#[\w]{1,6})|([\w\-]+)|(\/)/gi);if(!a)return{};for(var r=0;r<a.length;r++)if(a[r].match(/^(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)$/i))t.fontWeight=a[r];else if(a[r].match(/^(underline|line-through)$/i))t.textDecoration=a[r];else if("/"==a[r]);else if(a[r].match(/:/)){var o=a[r].replace("+"," ").split(/:[ ]*/);t[o[0]]=o[1]}else t.fill=Ue.fromString(a[r]);return t}}]),e}();function Vt(e,t){if(null!=t){t=""+t;var i,n=(t=Ht.escape(t)).match(/\{([^}]+)\}/g);if(n)for(i=0;i<n.length;i++){var a=Wt(e,n[i].replace(/\{([^}]+)\}/,"$1"));null==a&&(a=""),t=t.split(n[i]).join(a)}t=Ht.unescape(t)}else t="";return t}function Wt(e,t,i){for(var n,a,r=e.dataItem,o=[],s=/(format[a-zA-Z]*)\((.*)\)|([^.]+)/g;null!==(a=s.exec(t));)if(a[3]){o.push({prop:a[3]});var l=e.getDateFormatter().get("dateFields",[]),u=e.getNumberFormatter().get("numericFields",[]),c=e.getDurationFormatter().get("durationFields",[]);-1!==l.indexOf(a[3])?o.push({method:"formatDate",params:[]}):-1!==u.indexOf(a[3])?o.push({method:"formatNumber",params:[]}):-1!==c.indexOf(a[3])&&o.push({method:"formatDuration",params:[]})}else{var d=[];if(""!=we(a[2]))for(var h=void 0,f=/'([^']*)'|"([^"]*)"|([0-9\-]+)/g;null!==(h=f.exec(a[2]));)d.push(h[1]||h[2]||h[3]);o.push({method:a[1],params:d})}if(r){(null==(n=Yt(e,o,r._settings))||j(n))&&(n=Yt(e,o,r));var b=r.dataContext;null==n&&b&&(null==(n=Yt(e,o,b))&&(n=Yt(e,[{prop:t}],b)),null==n&&b.dataContext&&(n=Yt(e,o,b.dataContext))),null==n&&r.component&&r.component.dataItem!==r&&(n=Wt(r.component,t))}return null==n&&(n=Yt(e,o,e)),null==n&&e.parent&&(n=Wt(e.parent,t)),n}function Ut(e,t){var i=e.getPrivate("customData");if(j(i))return i[t]}function Yt(e,t,i,n){for(var a=i,r=!1,o=0,s=t.length;o<s;o++){var l=t[o];if(l.prop){if(a instanceof Ct){var u=a.get(l.prop);null==u&&(u=a.getPrivate(l.prop)),null==u&&(u=Ut(a,l.prop)),null==u&&(u=a[l.prop]),a=u}else if(a.get){var c=a.get(l.prop);null==c&&(c=a[l.prop]),a=c}else a=a[l.prop];if(null==a)return}else switch(l.method){case"formatNumber":var d=p(a);null!=d&&(a=e.getNumberFormatter().format(d,n||l.params[0]||void 0),r=!0);break;case"formatDate":var h=v(a);if(!m(h)||b(h.getTime()))return;null!=h&&(a=e.getDateFormatter().format(h,n||l.params[0]||void 0),r=!0);break;case"formatDuration":var f=p(a);null!=f&&(a=e.getDurationFormatter().format(f,n||l.params[0]||void 0,l.params[1]||void 0),r=!0);break;case"urlEncode":case"encodeURIComponent":a=encodeURIComponent(a);break;default:a[l.method]&&a[l.method].apply(i,l.params)}}if(!r){var y=[{method:"",params:n}];if(null==n)O(a)?(y[0].method="formatNumber",y[0].params=""):m(a)&&(y[0].method="formatDate",y[0].params="");else{var g=function(e){if(void 0===e)return"string";var t=(e=(e=(e=e.toLowerCase().replace(/^\[[^\]]*\]/,"")).replace(/\[[^\]]+\]/,"")).trim()).match(/\/(date|number|duration)$/);return t?t[1]:"number"===e?"number":"date"===e?"date":"duration"===e?"duration":e.match(/[#0]/)?"number":e.match(/[ymwdhnsqaxkzgtei]/)?"date":"string"}(n);"number"===g?y[0].method="formatNumber":"date"===g?y[0].method="formatDate":"duration"===g&&(y[0].method="formatDuration")}y[0].method&&(a=Yt(e,y,a))}return a}Object.defineProperty(Ht,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:"__amcharts__"});var qt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeContainer()}),Object.defineProperty(Object(l.a)(e),"_childrenDisplay",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeContainer()}),Object.defineProperty(Object(l.a)(e),"children",{enumerable:!0,configurable:!0,writable:!0,value:new K(Object(l.a)(e))}),Object.defineProperty(Object(l.a)(e),"_percentageSizeChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(l.a)(e),"_percentagePositionChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(Object(l.a)(e),"_prevWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(l.a)(e),"_prevHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(l.a)(e),"_contentWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(l.a)(e),"_contentHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(Object(l.a)(e),"_contentMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_vsbd0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_vsbd1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return Object(h.a)(i,[{key:"_afterNew",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_afterNew",this).call(this),this._display.addChild(this._childrenDisplay)}},{key:"_dispose",value:function(){C(this.allChildren(),(function(e){e.dispose()})),this.getPrivate("htmlElement")&&this._root._removeHTMLContent(this),Object(r.a)(Object(o.a)(i.prototype),"_dispose",this).call(this)}},{key:"_changed",value:function(){if(Object(r.a)(Object(o.a)(i.prototype),"_changed",this).call(this),this.isDirty("interactiveChildren")&&(this._display.interactiveChildren=this.get("interactiveChildren",!1)),this.isDirty("layout")&&(this._prevWidth=0,this._prevHeight=0,this.markDirtyBounds(),this._prevSettings.layout&&this.children.each((function(e){e.removePrivate("x"),e.removePrivate("y")}))),(this.isDirty("paddingTop")||this.isDirty("paddingBottom")||this.isDirty("paddingLeft")||this.isDirty("paddingRight"))&&this.children.each((function(e){e.markDirtyPosition()})),this.isDirty("maskContent")){var e=this._childrenDisplay,t=this._contentMask;this.get("maskContent")?t||(t=St.new(this._root,{x:-.5,y:-.5,width:this.width()+1,height:this.height()+1}),this._contentMask=t,e.addChildAt(t._display,0),e.mask=t._display):t&&(e.removeChild(t._display),e.mask=null,t.dispose(),this._contentMask=void 0)}}},{key:"_updateSize",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_updateSize",this).call(this),P(this._percentageSizeChildren,(function(e){e._updateSize()})),P(this._percentagePositionChildren,(function(e){e.markDirtyPosition(),e._updateSize()})),this.updateBackground()}},{key:"updateBackground",value:function(){var e=this.get("background"),t=this._localBounds;if(t&&!this.isHidden()){var i=t.left,n=t.top,a=t.right-i,r=t.bottom-n,o=this.get("maxWidth"),s=this.get("maxHeight");s&&r>s&&(r=s),o&&a>o&&(a=o);var l=this.width(),u=this.height();e&&(e.setAll({width:a,height:r,x:i,y:n}),this._display.interactive&&(e._display.interactive=!0));var c=this._contentMask;c&&c.setAll({width:l+1,height:u+1});var d=this.get("verticalScrollbar");if(d){d.set("height",u),d.set("x",l-d.width()-d.get("marginRight",0)),d.set("end",d.get("start",0)+u/this._contentHeight);var h=d.get("background");h&&h.setAll({width:d.width(),height:u});var f=!0;this._contentHeight<=u&&(f=!1),d.setPrivate("visible",f)}}}},{key:"_applyThemes",value:function(){return!!Object(r.a)(Object(o.a)(i.prototype),"_applyThemes",this).call(this)&&(this.eachChildren((function(e){e._applyThemes()})),!0)}},{key:"_applyState",value:function(e){Object(r.a)(Object(o.a)(i.prototype),"_applyState",this).call(this,e),this.get("setStateOnChildren")&&this.eachChildren((function(t){t.states.apply(e)}))}},{key:"_applyStateAnimated",value:function(e,t){Object(r.a)(Object(o.a)(i.prototype),"_applyStateAnimated",this).call(this,e,t),this.get("setStateOnChildren")&&this.eachChildren((function(i){i.states.applyAnimate(e,t)}))}},{key:"innerWidth",value:function(){return this.width()-this.get("paddingRight",0)-this.get("paddingLeft",0)}},{key:"innerHeight",value:function(){return this.height()-this.get("paddingTop",0)-this.get("paddingBottom",0)}},{key:"_getBounds",value:function(){var e=this.get("width"),t=this.get("height"),i=this.getPrivate("width"),n=this.getPrivate("height"),a={left:0,top:0,right:this.width(),bottom:this.height()},r=this.get("layout"),o=!1,s=!1;if((r instanceof Rt||r instanceof zt)&&(o=!0),r instanceof Nt&&(s=!0),null==e&&null==i||null==t&&null==n||this.get("verticalScrollbar")){var l=Number.MAX_VALUE,u=l,c=-l,d=l,h=-l,f=this.get("paddingLeft",0),b=this.get("paddingTop",0),p=this.get("paddingRight",0),v=this.get("paddingBottom",0);this.children.each((function(e){if("absolute"!=e.get("position")&&e.get("isMeasured")){var t=e.adjustedLocalBounds(),i=e.x(),n=e.y(),a=i+t.left,r=i+t.right,l=n+t.top,f=n+t.bottom;o&&(a-=e.get("marginLeft",0),r+=e.get("marginRight",0)),s&&(l-=e.get("marginTop",0),f+=e.get("marginBottom",0)),a<u&&(u=a),r>c&&(c=r),l<d&&(d=l),f>h&&(h=f)}})),u==l&&(u=0),c==-l&&(c=0),d==l&&(d=0),h==-l&&(h=0),a.left=u-f,a.top=d-b,a.right=c+p,a.bottom=h+v}this._contentWidth=a.right-a.left,this._contentHeight=a.bottom-a.top,O(e)&&(a.left=0,a.right=e),O(i)&&(a.left=0,a.right=i),O(t)&&(a.top=0,a.bottom=t),O(n)&&(a.top=0,a.bottom=n),this._localBounds=a}},{key:"_updateBounds",value:function(){var e=this.get("layout");e&&e.updateContainer(this),Object(r.a)(Object(o.a)(i.prototype),"_updateBounds",this).call(this),this.updateBackground()}},{key:"markDirty",value:function(){Object(r.a)(Object(o.a)(i.prototype),"markDirty",this).call(this),this._root._addDirtyParent(this)}},{key:"_prepareChildren",value:function(){var e=this.innerWidth(),t=this.innerHeight();if(e!=this._prevWidth||t!=this._prevHeight){var i=this.get("layout"),n=!1,a=!1;i&&((i instanceof Rt||i instanceof zt)&&(n=!0),i instanceof Nt&&(a=!0)),P(this._percentageSizeChildren,(function(i){if(!n){var r=i.get("width");r instanceof Z&&i.setPrivate("width",r.value*e)}if(!a){var o=i.get("height");o instanceof Z&&i.setPrivate("height",o.value*t)}})),P(this._percentagePositionChildren,(function(e){e.markDirtyPosition(),e.markDirtyBounds()})),this._prevWidth=e,this._prevHeight=t,this._sizeDirty=!0,this.updateBackground()}this._handleStates()}},{key:"_updateChildren",value:function(){var e=this;if(this.isDirty("html")){var t=this.get("html");t&&""!==t?this._root._setHTMLContent(this,Vt(this,this.get("html",""))):this._root._removeHTMLContent(this),this._root._positionHTMLElement(this)}if(this.isDirty("verticalScrollbar")){var i=this.get("verticalScrollbar");if(i){i._setParent(this),i.children.removeValue(i.startGrip),i.children.removeValue(i.endGrip),this.set("maskContent",!0),this.set("paddingRight",i.width()+i.get("marginRight",0)+i.get("marginLeft",0));var n=this.get("background");n||(n=this.set("background",St.new(this._root,{themeTags:["background"],fillOpacity:0,fill:this._root.interfaceColors.get("alternativeBackground")}))),this._vsbd0=this.events.on("wheel",(function(t){var n=t.originalEvent;if(ye(n,e)){n.preventDefault();var a=n.deltaY/5e3,r=i.get("start",0),o=i.get("end",1);r+a<=0&&(a=-r),o+a>=1&&(a=1-o),r+a>=0&&o+a<=1&&(i.set("start",r+a),i.set("end",o+a))}})),this._disposers.push(this._vsbd0),this._vsbd1=i.events.on("rangechanged",(function(){var t=e._contentHeight,n=e._childrenDisplay,a=e._contentMask;n.y=-i.get("start")*t,n.markDirtyLayer(),a&&(a._display.y=-n.y,n.mask=a._display)})),this._disposers.push(this._vsbd1),this._display.addChild(i._display)}else{var a=this._prevSettings.verticalScrollbar;a&&(this._display.removeChild(a._display),this._vsbd0&&this._vsbd0.dispose(),this._vsbd1&&this._vsbd1.dispose(),this._childrenDisplay.y=0,this.setPrivate("height",void 0),this.set("maskContent",!1),this.set("paddingRight",void 0))}}if(this.isDirty("background")){var r=this._prevSettings.background;r&&this._display.removeChild(r._display);var o=this.get("background");o instanceof Ct&&(o.set("isMeasured",!1),o._setParent(this),this._display.addChildAt(o._display,0))}if(this.isDirty("mask")){var s=this.get("mask"),l=this._prevSettings.mask;if(l&&(this._display.removeChild(l._display),l!=s&&l.dispose()),s){var u=s.parent;u&&u.children.removeValue(s),s._setParent(this),this._display.addChildAt(s._display,0),this._childrenDisplay.mask=s._display}}}},{key:"_processTemplateField",value:function(){Object(r.a)(Object(o.a)(i.prototype),"_processTemplateField",this).call(this),this.children.each((function(e){e._processTemplateField()}))}},{key:"walkChildren",value:function(e){this.children.each((function(t){t instanceof i&&t.walkChildren(e),e(t)}))}},{key:"eachChildren",value:function(e){var t=this.get("background");t&&e(t);var i=this.get("verticalScrollbar");i&&e(i);var n=this.get("mask");n&&e(n),this.children.values.forEach((function(t){e(t)}))}},{key:"allChildren",value:function(){var e=[];return this.eachChildren((function(t){e.push(t)})),e}},{key:"_setDataItem",value:function(e){var t=e!==this._dataItem;Object(r.a)(Object(o.a)(i.prototype),"_setDataItem",this).call(this,e);var n=this.get("html","");n&&""!==n&&t&&this._root._setHTMLContent(this,Vt(this,n))}}]),i}(Ct);Object.defineProperty(qt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Container"}),Object.defineProperty(qt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ct.classNames.concat([qt.className])});var Gt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"textStyle",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeTextStyle()}),Object.defineProperty(Object(l.a)(e),"_display",{enumerable:!0,configurable:!0,writable:!0,value:e._root._renderer.makeText("",e.textStyle)}),Object.defineProperty(Object(l.a)(e),"_textStyles",{enumerable:!0,configurable:!0,writable:!0,value:["textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale"]}),Object.defineProperty(Object(l.a)(e),"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return Object(h.a)(i,[{key:"_updateBounds",value:function(){if(this.get("text"))Object(r.a)(Object(o.a)(i.prototype),"_updateBounds",this).call(this);else{this._adjustedLocalBounds={left:0,right:0,top:0,bottom:0}}}},{key:"_changed",value:function(){var e=this;Object(r.a)(Object(o.a)(i.prototype),"_changed",this).call(this),this._display.clear();var t=this.textStyle;if(this.isDirty("opacity")){var n=this.get("opacity",1);this._display.alpha=n}if((this.isDirty("text")||this.isDirty("populateText"))&&(this._display.text=this._getText(),this.markDirtyBounds(),"tooltip"==this.get("role")&&this._root.updateTooltip(this)),this.isPrivateDirty("tooltipElement")&&this.getPrivate("tooltipElement")&&this._disposers.push(new z((function(){e._root._removeTooltipElement(e)}))),this.isDirty("width")&&(t.wordWrapWidth=this.width(),this.markDirtyBounds()),this.isDirty("oversizedBehavior")&&(t.oversizedBehavior=this.get("oversizedBehavior","none"),this.markDirtyBounds()),this.isDirty("breakWords")&&(t.breakWords=this.get("breakWords",!1),this.markDirtyBounds()),this.isDirty("ellipsis")&&(t.ellipsis=this.get("ellipsis"),this.markDirtyBounds()),this.isDirty("ignoreFormatting")&&(t.ignoreFormatting=this.get("ignoreFormatting",!1),this.markDirtyBounds()),this.isDirty("minScale")&&(t.minScale=this.get("minScale",0),this.markDirtyBounds()),this.isDirty("fill")){var a=this.get("fill");a&&(t.fill=a)}if(this.isDirty("fillOpacity")){var s=this.get("fillOpacity",1);s&&(t.fillOpacity=s)}(this.isDirty("maxWidth")||this.isPrivateDirty("maxWidth"))&&(t.maxWidth=this.get("maxWidth",this.getPrivate("maxWidth")),this.markDirtyBounds()),(this.isDirty("maxHeight")||this.isPrivateDirty("maxHeight"))&&(t.maxHeight=this.get("maxHeight",this.getPrivate("maxHeight")),this.markDirtyBounds()),P(this._textStyles,(function(i){e._dirty[i]&&(t[i]=e.get(i),e.markDirtyBounds())})),t.fontSize=this.get("fontSize"),t.fontFamily=this.get("fontFamily"),this._display.style=t,this.isDirty("role")&&"tooltip"==this.get("role")&&this._root.updateTooltip(this)}},{key:"_getText",value:function(){var e=this.get("text","");return this.get("populateText")?Vt(this,e):e}},{key:"markDirtyText",value:function(){this._display.text=this._getText(),"tooltip"==this.get("role")&&this._root.updateTooltip(this),this.markDirtyBounds(),this.markDirty()}},{key:"_setDataItem",value:function(e){Object(r.a)(Object(o.a)(i.prototype),"_setDataItem",this).call(this,e),this.get("populateText")&&this.markDirtyText()}},{key:"getNumberFormatter",value:function(){return this.parent?this.parent.getNumberFormatter():Object(r.a)(Object(o.a)(i.prototype),"getNumberFormatter",this).call(this)}},{key:"getDateFormatter",value:function(){return this.parent?this.parent.getDateFormatter():Object(r.a)(Object(o.a)(i.prototype),"getDateFormatter",this).call(this)}},{key:"getDurationFormatter",value:function(){return this.parent?this.parent.getDurationFormatter():Object(r.a)(Object(o.a)(i.prototype),"getDurationFormatter",this).call(this)}}]),i}(Ct);Object.defineProperty(Gt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Text"}),Object.defineProperty(Gt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ct.classNames.concat([Gt.className])});var Xt=function(e){Object(u.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(d.a)(this,i),e=t.apply(this,arguments),Object.defineProperty(Object(l.a)(e),"_text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(Object(l.a)(e),"_textKeys",{enumerable:!0,configurable:!0,writable:!0,value:["text","fill","fillOpacity","textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","populateText","role","ignoreFormatting"]}),e}return Object(h.a)(i,[{key:"text",get:function(){return this._text}},{key:"_afterNew",value:function(){var e=this;Object(r.a)(Object(o.a)(i.prototype),"_afterNew",this).call(this),this._makeText(),P(this._textKeys,(function(t){var i=e.get(t);null!=i&&e._text.set(t,i)})),""!==this.get("html","")&&this._text.set("text",""),this.onPrivate("maxWidth",(function(){e._setMaxDimentions()})),this.onPrivate("maxHeight",(function(){e._setMaxDimentions()}))}},{key:"_makeText",value:function(){this._text=this.children.push(Gt.new(this._root,{}))}},{key:"_updateChildren",value:function(){var e=this;if(Object(r.a)(Object(o.a)(i.prototype),"_updateChildren",this).call(this),P(this._textKeys,(function(t){e._text.set(t,e.get(t))})),this.isDirty("maxWidth")&&this._setMaxDimentions(),this.isDirty("maxHeight")&&this._setMaxDimentions(),this.isDirty("rotation")&&this._setMaxDimentions(),""!==this.get("html","")?this._text.set("text",""):this._text.set("text",this.get("text")),this.isDirty("textAlign")||this.isDirty("width")){var t,n=this.get("textAlign");null!=this.get("width")?t="right"==n?Q:"center"==n?J:0:"left"==n||"start"==n?t=this.get("paddingLeft"):"right"!=n&&"end"!=n||(t=-this.get("paddingRight")),this.text.set("x",t)}}},{key:"_setMaxDimentions",value:function(){var e=this.get("rotation"),t=90==e||270==e||-90==e,i=this.get("maxWidth",this.getPrivate("maxWidth",1/0));O(i)?this.text.set(t?"maxHeight":"maxWidth",i-this.get("paddingLeft",0)-this.get("paddingRight",0)):this.text.set(t?"maxHeight":"maxWidth",void 0);var n=this.get("maxHeight",this.getPrivate("maxHeight",1/0));O(n)?this.text.set(t?"maxWidth":"maxHeight",n-this.get("paddingTop",0)-this.get("paddingBottom",0)):this.text.set(t?"maxWidth":"maxHeight",void 0)}},{key:"_setDataItem",value:function(e){Object(r.a)(Object(o.a)(i.prototype),"_setDataItem",this).call(this,e),this._markDirtyKey("text"),this.text.get("populateText")&&this.text.markDirtyText()}},{key:"getText",value:function(){return this._text._getText()}}]),i}(qt);Object.defineProperty(Xt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Label"}),Object.defineProperty(Xt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:qt.classNames.concat([Xt.className])});var Kt=function(){function e(t,i){if(Object(d.a)(this,e),Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._root=t,!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`")}return Object(h.a)(e,[{key:"setupDefaultRules",value:function(){}},{key:"_lookupRules",value:function(e){return this._rules[e]}},{key:"ruleRaw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this._rules[e];i||(i=this._rules[e]=[]),t.sort(pt);var n=function(e,t){for(var i=0,n=e.length,a=!1;i<n;){var r=i+n>>1,o=t(e[r]);o<0?i=r+1:0===o?(a=!0,i=r+1):n=r}return{found:a,index:a?i-1:i}}(i,(function(e){var i=pt(e.tags.length,t.length);return 0===i?vt(e.tags,t,pt):i})),a=n.index;if(n.found)return i[a].template;var r=Mt.new({});return i.splice(a,0,{tags:t,template:r}),r}},{key:"rule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.ruleRaw(e,t)}}],[{key:"new",value:function(e){var t=new this(e,!0);return t.setupDefaultRules(),t}}]),e}()},572:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return h}));var n=i(1),a=i(4),r=i(12),o=i(221),s=i(408),l=i(235),u=i(210);function c(e,t,i){return d.apply(this,arguments)}function d(){return d=Object(r.a)(Object(a.a)().mark((function e(t,i,n){var r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t,i,n);case 2:return r=e.sent,e.abrupt("return",l.a.fromJSON(r));case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function h(e,t,i){return f.apply(this,arguments)}function f(){return f=Object(r.a)(Object(a.a)().mark((function e(t,i,r){var l,c,d,h,f;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=Object(o.c)(t),c=Object(n.a)({},r),d=u.a.from(i),e.next=5,Object(s.a)(l,d,d.sourceSpatialReference,c);case 5:return h=e.sent,f=h.data,e.abrupt("return",f);case 8:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}},600:function(e,t,i){"use strict";function n(e){return"h"in e&&"s"in e&&"v"in e}function a(e){return"l"in e&&"a"in e&&"b"in e}function r(e){return"l"in e&&"c"in e&&"h"in e}function o(e){return"x"in e&&"y"in e&&"z"in e}i.d(t,"a",(function(){return y})),i.d(t,"b",(function(){return g})),i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return v}));var s=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],l=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function u(e,t){var i,n,a=[];if(e[0].length!==t.length)throw new Error("dimensions do not match");var r=e.length,o=e[0].length,s=0;for(i=0;i<r;i++){for(s=0,n=0;n<o;n++)s+=e[i][n]*t[n];a.push(s)}return a}function c(e){var t=[e.r/255,e.g/255,e.b/255].map((function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)})),i=u(s,t);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function d(e){var t=u(l,[e.x/100,e.y/100,e.z/100]).map((function(e){var t=e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function h(e){var t=[e.x/95.047,e.y/100,e.z/108.883].map((function(e){return e>Math.pow(6/29,3)?Math.pow(e,1/3):1/3*Math.pow(29/6,2)*e+4/29}));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function f(e){var t=e.l,i=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((function(e){return e>6/29?Math.pow(e,3):3*Math.pow(6/29,2)*(e-4/29)}));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function b(e){return function(e){var t=e.l,i=e.a,n=e.b,a=Math.sqrt(i*i+n*n),r=Math.atan2(n,i);return{l:t,c:a,h:r=r>0?r:r+2*Math.PI}}(h(c(e)))}function p(e){return d(f(function(e){var t=e.l,i=e.c,n=e.h;return{l:t,a:i*Math.cos(n),b:i*Math.sin(n)}}(e)))}function v(e){return function(e){return"r"in e&&"g"in e&&"b"in e}(e)?e:r(e)?p(e):a(e)?function(e){return d(f(e))}(e):o(e)?d(e):n(e)?function(e){var t,i=(e.h+360)%360/60,n=e.s/100,a=e.v/100*255,r=a*n,o=r*(1-Math.abs(i%2-1));switch(Math.floor(i)){case 0:t={r:r,g:o,b:0};break;case 1:t={r:o,g:r,b:0};break;case 2:t={r:0,g:r,b:o};break;case 3:t={r:0,g:o,b:r};break;case 4:t={r:o,g:0,b:r};break;case 5:case 6:t={r:r,g:0,b:o};break;default:t={r:0,g:0,b:0}}return t.r=Math.round(t.r+a-r),t.g=Math.round(t.g+a-r),t.b=Math.round(t.b+a-r),t}(e):e}function y(e){return n(e)?e:function(e){var t=e.r,i=e.g,n=e.b,a=Math.max(t,i,n),r=a-Math.min(t,i,n),o=a,s=0===r?0:a===t?(i-n)/r%6:a===i?(n-t)/r+2:(t-i)/r+4,l=0===r?0:r/o;return s<0&&(s+=6),{h:s*=60,s:l*=100,v:o*=100/255}}(v(e))}function g(e){return a(e)?e:function(e){return h(c(e))}(v(e))}function m(e){return r(e)?e:b(v(e))}},649:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n,a=i(89),r=i(88),o=i(90),s=i(91),l=i(94),u=i(105),c=i(97),d=i(96),h=(i(98),i(93),i(95));var f={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},b=n=function(e){Object(o.a)(i,e);var t=Object(s.a)(i);function i(e){var n;return Object(a.a)(this,i),(n=t.call(this,e)).contentType=null,n.exifInfo=null,n.id=null,n.globalId=null,n.keywords=null,n.name=null,n.parentGlobalId=null,n.parentObjectId=null,n.size=null,n.url=null,n}return Object(r.a)(i,[{key:"orientationInfo",get:function(){var e=function(e){var t=e.exifInfo,i=e.exifName,n=e.tagName;if(!t||!i||!n)return null;var a=t.find((function(e){return e.name===i}));return a?function(e){var t=e.tagName,i=e.tags;if(!i||!t)return null;var n=i.find((function(e){return e.name===t}));return n&&n.value||null}({tagName:n,tags:a.tags}):null}({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return f[e]||null}},{key:"clone",value:function(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}}]),i}(u.a);Object(l.a)([Object(c.b)({type:String})],b.prototype,"contentType",void 0),Object(l.a)([Object(c.b)()],b.prototype,"exifInfo",void 0),Object(l.a)([Object(c.b)({readOnly:!0})],b.prototype,"orientationInfo",null),Object(l.a)([Object(c.b)({type:d.a})],b.prototype,"id",void 0),Object(l.a)([Object(c.b)({type:String})],b.prototype,"globalId",void 0),Object(l.a)([Object(c.b)({type:String})],b.prototype,"keywords",void 0),Object(l.a)([Object(c.b)({type:String})],b.prototype,"name",void 0),Object(l.a)([Object(c.b)({json:{read:!1}})],b.prototype,"parentGlobalId",void 0),Object(l.a)([Object(c.b)({json:{read:!1}})],b.prototype,"parentObjectId",void 0),Object(l.a)([Object(c.b)({type:d.a})],b.prototype,"size",void 0),Object(l.a)([Object(c.b)({json:{read:!1}})],b.prototype,"url",void 0);var p=b=n=Object(l.a)([Object(h.a)("esri.layers.support.AttachmentInfo")],b)},681:function(e,t,i){"use strict";function n(e,t,i,n){var a=null,r=1e3;"number"==typeof t?(r=t,n=i):(a=null!==t&&void 0!==t?t:null,r=i);var o,s=0,l=function(){s=0,e.apply(n,o)},u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a&&a.apply(n,t),o=t,r?s||(s=setTimeout(l,r)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}i.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=49.dbac96f3.chunk.js.map
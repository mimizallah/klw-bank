(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[47],{121:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var r=i(107),n=i(106),a=i(112),s=i(92),o=i(90),l=i(91),h=i(99),c=i(89),u=i(88),f=i(116),v=i(150),y=i(122),d=i(169),m=function(){function t(){Object(c.a)(this,t)}return Object(u.a)(t,[{key:"asJSON",value:function(){var t=Object(v.a)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:t[0][0][0],ymin:t[0][0][1],xmax:t[0][2][0],ymax:t[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:t.flat()}:"esriGeometryPoint"===this.geometryType?{x:t[0][0][0],y:t[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:t}:{paths:t}}},{key:"invertY",value:function(){this.yFactor*=-1}}],[{key:"fromOptimized",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(new p).initialize(t,e,i,r,1)}},{key:"fromJSON",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=b(t),n=Object(h.a)(r,2),a=n[0],s=n[1];return(new g).initialize(a,s,e,i,1)}},{key:"fromOptimizedCIM",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(new O).initialize(t,e,i,r,1)}},{key:"fromJSONCIM",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=b(t),n=Object(h.a)(r,2),a=n[0],s=n[1];return(new k).initialize(a,s,e,i,1)}},{key:"fromFeatureSetReader",value:function(t){var e=t.readGeometryForDisplay(),i=t.geometryType;return e&&i?this.fromOptimized(e,i):null}},{key:"fromFeatureSetReaderCIM",value:function(t){var e=t.readGeometryForDisplay(),i=t.geometryType;return e&&i?this.fromOptimizedCIM(e,i):null}},{key:"createEmptyOptimized",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(new p).initialize(new d.a,t,e,i,1)}},{key:"createEmptyJSON",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(new g).initialize([],t,e,i,1)}},{key:"createEmptyOptimizedCIM",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(new O).initialize(new d.a,t,e,i,1)}},{key:"createEmptyJSONCIM",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(new k).initialize([],t,e,i,1)}}]),t}(),p=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(){var t;return Object(c.a)(this,i),(t=e.apply(this,arguments))._end=-1,t}return Object(u.a)(i,[{key:"initialize",value:function(t,e,i,r,n){return this.hasZ=i,this.hasM=r,this.geometryType=e,this._stride=2+Number(i)+Number(r),this._geometry=t,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=n,this}},{key:"reset",value:function(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}},{key:"seekPathStart",value:function(){this._pointOffset=this._pathOffset-this._stride}},{key:"seekPathEnd",value:function(){this._pointOffset=this._end}},{key:"seekInPath",value:function(t){var e=this._pathOffset+t*this._stride;return e>=0&&e<this._end&&(this._pointOffset=e,!0)}},{key:"nextPoint",value:function(){return(this._pointOffset+=this._stride)<this._end}},{key:"prevPoint",value:function(){return(this._pointOffset-=this._stride)>=this._pathOffset}},{key:"nextPath",value:function(){if(this._pathIndex>=0){var t=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex];this._pathOffset+=this._stride*t}this._pointOffset=this._pathOffset-this._stride;var e=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex+1];return this._end=this._pointOffset+this._stride+this._stride*e,++this._pathIndex<this.numPaths}},{key:"pathLength",value:function(){for(var t=this._end,e=this._stride,i=this._geometry.coords,r=0,n=this._pathOffset+e;n<t;n+=e){var a=i[n-e],s=i[n-e+1],o=i[n]-a,l=i[n+1]-s;r+=Math.sqrt(o*o+l*l)}return r}},{key:"startPath",value:function(){this._geometry.lengths.push(0)}},{key:"pushPath",value:function(t){this.startPath(),this.pushPoints(t)}},{key:"pushPoint",value:function(t){for(var e=0;e<this._stride;++e)this._geometry.coords.push(t[e]);this._geometry.lengths[this.numPaths-1]++}},{key:"pushXY",value:function(t,e){this._geometry.coords.push(t,e),this._geometry.lengths[this.numPaths-1]++}},{key:"pushPoints",value:function(t){var e,i=Object(s.a)(t);try{for(i.s();!(e=i.n()).done;)for(var r=e.value,n=0;n<this._stride;++n)this._geometry.coords.push(r[n])}catch(a){i.e(a)}finally{i.f()}this._geometry.lengths[this.numPaths-1]+=t.length}},{key:"asOptimized",value:function(){var t=this._geometry.clone();if(1!==this.yFactor)for(var e=1;e<t.coords.length;e+=this._stride)t.coords[e]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(t.lengths.length=0),t}},{key:"isClosed",value:function(){for(var t=this._geometry.coords,e=this._pathOffset,i=this._end-this._stride,r=0;r<this._stride;r++)if(t[e+r]!==t[i+r])return!1;return!0}},{key:"clone",value:function(){return(new i).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}},{key:"numPoints",get:function(){var t=this._geometry.lengths;return this._pathIndex<0||this._pathIndex>t.length-1?0:t[this._pathIndex]}},{key:"numPaths",get:function(){return this._geometry.lengths.length}},{key:"x",get:function(){return this._geometry.coords[this._pointOffset]},set:function(t){this._geometry.coords[this._pointOffset]=t}},{key:"y",get:function(){return this.yFactor*this._geometry.coords[this._pointOffset+1]},set:function(t){this._geometry.coords[this._pointOffset+1]=this.yFactor*t}},{key:"z",get:function(){return this._geometry.coords[this._pointOffset+2]},set:function(t){this._geometry.coords[this._pointOffset+2]=t}},{key:"m",get:function(){var t=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+t]},set:function(t){this._geometry.coords[this._pointOffset+3]=t}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"pointIndex",get:function(){return this._pointOffset/this._stride}}]),i}(m);function _(t){var e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e}function b(t){return Object(y.g)(t)?[t.rings,"esriGeometryPolygon"]:Object(y.h)(t)?[t.paths,"esriGeometryPolyline"]:Object(y.e)(t)?[[t.points],"esriGeometryMultipoint"]:Object(y.d)(t)?[[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]],"esriGeometryEnvelope"]:Object(y.f)(t)?[[[_(t)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}var g=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(){return Object(c.a)(this,i),e.apply(this,arguments)}return Object(u.a)(i,[{key:"initialize",value:function(t,e,i,r,n){return this._paths=t,this.geometryType=e,this.hasZ=i,this.hasM=r,this._pathIndex=this._pointIndex=-1,this.yFactor=n,this._mIdx=this.hasZ?3:2,this}},{key:"reset",value:function(){this._pathIndex=this._pointIndex=-1}},{key:"seekPathStart",value:function(){this._pointIndex=-1}},{key:"seekPathEnd",value:function(){this._pointIndex=this._currentPath.length}},{key:"seekInPath",value:function(t){return t>=0&&t<this._currentPath.length&&(this._pointIndex=t,this._currentPoint=this._currentPath[this._pointIndex],!0)}},{key:"nextPoint",value:function(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}},{key:"prevPoint",value:function(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}},{key:"nextPath",value:function(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.numPaths}},{key:"pathLength",value:function(){for(var t=this._currentPath.length,e=this._currentPath,i=0,r=1;r<t;r++){var n=e[r-1],a=e[r],s=n[0],o=n[1],l=a[0]-s,h=a[1]-o;i+=Math.sqrt(l*l+h*h)}return i}},{key:"startPath",value:function(){this._paths.push([])}},{key:"pushPath",value:function(t){this._paths.push(t)}},{key:"pushPoint",value:function(t){this._paths[this.pathIndex].push(t)}},{key:"pushXY",value:function(t,e){this._paths[this.pathIndex].push([t,e])}},{key:"pushPoints",value:function(t){var e;(e=this._paths[this.pathIndex]).push.apply(e,Object(a.a)(t))}},{key:"asOptimized",value:function(){var t,e=new d.a;if("esriGeometryPoint"===this.geometryType)(t=e.coords).push.apply(t,Object(a.a)(this._paths[0][0])),e.lengths.length=0;else{var i,r=Object(s.a)(this._paths);try{for(r.s();!(i=r.n()).done;){var n,o=i.value,l=Object(s.a)(o);try{for(l.s();!(n=l.n()).done;){var h=n.value;e.coords.push(h[0]),e.coords.push(h[1]*this.yFactor),this.hasZ&&e.coords.push(h[2]),this.hasM&&e.coords.push(h[this._mIdx])}}catch(c){l.e(c)}finally{l.f()}e.lengths.push(o.length)}}catch(c){r.e(c)}finally{r.f()}}return e}},{key:"isClosed",value:function(){for(var t=this._currentPath[0],e=this._currentPath[this._currentPath.length-1],i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}},{key:"clone",value:function(){return(new i).initialize(Object(f.a)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}},{key:"numPoints",get:function(){return this._pathIndex<0||this._pathIndex>this.numPaths-1?-1:this._paths[this._pathIndex].length}},{key:"numPaths",get:function(){return this._paths.length}},{key:"x",get:function(){return this._currentPoint[0]},set:function(t){this._currentPoint[0]=t}},{key:"y",get:function(){return this.yFactor*this._currentPoint[1]},set:function(t){this._currentPoint[1]=this.yFactor*t}},{key:"z",get:function(){return this._currentPoint[2]},set:function(t){this._currentPoint[2]=t}},{key:"m",get:function(){return this._currentPoint[this._mIdx]},set:function(t){this._currentPoint[this._mIdx]=t}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"pointIndex",get:function(){return this._pointIndex}}]),i}(m),O=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(){return Object(c.a)(this,i),e.apply(this,arguments)}return Object(u.a)(i,[{key:"initialize",value:function(t,e,a,s,o){return Object(r.a)(Object(n.a)(i.prototype),"initialize",this).call(this,t,e,a,s,o),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.numPaths).fill(void 0).map((function(t){return new Set}))),this}},{key:"startPath",value:function(){Object(r.a)(Object(n.a)(i.prototype),"startPath",this).call(this),this._controlPoints.push(new Set)}},{key:"clone",value:function(){var t=(new i).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return t._controlPoints=this._controlPoints,t}},{key:"setControlPoint",value:function(){this._controlPoints[this.pathIndex].add(this.pointIndex)}},{key:"getControlPoint",value:function(){return this._controlPoints[this.pathIndex].has(this.pointIndex)}},{key:"setControlPointAt",value:function(t){this._controlPoints[this.pathIndex].add(t)}},{key:"getControlPointAt",value:function(t){return this._controlPoints[this.pathIndex].has(t)}}]),i}(p),k=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(){return Object(c.a)(this,i),e.apply(this,arguments)}return Object(u.a)(i,[{key:"initialize",value:function(t,e,a,s,o){return Object(r.a)(Object(n.a)(i.prototype),"initialize",this).call(this,t,e,a,s,o)}},{key:"clone",value:function(){return(new i).initialize(Object(f.a)(this._paths),this.geometryType,this.hasZ,this.hasM,1)}},{key:"setControlPoint",value:function(){this._paths[this.pathIndex][this.pointIndex][4]=1}},{key:"getControlPoint",value:function(){return 1===this._paths[this.pathIndex][this.pointIndex][4]}},{key:"setControlPointAt",value:function(t){this._paths[this.pathIndex][t][4]=1}},{key:"getControlPointAt",value:function(t){return 1===this._paths[this.pathIndex][t][4]}}]),i}(g)},155:function(t,e,i){"use strict";var r,n;function a(t){switch(t){case"left":return r.Left;case"right":return r.Right;case"center":return r.Center}}function s(t){switch(t){case"top":return n.Top;case"middle":return n.Center;case"baseline":return n.Baseline;case"bottom":return n.Bottom}}function o(t){switch(t){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[r.Right,n.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[r.Center,n.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[r.Left,n.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[r.Right,n.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[r.Center,n.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[r.Left,n.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[r.Right,n.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[r.Center,n.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[r.Left,n.Top];default:return console.debug("Found invalid placement type ".concat(t)),[r.Center,n.Center]}}function l(t){switch(t){case r.Right:return-1;case r.Center:return 0;case r.Left:return 1;default:return console.debug("Found invalid horizontal alignment ".concat(t)),0}}function h(t){switch(t){case n.Top:return 1;case n.Center:return 0;case n.Bottom:case n.Baseline:return-1;default:return console.debug("Found invalid vertical alignment ".concat(t)),0}}function c(t){switch(t){case"left":return r.Left;case"right":return r.Right;case"center":return r.Center}}function u(t){switch(t){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return c})),i.d(e,"e",(function(){return a})),i.d(e,"f",(function(){return l})),i.d(e,"g",(function(){return s})),i.d(e,"h",(function(){return h})),i.d(e,"i",(function(){return u})),function(t){t[t.Left=-1]="Left",t[t.Center=0]="Center",t[t.Right=1]="Right"}(r||(r={})),function(t){t[t.Top=1]="Top",t[t.Center=0]="Center",t[t.Bottom=-1]="Bottom",t[t.Baseline=2]="Baseline"}(n||(n={}))},173:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(89),n=i(88),a=function(){function t(){Object(r.a)(this,t),this.setIdentity()}return Object(n.a)(t,[{key:"getAngle",value:function(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}},{key:"setIdentity",value:function(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}},{key:"setTranslate",value:function(t,e){this.tx=t,this.ty=e}},{key:"setTranslateZ",value:function(t){this.tz=t}},{key:"setRotateCS",value:function(t,e){this.rz=void 0,this.rzCos=t,this.rzSin=e}},{key:"setRotate",value:function(t){this.rz=t,this.rzCos=void 0,this.rzSin=void 0}},{key:"setRotateY",value:function(t){this.ry=t}},{key:"setScale",value:function(t){this.s=t}},{key:"setMeasure",value:function(t){this.m=t}}]),t}()},174:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return u}));var r,n=i(92),a=i(89),s=i(88),o=i(121),l=i(239),h=512,c=function(){function t(e){Object(a.a)(this,t),this._geometry=e}return Object(s.a)(t,[{key:"next",value:function(){var t=this._geometry;return this._geometry=null,t}}]),t}();function u(t,e){r||(r=new l.d(0,0,0,1));var i,a,s="esriGeometryPolygon"===t.geometryType,c=s?l.a.Polygon:l.a.LineString,u=s?3:2;for(r.reset(c),r.setPixelMargin(e+1),r.setExtent(h);t.nextPath();)if(!(t.numPoints<u)){for(t.nextPoint(),i=t.x,a=-t.y,r.moveTo(i,a);t.nextPoint();)i=t.x,a=-t.y,r.lineTo(i,a);s&&r.close()}var f=r.result(!1);if(f){var v,y=o.a.createEmptyOptimizedCIM(t.geometryType),d=Object(n.a)(f);try{for(d.s();!(v=d.n()).done;){var m=v.value;y.startPath();var p,_=Object(n.a)(m);try{for(_.s();!(p=_.n()).done;){var b=p.value;y.pushXY(b.x,-b.y)}}catch(g){_.e(g)}finally{_.f()}}}catch(g){d.e(g)}finally{d.f()}return y.reset(),y}return null}},179:function(t,e,i){"use strict";i.d(e,"a",(function(){return R})),i.d(e,"b",(function(){return G})),i.d(e,"c",(function(){return X})),i.d(e,"d",(function(){return E})),i.d(e,"e",(function(){return q})),i.d(e,"f",(function(){return T}));var r=i(4),n=i(12),a=i(1),s=i(99),o=i(89),l=i(88),h=i(92),c=i(143),u=(i(177),i(180)),f=i(116),v=i(102),y=i(212),d=i(108),m=i(139),p=i(153),_=i(207),b=i(173),g=i(232),O=i(114),k=i(152),P=i(230),x=i(286),M=i(104),j=i(198),S=i(378),C=Math.PI,w=C/2,I=Math.PI/180,L=96/72,z=v.a.getLogger("esri.symbols.cim.CIMSymbolHelper");function T(t){if(!t||!t.type)return null;var e;switch(t.type){case"cim":return t.data;case"web-style":return t;case"simple-marker":var i=R.fromSimpleMarker(t);if(!i)return null;e=i;break;case"picture-marker":e=R.fromPictureMarker(t);break;case"simple-line":e=R.fromSimpleLineSymbol(t);break;case"simple-fill":e=R.fromSimpleFillSymbol(t);break;case"picture-fill":e=R.fromPictureFillSymbol(t);break;case"text":e=R.fromTextSymbol(t)}return{type:"CIMSymbolReference",symbol:e}}function A(t,e,i){switch(e.type){case"CIMSymbolReference":return A(t,e.symbol,i);case"CIMPointSymbol":null==i&&(i={x:0,y:0}),t.drawSymbol(e,i);break;case"CIMLineSymbol":null==i&&(i={paths:[[[0,0],[10,0]]]}),t.drawSymbol(e,i);break;case"CIMPolygonSymbol":null==i&&(i={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),t.drawSymbol(e,i);break;case"CIMTextSymbol":t.drawSymbol(e,{x:0,y:0});break;case"CIMVectorMarker":var r=new b.a;t.drawMarker(e,r)}return t.envelope()}function N(t){if(!t)return 0;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(t.offset);default:return 0}}function F(t){if(!t)return 0;switch(t.type){case"CIMGeometricEffectArrow":return Math.abs(.5*t.width);case"CIMGeometricEffectBuffer":return Math.abs(t.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(t.length);case"CIMGeometricEffectJog":return Math.abs(.5*t.length);case"CIMGeometricEffectMove":return Math.max(Math.abs(Object(k.s)(t.offsetX)),Math.abs(Object(k.s)(t.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(t.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(t.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(t.fromWidth),Math.abs(t.toWidth));case"CIMGeometricEffectWave":return Math.abs(t.amplitude);case"CIMGeometricEffectDonut":return Math.abs(t.width)}}function E(t){if(!t)return 0;var e,i=0,r=Object(h.a)(t);try{for(r.s();!(e=r.n()).done;){i+=F(e.value)}}catch(n){r.e(n)}finally{r.f()}return i}var G=function(){function t(){Object(o.a)(this,t)}return Object(l.a)(t,[{key:"getSymbolInflateSize",value:function(t,e,i,r,n){return t||(t=[0,0,0,0]),e?this._getInflateSize(t,e,i,r,n):t}},{key:"_vectorMarkerBounds",value:function(t,e,i,r){var n=!0,a=Object(m.h)();if(e&&e.markerGraphics){var s,o=Object(h.a)(e.markerGraphics);try{for(o.s();!(s=o.n()).done;){var l=s.value,c=[0,0,0,0];l.geometry&&(Object(p.b)(a,l.geometry),c[0]=0,c[1]=0,c[2]=0,c[3]=0,this.getSymbolInflateSize(c,l.symbol,i,0,r),a[0]+=c[0],a[1]+=c[1],a[2]+=c[2],a[3]+=c[3],n?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],n=!1):(t[0]=Math.min(t[0],a[0]),t[1]=Math.min(t[1],a[1]),t[2]=Math.max(t[2],a[2]),t[3]=Math.max(t[3],a[3])))}}catch(u){o.e(u)}finally{o.f()}}return t}},{key:"_getInflateSize",value:function(t,e,i,r,n){if(function(t){return void 0!==t.symbolLayers}(e)){var a=this._getLayersInflateSize(t,e.symbolLayers,i,r,n),s=E(e.effects);return s>0&&(a[0]-=s,a[1]-=s,a[2]+=s,a[3]+=s),a}return this._getTextInflatedSize(t,e,n)}},{key:"_getLayersInflateSize",value:function(t,e,i,r,n){var a=!0;if(!e)return t;var s,o=Object(h.a)(e);try{for(o.s();!(s=o.n()).done;){var l=s.value;if(l){var c=[0,0,0,0];switch(l.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":var u=l,f=u.width;null!=f&&(u.capStyle===O.q.Square||u.joinStyle===O.s.Miter?f/=1.4142135623730951:f/=2,c[0]=-f,c[1]=-f,c[2]=f,c[3]=f);break;case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":var v=l;if("CIMVectorMarker"===l.type){var y=l;if(c=this._vectorMarkerBounds(c,y,i,n),y.frame){var d=(y.frame.xmin+y.frame.xmax)/2,p=(y.frame.ymin+y.frame.ymax)/2;if(c[0]-=d,c[1]-=p,c[2]-=d,c[3]-=p,null!=y.size){var _=y.size/(y.frame.ymax-y.frame.ymin);c[0]*=_,c[1]*=_,c[2]*=_,c[3]*=_}}}else if("CIMPictureMarker"===l.type){var b=l,g=i.getResource(b.url),P=1;if(null!=g&&g.height&&(P=g.width/g.height),null!=v.size){var M=v.size/2,j=v.size*P*b.scaleX/2;c=[-j,-M,j,M]}}else if(null!=v.size){var S=v.size/2;c=[-S,-S,S,S]}if(v.anchorPoint){var C=void 0,w=void 0;"Absolute"===v.anchorPointUnits?(C=v.anchorPoint.x,w=v.anchorPoint.y):(C=v.anchorPoint.x*(c[2]-c[0]),w=v.anchorPoint.y*(c[3]-c[1])),c[0]-=C,c[1]-=w,c[2]-=C,c[3]-=w}var L=Object(k.s)(v.rotation);if(v.rotateClockwise&&(L=-L),r&&(L-=r),L){var z=I*L,T=Math.cos(z),A=Math.sin(z),F=Object(m.h)([x.c,x.c,-x.c,-x.c]);Object(m.l)(F,[c[0]*T-c[1]*A,c[0]*A+c[1]*T]),Object(m.l)(F,[c[0]*T-c[3]*A,c[0]*A+c[3]*T]),Object(m.l)(F,[c[2]*T-c[1]*A,c[2]*A+c[1]*T]),Object(m.l)(F,[c[2]*T-c[3]*A,c[2]*A+c[3]*T]),c=F}var G=Object(k.s)(v.offsetX),R=Object(k.s)(v.offsetY);if(r){var X=I*r,D=Math.cos(X),H=Math.sin(X),Y=G*H+R*D;G=G*D-R*H,R=Y}c[0]+=G,c[1]+=R,c[2]+=G,c[3]+=R;var V=N(v.markerPlacement);V>0&&(c[0]-=V,c[1]-=V,c[2]+=V,c[3]+=V)}var B=E(l.effects);B>0&&(c[0]-=B,c[1]-=B,c[2]+=B,c[3]+=B),a?(t[0]=c[0],t[1]=c[1],t[2]=c[2],t[3]=c[3],a=!1):(t[0]=Math.min(t[0],c[0]),t[1]=Math.min(t[1],c[1]),t[2]=Math.max(t[2],c[2]),t[3]=Math.max(t[3],c[3]))}}}catch(W){o.e(W)}finally{o.f()}return t}},{key:"_getTextInflatedSize",value:function(t,e,i){var r,n,a,s=null!==(r=e.height)&&void 0!==r?r:g.f;if(t[0]=-s/2,t[1]=-s/2,t[2]=s/2,t[3]=s/2,!i)return t;var o=i.get(e);if(!o)return t;var l=o.text,h=o.mosaicItem;if(null===h||void 0===h||null===(n=h.glyphMosaicItems)||void 0===n||!n.length)return t;var c=e.lineGapType,f=e.lineGap,v=c?Object(g.k)(c,null!==f&&void 0!==f?f:0,s):0,y=Object(u.a)(l)[1],d=h.glyphMosaicItems,m="CIMBackgroundCallout"===(null===(a=e.callout)||void 0===a?void 0:a.type),p=Object(j.a)(d,y,{scale:s/M.y,angle:Object(k.s)(e.angle),xOffset:Object(k.s)(e.offsetX),yOffset:Object(k.s)(e.offsetY),hAlign:Object(g.j)(e.horizontalAlignment),vAlign:Object(g.l)(e.verticalAlignment),maxLineWidth:512,lineHeight:M.B*Math.max(.25,Math.min(v||1,4)),decoration:e.font.decoration||"none",isCIM:!0,hasBackground:m}).boundsT;return t[0]=p.x-p.halfWidth,t[1]=-p.y-p.halfHeight,t[2]=p.x+p.halfWidth,t[3]=-p.y+p.halfHeight,t}}],[{key:"safeSize",value:function(t){var e=Math.max(Math.abs(t[0]),Math.abs(t[2])),i=Math.max(Math.abs(t[1]),Math.abs(t[3]));return Math.sqrt(e*e+i*i)}}]),t}(),R=function(){function t(){Object(o.a)(this,t)}return Object(l.a)(t,null,[{key:"getEnvelope",value:function(t,e,i){if(!t)return null;var r=new g.g(i);if(Array.isArray(t)){var n,a,s=Object(h.a)(t);try{for(s.s();!(a=s.n()).done;){var o=a.value;n?n.union(A(r,o,e)):n=A(r,o,e)}}catch(l){s.e(l)}finally{s.f()}return n}return A(r,t,e)}},{key:"getTextureAnchor",value:function(t,e){var i=this.getEnvelope(t,null,e);if(!i)return[0,0,0];var r=(i.x+.5*i.width)*L,n=(i.y+.5*i.height)*L,a=i.width*L+2,s=i.height*L+2;return[-r/a,-n/s,s]}},{key:"rasterize",value:function(t,e,i,r){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=i||this.getEnvelope(e,null,r);if(!a)return[null,0,0,0,0];var s=(a.x+.5*a.width)*L,o=(a.y+.5*a.height)*L;t.width=a.width*L,t.height=a.height*L,i||(t.width+=2,t.height+=2);var l=t.getContext("2d"),h=g.i.createScale(L,-L);h.translate(.5*t.width-s,.5*t.height+o);var c=new g.a(l,r,h);switch(e.type){case"CIMPointSymbol":c.drawSymbol(e,{type:"point",x:0,y:0});break;case"CIMVectorMarker":var u=new b.a;c.drawMarker(e,u)}var f=l.getImageData(0,0,t.width,t.height),v=new Uint8Array(f.data);if(n)for(var y,d=0;d<v.length;d+=4)y=v[d+3]/255,v[d]=v[d]*y,v[d+1]=v[d+1]*y,v[d+2]=v[d+2]*y;return[v,t.width,t.height,-s/t.width,-o/t.height]}},{key:"fromTextSymbol",value:function(t){var e,i,r,n,a,s,o=t.angle,l=t.color,h=t.font,c=t.haloColor,f=t.haloSize,v=t.horizontalAlignment,y=t.kerning,d=t.text,m=t.verticalAlignment,p=t.xoffset,_=t.yoffset,b=t.backgroundColor,g=t.borderLineColor,P=t.borderLineSize;h&&(e=h.family,i=h.style,r=h.weight,n=h.size,a=h.decoration);var x=!1;return d&&(x=Object(u.a)(d)[1]),(b||P)&&(s={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:B(b)},{type:"CIMSolidStroke",color:B(g),width:P}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:o,blockProgression:O.d.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:O.g.Normal,fontEncoding:O.h.Unicode,fontFamilyName:e||"Arial",fontStyleName:W(i,r),fontType:O.i.Unspecified,haloSize:f,height:n,hinting:O.o.Default,horizontalAlignment:Y(null!==v&&void 0!==v?v:"center"),kerning:y,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:Object(k.s)(p),offsetY:Object(k.s)(_),strikethrough:"line-through"===a,underline:"underline"===a,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:B(l)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:B(c)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:x?O.x.RTL:O.x.LTR,verticalAlignment:V(null!==m&&void 0!==m?m:"baseline"),verticalGlyphOrientation:O.z.Right,wordSpacing:100,billboardMode3D:O.c.FaceNearPlane,callout:s},textString:d}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}},{key:"fromPictureFillSymbol",value:function(t){var e,i=t.height,r=t.outline,n=t.width,a=t.xoffset,s=t.xscale,o=t.yoffset,l=t.yscale,h=[],c={type:"CIMPolygonSymbol",symbolLayers:h};if(r){var u=tt(r);u&&h.push(u)}var f=t.url;"esriPFS"===t.type&&t.imageData&&(f=t.imageData);var v="angle"in t&&null!==(e=t.angle)&&void 0!==e?e:0,y=(null!==n&&void 0!==n?n:0)*(s||1),d=(null!==i&&void 0!==i?i:0)*(l||1);return h.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:O.y.Picture,tintColor:null,url:f,height:d,width:y,offsetX:Object(k.s)(a),offsetY:Object(k.s)(o),rotation:Object(k.s)(-v),colorSubstitutions:null}),c}},{key:"fromSimpleFillSymbol",value:function(t){var e=t.color,i=t.style,r=t.outline,n=[],a={type:"CIMPolygonSymbol",symbolLayers:n};if(r){var s=tt(r);s&&n.push(s)}if(i&&"solid"!==i&&"none"!==i&&"esriSFSSolid"!==i&&"esriSFSNull"!==i){var o={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:B(e),capStyle:O.q.Butt,joinStyle:O.s.Miter,width:.75}]},l=0,h=Object(d.d)(K(i)?8:10);switch(i){case"vertical":case"esriSFSVertical":l=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":l=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":l=45;break;case"cross":case"esriSFSCross":l=0}n.push({type:"CIMHatchFill",lineSymbol:o,offsetX:0,offsetY:0,rotation:l,separation:h}),"cross"===i||"esriSFSCross"===i?n.push({type:"CIMHatchFill",lineSymbol:Object(f.a)(o),offsetX:0,offsetY:0,rotation:90,separation:h}):"diagonal-cross"!==i&&"esriSFSDiagonalCross"!==i||n.push({type:"CIMHatchFill",lineSymbol:Object(f.a)(o),offsetX:0,offsetY:0,rotation:45,separation:h})}else!i||"solid"!==i&&"esriSFSSolid"!==i||n.push({type:"CIMSolidFill",enable:!0,color:B(e)});return a}},{key:"fromSimpleLineSymbol",value:function(e){var i=e.cap,r=e.color,n=e.join,a=e.marker,s=e.miterLimit,o=e.style,l=e.width,h=null;"solid"!==o&&"none"!==o&&"esriSLSSolid"!==o&&"esriSLSNull"!==o&&(h=[{type:"CIMGeometricEffectDashes",dashTemplate:q(o,i),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);var c=[];if(a){var u;switch(a.placement){case"begin-end":u=O.f.Both;break;case"begin":u=O.f.JustBegin;break;case"end":u=O.f.JustEnd;break;default:u=O.f.None}var f=t.fromSimpleMarker(a,l,r).symbolLayers[0];f.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:u,offsetAlongLine:0},c.push(f)}return c.push({type:"CIMSolidStroke",color:"none"!==o&&"esriSLSNull"!==o?B(r):[0,0,0,0],capStyle:D(i),joinStyle:H(n),miterLimit:s,width:l,effects:h}),{type:"CIMLineSymbol",symbolLayers:c}}},{key:"fromPictureMarker",value:function(t){var e=t.angle,i=t.height,r=t.width,n=t.xoffset,a=t.yoffset,s=t.url;return"esriPMS"===t.type&&t.imageData&&(s=t.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:O.y.Picture,tintColor:null,url:s,size:i,width:r,offsetX:Object(k.s)(n),offsetY:Object(k.s)(a),rotation:Object(k.s)(-e)}]}}},{key:"fromSimpleMarker",value:function(t,e,i){var r,n=t.style,a=null!==(r=t.color)&&void 0!==r?r:i;if("path"===n){var o=[];if("outline"in t&&t.outline){var l=t.outline;o.push({type:"CIMSolidStroke",enable:!0,width:Object(d.c)(Math.round(Object(d.d)(l.width))),color:B(l.color)})}o.push({type:"CIMSolidFill",enable:!0,color:B(a),path:t.path});var h=Z("square"),c=Object(s.a)(h,2),u=c[0],f=c[1];return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:Object(k.s)(-t.angle),size:Object(k.s)(t.size||6),offsetX:Object(k.s)(t.xoffset),offsetY:Object(k.s)(t.yoffset),frame:u,markerGraphics:[{type:"CIMMarkerGraphic",geometry:f,symbol:{type:"CIMPolygonSymbol",symbolLayers:o}}]}]}}var v,y=Z(n),m=Object(s.a)(y,2),p=m[0],_=m[1];if(_&&p){var b=[];if("outline"in t&&t.outline){var g=t.outline;b.push({type:"CIMSolidStroke",enable:!0,width:null!=g.width&&g.width>.667?Object(d.c)(Math.round(Object(d.d)(g.width))):g.width,color:B(g.color)})}else!e||"line-marker"!==t.type||"cross"!==t.style&&"x"!==t.style||b.push({type:"CIMSolidStroke",enable:!0,width:e,color:B(a)});b.push({type:"CIMSolidFill",enable:!0,color:B(a)});var O={type:"CIMPolygonSymbol",symbolLayers:b};v={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:Object(k.s)(-t.angle),size:Object(k.s)(t.size||6*e),offsetX:Object(k.s)(t.xoffset),offsetY:Object(k.s)(t.yoffset),frame:p,markerGraphics:[{type:"CIMMarkerGraphic",geometry:_,symbol:O}]}]}}return v}},{key:"fromCIMHatchFill",value:function(t,e){var i,r,n=e*(null!==(i=t.separation)&&void 0!==i?i:g.b),a=n/2,s=Object(f.a)(t.lineSymbol);null===(r=s.symbolLayers)||void 0===r||r.forEach((function(t){var i;switch(t.type){case"CIMSolidStroke":null!=t.width&&(t.width*=e),null===(i=t.effects)||void 0===i||i.forEach((function(t){"CIMGeometricEffectDashes"===t.type&&(t.dashTemplate=t.dashTemplate.map((function(t){return t*e})))}));break;case"CIMVectorMarker":null!=t.size&&(t.size*=e);var r=t.markerPlacement;null!=r&&"placementTemplate"in r&&(r.placementTemplate=r.placementTemplate.map((function(t){return t*e})))}}));for(var o=this._getLineSymbolPeriod(s)||4;o<4;)o*=2;var l=o/2;return{type:"CIMVectorMarker",frame:{xmin:-l,xmax:l,ymin:-a,ymax:a},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-l,0],[l,0]]]},symbol:s}],size:n}}},{key:"fetchResources",value:function(e,i,r){if(e&&i)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":var n=e.symbolLayers;if(!n)return;var a,s=Object(h.a)(n);try{for(s.s();!(a=s.n()).done;){var o=a.value;switch(Q(o,i,r),o.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in o&&o.url&&r.push(i.fetchResource(o.url,null));break;case"CIMVectorMarker":var l=o.markerGraphics;if(!l)continue;var c,u=Object(h.a)(l);try{for(u.s();!(c=u.n()).done;){var f=c.value;if(f){var v=f.symbol;v&&t.fetchResources(v,i,r)}}}catch(y){u.e(y)}finally{u.f()}}}}catch(y){s.e(y)}finally{s.f()}}}},{key:"fetchFonts",value:function(e,i,r){if(e&&i)if("symbolLayers"in e&&e.symbolLayers){var n,a=Object(h.a)(e.symbolLayers);try{for(a.s();!(n=a.n()).done;){var s=n.value;if("CIMVectorMarker"===s.type&&s.markerGraphics){var o,l=Object(h.a)(s.markerGraphics);try{for(l.s();!(o=l.n()).done;){var c=o.value;(null===c||void 0===c?void 0:c.symbol)&&t.fetchFonts(c.symbol,i,r)}}catch(_){l.e(_)}finally{l.f()}}}}catch(_){a.e(_)}finally{a.f()}}else if("CIMTextSymbol"===e.type){var u=e.fontFamilyName,f=e.fontStyleName;if(!u||"calcitewebcoreicons"===u.toLowerCase())return;var v=Object(k.j)(f),y=v.style,d=v.weight,m=Object(k.i)(e),p=new S.a({family:u,style:y,weight:d,decoration:m});r.push(i.loadFont(p).catch((function(){z.error("Unsupported font ".concat(u," in CIM symbol"))})))}}},{key:"_getLineSymbolPeriod",value:function(t){if(t){var e=this._getEffectsRepeat(t.effects);if(e)return e;if(t.symbolLayers){var i,r=Object(h.a)(t.symbolLayers);try{for(r.s();!(i=r.n()).done;){var n=i.value;if(n){var a=this._getEffectsRepeat(n.effects);if(a)return a;switch(n.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":var s=this._getPlacementRepeat(n.markerPlacement);if(s)return s}}}}catch(o){r.e(o)}finally{r.f()}}}return 0}},{key:"_getEffectsRepeat",value:function(t){if(t){var e,i=Object(h.a)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;if(r)switch(r.type){case"CIMGeometricEffectDashes":var n=r.dashTemplate;if(n&&n.length){var a,s=0,o=Object(h.a)(n);try{for(o.s();!(a=o.n()).done;){s+=a.value}}catch(l){o.e(l)}finally{o.f()}return 1&n.length&&(s*=2),s}break;case"CIMGeometricEffectWave":return r.period;default:z.error("unsupported geometric effect type ".concat(r.type))}}}catch(l){i.e(l)}finally{i.f()}}return 0}},{key:"_getPlacementRepeat",value:function(t){if(t)switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":var e=t.placementTemplate;if(e&&e.length){var i,r=0,n=Object(h.a)(e);try{for(n.s();!(i=n.n()).done;){r+=+i.value}}catch(a){n.e(a)}finally{n.f()}return 1&e.length&&(r*=2),r}}return 0}},{key:"fromCIMInsidePolygon",value:function(t){var e,i=t.markerPlacement,r=Object(a.a)({},t);r.markerPlacement=null,r.anchorPoint=null;var n,s,o,l,h=Math.abs(i.stepX),c=Math.abs(i.stepY),u=(null!==(e=i.randomness)&&void 0!==e?e:100)/100;if("Random"===i.gridType){var f=Object(d.d)(M.K),v=Math.max(Math.floor(f/h),1),m=Math.max(Math.floor(f/c),1);n=v*h/2,o=2*(s=m*c/2);var p=new y.a(i.seed),_=u*h/1.5,b=u*c/1.5;l=[];for(var g=0;g<v;g++)for(var O=0;O<m;O++){var k=g*h-n+_*(.5-p.getFloat()),P=O*c-s+b*(.5-p.getFloat());l.push({x:k,y:P}),0===g&&l.push({x:k+2*n,y:P}),0===O&&l.push({x:k,y:P+2*s})}}else!0===i.shiftOddRows?(o=2*c,l=[{x:-(n=h/2),y:0},{x:n,y:0},{x:0,y:s=c},{x:0,y:-s}]):(n=h/2,s=c/2,o=c,l=[{x:-h,y:0},{x:0,y:-c},{x:-h,y:-c},{x:0,y:0},{x:h,y:0},{x:0,y:c},{x:h,y:c},{x:-h,y:c},{x:h,y:-c}]);return{type:"CIMVectorMarker",frame:{xmin:-n,xmax:n,ymin:-s,ymax:s},markerGraphics:l.map((function(t){return{type:"CIMMarkerGraphic",geometry:t,symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}})),size:o}}},{key:"getSize",value:function(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":var e=0;if(t.symbolLayers){var i,r=Object(h.a)(t.symbolLayers);try{for(r.s();!(i=r.n()).done;){var n=i.value;if(n)switch(n.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":var a=n.size;null!=a&&a>e&&(e=a)}}}catch(v){r.e(v)}finally{r.f()}}return e;case"CIMLineSymbol":case"CIMPolygonSymbol":var s=0;if(t.symbolLayers){var o,l=Object(h.a)(t.symbolLayers);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(c)switch(c.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":var u=c.width;null!=u&&u>s&&(s=u);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(c.markerPlacement&&Object(k.w)(c.markerPlacement)){var f=c.size;null!=f&&f>s&&(s=f)}}}}catch(v){l.e(v)}finally{l.f()}}return s}}},{key:"getMarkerScaleRatio",value:function(t){if(t&&"CIMVectorMarker"===t.type&&!1!==t.scaleSymbolsProportionally&&t.frame&&null!=t.size){var e=t.frame.ymax-t.frame.ymin;return t.size/e}return 1}}]),t}(),X=function(){function t(){Object(o.a)(this,t)}return Object(l.a)(t,null,[{key:"findApplicableOverrides",value:function(e,i,r){if(e&&i){if(e.primitiveName){var n,a=!1,s=Object(h.a)(r);try{for(s.s();!(n=s.n()).done;){if(n.value.primitiveName===e.primitiveName){a=!0;break}}}catch(P){s.e(P)}finally{s.f()}if(!a){var o,l=Object(h.a)(i);try{for(l.s();!(o=l.n()).done;){var c=o.value;c.primitiveName===e.primitiveName&&r.push(c)}}catch(P){l.e(P)}finally{l.f()}}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects){var u,f=Object(h.a)(e.effects);try{for(f.s();!(u=f.n()).done;){var v=u.value;t.findApplicableOverrides(v,i,r)}}catch(P){f.e(P)}finally{f.f()}}if(e.symbolLayers){var y,d=Object(h.a)(e.symbolLayers);try{for(d.s();!(y=d.n()).done;){var m=y.value;t.findApplicableOverrides(m,i,r)}}catch(P){d.e(P)}finally{d.f()}}break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects){var p,_=Object(h.a)(e.effects);try{for(_.s();!(p=_.n()).done;){var b=p.value;t.findApplicableOverrides(b,i,r)}}catch(P){_.e(P)}finally{_.f()}}if(e.markerPlacement&&t.findApplicableOverrides(e.markerPlacement,i,r),"CIMVectorMarker"===e.type){if(e.markerGraphics){var g,O=Object(h.a)(e.markerGraphics);try{for(O.s();!(g=O.n()).done;){var k=g.value;t.findApplicableOverrides(k,i,r),t.findApplicableOverrides(k.symbol,i,r)}}catch(P){O.e(P)}finally{O.f()}}}else"CIMCharacterMarker"===e.type?t.findApplicableOverrides(e.symbol,i,r):"CIMHatchFill"===e.type?t.findApplicableOverrides(e.lineSymbol,i,r):"CIMPictureMarker"===e.type&&t.findApplicableOverrides(e.animatedSymbolProperties,i,r)}}}},{key:"findEffectOverrides",value:function(t,e,i){if(e&&t)for(var r=t.length,n=0;n<r;n++){var a=t[n],s=null===a||void 0===a?void 0:a.primitiveName;if(s){var o,l=!1,c=Object(h.a)(i);try{for(c.s();!(o=c.n()).done;){if(o.value.primitiveName===s){l=!0;break}}}catch(y){c.e(y)}finally{c.f()}if(!l){var u,f=Object(h.a)(e);try{for(f.s();!(u=f.n()).done;){var v=u.value;v.primitiveName===s&&i.push(v)}}catch(y){f.e(y)}finally{f.f()}}}}}},{key:"resolveSymbolOverrides",value:function(){var e=Object(n.a)(Object(r.a)().mark((function e(i,n,a,s,o,l,h){var c,u,v,y,d;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&i.symbol){e.next=2;break}return e.abrupt("return",null);case 2:if(c=i.symbol,u=i.primitiveOverrides,(v=!!u)||s){e.next=6;break}return e.abrupt("return",c);case 6:if(c=Object(f.a)(c),y=!0,n||(n={attributes:{}},y=!1),!v){e.next=14;break}if(y||(u=u.filter((function(t){var e;return!(null!==(e=t.valueExpressionInfo)&&void 0!==e&&e.expression.includes("$feature"))}))),h||(u=u.filter((function(t){var e;return!(null!==(e=t.valueExpressionInfo)&&void 0!==e&&e.expression.includes("$view"))}))),!(u.length>0)){e.next=13;break}return d=Object(k.d)(n.attributes),e.next=13,t.evaluateOverrides(u,n,{spatialReference:a,fields:d,geometryType:o},l,h);case 13:t.applyOverrides(c,u);case 14:return e.abrupt("return",(s&&t.applyDictionaryTextOverrides(c,n,s),c));case 15:case"end":return e.stop()}}),e)})));return function(t,i,r,n,a,s,o){return e.apply(this,arguments)}}()},{key:"evaluateOverrides",value:function(){var t=Object(n.a)(Object(r.a)().mark((function t(e,i,n,a,s){var o,l,c,u;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i){t.next=2;break}return t.abrupt("return");case 2:l=Object(h.a)(e),t.prev=3,u=Object(r.a)().mark((function t(){var e,l,h;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=c.value,(l=e.valueExpressionInfo)&&n&&n.geometryType&&(o||(o=[]),e.value=void 0,h=Object(_.d)(l.expression,n.spatialReference,n.fields).then((function(t){e.value=Object(P.a)(t,i,{$view:s},n.geometryType,a)})),o.push(h));case 3:case"end":return t.stop()}}),t)})),l.s();case 6:if((c=l.n()).done){t.next=10;break}return t.delegateYield(u(),"t0",8);case 8:t.next=6;break;case 10:t.next=15;break;case 12:t.prev=12,t.t1=t.catch(3),l.e(t.t1);case 15:return t.prev=15,l.f(),t.finish(15);case 18:if(t.t2=void 0!==o&&o.length>0,!t.t2){t.next=22;break}return t.next=22,Promise.all(o);case 22:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})));return function(e,i,r,n,a){return t.apply(this,arguments)}}()},{key:"applyDictionaryTextOverrides",value:function(e,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Normal";if(e&&e.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":var a=e.symbolLayers;if(!a)return;var s,o=Object(h.a)(a);try{for(o.s();!(s=o.n()).done;){var l=s.value;l&&"CIMVectorMarker"===l.type&&t.applyDictionaryTextOverrides(l,i,r,"CIMTextSymbol"===e.type?e.textCase:n)}}catch(m){o.e(m)}finally{o.f()}break;case"CIMVectorMarker":var c=e.markerGraphics;if(!c)return;var u,f=Object(h.a)(c);try{for(f.s();!(u=f.n()).done;){var v=u.value;v&&t.applyDictionaryTextOverrides(v,i,r)}}catch(m){f.e(m)}finally{f.f()}break;case"CIMMarkerGraphic":var y=e.textString;if(y&&y.includes("[")){var d=Object(k.b)(y,r);e.textString=Object(k.c)(i,d,n)}}}},{key:"applyOverrides",value:function(e,i,r,n){if(e.primitiveName){var a,s=Object(h.a)(i);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(o.primitiveName===e.primitiveName){var l=$(o.propertyName);if(n&&n.push({cim:e,nocapPropertyName:l,value:e[l]}),o.expression&&(o.value=t.toValue(o.propertyName,o.expression)),r){var c,u=!1,f=Object(h.a)(r);try{for(f.s();!(c=f.n()).done;){c.value.primitiveName===e.primitiveName&&(u=!0)}}catch(M){f.e(M)}finally{f.f()}u||r.push(o)}null!=o.value&&(e[l]=o.value)}}}catch(M){s.e(M)}finally{s.f()}}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects){var v,y=Object(h.a)(e.effects);try{for(y.s();!(v=y.n()).done;){var d=v.value;t.applyOverrides(d,i,r,n)}}catch(M){y.e(M)}finally{y.f()}}if(e.symbolLayers){var m,p=Object(h.a)(e.symbolLayers);try{for(p.s();!(m=p.n()).done;){var _=m.value;t.applyOverrides(_,i,r,n)}}catch(M){p.e(M)}finally{p.f()}}break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects){var b,g=Object(h.a)(e.effects);try{for(g.s();!(b=g.n()).done;){var O=b.value;t.applyOverrides(O,i,r,n)}}catch(M){g.e(M)}finally{g.f()}}if("CIMVectorMarker"===e.type&&e.markerGraphics){var k,P=Object(h.a)(e.markerGraphics);try{for(P.s();!(k=P.n()).done;){var x=k.value;t.applyOverrides(x,i,r,n),t.applyOverrides(x.symbol,i,r,n)}}catch(M){P.e(M)}finally{P.f()}}}}},{key:"restoreOverrides",value:function(t){var e,i=Object(h.a)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.cim[r.nocapPropertyName]=r.value}}catch(n){i.e(n)}finally{i.f()}}},{key:"buildOverrideKey",value:function(t){var e,i="",r=Object(h.a)(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;void 0!==n.value&&(i+="".concat(n.primitiveName).concat(n.propertyName).concat(JSON.stringify(n.value)))}}catch(a){r.e(a)}finally{r.f()}return i}},{key:"toValue",value:function(t,e){if("DashTemplate"===t)return e.split(" ").map((function(t){return Number(t)}));if("Color"===t){var i=new c.a(e).toRgba();return i[3]*=255,i}return e}}]),t}(),D=function(t){if(!t)return O.q.Butt;switch(t){case"butt":return O.q.Butt;case"square":return O.q.Square;case"round":return O.q.Round}},H=function(t){if(!t)return O.s.Miter;switch(t){case"miter":return O.s.Miter;case"round":return O.s.Round;case"bevel":return O.s.Bevel}},Y=function(t){if(null==t)return"Center";switch(t){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},V=function(t){if(null==t)return"Center";switch(t){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},B=function(t){return t?[t.r,t.g,t.b,255*t.a]:[0,0,0,0]},W=function(t,e){var i=J(e),r=U(t);return i&&r?"".concat(i,"-").concat(r):"".concat(i).concat(r)},J=function(t){if(!t)return"";switch(t.toLowerCase()){case"bold":case"bolder":return"bold"}return""},U=function(t){if(!t)return"";switch(t.toLowerCase()){case"italic":case"oblique":return"italic"}return""},q=function(t,e){var i="butt"===e;switch(t){case"dash":case"esriSLSDash":return i?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return i?[4,3,1,3]:[3,4,0,4];case"dot":case"esriSLSDot":return i?[1,3]:[0,4];case"long-dash":case"esriSLSLongDash":return i?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return i?[8,3,1,3]:[7,4,0,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return i?[8,3,1,3,1,3]:[7,4,0,4,0,4];case"short-dash":case"esriSLSShortDash":return i?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return i?[4,1,1,1]:[3,2,0,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return i?[4,1,1,1,1,1]:[3,2,0,2,0,2];case"short-dot":case"esriSLSShortDot":return i?[1,1]:[0,2];case"solid":case"esriSLSSolid":case"none":return z.error("Unexpected: style does not require rasterization"),[0,0];default:return z.error("Tried to rasterize SLS, but found an unexpected style: ".concat(t,"!")),[0,0]}};var Z=function(t){var e,i,r=50,n=t;if("circle"===n||"esriSMSCircle"===n){var a=Math.acos(.995),s=Math.ceil(C/a/4);0===s&&(s=1),a=w/s,s*=4;var o=[];o.push([r,0]);for(var l=1;l<s;l++)o.push([r*Math.cos(l*a),-r*Math.sin(l*a)]);o.push([r,0]),e={rings:[o]},i={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if("cross"===n||"esriSMSCross"===n){e={rings:[[[0,r],[0,0],[r,0],[r,-0],[0,-0],[0,-r],[-0,-r],[-0,-0],[-r,-0],[-r,0],[-0,0],[-0,r],[0,r]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if("diamond"===n||"esriSMSDiamond"===n)e={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("square"===n||"esriSMSSquare"===n)e={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("x"===n||"esriSMSX"===n){e={rings:[[[0,0],[50,r],[r,50],[0,0],[r,-50],[50,-r],[0,-0],[-50,-r],[-r,-50],[-0,0],[-r,50],[-50,r],[0,0]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if("triangle"===n||"esriSMSTriangle"===n){var h=57.735026918962575,c=-h,u=2/3*100,f=u-100;e={rings:[[[c,f],[0,u],[h,f],[c,f]]]},i={xmin:c,ymin:f,xmax:h,ymax:u}}else"arrow"===n&&(e={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},i={xmin:-r,ymin:-r,xmax:r,ymax:r});return[i,e]},K=function(t){return"vertical"===t||"horizontal"===t||"cross"===t||"esriSFSCross"===t||"esriSFSVertical"===t||"esriSFSHorizontal"===t},$=function(t){return t?t.charAt(0).toLowerCase()+t.substr(1):t};function Q(t,e,i){t.effects&&null==e.geometryEngine&&(e.geometryEnginePromise?i.push(e.geometryEnginePromise):Object(k.z)(t.effects)&&(e.geometryEnginePromise=Object(k.t)(),i.push(e.geometryEnginePromise),e.geometryEnginePromise.then((function(t){return e.geometryEngine=t}))))}function tt(t){if(!t)return null;var e=null,i=t.cap,r=t.color,n=t.join,a=t.miterLimit,s=t.style,o=t.width;return"solid"!==s&&"none"!==s&&"esriSLSSolid"!==s&&"esriSLSNull"!==s&&(e=[{type:"CIMGeometricEffectDashes",dashTemplate:q(s,i),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==s&&"none"!==s?B(r):[0,0,0,0],capStyle:D(i),joinStyle:H(n),miterLimit:a,width:o,effects:e}}},180:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=new(i(337).a);function n(t){return null==t?["",!1]:r.hasBidiChar(t)?(e="rtl"===r.checkContextual(t)?"IDNNN":"ICNNN",[r.bidiTransform(t,e,"VLYSN"),!0]):[t,!1];var e}},198:function(t,e,i){"use strict";i.d(e,"a",(function(){return w}));var r=i(92),n=i(99),a=i(89),s=i(88),o=i(108),l=i(219),h=i(182),c=i(171),u=i(156),f=i(155),v=i(118),y=i(260),d=function(){function t(e,i,r,n){Object(a.a)(this,t),this.center=Object(u.d)(e,i),this.centerT=Object(u.c)(),this.halfWidth=r/2,this.halfHeight=n/2,this.width=r,this.height=n}return Object(s.a)(t,[{key:"x",get:function(){return this.center[0]},set:function(t){this.center[0]=t}},{key:"y",get:function(){return this.center[1]},set:function(t){this.center[1]=t}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"serialize",value:function(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}},{key:"findCollisionDelta",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=Math.abs(t.centerT[0]-this.centerT[0]),r=Math.abs(t.centerT[1]-this.centerT[1]),n=(t.halfWidth+this.halfWidth+e)/i,a=(t.halfHeight+this.halfHeight+e)/r,s=Math.min(n,a);return Math.log2(s)}},{key:"extend",value:function(t){var e=Math.min(this.xmin,t.xmin),i=Math.min(this.ymin,t.ymin),r=Math.max(this.xmax,t.xmax)-e,n=Math.max(this.ymax,t.ymax)-i,a=e+r/2,s=i+n/2;this.width=r,this.height=n,this.halfWidth=r/2,this.halfHeight=n/2,this.x=a,this.y=s}}],[{key:"deserialize",value:function(e){return new t(e.readF32(),e.readF32(),e.readInt32(),e.readInt32())}}]),t}(),m=26,p=4,_=m+p,b=m-6,g=3,O=Math.PI/180,k=function(){function t(e,i,r,n){Object(a.a)(this,t),this._rotationT=Object(h.a)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;var s=r.rect,o=new Float32Array(8);e*=n,i*=n;var l=r.code?s.width*n:r.metrics.width,c=r.code?s.height*n:r.metrics.height;this.width=l,this.height=c,o[0]=e,o[1]=i,o[2]=e+l,o[3]=i,o[4]=e,o[5]=i+c,o[6]=e+l,o[7]=i+c,this._data=o,this._setTextureCoords(s),this._scale=n,this._mosaic=r,this.x=e,this.y=i,this.maxOffset=Math.max(e+l,i+c)}return Object(s.a)(t,[{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(t){this._angle=t,Object(l.b)(this._rotationT,-t),this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){return this._offsets||this._setOffsets(this._data),this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){var t=this._mosaic.metrics,e=t.height,i=t.width*this._scale,r=Math.abs(e)*this._scale,n=new Float32Array(8);n[0]=this.x,n[1]=this.y,n[2]=this.x+i,n[3]=this.y,n[4]=this.x,n[5]=this.y+r,n[6]=this.x+i,n[7]=this.y+r;var a=Object(l.g)(Object(h.a)(),this._rotationT,this._transform);Object(h.b)(n,n,a);for(var s=1/0,o=1/0,c=0,u=0,f=0;f<4;f++){var v=n[2*f],y=n[2*f+1];s=Math.min(s,v),o=Math.min(o,y),c=Math.max(c,v),u=Math.max(u,y)}var m=c-s,p=u-o,_=s+m/2,b=o+p/2;this._bounds=new d(_,b,m,p)}return this._bounds}},{key:"setTransform",value:function(t){this._transform=t,this._offsets=null}},{key:"_setOffsets",value:function(t){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var e=this._offsets,i=new Float32Array(8),r=Object(l.g)(Object(h.a)(),this._rotationT,this._transform);Object(h.b)(i,t,r),e.upperLeft=Object(v.a)(8*i[0],8*i[1]),e.upperRight=Object(v.a)(8*i[2],8*i[3]),e.lowerLeft=Object(v.a)(8*i[4],8*i[5]),e.lowerRight=Object(v.a)(8*i[6],8*i[7])}},{key:"_setTextureCoords",value:function(t){var e=t.x,i=t.y,r=t.width,n=t.height;this._texcoords={upperLeft:Object(v.a)(e,i),upperRight:Object(v.a)(e+r,i),lowerLeft:Object(v.a)(e,i+n),lowerRight:Object(v.a)(e+r,i+n)}}}]),t}(),P=function(t,e){return{code:0,page:0,sdf:!0,rect:new y.a(0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:t,left:0,top:0}}};function x(t,e){return t.forEach((function(t){return Object(c.q)(t,t,e)})),{upperLeft:Object(v.a)(8*t[0][0],8*t[0][1]),upperRight:Object(v.a)(8*t[1][0],8*t[1][1]),lowerLeft:Object(v.a)(8*t[2][0],8*t[2][1]),lowerRight:Object(v.a)(8*t[3][0],8*t[3][1])}}var M=function(){function t(e,i,s){var o,l;Object(a.a)(this,t),this._rotation=0,this._decorate(e,i,s),this.glyphs=e,this.bounds=this._createBounds(e),this.isMultiline=i.length>1,this._hasRotation=0!==s.angle,this._transform=this._createGlyphTransform(this.bounds,s),this._borderLineSize=s.borderLineSize,(s.borderLineSize||s.hasBackground)&&(o=this.shapeBackground(this._transform),l=Object(n.a)(o,2),this.bounds=l[0],this.background=l[1]);var h,c=Object(r.a)(e);try{for(c.s();!(h=c.n()).done;){h.value.setTransform(this._transform)}}catch(u){c.e(u)}finally{c.f()}}return Object(s.a)(t,[{key:"setRotation",value:function(t){if(0!==t||0!==this._rotation){this._rotation=t;var e=this._transform,i=Object(l.b)(Object(h.a)(),t);Object(l.g)(e,i,e);var n,a=Object(r.a)(this.glyphs);try{for(a.s();!(n=a.n()).done;){n.value.setTransform(this._transform)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"_decorate",value:function(t,e,i){if(i.decoration&&"none"!==i.decoration&&t.length){var n,a=i.scale,s="underline"===i.decoration?_:b,o=t[0].textureBinding,l=Object(r.a)(e);try{for(l.s();!(n=l.n()).done;){var h=n.value,c=h.startX*a,u=h.startY*a,f=(h.width+h.glyphWidthEnd)*a;t.push(new k(c,u+s*a,P(f,o),1))}}catch(v){l.e(v)}finally{l.f()}}}},{key:"shapeBackground",value:function(t){var e=(1.5+Object(o.c)(this._borderLineSize||0))/2,i=this._borderLineSize?e:0,r=this.bounds,n=r.xmin,a=r.ymin,s=r.xmax,l=r.ymax,h=r.x,c=r.y,u=r.width,f=r.height,v=[n-8,a-8],y=[s+8,a-8],m=[n-8,l+8],p=[s+8,l+8],_=x([[v[0]-e,v[1]-e],[y[0]+e,y[1]-e],[v[0]+i,v[1]+i],[y[0]-i,y[1]+i]],t),b=x([[m[0]+i,m[1]-i],[p[0]-i,p[1]-i],[m[0]-e,m[1]+e],[p[0]+e,p[1]+e]],t),g=x([[v[0]-e,v[1]-e],[v[0]+i,v[1]+i],[m[0]-e,m[1]+e],[m[0]+i,m[1]-i]],t),O=x([[y[0]-i,y[1]+i],[y[0]+e,y[1]-e],[p[0]-i,p[1]-i],[p[0]+e,p[1]+e]],t),k={main:x([v,y,m,p],t),top:_,bot:b,left:g,right:O};return[new d(h,c,u+2*e,f+2*e),k]}},{key:"boundsT",get:function(){var t=this.bounds,e=Object(c.p)(Object(u.c)(),t.x,t.y);if(Object(c.q)(e,e,this._transform),this._hasRotation){var i=Math.max(t.width,t.height);return new d(e[0],e[1],i,i)}return new d(e[0],e[1],t.width,t.height)}},{key:"_createBounds",value:function(t){var e,i=1/0,n=1/0,a=0,s=0,o=Object(r.a)(t);try{for(o.s();!(e=o.n()).done;){var l=e.value;i=Math.min(i,l.xTopLeft),n=Math.min(n,l.yTopLeft),a=Math.max(a,l.xBottomRight),s=Math.max(s,l.yBottomRight)}}catch(u){o.e(u)}finally{o.f()}var h=a-i,c=s-n;return new d(i+h/2,n+c/2,h,c)}},{key:"_createGlyphTransform",value:function(t,e){var i=O*e.angle,r=Object(h.a)(),n=Object(u.c)();return Object(l.j)(r,r,Object(c.p)(n,e.xOffset,-e.yOffset)),e.isCIM?Object(l.h)(r,r,i):(Object(l.j)(r,r,Object(c.p)(n,t.x,t.y)),Object(l.h)(r,r,i),Object(l.j)(r,r,Object(c.p)(n,-t.x,-t.y))),r}}]),t}(),j=Object(s.a)((function t(e,i,r,n,s,o){Object(a.a)(this,t),this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(i,r)),this.end=Math.max(0,Math.max(i,r)),this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width),this.width=n,this.yMin=s,this.yMax=o})),S=function(t){return 10===t},C=function(t){return 32===t};function w(t,e,i){for(var r=i.scale,n=new Array,a=function(t,e,i){for(var r=new Array,n=1/i.scale,a=i.maxLineWidth*n,s=e?t.length-1:0,o=e?-1:t.length,l=e?-1:1,h=s,c=0,u=0,f=h,v=f,y=0,d=1/0,m=0;h!==o;){var p=t[h],_=p.code,b=p.metrics,g=Math.abs(b.top);if(S(_)||C(_)||(d=Math.min(d,g),m=Math.max(m,g+b.height)),S(_))h!==s&&(r.push(new j(t,f,h-l,c,d,m)),d=1/0,m=0),c=0,f=h+l,v=h+l,u=0;else if(C(_))v=h+l,u=0,y=b.advance,c+=b.advance;else if(c>a){if(v!==f){var O=v-2*l;c-=y,r.push(new j(t,f,O,c-u,d,m)),d=1/0,m=0,f=v,c=u}else r.push(new j(t,f,h-l,c,d,m)),d=1/0,m=0,f=h,v=h,c=0;c+=b.advance,u+=b.advance}else c+=b.advance,u+=b.advance;h+=l}var k=new j(t,f,h-l,c,d,m);return k.start>=0&&k.end<t.length&&r.push(k),r}(t,e,i),s=function(t,e){for(var i=0,r=0;r<t.length;r++){var n=t[r].width;i=Math.max(n,i)}var a="underline"===e.decoration?p:0,s=t[0].yMin;return{x:0,y:s,height:t[t.length-1].yMax+e.lineHeight*(t.length-1)+a-s,width:i}}(a,i),o=i.vAlign,l=i.hAlign,h=o===f.b.Baseline?1:0,c=h?0:o-1,u=(1-h)*-s.y+c*(s.height/2)+(h?1:0)*-m,v=0;v<a.length;v++){var y=a[v],d=y.start,_=y.end,b=-1*(l+1)*(y.width/2)-g,O=v*i.lineHeight+u-g;a[v].startX=b,a[v].startY=O;for(var P=d;P<=_;P++){var x=t[P];if(!S(x.code)){var w=new k(b+x.metrics.left,O-x.metrics.top,x,r);b+=x.metrics.advance,n.push(w)}}}return new M(n,a,i)}},211:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i(89),n=i(88),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(r.a)(this,t),this.x=e,this.y=i,this.width=n,this.height=a}return Object(n.a)(t,[{key:"isEmpty",get:function(){return this.width<=0||this.height<=0}},{key:"union",value:function(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}]),t}()},230:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(1),n=i(101),a=i(102),s=i(327);function o(t,e,i,n,s){if(null==t)return null;var o=t.referencesGeometry()&&s?h(e,n,s):e,l=t.repurposeFeature(o);try{return t.evaluate(Object(r.a)(Object(r.a)({},i),{},{$feature:l}),t.services)}catch(c){return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",c),null}}var l=new Map;function h(t,e,i){var o=i.transform,h=i.hasZ,c=i.hasM;l.has(e)||l.set(e,function(t){var e={};switch(t){case"esriGeometryPoint":return function(t,i,r,n){return Object(s.e)(i,e,t,r,n)};case"esriGeometryPolygon":return function(t,i,r,n){return Object(s.f)(i,e,t,r,n)};case"esriGeometryPolyline":return function(t,i,r,n){return Object(s.g)(i,e,t,r,n)};case"esriGeometryMultipoint":return function(t,i,r,n){return Object(s.d)(i,e,t,r,n)};default:return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.a("mapview-arcade","Unable to handle geometryType: ".concat(t))),function(t){return t}}}(e));var u=l.get(e)(t.geometry,o,h,c);return Object(r.a)(Object(r.a)({},t),{},{geometry:u})}},231:function(t,e,i){"use strict";i.d(e,"a",(function(){return Ut})),i.d(e,"b",(function(){return qt}));var r=i(89),n=i(88),a=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new s(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();a.instance=null;var s=function(){function t(e,i,n){Object(r.a)(this,t),this._inputGeometries=e,this._angleTolerance=void 0!==i.angleTolerance?i.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}return Object(n.a)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if("esriGeometryPolygon"===t.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===t.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==t.geometryType){t=this._inputGeometries.next();continue}if(this._maxCosAngle)return t;this._isClosed=!0}for(;t.nextPath();)this._processPath(t);return t.reset(),t}return null}},{key:"_processPath",value:function(t){if(t.nextPoint()){var e=t.x,i=t.y,r=e,n=i,a=t.numPoints,s=0,o=0,l=0,h=0,c=0,u=0;this._isClosed&&++a;for(var f=1;t.nextPoint()||f<a;++f){var v=void 0,y=void 0;this._isClosed&&f===a-1?(v=e,y=i):(v=t.x,y=t.y);var d=v-r,m=y-n,p=Math.sqrt(d*d+m*m);f>1&&p>0&&l>0&&(s*d+o*m)/p/l<=this._maxCosAngle&&t.setControlPointAt(f-1),1===f&&(h=d,c=m,u=p),p>0&&(r=v,n=y,s=d,o=m,l=p)}this._isClosed&&l>0&&u>0&&(s*h+o*c)/u/l<=this._maxCosAngle&&t.setControlPointAt(0)}}}]),t}(),o=i(90),l=i(91),h=i(121),c=i(150),u=i(173);function f(t,e){t[4]=e}var v=function(){function t(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(r.a)(this,t),this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!i&&"esriGeometryPolygon"===e.geometryType||!n&&"esriGeometryPolyline"===e.geometryType?null:e,this.geomUnitsPerPoint=a,this.iteratePath=!1,this.internalPlacement=new u.a}return Object(n.a)(t,[{key:"next",value:function(){if(!this.geometryCursor)return null;for(;this.iteratePath||this.geometryCursor.nextPath();){this.geometryCursor.seekPathStart();var t=this.processPath(this.geometryCursor);if(t)return t}return this.geometryCursor=null,null}}]),t}(),y=function(){function t(e,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(r.a)(this,t),this.isClosed=!1,this.inputGeometries=e,this.acceptPolygon=i,this.acceptPolyline=n,this.geomUnitsPerPoint=a,this.iteratePath=!1,this.multiPathCursor=null}return Object(n.a)(t,[{key:"next",value:function(){for(;;){if(!this.multiPathCursor){for(var t=this.inputGeometries.next();t&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===t.geometryType||"esriGeometryEnvelope"===t.geometryType,this.multiPathCursor=t,!this.multiPathCursor);)t=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();var e=this.processPath(this.multiPathCursor);if(e)return e}this.multiPathCursor=null}}}]),t}(),d=i(99),m=i(114),p=.03,_=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"isEmpty",value:function(t){if(!t.nextPoint())return!0;var e,i,r,n;for(e=t.x,i=t.y;t.nextPoint();e=i,i=n)if(r=t.x,n=t.y,r!==e||n!==i)return t.seekPathStart(),!1;return t.seekPathStart(),!0}},{key:"normalize",value:function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);0!==e&&(t[0]/=e,t[1]/=e)}},{key:"getLength",value:function(t,e,i,r){var n=i-t,a=r-e;return Math.sqrt(n*n+a*a)}},{key:"getSegLength",value:function(t){var e=Object(d.a)(t,2),i=Object(d.a)(e[0],2),r=i[0],n=i[1],a=Object(d.a)(e[1],2),s=a[0],o=a[1];return this.getLength(r,n,s,o)}},{key:"getCoord2D",value:function(t,e,i,r,n){return[t+(i-t)*n,e+(r-e)*n]}},{key:"getSegCoord2D",value:function(t,e){var i=Object(d.a)(t,2),r=Object(d.a)(i[0],2),n=r[0],a=r[1],s=Object(d.a)(i[1],2),o=s[0],l=s[1];return this.getCoord2D(n,a,o,l,e)}},{key:"getAngle",value:function(t,e,i,r,n){var a=i-t,s=r-e;return Math.atan2(s,a)}},{key:"getAngleCS",value:function(t,e,i,r,n){var a=i-t,s=r-e,o=Math.sqrt(a*a+s*s);return o>0?[a/o,s/o]:[1,0]}},{key:"getSegAngleCS",value:function(t,e){var i=Object(d.a)(t,2),r=Object(d.a)(i[0],2),n=r[0],a=r[1],s=Object(d.a)(i[1],2),o=s[0],l=s[1];return this.getAngleCS(n,a,o,l,e)}},{key:"cut",value:function(t,e,i,r,n,a){return[n<=0?[t,e]:this.getCoord2D(t,e,i,r,n),a>=1?[i,r]:this.getCoord2D(t,e,i,r,a)]}},{key:"getSubCurve",value:function(t,e,i){var r=h.a.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(r,t,e,i)?r:null}},{key:"appendSubCurve",value:function(t,e,i,r){t.startPath(),e.seekPathStart();var n=0,a=!0;if(!e.nextPoint())return!1;for(var s=e.x,o=e.y;e.nextPoint();){var l=this.getLength(s,o,e.x,e.y);if(0!==l){if(a){if(n+l>i){var h=(i-n)/l,c=1,u=!1;n+l>=r&&(c=(r-n)/l,u=!0);var f=this.cut(s,o,e.x,e.y,h,c);if(f&&t.pushPoints(f),u)break;a=!1}}else{if(n+l>r){var v=this.cut(s,o,e.x,e.y,0,(r-n)/l);v&&t.pushPoint(v[1]);break}t.pushXY(e.x,e.y)}n+=l,s=e.x,o=e.y}else s=e.x,o=e.y}return!0}},{key:"getCIMPointAlong",value:function(t,e){if(!t.nextPoint())return null;var i,r,n,a,s=0;for(i=t.x,r=t.y;t.nextPoint();i=n,r=a){n=t.x,a=t.y;var o=this.getLength(i,r,n,a);if(0!==o){if(s+o>e){var l=(e-s)/o;return this.getCoord2D(i,r,n,a,l)}s+=o}}return null}},{key:"offset",value:function(t,e,i,r,n){if(!t||t.length<2)return null;for(var a=0,s=t[a++],o=a;a<t.length;){var l=t[a];l[0]===s[0]&&l[1]===s[1]||(a!==o&&(t[o]=t[a]),s=t[o++]),a++}var h=t[0][0]===t[o-1][0]&&t[0][1]===t[o-1][1];if(h&&--o,o<(h?3:2))return null;var c=[];s=h?t[o-1]:null;for(var u=t[0],f=0;f<o;f++){var v=f===o-1?h?t[0]:null:t[f+1];if(s)if(v){var y=[v[0]-u[0],v[1]-u[1]];this.normalize(y);var d=[u[0]-s[0],u[1]-s[1]];this.normalize(d);var p=d[0]*y[1]-d[1]*y[0],_=d[0]*y[0]+d[1]*y[1];if(0===p&&1===_){u=v;continue}if(p>=0==e<=0){if(_<1){var b=[y[0]-d[0],y[1]-d[1]];this.normalize(b);var g=Math.sqrt((1+_)/2);if(g>1/r){var O=-Math.abs(e)/g;c.push([u[0]-b[0]*O,u[1]-b[1]*O])}}}else switch(i){case m.m.Mitered:var k=Math.sqrt((1+_)/2);if(k>0&&1/k<r){var P=[y[0]-d[0],y[1]-d[1]];this.normalize(P);var x=Math.abs(e)/k;c.push([u[0]-P[0]*x,u[1]-P[1]*x]);break}case m.m.Bevelled:c.push([u[0]+d[1]*e,u[1]-d[0]*e]),c.push([u[0]+y[1]*e,u[1]-y[0]*e]);break;case m.m.Rounded:if(_<1){c.push([u[0]+d[1]*e,u[1]-d[0]*e]);var M=Math.floor(2.5*(1-_));if(M>0)for(var j=1/M,S=j,C=1;C<M;C++,S+=j){var w=[d[1]*(1-S)+y[1]*S,-d[0]*(1-S)-y[0]*S];this.normalize(w),c.push([u[0]+w[0]*e,u[1]+w[1]*e])}c.push([u[0]+y[1]*e,u[1]-y[0]*e])}break;case m.m.Square:default:if(p<0)c.push([u[0]+(d[1]+d[0])*e,u[1]+(d[1]-d[0])*e]),c.push([u[0]+(y[1]-y[0])*e,u[1]-(y[0]+y[1])*e]);else{var I=Math.sqrt((1+Math.abs(_))/2),L=[y[0]-d[0],y[1]-d[1]];this.normalize(L);var z=e/I;c.push([u[0]-L[0]*z,u[1]-L[1]*z])}}}else{var T=[u[0]-s[0],u[1]-s[1]];this.normalize(T),c.push([u[0]+T[1]*e,u[1]-T[0]*e])}else{var A=[v[0]-u[0],v[1]-u[1]];this.normalize(A),c.push([u[0]+A[1]*e,u[1]-A[0]*e])}s=u,u=v}return c.length<(h?3:2)?null:(h&&c.push([c[0][0],c[0][1]]),c)}}]),t}(),b=1.7320508075688772,g=m.j.OpenEnded,O=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new k(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();O.instance=null;var k=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t,!1,!0))._curveHelper=new _,s._width=(void 0!==n.width?n.width:5)*a,s._arrowType=void 0!==n.geometricEffectArrowType?n.geometricEffectArrowType:void 0!==n.arrowType?n.arrowType:g,s._offsetFlattenError=p*a,s}return Object(n.a)(i,[{key:"processPath",value:function(t){var e=h.a.createEmptyOptimizedCIM(t.geometryType);switch(this._arrowType){case m.j.OpenEnded:default:this._constructSimpleArrow(e,t,!0);break;case m.j.Block:this._constructSimpleArrow(e,t,!1);break;case m.j.Crossed:this._constructCrossedArrow(e,t)}return e}},{key:"_constructSimpleArrow",value:function(t,e,i){var r=e.pathLength(),n=this._width;r<2*n&&(n=r/2);var a=this._curveHelper.getSubCurve(e,0,r-n);if(a&&a.nextPath()){a.seekPathStart();var s=n/2;if(!this._curveHelper.isEmpty(a)){var o=Object(c.b)(a),l=this._constructOffset(o,-s);if(l){var h=this._constructOffset(o,s);if(h){var u=this._constructArrowBasePoint(l,-s/2);if(u){var f=this._constructArrowBasePoint(h,s/2);if(f){e.seekInPath(e.numPoints-1);var v=[e.x,e.y];t.pushPath(h),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(f),t.nextPoint(),t.setControlPoint(),t.pushPoint(v),t.nextPoint(),t.setControlPoint(),t.pushPoint(u),t.nextPoint(),t.setControlPoint(),t.pushPoints(l.reverse()),t.setControlPoint(),i||(t.setControlPointAt(0),t.setControlPointAt(t.numPoints-1),t.pushPoint(h[0])),t.reset()}}}}}}}},{key:"_constructCrossedArrow",value:function(t,e){var i=e.pathLength(),r=this._width;i<3.732050807568877*r&&(r=i/3.732050807568877),e.seekPathStart();var n=this._curveHelper.getSubCurve(e,0,i-r*(1+b));if(n){n.nextPath();var a=r/2;if(!this._curveHelper.isEmpty(n)){var s=Object(c.b)(n),o=this._constructOffset(s,a);if(o){var l=this._constructOffset(s,-a);if(l){var h=this._curveHelper.getSubCurve(e,0,i-r);if(h&&(h.nextPath(),!this._curveHelper.isEmpty(h))){var u=Object(c.b)(h),f=this._constructOffset(u,a);if(f){var v=this._constructOffset(u,-a);if(v){var y=f[f.length-1],d=this._constructArrowBasePoint(f,a/2);if(d){var m=v[v.length-1],p=this._constructArrowBasePoint(v,-a/2);if(p){e.seekInPath(e.numPoints-1);var _=[e.x,e.y];t.pushPath(o),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(m),t.nextPoint(),t.setControlPoint(),t.pushPoint(p),t.nextPoint(),t.setControlPoint(),t.pushPoint(_),t.nextPoint(),t.setControlPoint(),t.pushPoint(d),t.nextPoint(),t.setControlPoint(),t.pushPoint(y),t.nextPoint(),t.setControlPoint(),t.pushPoints(l.reverse()),t.nextPoint(),t.setControlPoint(),t.reset()}}}}}}}}}}},{key:"_constructOffset",value:function(t,e){return this._curveHelper.offset(t,e,m.m.Rounded,4,this._offsetFlattenError)}},{key:"_constructArrowBasePoint",value:function(t,e){if(!t||t.length<2)return null;var i=t[t.length-2],r=t[t.length-1],n=[r[0]-i[0],r[1]-i[1]];return this._curveHelper.normalize(n),[r[0]+n[1]*e,r[1]-n[0]*e]}}]),i}(y),P=(i(119),i(174)),x=i(125),M=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n,a){return new j(t,e,i,r,n,a)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();M.instance=null;var j=function(){function t(e,i,n,a,s,o){Object(r.a)(this,t),this._inputGeometries=e,this._tileKey=a,this._geometryEngine=s,this._curveHelper=new _,this._size=(void 0!==i.size?i.size:1)*n,this._maxInflateSize=o*n,this._offsetFlattenError=p*n}return Object(n.a)(t,[{key:"next",value:function(){for(var t;t=this._inputGeometries.next();){if(0===this._size)return t;if("esriGeometryEnvelope"===t.geometryType)if(this._size>0){var e=h.a.createEmptyOptimizedCIM(t.geometryType),i=Object(c.a)(t)[0],r=this._curveHelper.offset(i,this._size,m.m.Rounded,4,this._offsetFlattenError);if(r)return e.pushPath(r),e}else if(this._size<0){var n=t.asJSON();if(Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._size>0)return h.a.fromJSONCIM({xmin:n.xmin-this._size,xmax:n.xmax+this._size,ymin:n.ymin-this._size,ymax:n.ymax+this._size})}var a=this._geometryEngine;if(null==a)return null;var s=this._tileKey?Object(P.b)(t,this._maxInflateSize):t;if(s){var o=a.buffer(x.a.WebMercator,s.asJSON(),this._size,1);return o?h.a.fromJSONCIM(o):null}}return null}}]),t}(),S=i(92),C=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new w(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();C.instance=null;var w=function(){function t(e,i,n){var a;Object(r.a)(this,t),this._defaultPointSize=20,this._inputGeometries=e,this._geomUnitsPerPoint=n,this._rule=null!==(a=i.rule)&&void 0!==a?a:m.k.FullGeometry,this._defaultSize=this._defaultPointSize*n}return Object(n.a)(t,[{key:"next",value:function(){for(var t;t=this._inputGeometries.next();){var e=this._processGeom(Object(c.a)(t));if(e&&e.length)return h.a.fromJSONCIM({paths:e})}return null}},{key:"_clone",value:function(t){return[t[0],t[1]]}},{key:"_mid",value:function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}},{key:"_mix",value:function(t,e,i,r){return[t[0]*e+i[0]*r,t[1]*e+i[1]*r]}},{key:"_add",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"_add2",value:function(t,e,i){return[t[0]+e,t[1]+i]}},{key:"_sub",value:function(t,e){return[t[0]-e[0],t[1]-e[1]]}},{key:"_dist",value:function(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}},{key:"_norm",value:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}},{key:"_normalize",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)/this._norm(t);t[0]*=e,t[1]*=e}},{key:"_leftPerpendicular",value:function(t){var e=-t[1],i=t[0];t[0]=e,t[1]=i}},{key:"_leftPerp",value:function(t){return[-t[1],t[0]]}},{key:"_rightPerpendicular",value:function(t){var e=t[1],i=-t[0];t[0]=e,t[1]=i}},{key:"_rightPerp",value:function(t){return[t[1],-t[0]]}},{key:"_dotProduct",value:function(t,e){return t[0]*e[0]+t[1]*e[1]}},{key:"_crossProduct",value:function(t,e){return t[0]*e[1]-t[1]*e[0]}},{key:"_rotateDirect",value:function(t,e,i){var r=t[0]*e-t[1]*i,n=t[0]*i+t[1]*e;t[0]=r,t[1]=n}},{key:"_makeCtrlPt",value:function(t){var e=[t[0],t[1]];return f(e,1),e}},{key:"_addAngledTicks",value:function(t,e,i,r){var n=this._sub(i,e);this._normalize(n);var a,s=this._crossProduct(n,this._sub(r,e));a=s>0?this._rightPerp(n):this._leftPerp(n);var o=Math.abs(s)/2,l=[];l.push([e[0]+(a[0]-n[0])*o,e[1]+(a[1]-n[1])*o]),l.push(e),l.push(i),l.push([i[0]+(a[0]+n[0])*o,i[1]+(a[1]+n[1])*o]),t.push(l)}},{key:"_addBezier2",value:function(t,e,i,r,n){if(0!=n--){var a=this._mid(e,i),s=this._mid(i,r),o=this._mid(a,s);this._addBezier2(t,e,a,o,n),this._addBezier2(t,o,s,r,n)}else t.push(r)}},{key:"_addBezier3",value:function(t,e,i,r,n,a){if(0!=a--){var s=this._mid(e,i),o=this._mid(i,r),l=this._mid(r,n),h=this._mid(s,o),c=this._mid(o,l),u=this._mid(h,c);this._addBezier3(t,e,s,h,u,a),this._addBezier3(t,u,c,l,n,a)}else t.push(n)}},{key:"_add90DegArc",value:function(t,e,i,r,n){var a=null!==n&&void 0!==n?n:this._crossProduct(this._sub(i,e),this._sub(r,e))>0,s=this._mid(e,i),o=this._sub(s,e);a?this._leftPerpendicular(o):this._rightPerpendicular(o),s[0]+=o[0],s[1]+=o[1],this._addBezier3(t,e,this._mix(e,.33333,s,.66667),this._mix(i,.33333,s,.66667),i,4)}},{key:"_addArrow",value:function(t,e,i){var r=e[0],n=e[1],a=e[e.length-1],s=this._sub(r,n);this._normalize(s);var o=this._crossProduct(s,this._sub(a,n)),l=.5*o,h=this._leftPerp(s),c=[a[0]-h[0]*o,a[1]-h[1]*o],u=e.length-1,f=[];f.push(i?[-h[0],-h[1]]:h);for(var v=[-s[0],-s[1]],y=1;y<u-1;y++){var d=this._sub(e[y+1],e[y]);this._normalize(d);var m=this._dotProduct(d,v),p=this._crossProduct(d,v),_=Math.sqrt((1+m)/2),b=this._sub(d,v);this._normalize(b),b[0]/=_,b[1]/=_,f.push(p<0?[-b[0],-b[1]]:b),v=d}f.push(this._rightPerp(v));for(var g=f.length-1;g>0;g--)t.push([e[g][0]+f[g][0]*l,e[g][1]+f[g][1]*l]);t.push([c[0]+f[0][0]*l,c[1]+f[0][1]*l]),t.push([c[0]+f[0][0]*o,c[1]+f[0][1]*o]),t.push(r),t.push([c[0]-f[0][0]*o,c[1]-f[0][1]*o]),t.push([c[0]-f[0][0]*l,c[1]-f[0][1]*l]);for(var O=1;O<f.length;O++)t.push([e[O][0]-f[O][0]*l,e[O][1]-f[O][1]*l])}},{key:"_cp2",value:function(t,e,i){return t.length>=2?t[1]:this._add2(t[0],e*this._defaultSize,i*this._defaultSize)}},{key:"_cp3",value:function(t,e,i,r){if(t.length>=3)return t[2];var n=this._mix(t[0],1-i,e,i),a=this._sub(e,t[0]);return this._normalize(a),this._rightPerpendicular(a),[n[0]+a[0]*r*this._defaultSize,n[1]+a[1]*r*this._defaultSize]}},{key:"_arrowPath",value:function(t){if(t.length>2)return t;var e=t[0],i=this._cp2(t,-4,0),r=this._sub(e,i);this._normalize(r);var n=this._rightPerp(r);return[e,i,[e[0]+(n[0]-r[0])*this._defaultSize,e[1]+(n[1]-r[1])*this._defaultSize]]}},{key:"_arrowLastSeg",value:function(t){var e,i=t[0],r=this._cp2(t,-4,0);if(t.length>=3)e=t[t.length-1];else{var n=this._sub(i,r);this._normalize(n);var a=this._rightPerp(n);e=[i[0]+(a[0]-n[0])*this._defaultSize,i[1]+(a[1]-n[1])*this._defaultSize]}return[r,e]}},{key:"_processGeom",value:function(t){if(!t)return null;var e,i=[],r=Object(S.a)(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n&&0!==n.length){var a=n.length,s=n[0];switch(this._rule){case m.k.PerpendicularFromFirstSegment:var o=this._cp2(n,0,-1),l=this._cp3(n,o,.5,4),h=[];h.push(l),h.push(this._mid(s,o)),i.push(h);break;case m.k.ReversedFirstSegment:var c=this._cp2(n,0,-1);i.push([c,s]);break;case m.k.PerpendicularToSecondSegment:var u=this._cp2(n,-4,1),v=this._cp3(n,u,.882353,-1.94),y=[];y.push(this._mid(u,v)),y.push(s),i.push(y);break;case m.k.SecondSegmentWithTicks:var p=this._cp2(n,-4,1),_=this._cp3(n,p,.882353,-1.94),b=this._sub(_,p),g=void 0;g=this._crossProduct(b,this._sub(s,p))>0?this._rightPerp(g):this._leftPerp(b);var O=[];O.push([p[0]+(g[0]-b[0])/3,p[1]+(g[1]-b[1])/3]),O.push(p),O.push(_),O.push([_[0]+(g[0]+b[0])/3,_[1]+(g[1]+b[1])/3]),i.push(O);break;case m.k.DoublePerpendicular:var k=this._cp2(n,0,-1),P=this._cp3(n,k,.5,3),x=this._mid(s,k),M=this._sub(x,P);this._normalize(M);var j=this._crossProduct(M,this._sub(s,P));this._leftPerpendicular(M);var C=[];C.push(s),C.push([P[0]+M[0]*j,P[1]+M[1]*j]),i.push(C);var w=[];w.push([P[0]-M[0]*j,P[1]-M[1]*j]),w.push(k),i.push(w);break;case m.k.OppositeToFirstSegment:var I=this._cp2(n,0,-1),L=this._cp3(n,I,.5,3),z=this._mid(s,I),T=this._sub(z,L);this._normalize(T);var A=this._crossProduct(T,this._sub(s,L));this._leftPerpendicular(T);var N=[];N.push([L[0]+T[0]*A,L[1]+T[1]*A]),N.push([L[0]-T[0]*A,L[1]-T[1]*A]),i.push(N);break;case m.k.TriplePerpendicular:var F=this._cp2(n,0,-1),E=this._cp3(n,F,.5,4),G=this._mid(s,F),R=this._sub(G,E);this._normalize(R);var X=this._crossProduct(R,this._sub(s,E));this._leftPerpendicular(R);var D=[];D.push([E[0]+R[0]*X*.8,E[1]+R[1]*X*.8]),D.push([G[0]+.8*(s[0]-G[0]),G[1]+.8*(s[1]-G[1])]),i.push(D),i.push([E,G]);var H=[];H.push([E[0]-R[0]*X*.8,E[1]-R[1]*X*.8]),H.push([G[0]+.8*(F[0]-G[0]),G[1]+.8*(F[1]-G[1])]),i.push(H);break;case m.k.HalfCircleFirstSegment:var Y=this._cp2(n,0,-1),V=this._cp3(n,Y,.5,4),B=this._mid(s,Y),W=this._sub(Y,s),J=Math.cos(Math.PI/18),U=Math.sin(Math.PI/18),q=Math.sqrt((1+J)/2),Z=Math.sqrt((1-J)/2),K=[],$=void 0;this._crossProduct(W,this._sub(V,s))>0?(K.push(s),W=this._sub(s,B),$=Y):(K.push(Y),W=this._sub(Y,B),$=s),this._rotateDirect(W,q,Z),W[0]/=q,W[1]/=q;for(var Q=1;Q<=18;Q++)K.push(this._add(B,W)),this._rotateDirect(W,J,U);K.push($),i.push(K);break;case m.k.HalfCircleSecondSegment:var tt=this._cp2(n,0,-1),et=this._cp3(n,tt,1,-1),it=this._sub(s,tt);this._normalize(it);var rt=this._crossProduct(it,this._sub(et,tt))/2;this._leftPerpendicular(it);var nt=[tt[0]+it[0]*rt,tt[1]+it[1]*rt];it=this._sub(tt,nt);var at=Math.cos(Math.PI/18),st=Math.sin(Math.PI/18);rt>0&&(st=-st);for(var ot=[tt],lt=1;lt<=18;lt++)this._rotateDirect(it,at,st),ot.push(this._add(nt,it));i.push(ot);break;case m.k.HalfCircleExtended:var ht=this._cp2(n,0,-2),ct=this._cp3(n,ht,1,-1),ut=void 0;if(a>=4)ut=n[3];else{var ft=this._sub(s,ht);ut=this._add(ct,ft)}var vt=this._dist(ht,ct)/2/.75,yt=this._sub(ht,s);this._normalize(yt,vt);var dt=this._sub(ct,ut);this._normalize(dt,vt);var mt=[ut,ct];i.push(mt);var pt=[this._clone(ct)];this._addBezier3(pt,ct,this._add(ct,dt),this._add(ht,yt),ht,4),pt.push(s),i.push(pt);break;case m.k.OpenCircle:for(var _t=this._cp2(n,-2,0),bt=this._sub(_t,s),gt=Math.cos(Math.PI/18),Ot=-Math.sin(Math.PI/18),kt=[_t],Pt=1;Pt<=33;Pt++)this._rotateDirect(bt,gt,Ot),kt.push(this._add(s,bt));i.push(kt);break;case m.k.CoverageEdgesWithTicks:var xt=this._cp2(n,0,-1),Mt=void 0,jt=void 0;if(a>=3)Mt=n[2];else{var St=this._sub(xt,s),Ct=this._leftPerp(St);Mt=[s[0]+Ct[0]-.25*St[0],s[1]+Ct[1]-.25*St[1]]}if(a>=4)jt=n[3];else{var wt=this._mid(s,xt),It=this._sub(s,xt);this._normalize(It),this._leftPerpendicular(It);var Lt=this._crossProduct(It,this._sub(Mt,wt));this._rightPerpendicular(It),jt=[Mt[0]+It[0]*Lt*2,Mt[1]+It[1]*Lt*2]}var zt=this._sub(xt,s),Tt=void 0,At=void 0;Tt=this._crossProduct(zt,this._sub(Mt,s))>0?this._rightPerp(zt):this._leftPerp(zt),(At=[]).push(Mt),At.push(s),At.push([s[0]+(Tt[0]-zt[0])/3,s[1]+(Tt[1]-zt[1])/3]),i.push(At),Tt=this._crossProduct(zt,this._sub(jt,xt))>0?this._rightPerp(Tt):this._leftPerp(zt),(At=[]).push([xt[0]+(Tt[0]+zt[0])/3,xt[1]+(Tt[1]+zt[1])/3]),At.push(xt),At.push(jt),i.push(At);break;case m.k.GapExtentWithDoubleTicks:var Nt=this._cp2(n,0,2),Ft=this._cp3(n,Nt,0,1),Et=void 0;if(a>=4)Et=n[3];else{var Gt=this._sub(Nt,s);Et=this._add(Ft,Gt)}this._addAngledTicks(i,s,Nt,this._mid(Ft,Et)),this._addAngledTicks(i,Ft,Et,this._mid(s,Nt));break;case m.k.GapExtentMidline:var Rt=this._cp2(n,2,0),Xt=this._cp3(n,Rt,0,1),Dt=void 0;if(a>=4)Dt=n[3];else{var Ht=this._sub(Rt,s);Dt=this._add(Xt,Ht)}var Yt=[];Yt.push(this._mid(s,Xt)),Yt.push(this._mid(Rt,Dt)),i.push(Yt);break;case m.k.Chevron:var Vt=this._cp2(n,-1,-1),Bt=void 0;if(a>=3)Bt=n[2];else{var Wt=this._sub(Vt,s);this._leftPerpendicular(Wt),Bt=this._add(s,Wt)}i.push([Vt,this._makeCtrlPt(s),Bt]);break;case m.k.PerpendicularWithArc:var Jt=this._cp2(n,0,-2),Ut=this._cp3(n,Jt,.5,-1),qt=this._sub(Jt,s),Zt=this._norm(qt);qt[0]/=Zt,qt[1]/=Zt;var Kt=this._crossProduct(qt,this._sub(Ut,s)),$t=this._dotProduct(qt,this._sub(Ut,s));$t<.05*Zt?$t=.05*Zt:$t>.95*Zt&&($t=.95*Zt);var Qt=[s[0]+qt[0]*$t,s[1]+qt[1]*$t];this._leftPerpendicular(qt);var te=[];te.push([Qt[0]-qt[0]*Kt,Qt[1]-qt[1]*Kt]),te.push([Qt[0]+qt[0]*Kt,Qt[1]+qt[1]*Kt]),i.push(te);var ee=[Jt[0]+qt[0]*Kt,Jt[1]+qt[1]*Kt];qt=this._sub(Jt,ee);var ie=Math.cos(Math.PI/18),re=Math.sin(Math.PI/18);Kt<0&&(re=-re),te=[s,Jt];for(var ne=1;ne<=9;ne++)this._rotateDirect(qt,ie,re),te.push(this._add(ee,qt));i.push(te);break;case m.k.ClosedHalfCircle:for(var ae=this._cp2(n,2,0),se=this._mid(s,ae),oe=this._sub(ae,se),le=Math.cos(Math.PI/18),he=Math.sin(Math.PI/18),ce=[s,ae],ue=1;ue<=18;ue++)this._rotateDirect(oe,le,he),ce.push(this._add(se,oe));i.push(ce);break;case m.k.TripleParallelExtended:var fe=this._cp2(n,0,-2),ve=this._cp3(n,fe,1,-2),ye=this._mid(s,fe),de=this._sub(ve,fe);this._normalize(de);var me=Math.abs(this._crossProduct(de,this._sub(ye,fe)))/2,pe=this._dist(fe,ve),_e=[fe,s];_e.push([s[0]+de[0]*pe*.5,s[1]+de[1]*pe*.5]),i.push(_e);var be=[];be.push([ye[0]-de[0]*me,ye[1]-de[1]*me]),be.push([ye[0]+de[0]*pe*.375,ye[1]+de[1]*pe*.375]),f(be[be.length-1],1),be.push([ye[0]+de[0]*pe*.75,ye[1]+de[1]*pe*.75]),i.push(be);var ge=[fe,ve];i.push(ge);break;case m.k.ParallelWithTicks:var Oe=this._cp2(n,3,0),ke=this._cp3(n,Oe,.5,-1),Pe=this._sub(ke,Oe);this._normalize(Pe);var xe=this._crossProduct(Pe,this._sub(ke,s));this._leftPerpendicular(Pe),this._addAngledTicks(i,s,Oe,ke),this._addAngledTicks(i,this._mix(s,1,Pe,xe),this._mix(Oe,1,Pe,xe),this._mid(s,Oe));break;case m.k.Parallel:var Me=this._cp2(n,3,0),je=this._cp3(n,Me,.5,-1),Se=this._sub(Me,s);this._normalize(Se);var Ce=this._leftPerp(Se),we=this._crossProduct(Se,this._sub(je,s)),Ie=[s,Me];i.push(Ie),(Ie=[]).push([s[0]+Ce[0]*we,s[1]+Ce[1]*we]),Ie.push([Me[0]+Ce[0]*we,Me[1]+Ce[1]*we]),i.push(Ie);break;case m.k.PerpendicularToFirstSegment:var Le=this._cp2(n,3,0),ze=this._cp3(n,Le,.5,-1),Te=this._mid(s,Le),Ae=this._sub(Le,s);this._normalize(Ae);var Ne=this._crossProduct(Ae,this._sub(ze,s));this._leftPerpendicular(Ae);var Fe=[];Fe.push([Te[0]-Ae[0]*Ne*.25,Te[1]-Ae[1]*Ne*.25]),Fe.push([Te[0]+Ae[0]*Ne*1.25,Te[1]+Ae[1]*Ne*1.25]),i.push(Fe);break;case m.k.ParallelOffset:var Ee=this._cp2(n,3,0),Ge=this._cp3(n,Ee,.5,-1),Re=this._sub(Ee,s);this._normalize(Re);var Xe=this._crossProduct(Re,this._sub(Ge,s));this._leftPerpendicular(Re);var De=[];De.push([s[0]-Re[0]*Xe,s[1]-Re[1]*Xe]),De.push([Ee[0]-Re[0]*Xe,Ee[1]-Re[1]*Xe]),i.push(De);var He=[];He.push([s[0]+Re[0]*Xe,s[1]+Re[1]*Xe]),He.push([Ee[0]+Re[0]*Xe,Ee[1]+Re[1]*Xe]),i.push(He);break;case m.k.OffsetOpposite:var Ye=this._cp2(n,3,0),Ve=this._cp3(n,Ye,.5,-1),Be=this._sub(Ye,s);this._normalize(Be);var We=this._crossProduct(Be,this._sub(Ve,s));this._leftPerpendicular(Be);var Je=[];Je.push([s[0]-Be[0]*We,s[1]-Be[1]*We]),Je.push([Ye[0]-Be[0]*We,Ye[1]-Be[1]*We]),i.push(Je);break;case m.k.OffsetSame:var Ue=this._cp2(n,3,0),qe=this._cp3(n,Ue,.5,-1),Ze=this._sub(Ue,s);this._normalize(Ze);var Ke=this._crossProduct(Ze,this._sub(qe,s));this._leftPerpendicular(Ze);var $e=[];$e.push([s[0]+Ze[0]*Ke,s[1]+Ze[1]*Ke]),$e.push([Ue[0]+Ze[0]*Ke,Ue[1]+Ze[1]*Ke]),i.push($e);break;case m.k.CircleWithArc:var Qe=this._cp2(n,3,0),ti=this._cp3(n,Qe,.5,-1),ei=void 0,ii=void 0;if(a>=4)ei=n[3],ii=this._crossProduct(this._sub(ei,Qe),this._sub(ti,Qe))>0;else{ei=Qe,ii=this._crossProduct(this._sub(ei,s),this._sub(ti,s))>0;var ri=24*this._geomUnitsPerPoint,ni=this._sub(ei,s);this._normalize(ni,ri);var ai=Math.sqrt(2)/2;this._rotateDirect(ni,ai,ii?ai:-ai),Qe=this._add(s,ni)}for(var si=this._sub(Qe,s),oi=Math.cos(Math.PI/18),li=Math.sin(Math.PI/18),hi=[Qe],ci=1;ci<=36;ci++)this._rotateDirect(si,oi,li),hi.push(this._add(s,si));this._add90DegArc(hi,Qe,ei,ti,ii),f(hi[hi.length-8],1),i.push(hi);break;case m.k.DoubleJog:var ui=void 0,fi=void 0,vi=this._cp2(n,-3,1);if(ui=a>=3?n[2]:this._add(s,this._sub(s,vi)),a>=4)fi=n[3];else{var yi=s;s=vi,fi=ui;var di=this._dist(s,yi),mi=this._dist(fi,yi),pi=30*this._geomUnitsPerPoint;.5*di<pi&&(pi=.5*di),.5*mi<pi&&(pi=.5*mi),vi=this._mix(s,pi/di,yi,(di-pi)/di),ui=this._mix(fi,pi/mi,yi,(mi-pi)/mi)}var _i=this._mid(s,vi),bi=this._mid(fi,ui),gi=this._dist(s,vi),Oi=this._dist(ui,fi),ki=Math.min(gi,Oi)/8;ki=Math.min(ki,24*this._geomUnitsPerPoint);var Pi=Math.cos(Math.PI/4),xi=this._sub(s,vi);this._normalize(xi,ki),this._crossProduct(xi,this._sub(fi,vi))>0?this._rotateDirect(xi,Pi,-Pi):this._rotateDirect(xi,Pi,Pi);var Mi=[];Mi.push(vi),Mi.push(this._add(_i,xi)),Mi.push(this._sub(_i,xi)),Mi.push(s),i.push(Mi),xi=this._sub(fi,ui),this._normalize(xi,ki),this._crossProduct(xi,this._sub(s,ui))<0?this._rotateDirect(xi,Pi,Pi):this._rotateDirect(xi,Pi,-Pi),(Mi=[]).push(ui),Mi.push(this._add(bi,xi)),Mi.push(this._sub(bi,xi)),Mi.push(fi),i.push(Mi);break;case m.k.PerpendicularOffset:var ji=this._cp2(n,-4,1),Si=this._cp3(n,ji,.882353,-1.94),Ci=this._sub(Si,ji);this._crossProduct(Ci,this._sub(s,ji))>0?this._rightPerpendicular(Ci):this._leftPerpendicular(Ci);var wi=[Ci[0]/8,Ci[1]/8],Ii=this._sub(this._mid(ji,Si),wi);i.push([Ii,s]);break;case m.k.LineExcludingLastSegment:for(var Li=this._arrowPath(n),zi=[],Ti=Li.length-2;Ti--;)zi.push(Li[Ti]);i.push(zi);break;case m.k.MultivertexArrow:var Ai=this._arrowPath(n),Ni=[];this._addArrow(Ni,Ai,!1),i.push(Ni);break;case m.k.CrossedArrow:var Fi=this._arrowPath(n),Ei=[];this._addArrow(Ei,Fi,!0),i.push(Ei);break;case m.k.ChevronArrow:var Gi=this._arrowLastSeg(n),Ri=Object(d.a)(Gi,2),Xi=Ri[0],Di=Ri[1],Hi=10*this._geomUnitsPerPoint,Yi=this._sub(s,Xi);this._normalize(Yi);var Vi=this._crossProduct(Yi,this._sub(Di,Xi)),Bi=this._leftPerp(Yi),Wi=[Di[0]-Bi[0]*Vi*2,Di[1]-Bi[1]*Vi*2],Ji=[];Ji.push([Di[0]+Yi[0]*Hi,Di[1]+Yi[1]*Hi]),Ji.push(s),Ji.push([Wi[0]+Yi[0]*Hi,Wi[1]+Yi[1]*Hi]),i.push(Ji);break;case m.k.ChevronArrowOffset:var Ui=this._arrowLastSeg(n),qi=Object(d.a)(Ui,2),Zi=qi[0],Ki=qi[1],$i=this._sub(s,Zi);this._normalize($i);var Qi=this._crossProduct($i,this._sub(Ki,Zi));this._leftPerpendicular($i);var tr=[Ki[0]-$i[0]*Qi,Ki[1]-$i[1]*Qi],er=[];er.push([tr[0]+$i[0]*Qi*.5,tr[1]+$i[1]*Qi*.5]),er.push(this._mid(tr,s)),er.push([tr[0]-$i[0]*Qi*.5,tr[1]-$i[1]*Qi*.5]),i.push(er);break;case m.k.PartialFirstSegment:var ir=this._arrowLastSeg(n),rr=Object(d.a)(ir,2),nr=rr[0],ar=rr[1],sr=this._sub(s,nr);this._normalize(sr);var or=this._crossProduct(sr,this._sub(ar,nr));this._leftPerpendicular(sr);var lr=[ar[0]-sr[0]*or,ar[1]-sr[1]*or];i.push([nr,lr]);break;case m.k.Arch:var hr=this._cp2(n,0,-1),cr=this._cp3(n,hr,.5,1),ur=this._sub(s,hr),fr=this._mix(cr,1,ur,.55),vr=this._mix(cr,1,ur,-.55),yr=[s];this._addBezier2(yr,s,fr,cr,4),this._addBezier2(yr,cr,vr,hr,4),i.push(yr);break;case m.k.CurvedParallelTicks:var dr=this._cp2(n,-4,1),mr=this._cp3(n,dr,.882353,-1.94),pr=this._sub(mr,dr);this._crossProduct(pr,this._sub(s,dr))>0?this._rightPerpendicular(pr):this._leftPerpendicular(pr);var _r=[pr[0]/8,pr[1]/8],br=this._sub(this._mid(dr,mr),_r),gr=this._sub(this._mix(dr,.75,mr,.25),_r),Or=this._sub(this._mix(dr,.25,mr,.75),_r),kr=[dr];this._addBezier2(kr,dr,gr,br,3),this._addBezier2(kr,br,Or,mr,3),i.push(kr);for(var Pr=0;Pr<8;Pr++){var xr=kr[2*Pr+1],Mr=[this._clone(xr)];Mr.push(this._add(xr,[pr[0]/4,pr[1]/4])),i.push(Mr)}break;case m.k.Arc90Degrees:var jr=this._cp2(n,0,-1),Sr=this._cp3(n,jr,.5,1),Cr=[jr];this._add90DegArc(Cr,jr,s,Sr),i.push(Cr);break;case m.k.FullGeometry:default:i.push(n)}}}}catch(wr){r.e(wr)}finally{r.f()}return i}}]),t}(),I=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new T(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();I.instance=null;var L,z,T=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t,!0,!0))._curveHelper=new _,s._beginCut=(void 0!==n.beginCut?n.beginCut:1)*a,s._endCut=(void 0!==n.endCut?n.endCut:1)*a,s._middleCut=(void 0!==n.middleCut?n.middleCut:0)*a,s._invert=void 0!==n.invert&&n.invert,s._beginCut<0&&(s._beginCut=0),s._endCut<0&&(s._endCut=0),s._middleCut<0&&(s._middleCut=0),s}return Object(n.a)(i,[{key:"processPath",value:function(t){var e=this._beginCut,i=this._endCut,r=this._middleCut,n=t.pathLength(),a=h.a.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==e||0!==i||0!==r)if(e+i+r>=n)for(a.startPath();t.nextPoint();)a.pushXY(t.x,t.y);else this._curveHelper.appendSubCurve(a,t,0,e),this._curveHelper.appendSubCurve(a,t,.5*(n-r),.5*(n+r)),this._curveHelper.appendSubCurve(a,t,n-i,i)}else if(0===e&&0===i&&0===r)for(a.startPath();t.nextPoint();)a.pushXY(t.x,t.y);else e+i+r<n&&(0===r?this._curveHelper.appendSubCurve(a,t,e,n-i):(this._curveHelper.appendSubCurve(a,t,e,.5*(n-r)),this._curveHelper.appendSubCurve(a,t,.5*(n+r),n-i)));return 0===a.numPaths?null:a}}]),i}(y),A=function(){function t(){Object(r.a)(this,t),this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}return Object(n.a)(t,[{key:"isEmpty",value:function(){return 0===this._values.length}},{key:"size",value:function(){return this._values.length}},{key:"init",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._setEmpty(),!t||0===t.length)return!1;for(var r=0;r<t.length;r++){var n=Math.abs(t[r]);i&&n<1e-7&&(n=1e-7),this._values.push(n),this._length+=n}return e&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}},{key:"scale",value:function(t){for(var e=this._values?this._values.length:0,i=0;i<e;++i)this._values[i]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t}},{key:"addValue",value:function(t){this._length+=t,this._values.push(t)}},{key:"firstValue",value:function(){return this._values[0]}},{key:"lastValue",value:function(){return this._values[this._values.length-1]}},{key:"nextValue",value:function(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}},{key:"reset",value:function(){this._currentValue=-1}},{key:"length",value:function(){return this._length}},{key:"_setEmpty",value:function(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}]),t}(),N=Object(n.a)((function t(){Object(r.a)(this,t),this.pt=null,this.ca=0,this.sa=0}));(z=L||(L={}))[z.FAIL=0]="FAIL",z[z.END=1]="END",z[z.CONTINUE=2]="CONTINUE";var F=function(){function t(){Object(r.a)(this,t),this.reset()}return Object(n.a)(t,[{key:"reset",value:function(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}},{key:"isValid",value:function(){return null!==this.segment}},{key:"copyTo",value:function(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd}}]),t}(),E=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(r.a)(this,i),(t=e.call(this,n,a))._tolerance=p,t._currentPosition=new F,t}return Object(n.a)(i,[{key:"updateTolerance",value:function(t){this._tolerance=p*t}},{key:"init",value:function(t,e){return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=t,this._seg=-1,this._setPosAtNextPart()}},{key:"curPositionIsValid",value:function(){return this._currentPosition.isValid()}},{key:"nextPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L.FAIL,i=new F;return!!this._nextPosition(t,i,null,e)&&(i.copyTo(this._currentPosition),!0)}},{key:"curPointAndAngle",value:function(t){t.pt=this._getPoint(this._currentPosition);var e=this._getAngleCS(this._currentPosition),i=Object(d.a)(e,2),r=i[0],n=i[1];t.ca=r,t.sa=n}},{key:"nextPointAndAngle",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:L.FAIL,r=new F;if(!this._nextPosition(t,r,null,i))return!1;r.copyTo(this._currentPosition),e.pt=this._getPoint(r);var n=this._getAngleCS(r),a=Object(d.a)(n,2),s=a[0],o=a[1];return e.ca=s,e.sa=o,!0}},{key:"nextCurve",value:function(t){if(0===t)return null;var e=h.a.createEmptyOptimizedCIM("esriGeometryPolyline");e.startPath(),e.nextPath();var i=new F;return this._nextPosition(t,i,e,L.END)?(i.copyTo(this._currentPosition),e):null}},{key:"isPathEnd",value:function(){return this._currentPosition.isPathEnd}},{key:"getPathEnd",value:function(){return this._currentPosition.segment[1]}},{key:"getPt",value:function(t){return this._pathCursor.seekInPath(t),[this._pathCursor.x,this._pathCursor.y]}},{key:"getSeg",value:function(t){return[this.getPt(t),this.getPt(t+1)]}},{key:"_nextPosition",value:function(t,e,i,r){if(this._currentPosition.isPathEnd)return!1;var n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(e);e.abscissa+t*this._partLengthRatio>e.segmentLength+this._tolerance;){if(i){if(0===i.numPoints)if(0===n){var a=e.segment[0];i.pushXY(a[0],a[1])}else i.pushPoint(this.getSegCoord2D(e.segment,n));var s=e.segment[1];i.pushXY(s[0],s[1])}if(n=0,t-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.getSegLength(e.segment),e.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return r!==L.FAIL&&(e.segmentLength=this.getSegLength(e.segment),e.isPartEnd=!0,r===L.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+t,!0);this._currentPosition.copyTo(e)}}if(e.abscissa+=t*this._partLengthRatio,i){0===i.numPoints&&(0===n?i.pushPoint(e.segment[0]):i.pushPoint(this.getSegCoord2D(e.segment,n)));var o=e.abscissa/e.segmentLength;1===o?i.pushPoint(e.segment[1]):i.pushPoint(this.getSegCoord2D(e.segment,o))}return this._partSegCount||Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0),!0}},{key:"_getPoint",value:function(t){var e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,e)}},{key:"_getAngleCS",value:function(t){var e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegAngleCS(this._currentPosition.segment,e)}},{key:"_setPosAtNextPart",value:function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}for(var t=this._partSegCount;t;)this._previousSegment(),--t;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;var e=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(e);var i=e+this._partSegCount+1;if(i>=this._pathCursor.numPoints&&(i=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(i),this._patternLength>0){var r=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,n=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap,a=Math.round((this._partLength-(r+n))/this._patternLength);a<=0&&(a=r+n>0?0:1),this._partLengthRatio=this._partLength/(r+n+a*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}},{key:"_hasNextSegment",value:function(){return this._seg<this._pathCursor.numPoints-2}},{key:"_previousSegment",value:function(){return this.getSeg(--this._seg)}},{key:"_nextSegment",value:function(){return this.getSeg(++this._seg)}},{key:"_getStartPointIndex",value:function(){return this._seg}},{key:"_getEndPointIndex",value:function(){return this._seg+1}}]),i}(_),G=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new R(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();G.instance=null;var R=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s,o,l;return Object(r.a)(this,i),(l=e.call(this,t,!0,!0))._firstCurve=null,l._walker=new E,l._walker.updateTolerance(a),l._endings=n.lineDashEnding,l._customDashPos=-(null!==(s=n.offsetAlongLine)&&void 0!==s?s:0)*a,l._offsetAtEnd=(null!==(o=n.customEndingOffset)&&void 0!==o?o:0)*a,l._pattern=new A,l._pattern.init(n.dashTemplate,!0),l._pattern.scale(a),l}return Object(n.a)(i,[{key:"processPath",value:function(t){var e,i;if(0===this._pattern.length()){this.iteratePath=!1;var r=Object(c.b)(t);return h.a.fromJSONCIM({paths:[r]})}if(!this.iteratePath){var n=!0;switch(this._endings){case m.r.HalfPattern:case m.r.HalfGap:default:this._pattern.extPtGap=0;break;case m.r.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case m.r.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case m.r.NoConstraint:this.isClosed||(n=!1);break;case m.r.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var a=t.pathLength();if(this._pattern.isEmpty()||a<.1*this._pattern.length()){var s=Object(c.b)(t);return h.a.fromJSONCIM({paths:[s]})}if(!this._walker.init(t,this._pattern,n)){var o=Object(c.b)(t);return h.a.fromJSONCIM({paths:[o]})}}if(this.iteratePath)i=this._pattern.nextValue();else{var l;switch(this._endings){case m.r.HalfPattern:default:l=.5*this._pattern.firstValue();break;case m.r.HalfGap:l=.5*-this._pattern.lastValue();break;case m.r.FullGap:l=-this._pattern.lastValue();break;case m.r.FullPattern:l=0;break;case m.r.NoConstraint:case m.r.Custom:l=-this._customDashPos}var u=l/this._pattern.length();l=(u-=Math.floor(u))*this._pattern.length(),this._pattern.reset(),i=this._pattern.nextValue();for(var f=!1;l>=i;)l-=i,i=this._pattern.nextValue(),f=!f;i-=l,f?(this._walker.nextPosition(i),i=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(i),i=this._pattern.nextValue(),this._walker.nextPosition(i),i=this._pattern.nextValue())}var v=this._walker.nextCurve(i);if(v)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)v.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else i=this._pattern.nextValue(),!this._walker.nextPosition(i)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(v=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,v=this._firstCurve,this._firstCurve=null;return null!==(e=v)&&void 0!==e&&e.reset(),v}}]),i}(y),X=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n,a){return new D(t,e,i,r,n,a)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();X.instance=null;var D=function(){function t(e,i,n,a,s,o){switch(Object(r.a)(this,t),this._inputGeometries=e,this._tileKey=a,this._geometryEngine=s,this._maxInflateSize=o*n,this._width=(void 0!==i.width?i.width:2)*n,i.method){case m.l.Mitered:case m.l.Bevelled:case m.l.Rounded:case m.l.TrueBuffer:case m.l.Square:}this._option=i.option}return Object(n.a)(t,[{key:"next",value:function(){for(var t;t=this._inputGeometries.next();){if("esriGeometryEnvelope"===t.geometryType&&this._width>0){var e=t.asJSON();return Math.min(e.xmax-e.xmin,e.ymax-e.ymin)-2*this._width<0?t:h.a.fromJSONCIM({paths:[[[e.xmin+this._width,e.ymin+this._width],[e.xmax-this._width,e.ymin+this._width],[e.xmax-this._width,e.ymax-this._width],[e.xmin+this._width,e.ymax-this._width],[e.xmin+this._width,e.ymin+this._width]],[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}if("esriGeometryPolygon"===t.geometryType){if(0===this._width)return t.clone();var i=this._geometryEngine;if(null==i)return null;var r=this._tileKey?Object(P.b)(t,this._maxInflateSize):t.clone();if(!r)continue;var n=i.buffer(x.a.WebMercator,r.asJSON(),-this._width,1);if(n){var a,s=Object(S.a)(n.rings);try{for(s.s();!(a=s.n()).done;){var o=a.value;o&&r.pushPath(o.reverse())}}catch(l){s.e(l)}finally{s.f()}}return r}}return null}}]),t}(),H=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new Y(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();H.instance=null;var Y=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t,!1,!0))._curveHelper=new _,s._length=(void 0!==n.length?n.length:20)*a,s._angle=void 0!==n.angle?n.angle:225,s._position=void 0!==n.position?n.position:50,s._length<0&&(s._length=-s._length),s._position<20&&(s._position=20),s._position>80&&(s._position=80),s._mirror=!1,s}return Object(n.a)(i,[{key:"processPath",value:function(t){var e=h.a.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(t))return null;t.seekInPath(0);var i=t.x,r=t.y;t.seekInPath(t.numPoints-1);var n=t.x,a=t.y,s=[n-i,a-r];this._curveHelper.normalize(s);var o=i+(n-i)*this._position/100,l=r+(a-r)*this._position/100,c=Math.cos((90-this._angle)/180*Math.PI),u=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(u=-u),this._mirror=!this._mirror;var f=[o-this._length/2*c,l-this._length/2*u],v=[o+this._length/2*c,l+this._length/2*u];return e.pushPath([[i,r],f,v,[n,a]]),e}}]),i}(y),V=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new B(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();V.instance=null;var B=function(){function t(e,i,n){Object(r.a)(this,t),this._inputGeometries=e,this._offsetX=void 0!==i.offsetX?i.offsetX*n:0,this._offsetY=void 0!==i.offsetY?i.offsetY*n:0}return Object(n.a)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(t.numPaths>0)return this._move(t.clone(),this._offsetX,this._offsetY);t=this._inputGeometries.next()}return null}},{key:"_move",value:function(t,e,i){for(;t.nextPath();)for(;t.nextPoint();)t.x=t.x+e,t.y=t.y+i;return t.reset(),t}}]),t}(),W=i(122),J=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n,a){return new U(t,e,i,r,n,a)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();J.instance=null;var U=function(){function t(e,i,n,a,s,o){var l;Object(r.a)(this,t),this._inputGeometries=e,this._tileKey=a,this._geometryEngine=s,this._curveHelper=new _,this._offset=(null!==(l=i.offset)&&void 0!==l?l:1)*n,this._method=i.method,this._maxInflateSize=o*n,this._option=i.option,this._offsetFlattenError=p*n}return Object(n.a)(t,[{key:"next",value:function(){for(var t;t=this._inputGeometries.next();){if(0===this._offset)return t.clone();if("esriGeometryEnvelope"===t.geometryType){if(this._method===m.m.Rounded&&this._offset>0){var e=Object(c.b)(t),i=this._curveHelper.offset(e,-this._offset,this._method,4,this._offsetFlattenError);if(i){var r=h.a.createEmptyOptimizedCIM(t.geometryType);return r.pushPath(i),r}return null}var n=t.asJSON();if(Object(W.d)(n)&&Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._offset>0)return h.a.fromJSONCIM({xmin:n.xmin-this._offset,xmax:n.xmax+this._offset,ymin:n.ymin-this._offset,ymax:n.ymax+this._offset})}var a=this._geometryEngine;if(null!=a){var s=this._tileKey?Object(P.b)(t,this._maxInflateSize):t.clone();if(s){var o=a.offset(x.a.WebMercator,s.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return o?h.a.fromJSONCIM(o):null}}}return null}}]),t}(),q=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new Z(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();q.instance=null;var Z=function(){function t(e,i,n){Object(r.a)(this,t),this._inputGeometries=e,this._reverse=void 0===i.reverse||i.reverse}return Object(n.a)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(!this._reverse)return t;if("esriGeometryPolyline"===t.geometryType)return K(t.clone());t=this._inputGeometries.next()}return null}}]),t}();function K(t){for(;t.nextPath();)for(var e=0;e<t.numPoints/2;e++){t.seekInPath(e);var i=t.x,r=t.y;t.seekInPath(t.numPoints-e-1);var n=t.x,a=t.y;t.x=i,t.y=r,t.seekInPath(e),t.x=n,t.y=a}return t.reset(),t}var $=i(153),Q=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new tt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();Q.instance=null;var tt=function(){function t(e,i,n){Object(r.a)(this,t),this._inputGeometries=e,this._rotateAngle=void 0!==i.angle?i.angle*Math.PI/180:0}return Object(n.a)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(0===this._rotateAngle||"esriGeometryPoint"===t.geometryType)return t;if(t.numPaths>0){var e=Object($.d)(t),i=(e[2]+e[0])/2,r=(e[3]+e[1])/2;return t.reset(),this._rotate(t.clone(),i,r)}t=this._inputGeometries.next()}return null}},{key:"_rotate",value:function(t,e,i){for(var r=Math.cos(this._rotateAngle),n=Math.sin(this._rotateAngle);t.nextPath();)for(;t.nextPoint();){var a=t.x-e,s=t.y-i;t.x=e+a*r-s*n,t.y=i+a*n+s*r}return t.reset(),t}}]),t}(),et=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new it(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();et.instance=null;var it=function(){function t(e,i,n){Object(r.a)(this,t),this._inputGeometries=e,this._xFactor=void 0!==i.XScaleFactor?i.XScaleFactor:1.15,this._yFactor=void 0!==i.YScaleFactor?i.YScaleFactor:1.15}return Object(n.a)(t,[{key:"next",value:function(){var t=this._inputGeometries.next();if(t){if(1===this._xFactor&&1===this._yFactor)return t;if("esriGeometryPoint"===t.geometryType)return t;if(t.numPaths>0){var e=Object($.d)(t),i=(e[2]+e[0])/2,r=(e[3]+e[1])/2;return t.reset(),this._scaleCursor(t.clone(),i,r)}}return null}},{key:"_scaleCursor",value:function(t,e,i){for(;t.nextPath();)for(;t.nextPoint();)t.x=e+(t.x-e)*this._xFactor,t.y=i+(t.y-i)*this._yFactor;return t.reset(),t}}]),t}(),rt=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new nt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();rt.instance=null;var nt=function(){function t(e,i,n){Object(r.a)(this,t),this._inputGeometries=e,this._height=(void 0!==i.amplitude?i.amplitude:2)*n,this._period=(void 0!==i.period?i.period:3)*n,this._style=i.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new A,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new E,this._walker.updateTolerance(n)}return Object(n.a)(t,[{key:"next",value:function(){for(var t=this._inputGeometries.next();t;){if(0===this._height||0===this._period)return t;var e=this._processGeom(t);if(e)return e;t=this._inputGeometries.next()}return null}},{key:"_processGeom",value:function(t){for(var e=h.a.createEmptyOptimizedCIM(t.geometryType);t.nextPath();){e.startPath();var i=t.pathLength();if(this._walker.init(t,this._pattern))switch(this._style){case m.n.Sinus:default:this._constructCurve(e,i,!1);break;case m.n.Square:this._constructSquare(e,i);break;case m.n.Triangle:this._constructTriangle(e,i);break;case m.n.Random:this._constructCurve(e,i,!0)}else for(;t.nextPoint();)e.pushXY(t.x,t.y)}return e}},{key:"_constructCurve",value:function(t,e,i){var r=Math.round(e/this._period);0===r&&(r=1);var n=16*r+1,a=e/r,s=this._period/16,o=1/n,l=2*Math.PI*e/a,h=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),f=.75-Math.random()/2,v=.75-Math.random()/2,y=new N;this._walker.curPointAndAngle(y),t.pushPoint(y.pt);for(var d=0;;){if(!this._walker.nextPointAndAngle(s,y)){t.pushPoint(this._walker.getPathEnd());break}var m=d,p=void 0;if(d+=o,i){var _=this._height/2*(1+.3*Math.sin(f*l*m+h));p=_*Math.sin(l*m+c),p+=_*Math.sin(v*l*m+u),p/=2}else p=.5*this._height*Math.sin(.5*l*m);t.pushXY(y.pt[0]-p*y.sa,y.pt[1]+p*y.ca)}}},{key:"_constructSquare",value:function(t,e){Math.round(e/this._period);for(var i=!0;;){var r=!1;if(this._walker.curPositionIsValid()){var n=new N;this._walker.curPointAndAngle(n);var a=new N;if(this._walker.nextPointAndAngle(this._period,a)){var s=new N;this._walker.nextPointAndAngle(this._period,s)&&(i?(t.pushPoint(n.pt),i=!1):t.pushPoint(n.pt),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(a.pt[0]-this._height/2*a.sa,a.pt[1]+this._height/2*a.ca),t.pushXY(a.pt[0]+this._height/2*a.sa,a.pt[1]-this._height/2*a.ca),t.pushXY(s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca),r=!0)}}if(!r){t.pushPoint(this._walker.getPathEnd());break}}}},{key:"_constructTriangle",value:function(t,e){Math.round(e/this._period);for(var i=!0;;){var r=!1;if(this._walker.curPositionIsValid()){var n=new N;this._walker.curPointAndAngle(n);var a=new N;if(this._walker.nextPointAndAngle(this._period/2,a)){var s=new N;this._walker.nextPointAndAngle(this._period,s)&&(this._walker.nextPosition(this._period/2)&&(i?(t.pushPoint(n.pt),i=!1):t.pushPoint(n.pt),t.pushXY(a.pt[0]-this._height/2*a.sa,a.pt[1]+this._height/2*a.ca),t.pushXY(s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca)),r=!0)}}if(!r){t.pushPoint(this._walker.getPathEnd());break}}}}]),t}(),at=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new st(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();at.instance=null;var st=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s,o;return Object(r.a)(this,i),(o=e.call(this,t))._geometryWalker=new E,o._geometryWalker.updateTolerance(a),o._angleToLine=null===(s=n.angleToLine)||void 0===s||s,o._offset=(n.offset?n.offset:0)*a,o._originalEndings=n.endings,o._offsetAtEnd=(n.customEndingOffset?n.customEndingOffset:0)*a,o._position=-(n.offsetAlongLine?n.offsetAlongLine:0)*a,o._pattern=new A,o._pattern.init(n.placementTemplate,!1),o._pattern.scale(a),o._endings=o._originalEndings,o}return Object(n.a)(i,[{key:"processPath",value:function(t){if(this._pattern.isEmpty())return null;var e;if(this.iteratePath)e=this._pattern.nextValue();else{this._originalEndings===m.t.WithFullGap&&this.isClosed?this._endings=m.t.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;var i,r=!0;switch(this._endings){case m.t.NoConstraint:i=-this._position,i=this._adjustPosition(i),r=!1;break;case m.t.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case m.t.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case m.t.WithMarkers:i=0;break;case m.t.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(t,this._pattern,r))return null;this._pattern.reset();for(var n=0;i>n;)i-=n,n=this._pattern.nextValue();e=n-=i,this.iteratePath=!0}var a=new N;return this._geometryWalker.nextPointAndAngle(e,a)?this._endings===m.t.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===m.t.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca),this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa),this.internalPlacement):(this.iteratePath=!1,null)}},{key:"_adjustPosition",value:function(t){var e=t/this._pattern.length();return(e-=Math.floor(e))*this._pattern.length()}}]),i}(v),ot=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new lt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();ot.instance=null;var lt=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t,!1,!0))._curveHelper=new _,s._angleToLine=void 0===n.angleToLine||n.angleToLine,s._offset=void 0!==n.offset?n.offset*a:0,s._type=n.extremityPlacement,s._position=void 0!==n.offsetAlongLine?n.offsetAlongLine*a:0,s._beginProcessed=!1,s}return Object(n.a)(i,[{key:"processPath",value:function(t){var e;switch(this._type){case m.f.Both:default:this._beginProcessed?(e=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(e=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case m.f.JustBegin:e=this._atExtremities(t,this._position,!0);break;case m.f.JustEnd:e=this._atExtremities(t,this._position,!1);case m.f.None:}return e}},{key:"_atExtremities",value:function(t,e,i){if(i||t.seekPathEnd(),i?t.nextPoint():t.prevPoint())for(var r=0,n=0,a=0,s=[t.x,t.y],o=s[0],l=s[1];i?t.nextPoint():t.prevPoint();){n=o,a=l,o=t.x,l=t.y;var h=this._curveHelper.getLength(n,a,o,l);if(r+h>e){var c=(e-r)/h,u=this._curveHelper.getAngleCS(n,a,o,l,c),f=Object(d.a)(u,2),v=f[0],y=f[1],m=this._curveHelper.getCoord2D(n,a,o,l,c);return this.internalPlacement.setTranslate(m[0]-this._offset*y,m[1]+this._offset*v),this._angleToLine&&this.internalPlacement.setRotateCS(-v,-y),this.internalPlacement}r+=h}return null}}]),i}(v),ht=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new ct(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();ht.instance=null;var ct=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t))._walker=new E,s._walker.updateTolerance(a),s._angleToLine=void 0===n.angleToLine||n.angleToLine,s._offset=void 0!==n.offset?n.offset*a:0,s._beginGap=void 0!==n.beginPosition?n.beginPosition*a:0,s._endGap=void 0!==n.endPosition?n.endPosition*a:0,s._flipFirst=void 0===n.flipFirst||n.flipFirst,s._pattern=new A,s._pattern.init(n.positionArray,!1,!1),s._subPathLen=0,s._posCount=s._pattern.size(),s._isFirst=!0,s._prevPos=0,s}return Object(n.a)(i,[{key:"processPath",value:function(t){if(this._pattern.isEmpty())return null;var e;if(this.iteratePath){var i=this._pattern.nextValue()*this._subPathLen,r=this._beginGap+i;e=r-this._prevPos,this._prevPos=r}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=t.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();var n=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+n;e=a-this._prevPos,this._prevPos=a,this.iteratePath=!0}var s=new N;if(!this._walker.nextPointAndAngle(e,s,L.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(s.pt[0]-this._offset*s.sa,s.pt[1]+this._offset*s.ca);var o,l,h=this._isFirst&&this._flipFirst;return this._angleToLine?(o=s.ca,l=s.sa):(o=1,l=0),h&&(o=-o,l=-l),this.internalPlacement.setRotateCS(o,l),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}]),i}(v),ut=i(212),ft=512,vt=24,yt=1e-6,dt=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new mt(t,e,i,r,n)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();dt.instance=null;var mt=function(){function t(e,i,n,a,s){var o,l;if(Object(r.a)(this,t),this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(null!==(o=i.stepX)&&void 0!==o?o:16)*n,this._stepY=Math.abs(null!==(l=i.stepY)&&void 0!==l?l:16)*n,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){var h;if(this._gridType=null!==(h=i.gridType)&&void 0!==h?h:m.u.Fixed,this._gridType===m.u.Random){var c,f,v=null!==(c=i.seed)&&void 0!==c?c:13;this._randomLCG=new ut.a(1*v),this._randomness=(null!==(f=i.randomness)&&void 0!==f?f:100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{var y,p,_,b;if(this._randomness=0,this._gridAngle=null!==(y=i.gridAngle)&&void 0!==y?y:0,this._shiftOddRows=null!==(p=i.shiftOddRows)&&void 0!==p&&p,this._offsetX=(null!==(_=i.offsetX)&&void 0!==_?_:0)*n,this._offsetY=(null!==(b=i.offsetY)&&void 0!==b?b:0)*n,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=a){var g=a.split("/"),O=Object(d.a)(g,4),k=O[0],P=O[1],x=O[2],M=O[3],j=parseFloat(k),S=parseFloat(P),C=parseFloat(x),w=parseFloat(M);this._graphicOriginX=-(w*Math.pow(2,j)+C)*ft,this._graphicOriginY=S*ft,this._testInsidePolygon=!0}this._internalPlacement=new u.a,this._calculateMinMax(e),this._geometryCursor=e}}return Object(n.a)(t,[{key:"next",value:function(){return this._geometryCursor?this._nextInside():null}},{key:"_buildRandomValues",value:function(){if(!t._randValues){t._randValues=[];for(var e=0;e<vt;e++)for(var i=0;i<vt;i++)t._randValues.push(this._randomLCG.getFloat()),t._randValues.push(this._randomLCG.getFloat())}}},{key:"_calculateMinMax",value:function(t){var e,i,r,n,a,s,o,l,h,c,u,f,v,y;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,o=l=v=u=Number.MAX_VALUE,h=c=y=f=-Number.MAX_VALUE;var d=1!==this._cosAngle;for(t.reset();t.nextPath();)for(;t.nextPoint();)s=t.x,a=t.y,e=s-this._graphicOriginX-this._offsetX,i=a-this._graphicOriginY-this._offsetY,d?(r=this._cosAngle*e-this._sinAngle*i,n=this._sinAngle*e+this._cosAngle*i):(r=e,n=i),o=Math.min(o,r),h=Math.max(h,r),l=Math.min(l,n),c=Math.max(c,n),u=Math.min(u,a),f=Math.max(f,a),v=Math.min(v,s),y=Math.max(y,s);u=u!==Number.MAX_VALUE?u:-512-this._stepY,f=f!==-Number.MAX_VALUE?f:this._stepY,v=v!==Number.MAX_VALUE?v:-this._stepX;var m=f-u,p=(y=y!==-Number.MAX_VALUE?y:ft+this._stepX)-v;if(this._verticalSubdivision=m>=p,this._polygonMin=this._verticalSubdivision?u:v,this._testInsidePolygon){var _=0-this._graphicOriginX-this._offsetX-this._stepX,b=ft-this._graphicOriginX-this._offsetX+this._stepX,g=-512-this._graphicOriginY-this._offsetY-this._stepY,O=0-this._graphicOriginY-this._offsetY+this._stepY;if(d){var k=[[_,g],[_,O],[b,g],[b,O]];_=g=Number.MAX_VALUE,b=O=-Number.MAX_VALUE;for(var P=0,x=k;P<x.length;P++){var M=x[P],j=this._cosAngle*M[0]-this._sinAngle*M[1],S=this._sinAngle*M[0]+this._cosAngle*M[1];_=Math.min(_,j),b=Math.max(b,j),g=Math.min(g,S),O=Math.max(O,S)}}o=o!==Number.MAX_VALUE?Math.max(o,_):_,l=l!==Number.MAX_VALUE?Math.max(l,g):g,h=h!==-Number.MAX_VALUE?Math.min(h,b):b,c=c!==-Number.MAX_VALUE?Math.min(c,O):O}this._xMin=Math.round(o/this._stepX),this._xMax=Math.round(h/this._stepX),this._yMin=Math.round(l/this._stepY),this._yMax=Math.round(c/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(t,v,y,u,f)}},{key:"_buildAccelerationMap",value:function(t,e,i,r,n){t.reset();var a=new Map,s=this._verticalSubdivision,o=s?n-r:i-e,l=Math.ceil(o/10);if(!(l<=1)){var h,c,u,f,v,y,d,m,p,_,b,g=Math.floor(o/l);for(l++,this._delta=g,s?(p=-512-this._stepY,_=this._stepY,b=r):(p=-this._stepX,_=ft+this._stepX,b=e);t.nextPath();)if(!(t.numPoints<2)&&t.nextPoint())for(h=t.x,c=t.y;t.nextPoint();h=u,c=f){if(u=t.x,f=t.y,s){if(c===f||c<p&&f<p||c>_&&f>_)continue;v=Math.min(c,f),y=Math.max(c,f)}else{if(h===u||h<p&&u<p||h>_&&u>_)continue;v=Math.min(h,u),y=Math.max(h,u)}for(;v<y;)pt(d=Math.floor((v-b)/g),h,c,u,f,a),v+=g;(m=Math.floor((y-b)/g))>d&&pt(m,h,c,u,f,a)}this._accelerationMap=a}}},{key:"_nextInside",value:function(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}var e=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(e+=.5*this._stepX);var i=this._currentY*this._stepY+this._offsetY,r=void 0,n=void 0;if(this._currentX++,this._gridType===m.u.Random){var a=(this._currentX%vt+vt)%vt,s=(this._currentY%vt+vt)%vt;r=this._graphicOriginX+e+this._stepX*this._randomness*(.5-t._randValues[s*vt+a])*2/3,n=this._graphicOriginY+i+this._stepY*this._randomness*(.5-t._randValues[s*vt+a+1])*2/3}else r=this._graphicOriginX+this._cosAngle*e+this._sinAngle*i,n=this._graphicOriginY-this._sinAngle*e+this._cosAngle*i;if(!this._testInsidePolygon||this._isInsidePolygon(r,n,this._geometryCursor))return this._internalPlacement.setTranslate(r,n),this._internalPlacement}}},{key:"_isInsidePolygon",value:function(t,e,i){if(null==this._accelerationMap)return function(t,e,i){var r,n,a,s,o=0;for(t+=yt,e+=yt,i.reset();i.nextPath();)if(i.nextPoint())for(r=i.x,n=i.y;i.nextPoint();r=a,n=s)a=i.x,n>e!=(s=i.y)>e&&((a-r)*(e-n)-(s-n)*(t-r)>0?o++:o--);return 0!==o}(t,e,i);t+=yt,e+=yt;var r=this._verticalSubdivision,n=r?e:t,a=Math.floor((n-this._polygonMin)/this._delta),s=this._accelerationMap.get(a);if(!s)return!1;var o,l,h,c,u=0,f=Object(S.a)(s);try{for(f.s();!(c=f.n()).done;){var v=c.value;if(o=v[0],l=v[1],r){if(o[1]>e==l[1]>e)continue;h=(l[0]-o[0])*(e-o[1])-(l[1]-o[1])*(t-o[0])}else{if(o[0]>t==l[0]>t)continue;h=(l[1]-o[1])*(t-o[0])-(l[0]-o[0])*(e-o[1])}h>0?u++:u--}}catch(y){f.e(y)}finally{f.f()}return 0!==u}}]),t}();function pt(t,e,i,r,n,a){var s=a.get(t);s||(s=[],a.set(t,s)),s.push([[e,i],[r,n]])}var _t=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new bt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();_t.instance=null;var bt=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t))._curveHelper=new _,s._angleToLine=void 0===n.angleToLine||n.angleToLine,s._offset=void 0!==n.offset?n.offset*a:0,s._relativeTo=n.relativeTo,s._position=void 0!==n.startPointOffset?n.startPointOffset*a:0,s._epsilon=.001*a,s}return Object(n.a)(i,[{key:"processPath",value:function(t){var e=this._position;if(this._relativeTo===m.v.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),t.nextPoint())for(var i=[t.x,t.y],r=i[0],n=i[1],a=0,s=0;t.nextPoint();){a=t.x,s=t.y;var o=this._curveHelper.getLength(r,n,a,s);if(!(o<this._epsilon)){var l=.5+this._position/o,h=this._curveHelper.getAngleCS(r,n,a,s,l),c=Object(d.a)(h,2),u=c[0],f=c[1],v=this._curveHelper.getCoord2D(r,n,a,s,l);return this.internalPlacement.setTranslate(v[0]-this._offset*f,v[1]+this._offset*u),this._angleToLine&&this.internalPlacement.setRotateCS(u,f),this.internalPlacement}r=a,n=s}return this.iteratePath=!1,null}var y=this._relativeTo===m.v.LineEnd;return this.onLine(t,e,y)}},{key:"onLine",value:function(t,e,i){var r,n=!1;switch(this._relativeTo){case m.v.LineMiddle:default:t.seekPathStart(),r=t.pathLength()/2+e;break;case m.v.LineBeginning:r=e;break;case m.v.LineEnd:r=e,n=!0}i?t.seekPathEnd():t.seekPathStart();var a=0;if(i?t.prevPoint():t.nextPoint())for(var s=[t.x,t.y],o=s[0],l=s[1],h=0,c=0;i?t.prevPoint():t.nextPoint();){h=t.x,c=t.y;var u=this._curveHelper.getLength(o,l,h,c);if(a+u>r){var f=(r-a)/u,v=this._curveHelper.getAngleCS(o,l,h,c,f),y=Object(d.a)(v,2),p=y[0],_=y[1],b=this._curveHelper.getCoord2D(o,l,h,c,f),g=n?-this._offset:this._offset;return this.internalPlacement.setTranslate(b[0]-g*_,b[1]+g*p),this._angleToLine&&(n?this.internalPlacement.setRotateCS(-p,-_):this.internalPlacement.setRotateCS(p,_)),this.internalPlacement}o=h,l=c,a+=u}return null}}]),i}(v),gt=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new Ot(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();gt.instance=null;var Ot=function(t){Object(o.a)(i,t);var e=Object(l.a)(i);function i(t,n,a){var s;return Object(r.a)(this,i),(s=e.call(this,t))._curveHelper=new _,s._angleToLine=void 0===n.angleToLine||n.angleToLine,s._offset=void 0!==n.offset?n.offset*a:0,s._endPoints=void 0===n.placeOnEndPoints||n.placeOnEndPoints,s._controlPoints=void 0===n.placeOnControlPoints||n.placeOnControlPoints,s._regularVertices=void 0===n.placeOnRegularVertices||n.placeOnRegularVertices,s._tags=[],s._tagIterator=0,s}return Object(n.a)(i,[{key:"processPath",value:function(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;var e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);var i=e[0],r=e[1];if(0!==this._offset){var n=Math.cos(e[2]),a=Math.sin(e[2]);i-=this._offset*a,r+=this._offset*n}return this.internalPlacement.setTranslate(i,r),this._tagIterator++,this.internalPlacement}},{key:"_preparePath",value:function(t){this._tags.length=0,this._tagIterator=0,t.seekPathStart();var e=t.isClosed(),i=0,r=!1,n=0,a=0;if(t.seekPathStart(),t.nextPoint())for(var s=t.x,o=t.y,l=t.getControlPoint(),h=!0,c=t.nextPoint();c;){var u=t.x,f=t.y,v=t.getControlPoint();(this._angleToLine||0!==this._offset)&&(n=this._curveHelper.getAngle(s,o,u,f,0)),h?(h=!1,e?(i=n,r=l):(this._endPoints||this._controlPoints&&l)&&this._tags.push([s,o,n])):l?this._controlPoints&&this._tags.push([s,o,kt(a,n)]):this._regularVertices&&this._tags.push([s,o,kt(a,n)]),(this._angleToLine||0!==this._offset)&&(a=this._curveHelper.getAngle(s,o,u,f,1)),(c=t.nextPoint())||(e?v||r?this._controlPoints&&this._tags.push([u,f,kt(a,i)]):this._regularVertices&&this._tags.push([u,f,kt(a,i)]):(this._endPoints||this._controlPoints&&v)&&this._tags.push([u,f,a])),s=u,o=f,l=v}this._tagIterator=0}}]),i}(v);function kt(t,e){for(var i=Math.PI;Math.abs(e-t)>i+2e-15;)e-t>i?e-=2*i:e+=2*i;return(t+e)/2}var Pt=i(93),xt=i(218),Mt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt;Object(r.a)(this,t),this._data=[],this._compare=e}return Object(n.a)(t,[{key:"size",get:function(){return this._data.length}},{key:"enqueue",value:function(t){if(null!=t){var e=this._data,i=this._compare;e.push(t);for(var r=e.length-1>>>0,n=e[r];r>0;){var a=r-1>>1,s=e[a];if(!(i(s,n)<=0))break;e[a]=n,e[r]=s,r=a}}}},{key:"dequeue",value:function(){var t=this._data,e=this._compare,i=t[0],r=t.pop();if(0===t.length)return i;t[0]=r;for(var n,a,s=0,o=t.length,l=t[0],h=null;;){var c=2*s+1,u=2*s+2;if(h=null,c<o&&(e(n=t[c],l)>0&&(h=c)),u<o&&(a=t[u],(null===h&&e(a,l)<=0||null!==h&&e(a,n)<=0)&&(h=u)),null===h)break;t[s]=t[h],t[h]=l,s=h}return i}}]),t}(),jt=function(t,e){return t<e?-1:t>e?1:0},St=i(139),Ct=i(241),wt=i(248),It=222045e-19;function Lt(t){return function(t){var e=t.rings;if(!e||0===e.length)return null;var i=Object($.b)(Object(St.h)(),t);if(!i)return null;for(var r=4*(Math.abs(i[0])+Math.abs(i[2])+Math.abs(i[1])+Math.abs(i[3])+1)*It,n=0,a=0,s=0;s<e.length;s++){var o=Object(Ct.g)(e[s]);o>a&&(a=o,n=s)}if(Math.abs(a)<=2*r*r){var l=Object($.e)(Object(St.h)(),e[n]);return[(l[0]+l[2])/2,(l[1]+l[3])/2]}var h=Object(xt.c)(e[n],!1,Object(St.h)());if(null===h)return null;if(1===e.length&&e[0].length<4)return h;var c=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],u=[NaN,NaN,NaN,NaN],f=[NaN,NaN,NaN,NaN],v=!1,y=Tt(h,t,!0);0===y.distance&&(v=!0,c[0][0]=h[0],c[0][1]=h[1],y=Tt(h,t,!1)),u[0]=y.distance,f[0]=0;var d=[NaN,NaN],m=!1,p=.25,_=-1,b=Object($.e)(Object(St.h)(),e[n]),g=NaN;do{if(g=NaN,c[1]=At(t,Ht(b[0],b[2],p),r,i),isNaN(c[1][0])||isNaN(c[1][1])||(g=(y=Tt(c[1],t,!1)).distance),!isNaN(g)&&g>r&&zt(c[1],t))m=!0,u[1]=g,f[1]=Yt(c[1],h);else if(!isNaN(g)&&g>_&&(_=g,d[0]=c[1][0],d[1]=c[1][1]),(p-=.01)<.1){if(!(_>=0))break;m=!0,u[1]=_,c[1][0]=d[0],c[1][1]=d[1],f[1]=Yt(c[1],h)}}while(!m);m=!1,p=.5,_=-1;var O=.01,k=1;do{if(g=NaN,c[2]=At(t,Ht(b[0],b[2],p),r,i),isNaN(c[2][0])||isNaN(c[2][1])||(g=(y=Tt(c[2],t,!1)).distance),!isNaN(g)&&g>r&&zt(c[2],t))m=!0,u[2]=g,f[2]=Yt(c[2],h);else if(!isNaN(g)&&g>_)_=g,d[0]=c[2][0],d[1]=c[2][1];else if(g>_&&(_=g,d[0]=c[2][0],d[1]=c[2][1]),p=.5+O*k,O+=.01,k*=-1,p<.3||p>.7){if(!(_>=0))break;m=!0,u[2]=_,c[2][0]=d[0],c[2][1]=d[1],f[2]=Yt(c[2],h)}}while(!m);m=!1,p=.75,_=-1;do{if(g=NaN,c[3]=At(t,Ht(b[0],b[2],p),r,i),isNaN(c[3][0])||isNaN(c[3][1])||(g=(y=Tt(c[3],t,!1)).distance),!isNaN(g)&&g>r&&zt(c[3],t))m=!0,u[3]=g,f[3]=Yt(c[3],h);else if(g>_&&(_=g,d[0]=c[3][0],d[1]=c[3][1]),(p+=.01)>.9){if(!(_>=0))break;m=!0,u[3]=_,c[3][0]=d[0],c[3][1]=d[1],f[3]=Yt(c[3],h)}}while(!m);for(var P,x=[0,1,2,3],M=v?0:1,j=M;j<4;j++)for(var S=M;S<3;S++){var C=f[S],w=f[S+1];Vt(C,w)>0&&(P=x[S],x[S]=x[S+1],x[S+1]=P,f[S]=w,f[S+1]=C)}for(var I=M,L=0,z=0,T=M;T<4;T++){switch(T){case 0:z=2*u[x[T]];break;case 1:z=1.66666666*u[x[T]];break;case 2:z=1.33333333*u[x[T]];break;case 3:z=u[x[T]]}z>L&&(L=z,I=x[T])}return c[I]}({rings:Object(c.a)(t)})}function zt(t,e){var i,r=e.rings,n=0,a=Object(S.a)(r);try{for(a.s();!(i=a.n()).done;)for(var s=i.value,o=s.length,l=1;l<o;++l){var h=s[l-1],c=s[l];h[1]>t[1]!=c[1]>t[1]&&((c[0]-h[0])*(t[1]-h[1])-(c[1]-h[1])*(t[0]-h[0])>0?n++:n--)}}catch(u){a.e(u)}finally{a.f()}return 0!==n}function Tt(t,e,i){if(i&&zt(t,e))return{coord:t,distance:0};var r,n=1/0,a=0,s=0,o=[0,0],l=e.rings,h=Object(S.a)(l);try{for(h.s();!(r=h.n()).done;){var c=r.value;if(!(c.length<2))for(var u=0;u<c.length-1;u++){Object(Ct.j)(o,t,c,u);var f=Yt(t,o);f<n&&(n=f,a=o[0],s=o[1])}}}catch(v){h.e(v)}finally{h.f()}return{coord:[a,s],distance:Math.sqrt(n)}}function At(t,e,i,r){var n,a=[e,0],s=1/0,o=1/0,l=!1,h=!1,c=[[e,r[1]-1],[e,r[3]+1]],u=[0,0],f=[0,0],v=[0,0],y=[[0,0],[0,0]],d=Object(St.h)(),m=t.rings,p=Object(S.a)(m);try{for(p.s();!(n=p.n()).done;){var _=n.value;if(!(_.length<2))for(var b=1;b<_.length;b++)if(y[0][0]=_[b-1][0],y[0][1]=_[b-1][1],y[1][0]=_[b][0],y[1][1]=_[b][1],null!==Nt(d,y)&&(f[0]=c[0][0],f[1]=c[0][1],v[0]=c[1][0],v[1]=c[1][1],0!==Xt(d,f,v)&&Object(wt.e)(c[0],c[1],y[0],y[1],u))){var g=u[1];s>o?g<s&&(s=g,l=!0):g<o&&(o=g,h=!0)}}}catch(O){p.e(O)}finally{p.f()}return l&&h?a[1]=(s+o)/2:a[0]=a[1]=NaN,a}function Nt(t,e){if(e.length<2)return null;t||(t=Object(St.h)());var i=Object(d.a)(e[0],2),r=i[0],n=i[1],a=Object(d.a)(e[1],2),s=a[0],o=a[1];return t[0]=Math.min(r,s),t[1]=Math.min(n,o),t[2]=Math.max(r,s),t[3]=Math.max(n,o),t}var Ft=1,Et=4,Gt=3,Rt=12;function Xt(t,e,i){var r=Dt(e,t),n=Dt(i,t),a=t[0],s=t[1],o=t[2],l=t[3];if(r&n)return 0;if(!(r|n))return 4;var h=(r?1:0)|(n?2:0);do{var c=i[0]-e[0],u=i[1]-e[1];if(c>u)r&Gt?(r&Ft?(e[1]+=u*(a-e[0])/c,e[0]=a):(e[1]+=u*(o-e[0])/c,e[0]=o),r=Dt(e,t)):n&Gt?(n&Ft?(i[1]+=u*(a-i[0])/c,i[0]=a):(i[1]+=u*(o-i[0])/c,i[0]=o),n=Dt(i,t)):r?(r&Et?(e[0]+=c*(s-e[1])/u,e[1]=s):(e[0]+=c*(l-e[1])/u,e[1]=l),r=Dt(e,t)):(n&Et?(i[0]+=c*(s-i[1])/u,i[1]=s):(i[0]+=c*(l-i[1])/u,i[1]=l),n=Dt(i,t));else if(r&Rt?(r&Et?(e[0]+=c*(s-e[1])/u,e[1]=s):(e[0]+=c*(l-e[1])/u,e[1]=l),r=Dt(e,t)):n&Rt?(n&Et?(i[0]+=c*(s-i[1])/u,i[1]=s):(i[0]+=c*(l-i[1])/u,i[1]=l),n=Dt(i,t)):r?(r&Ft?(e[1]+=u*(a-e[0])/c,e[0]=a):(e[1]+=u*(o-e[0])/c,e[0]=o),r=Dt(e,t)):(n&Ft?(i[1]+=u*(a-i[0])/c,i[0]=a):(i[1]+=u*(o-i[0])/c,i[0]=o),n=Dt(i,t)),r&n)return 0}while(r|n);return h}function Dt(t,e){return(t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function Ht(t,e,i){return t+(e-t)*i}function Yt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function Vt(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;var i=isNaN(t),r=isNaN(e);return i<r?-1:i>r?1:0}var Bt=Object(n.a)((function t(e,i,n,a){Object(r.a)(this,t),this.x=e,this.y=i,this.cellSize=n,this.distancefromCellCenter=Object(Ct.c)(e,i,a),this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2}));var Wt=function(){function t(){Object(r.a)(this,t)}return Object(n.a)(t,[{key:"execute",value:function(t,e,i,r,n){return new Jt(t,e,i)}}],[{key:"local",value:function(){return null===t.instance&&(t.instance=new t),t.instance}}]),t}();Wt.instance=null;var Jt=function(){function t(e,i,n){Object(r.a)(this,t),this._geometryCursor=e,this._offsetX=void 0!==i.offsetX?i.offsetX*n:0,this._offsetY=void 0!==i.offsetY?i.offsetY*n:0,this._method=void 0!==i.method?i.method:m.w.OnPolygon,this._internalPlacement=new u.a}return Object(n.a)(t,[{key:"next",value:function(){var t=this._geometryCursor;return this._geometryCursor=null,t?this._polygonCenter(t):null}},{key:"_polygonCenter",value:function(t){var e=!1;switch(this._method){case m.w.CenterOfMass:var i=Object(xt.e)(t);i&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),e=!0);break;case m.w.BoundingBoxCenter:var r=Object($.d)(t);r&&(this._internalPlacement.setTranslate((r[2]+r[0])/2+this._offsetX,(r[3]+r[1])/2+this._offsetY),e=!0);break;case m.w.OnPolygon:default:var n;n=Object(Pt.a)("polylabel-placement-enabled")?function(t){if(!t.nextPath()||!t.numPoints)return null;var e=Object($.a)(t),i=e[2]-e[0],r=e[3]-e[1];if(0===i||0===r)return[e[0]+i/2,e[1]+r/2];var n=Math.max(Math.min(i,r)/100,1),a=new Mt((function(t,e){return e.maxDistanceToPolygon-t.maxDistanceToPolygon})),s=Math.min(i,r),o=s/2,l=0,h=0;for(l=e[0];l<e[2];l+=s)for(h=e[1];h<e[3];h+=s)a.enqueue(new Bt(l+o,h+o,o,t));var c=Object(xt.d)(t);if(null===c)return null;for(var u,f=new Bt(c[0],c[1],0,t);a.size>0;)(u=a.dequeue()).distancefromCellCenter>f.distancefromCellCenter&&(f=u),u.maxDistanceToPolygon-f.distancefromCellCenter<=n||(o=u.cellSize/2,a.enqueue(new Bt(u.x-o,u.y-o,o,t)),a.enqueue(new Bt(u.x+o,u.y-o,o,t)),a.enqueue(new Bt(u.x-o,u.y+o,o,t)),a.enqueue(new Bt(u.x+o,u.y+o,o,t)));return[f.x,f.y]}(t):Lt(t),null!==n&&(this._internalPlacement.setTranslate(n[0]+this._offsetX,n[1]+this._offsetY),e=!0)}return e?this._internalPlacement:null}}]),t}();function Ut(t){if(!t)return null;switch(t.type){case"CIMGeometricEffectAddControlPoints":return a.local();case"CIMGeometricEffectArrow":return O.local();case"CIMGeometricEffectBuffer":return M.local();case"CIMGeometricEffectControlMeasureLine":return C.local();case"CIMGeometricEffectCut":return I.local();case"CIMGeometricEffectDashes":return G.local();case"CIMGeometricEffectDonut":return X.local();case"CIMGeometricEffectJog":return H.local();case"CIMGeometricEffectMove":return V.local();case"CIMGeometricEffectOffset":return J.local();case"CIMGeometricEffectReverse":return q.local();case"CIMGeometricEffectRotate":return Q.local();case"CIMGeometricEffectScale":return et.local();case"CIMGeometricEffectWave":return rt.local()}return null}function qt(t){if(!t)return null;switch(t.type){case"CIMMarkerPlacementAlongLineSameSize":return at.local();case"CIMMarkerPlacementAtExtremities":return ot.local();case"CIMMarkerPlacementAtRatioPositions":return ht.local();case"CIMMarkerPlacementInsidePolygon":return dt.local();case"CIMMarkerPlacementOnLine":return _t.local();case"CIMMarkerPlacementOnVertices":return gt.local();case"CIMMarkerPlacementPolygonCenter":return Wt.local()}return null}},232:function(t,e,i){"use strict";i.d(e,"a",(function(){return B})),i.d(e,"b",(function(){return R})),i.d(e,"c",(function(){return E})),i.d(e,"d",(function(){return G})),i.d(e,"e",(function(){return F})),i.d(e,"f",(function(){return X})),i.d(e,"g",(function(){return Y})),i.d(e,"h",(function(){return V})),i.d(e,"i",(function(){return D})),i.d(e,"j",(function(){return U})),i.d(e,"k",(function(){return Z})),i.d(e,"l",(function(){return q}));var r=i(107),n=i(106),a=i(90),s=i(91),o=i(99),l=i(92),h=i(89),c=i(88),u=i(180),f=i(237),v=i(116),y=i(102),d=i(291),m=i(108),p=i(121),_=i(139),b=i(153),g=i(218),O=i(122),k=i(174),P=function(){function t(){Object(h.a)(this,t)}return Object(c.a)(t,[{key:"applyColorSubstituition",value:function(t,e){if(!e)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var i=t.width,r=t.height,n=this._rasterizationCanvas,a=n.getContext("2d");t!==n&&(n.width=i,n.height=r,a.drawImage(t,0,0,i,r));var s=a.getImageData(0,0,i,r).data;if(e){var h,c=Object(l.a)(e);try{for(c.s();!(h=c.n()).done;){var u=h.value;if(u&&u.oldColor&&4===u.oldColor.length&&u.newColor&&4===u.newColor.length){var f=Object(o.a)(u.oldColor,4),v=f[0],y=f[1],d=f[2],m=f[3],p=Object(o.a)(u.newColor,4),_=p[0],b=p[1],g=p[2],O=p[3];if(v===_&&y===b&&d===g&&m===O)continue;for(var k=0;k<s.length;k+=4)v===s[k]&&y===s[k+1]&&d===s[k+2]&&m===s[k+3]&&(s[k]=_,s[k+1]=b,s[k+2]=g,s[k+3]=O)}}}catch(x){c.e(x)}finally{c.f()}}var P=new ImageData(s,i,r);return a.putImageData(P,0,0),n}},{key:"tintImageData",value:function(t,e){if(!e||e.length<4)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));var i=t.width,r=t.height,n=this._rasterizationCanvas,a=n.getContext("2d");t!==n&&(n.width=i,n.height=r,a.drawImage(t,0,0,i,r));for(var s=a.getImageData(0,0,i,r),o=new Uint8Array(s.data),l=[e[0]/255,e[1]/255,e[2]/255,e[3]/255],h=0;h<o.length;h+=4)o[h]*=l[0],o[h+1]*=l[1],o[h+2]*=l[2],o[h+3]*=l[3];var c=new ImageData(new Uint8ClampedArray(o.buffer),i,r);return a.putImageData(c,0,0),n}}]),t}(),x=i(231),M=i(173),j=i(114);function S(t){var e=t.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;var i=document.createElement("canvas");i.width=t.width,i.height=t.height;var r=i.getContext("2d");return e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0),i}var C=i(211),w=i(334),I=i(152),L=i(155),z=i(104),T=i(198),A=Math.PI/180,N=y.a.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),F=4,E=10,G=10,R=4,X=10,D=function(){function t(e){Object(h.a)(this,t),this._t=e}return Object(c.a)(t,[{key:"clone",value:function(){return new t(this._t.slice())}},{key:"transform",value:function(t){var e=this._t;return[e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}},{key:"scale",value:function(t,e){var i=this._t;return i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=e,i[4]*=e,i[5]*=e,this}},{key:"scaleRatio",value:function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}},{key:"translate",value:function(t,e){var i=this._t;return i[2]+=t,i[5]+=e,this}},{key:"rotate",value:function(e){return t.multiply(this,t.createRotate(e),this)}},{key:"angle",value:function(){var t=this._t[0],e=this._t[3],i=Math.sqrt(t*t+e*e);return[t/i,e/i]}},{key:"invert",value:function(){var e=this._t,i=e[0]*e[4]-e[1]*e[3];if(0===i)return new t([0,0,0,0,0,0]);i=1/i;var r=(e[1]*e[5]-e[2]*e[4])*i,n=(e[2]*e[3]-e[0]*e[5])*i;return new t([e[4]*i,-e[1]*i,r,-e[3]*i,e[0]*i,n])}}],[{key:"createIdentity",value:function(){return new t([1,0,0,0,1,0])}},{key:"createScale",value:function(e,i){return new t([e,0,0,0,i,0])}},{key:"createTranslate",value:function(e,i){return new t([0,0,e,0,0,i])}},{key:"createRotate",value:function(e){var i=Math.cos(e),r=Math.sin(e);return new t([i,-r,0,r,i,0])}},{key:"multiply",value:function(t,e,i){var r=t._t,n=e._t,a=r[0]*n[0]+r[3]*n[1],s=r[1]*n[0]+r[4]*n[1],o=r[2]*n[0]+r[5]*n[1]+n[2],l=r[0]*n[3]+r[3]*n[4],h=r[1]*n[3]+r[4]*n[4],c=r[2]*n[3]+r[5]*n[4]+n[5],u=i._t;return u[0]=a,u[1]=s,u[2]=o,u[3]=l,u[4]=h,u[5]=c,i}}]),t}(),H=function(){function t(e,i){Object(h.a)(this,t),this._resourceManager=e,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new d.a(M.a,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(i||D.createIdentity()),this._sizeTransfos.push(i?i.scaleRatio():1)}return Object(c.a)(t,[{key:"setTransform",value:function(t,e){this._transfos=[t||D.createIdentity()],this._sizeTransfos=[e||(t?t.scaleRatio():1)]}},{key:"setGeomUnitsPerPoint",value:function(t){this._geomUnitsPerPoint=t}},{key:"transformPt",value:function(t){return this._transfos[this._transfos.length-1].transform(t)}},{key:"transformSize",value:function(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}},{key:"reverseTransformPt",value:function(t){return this._transfos[this._transfos.length-1].invert().transform(t)}},{key:"reverseTransformSize",value:function(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}},{key:"getTransformAngle",value:function(){return this._transfos[this._transfos.length-1].angle()}},{key:"geomUnitsPerPoint",value:function(){return this.isEmbedded()?1:this._geomUnitsPerPoint}},{key:"isEmbedded",value:function(){return this._transfos.length>1}},{key:"back",value:function(){return this._transfos[this._transfos.length-1]}},{key:"push",value:function(t,e){var i=e?t.scaleRatio():1;D.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*i)}},{key:"pop",value:function(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}},{key:"drawSymbol",value:function(t,e,i){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(t,e);break;case"CIMTextSymbol":this.drawTextSymbol(t,e,i)}}},{key:"drawMultiLayerSymbol",value:function(t,e){if(t&&e){var i=t.symbolLayers;if(i){var r=t.effects;if(r&&r.length>0){var n=this.executeEffects(r,e);if(n)for(var a=n.next();a;)this.drawSymbolLayers(i,a.asJSON()),a=n.next()}else this.drawSymbolLayers(i,e)}}}},{key:"executeEffects",value:function(t,e){var i,r=this._resourceManager.geometryEngine,n=new k.a(p.a.fromJSONCIM(e)),a=Object(l.a)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=Object(x.a)(s);o&&(n=o.execute(n,s,this.geomUnitsPerPoint(),null,r))}}catch(h){a.e(h)}finally{a.f()}return n}},{key:"drawSymbolLayers",value:function(t,e){for(var i=t.length;i--;){var r=t[i];if(r&&!1!==r.enable){var n=r.effects;if(n&&n.length>0){var a=this.executeEffects(n,e);if(a)for(var s=null;(s=a.next())&&(this.drawSymbolLayer(r,s.asJSON()),!this._earlyReturn););}else this.drawSymbolLayer(r,e);if(this._earlyReturn)return}}}},{key:"drawSymbolLayer",value:function(t,e){switch(t.type){case"CIMSolidFill":this.drawSolidFill(e,t.color);break;case"CIMHatchFill":this.drawHatchFill(e,t);break;case"CIMPictureFill":this.drawPictureFill(e,t);break;case"CIMGradientFill":this.drawGradientFill(e,t);break;case"CIMSolidStroke":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(e,t);break;case"CIMGradientStroke":this.drawGradientStroke(e,t);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(t,e)}}},{key:"drawHatchFill",value:function(t,e){var i=this._buildHatchPolyline(e,t,this.geomUnitsPerPoint());i&&(this.pushClipPath(t),this.drawMultiLayerSymbol(e.lineSymbol,i),this.popClipPath())}},{key:"drawPictureFill",value:function(t,e){}},{key:"drawGradientFill",value:function(t,e){}},{key:"drawPictureStroke",value:function(t,e){}},{key:"drawGradientStroke",value:function(t,e){}},{key:"drawMarkerLayer",value:function(t,e){var i=t.markerPlacement;if(i){var r=Object(x.b)(i);if(r){var n="CIMMarkerPlacementInsidePolygon"===i.type||"CIMMarkerPlacementPolygonCenter"===i.type&&i.clipAtBoundary;n&&this.pushClipPath(e);var a=r.execute(p.a.fromJSONCIM(e),i,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(a)for(var s=null;(s=a.next())&&(this.drawMarker(t,s),!this._earlyReturn););n&&this.popClipPath()}}else{var h=this._placementPool.acquire();if(Object(O.f)(e))h.tx=e.x,h.ty=e.y,this.drawMarker(t,h);else if(Object(O.g)(e)){var c,u=Object(g.b)(e);u&&(c=Object(o.a)(u,2),h.tx=c[0],h.ty=c[1],this.drawMarker(t,h))}else{var f,v=Object(l.a)(e.points);try{for(v.s();!(f=v.n()).done;){var y=f.value;if(h.tx=y[0],h.ty=y[1],this.drawMarker(t,h),this._earlyReturn)break}}catch(d){v.e(d)}finally{v.f()}}this._placementPool.release(h)}}},{key:"drawMarker",value:function(t,e){switch(t.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(t,e);break;case"CIMVectorMarker":this.drawVectorMarker(t,e)}}},{key:"drawPictureMarker",value:function(t,e){if(t){var i=this._resourceManager.getResource(t.url),r=Object(I.s)(t.size,E);if(!(null==i||r<=0)){var n=i.width,a=i.height;if(n&&a){var s=n/a,o=Object(I.s)(t.scaleX,1),l=D.createIdentity(),h=t.anchorPoint;if(h){var c=h.x,u=h.y;"Absolute"!==t.anchorPointUnits&&(c*=r*s*o,u*=r),l.translate(-c,-u)}var f=Object(I.s)(t.rotation);t.rotateClockwise&&(f=-f),this._mapRotation&&(f+=this._mapRotation),f&&l.rotate(f*A);var v=Object(I.s)(t.offsetX),y=Object(I.s)(t.offsetY);if(v||y){if(this._mapRotation){var d=A*this._mapRotation,m=Math.cos(d),p=Math.sin(d),_=v*p+y*m;v=v*m-y*p,y=_}l.translate(v,y)}var b=this.geomUnitsPerPoint();1!==b&&l.scale(b,b);var g=e.getAngle();g&&l.rotate(g),l.translate(e.tx,e.ty),this.push(l,!1),this.drawImage(t,r),this.pop()}}}}},{key:"drawVectorMarker",value:function(t,e){if(t){var i=t.markerGraphics;if(i){var r=Object(I.s)(t.size,E),n=t.frame,a=n?n.ymax-n.ymin:0,s=r&&a?r/a:1,o=D.createIdentity();n&&o.translate(.5*-(n.xmax+n.xmin),.5*-(n.ymax+n.ymin));var h=t.anchorPoint;if(h){var c=h.x,u=h.y;"Absolute"!==t.anchorPointUnits?n&&(c*=n.xmax-n.xmin,u*=n.ymax-n.ymin):(c/=s,u/=s),o.translate(-c,-u)}1!==s&&o.scale(s,s);var f=Object(I.s)(t.rotation);t.rotateClockwise&&(f=-f),this._mapRotation&&(f+=this._mapRotation),f&&o.rotate(f*A);var v=Object(I.s)(t.offsetX),y=Object(I.s)(t.offsetY);if(v||y){if(this._mapRotation){var d=A*this._mapRotation,m=Math.cos(d),p=Math.sin(d),_=v*p+y*m;v=v*m-y*p,y=_}o.translate(v,y)}var b=this.geomUnitsPerPoint();1!==b&&o.scale(b,b);var g=e.getAngle();g&&o.rotate(g),o.translate(e.tx,e.ty),this.push(o,t.scaleSymbolsProportionally);var O,k=Object(l.a)(i);try{for(k.s();!(O=k.n()).done;){var P=O.value;if(P&&P.symbol&&P.geometry||N.error("Invalid marker graphic",P),this.drawSymbol(P.symbol,P.geometry,P.textString),this._earlyReturn)break}}catch(x){k.e(x)}finally{k.f()}this.pop()}}}},{key:"drawTextSymbol",value:function(t,e,i){if(t&&Object(O.f)(e)&&!(Object(I.s)(t.height,X)<=0)){var r=D.createIdentity(),n=Object(I.s)(t.angle);(n=-n)&&r.rotate(n*A);var a=Object(I.s)(t.offsetX),s=Object(I.s)(t.offsetY);(a||s)&&r.translate(a,s);var o=this.geomUnitsPerPoint();1!==o&&r.scale(o,o),r.translate(e.x,e.y),this.push(r,!1),this.drawText(t,i),this.pop()}}},{key:"_buildHatchPolyline",value:function(t,e,i){var r=Object(I.s)(t.separation,R)*i,n=Object(I.s)(t.rotation);if(0===r)return null;r<0&&(r=-r);for(var a=0,s=.5*r;a>s;)a-=r;for(;a<-s;)a+=r;var o=Object(_.h)();Object(b.b)(o,e),o[0]-=s,o[1]-=s,o[2]+=s,o[3]+=s;for(var l=[[o[0],o[1]],[o[0],o[3]],[o[2],o[3]],[o[2],o[1]]];n>180;)n-=180;for(;n<0;)n+=180;var h,c,u,f,v=Math.cos(n*A),y=Math.sin(n*A),d=-r*y,m=r*v;a=Object(I.s)(t.offsetX)*i*y-Object(I.s)(t.offsetY)*i*v,h=u=Number.MAX_VALUE,c=f=-Number.MAX_VALUE;for(var p=0,g=l;p<g.length;p++){var O=g[p],k=O[0],P=O[1],x=v*k+y*P,M=-y*k+v*P;h=Math.min(h,x),u=Math.min(u,M),c=Math.max(c,x),f=Math.max(f,M)}for(var j=v*h-y*(u=Math.floor(u/r)*r)-d*a/r,S=y*h+v*u-m*a/r,C=v*c-y*u-d*a/r,w=y*c+v*u-m*a/r,L=1+Math.round((f-u)/r),z=[],T=0;T<L;T++)j+=d,S+=m,C+=d,w+=m,z.push([[j,S],[C,w]]);return{paths:z}}}]),t}(),Y=function(t){Object(a.a)(i,t);var e=Object(s.a)(i);function i(t,r){var n;return Object(h.a)(this,i),(n=e.call(this,t,r)).reset(),n}return Object(c.a)(i,[{key:"reset",value:function(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}},{key:"envelope",value:function(){return new C.a(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}},{key:"bounds",value:function(){return Object(_.o)(this._xmin,this._ymin,this._xmax,this._ymax)}},{key:"drawSolidFill",value:function(t){if(t&&!(this._clipCount>0))if(Object(O.g)(t))this._processPath(t.rings,0);else if(Object(O.h)(t))this._processPath(t.paths,0);else if(Object(O.d)(t)){var e=J(t);e&&this._processPath(e.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}},{key:"drawSolidStroke",value:function(t,e,i){if(t&&!(this._clipCount>0)){var r=.5*this.transformSize(Object(I.s)(i,F));if(Object(O.g)(t))this._processPath(t.rings,r);else if(Object(O.h)(t))this._processPath(t.paths,r);else if(Object(O.d)(t)){var n=J(t);n&&this._processPath(n.rings,r)}else console.error("drawSolidStroke unexpected geometry type!")}}},{key:"drawMarkerLayer",value:function(t,e){Object(O.g)(e)&&t.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._processPath(e.rings,0):Object(r.a)(Object(n.a)(i.prototype),"drawMarkerLayer",this).call(this,t,e)}},{key:"drawHatchFill",value:function(t,e){this.drawSolidFill(t)}},{key:"drawPictureFill",value:function(t,e){this.drawSolidFill(t)}},{key:"drawGradientFill",value:function(t,e){this.drawSolidFill(t)}},{key:"drawPictureStroke",value:function(t,e){this.drawSolidStroke(t,null,e.width)}},{key:"drawGradientStroke",value:function(t,e){this.drawSolidStroke(t,null,e.width)}},{key:"pushClipPath",value:function(t){this.drawSolidFill(t),this._clipCount++}},{key:"popClipPath",value:function(){this._clipCount--}},{key:"drawImage",value:function(t,e){var i=t.url,r=Object(I.s)(t.scaleX,1),n=r*e,a=e,s=this._resourceManager.getResource(i);e||null==s||(n=r*s.width,a=s.height),this._merge(this.transformPt([-n/2,-a/2]),0),this._merge(this.transformPt([-n/2,a/2]),0),this._merge(this.transformPt([n/2,-a/2]),0),this._merge(this.transformPt([n/2,a/2]),0)}},{key:"drawText",value:function(t,e){if(e&&0!==e.length){this._textRasterizer||(this._textRasterizer=new w.a);var i=K(t),r=this._textRasterizer.computeTextSize(e,i),n=Object(o.a)(r,2),a=n[0],s=n[1],l=0;switch(t.horizontalAlignment){case"Left":l=a/2;break;case"Right":l=-a/2}var h=0;switch(t.verticalAlignment){case"Bottom":h=s/2;break;case"Top":h=-s/2;break;case"Baseline":h=s/6}this._merge(this.transformPt([-a/2+l,-s/2+h]),0),this._merge(this.transformPt([-a/2+l,s/2+h]),0),this._merge(this.transformPt([a/2+l,-s/2+h]),0),this._merge(this.transformPt([a/2+l,s/2+h]),0)}}},{key:"_processPath",value:function(t,e){if(t){var i,r=Object(l.a)(t);try{for(r.s();!(i=r.n()).done;){var n=i.value,a=n?n.length:0;if(a>1){this._merge(this.transformPt(n[0]),e);for(var s=1;s<a;s++)this._merge(this.transformPt(n[s]),e)}}}catch(o){r.e(o)}finally{r.f()}}}},{key:"_merge",value:function(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e)}}]),i}(H),V=function(t){Object(a.a)(i,t);var e=Object(s.a)(i);function i(){var t;return Object(h.a)(this,i),(t=e.apply(this,arguments))._searchPoint=[0,0],t._searchDistPoint=0,t._textInfo=null,t}return Object(c.a)(i,[{key:"hitTest",value:function(t,e,i,r,n,a){var s=a*Object(m.c)(1);this.setTransform(),this.setGeomUnitsPerPoint(s),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/s,this._textInfo=r;var o=e&&("CIMPointSymbol"===e.type&&"Map"!==e.angleAlignment||"CIMTextSymbol"===e.type);return this._mapRotation=o?n:0,this._earlyReturn=!1,this.drawSymbol(e,i),this._earlyReturn}},{key:"drawSolidFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawHatchFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawPictureFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawGradientFill",value:function(t,e){this._hitTestFill(t)}},{key:"drawSolidStroke",value:function(t,e,i,r,n,a){this._hitTestStroke(t,i)}},{key:"drawPictureStroke",value:function(t,e){this._hitTestStroke(t,e.width)}},{key:"drawGradientStroke",value:function(t,e){this._hitTestStroke(t,e.width)}},{key:"drawMarkerLayer",value:function(t,e){t.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._hitTestFill(e):Object(r.a)(Object(n.a)(i.prototype),"drawMarkerLayer",this).call(this,t,e)}},{key:"pushClipPath",value:function(t){}},{key:"popClipPath",value:function(){}},{key:"drawImage",value:function(t,e){var i=t.url,r=Object(I.s)(t.scaleX,1),n=this._resourceManager.getResource(i);if(null!=n&&0!==n.height&&0!==e){var a=e*this.geomUnitsPerPoint(),s=a*r*(n.width/n.height),o=this.reverseTransformPt(this._searchPoint),l=this._searchDistPoint;Math.abs(o[0])<s/2+l&&Math.abs(o[1])<a/2+l&&(this._earlyReturn=!0)}}},{key:"drawText",value:function(t,e){var i,r,n=this._textInfo;if(n){var a=n.get(t);if(a){var s=a.text,o=a.mosaicItem;if(null!==o&&void 0!==o&&null!==(i=o.glyphMosaicItems)&&void 0!==i&&i.length){var h,c=Object(I.s)(t.height,X),f=t.lineGapType,v=t.lineGap,y=f?Z(f,Object(I.s)(v),c):0,d=Object(u.a)(s)[1],m=o.glyphMosaicItems,p="CIMBackgroundCallout"===(null===(r=t.callout)||void 0===r?void 0:r.type),_=Object(T.a)(m,d,{scale:c/z.y,angle:0,xOffset:0,yOffset:0,hAlign:U(t.horizontalAlignment),vAlign:q(t.verticalAlignment),maxLineWidth:512,lineHeight:z.B*Math.max(.25,Math.min(y||1,4)),decoration:t.font.decoration||"none",isCIM:!0,hasBackground:p}),b=this.reverseTransformPt(this._searchPoint),g=b[0],O=b[1],k=Object(l.a)(_.glyphs);try{for(k.s();!(h=k.n()).done;){var P=h.value;if(g>P.xTopLeft&&g<P.xBottomRight&&O>-P.yBottomRight&&O<-P.yTopLeft){this._earlyReturn=!0;break}}}catch(x){k.e(x)}finally{k.f()}}}}}},{key:"_hitTestFill",value:function(t){var e=null;if(Object(O.d)(t)){var i=t;e=[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]}else if(Object(O.g)(t))e=t.rings;else{if(!Object(O.h)(t))return;e=t.paths}var r=this.reverseTransformPt(this._searchPoint);if(this._pointInPolygon(r,e)&&(this._earlyReturn=!0),!this._earlyReturn){var n=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(r,e,n)&&(this._earlyReturn=!0)}}},{key:"_hitTestStroke",value:function(t,e){var i=null;if(Object(O.d)(t)){var r=t;i=[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]}else if(Object(O.g)(t))i=t.rings;else{if(!Object(O.h)(t))return;i=t.paths}var n=this.reverseTransformPt(this._searchPoint),a=Object(I.s)(e,F)*this.geomUnitsPerPoint(),s=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(n,i,a/2+s)&&(this._earlyReturn=!0)}},{key:"_pointInPolygon",value:function(t,e){var i,r=0,n=Object(l.a)(e);try{for(n.s();!(i=n.n()).done;)for(var a=i.value,s=a.length,o=1;o<s;o++){var h=a[o-1],c=a[o];h[1]>t[1]!=c[1]>t[1]&&((c[0]-h[0])*(t[1]-h[1])-(c[1]-h[1])*(t[0]-h[0])>0?r++:r--)}}catch(u){n.e(u)}finally{n.f()}return 0!==r}},{key:"_nearLine",value:function(t,e,i){var r,n=Object(l.a)(e);try{for(n.s();!(r=n.n()).done;)for(var a=r.value,s=a.length,o=1;o<s;o++){var h=a[o-1],c=a[o],u=(c[0]-h[0])*(c[0]-h[0])+(c[1]-h[1])*(c[1]-h[1]);if(0!==u){u=Math.sqrt(u);var f=((c[0]-h[0])*(t[1]-h[1])-(c[1]-h[1])*(t[0]-h[0]))/u;if(Math.abs(f)<i){var v=((c[0]-h[0])*(t[0]-h[0])+(c[1]-h[1])*(t[1]-h[1]))/u;if(v>-i&&v<u+i)return!0}}}}catch(y){n.e(y)}finally{n.f()}return!1}}]),i}(H),B=function(t){Object(a.a)(i,t);var e=Object(s.a)(i);function i(t,r,n,a){var s;return Object(h.a)(this,i),(s=e.call(this,r,n))._applyAdditionalRenderProps=a,s._colorSubstitutionHelper=new P,s._ctx=t,s}return Object(c.a)(i,[{key:"drawSolidFill",value:function(t,e){var i;if(t){if(Object(O.g)(t))this._buildPath(t.rings,!0);else if(Object(O.h)(t))this._buildPath(t.paths,!0);else if(Object(O.d)(t))this._buildPath(J(t).rings,!0);else{if(!Object(O.e)(t))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}var r=this._ctx;r.fillStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+(null!==(i=e[3])&&void 0!==i?i:255)/255+")",r.fill("evenodd")}}},{key:"drawSolidStroke",value:function(t,e,i,r,n,a){var s;if(t&&e&&0!==i){if(Object(O.g)(t))this._buildPath(t.rings,!0);else if(Object(O.h)(t))this._buildPath(t.paths,!1);else{if(!Object(O.d)(t))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(J(t).rings,!0)}var o=this._ctx;o.strokeStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+(null!==(s=e[3])&&void 0!==s?s:255)/255+")",o.lineWidth=Math.max(this.transformSize(i),.5),this._setCapStyle(r),this._setJoinStyle(n),o.miterLimit=a,o.stroke()}}},{key:"pushClipPath",value:function(t){if(this._ctx.save(),Object(O.g)(t))this._buildPath(t.rings,!0);else if(Object(O.h)(t))this._buildPath(t.paths,!0);else{if(!Object(O.d)(t))return;this._buildPath(J(t).rings,!0)}this._ctx.clip("evenodd")}},{key:"popClipPath",value:function(){this._ctx.restore()}},{key:"drawImage",value:function(t,e){var i=t.colorSubstitutions,r=t.url,n=t.tintColor,a=Object(I.s)(t.scaleX,1),s=this._resourceManager.getResource(r);if(null!=s){var l=e*(s.width/s.height),h=e;e||(l=s.width,h=s.height);var c=Object(I.A)(r)||"src"in s&&Object(I.A)(s.src),u="getFrame"in s?S(s):s;i&&(u=this._colorSubstitutionHelper.applyColorSubstituition(u,i)),this._applyAdditionalRenderProps&&!c&&n&&(u=this._colorSubstitutionHelper.tintImageData(u,n));var f=this.transformPt([0,0]),v=this.getTransformAngle(),y=Object(o.a)(v,2),d=y[0],m=y[1],p=this.transformSize(1),_=this._ctx;_.save(),_.setTransform({m11:a*p*d,m12:a*p*m,m21:-p*m,m22:p*d,m41:f[0],m42:f[1]}),_.drawImage(u,-l/2,-h/2,l,h),_.restore()}}},{key:"drawText",value:function(t,e){if(e&&0!==e.length){this._textRasterizer||(this._textRasterizer=new w.a);var i=K(t);i.size*=this.transformSize(Object(m.d)(1));var r=this._textRasterizer.rasterizeText(e,i);if(r){var n=r.size,a=r.anchorX,s=r.anchorY,l=r.canvas,h=n[0]*(a+.5),c=n[1]*(s-.5),u=this._ctx,f=this.transformPt([0,0]),v=this.getTransformAngle(),y=Object(o.a)(v,2),d=y[0],p=y[1];u.save(),u.setTransform({m11:1*d,m12:1*p,m21:-1*p,m22:1*d,m41:f[0]-1*h,m42:f[1]+1*c}),u.drawImage(l,0,0),u.restore()}}}},{key:"drawPictureFill",value:function(t,e){if(t){var i=e.colorSubstitutions,r=e.height,n=e.offsetX,a=e.offsetY,s=e.rotation,o=e.scaleX,l=e.tintColor,h=e.url,c=this._resourceManager.getResource(h);if(null!=c){if(Object(O.g)(t))this._buildPath(t.rings,!0);else if(Object(O.h)(t))this._buildPath(t.paths,!0);else if(Object(O.d)(t))this._buildPath(J(t).rings,!0);else{if(!Object(O.e)(t))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}var u,f=this._ctx,v=Object(I.A)(h)||"src"in c&&Object(I.A)(c.src),y="getFrame"in c?S(c):c;if(i&&(y=this._colorSubstitutionHelper.applyColorSubstituition(y,i)),this._applyAdditionalRenderProps){v||l&&(y=this._colorSubstitutionHelper.tintImageData(y,l)),u=f.createPattern(y,"repeat");var d=this.transformSize(1);s||(s=0),n?n*=d:n=0,a?a*=d:a=0,r&&(r*=d);var m=r?r/c.height:1,p=o&&r?o*r/c.width:1;if(0!==s||1!==m||1!==p||0!==n||0!==a){var _=new DOMMatrix;_.rotateSelf(0,0,-s).translateSelf(n,a).scaleSelf(p,m,1),u.setTransform(_)}}else u=f.createPattern(y,"repeat");f.save(),f.fillStyle=u,f.fill("evenodd"),f.restore()}}}},{key:"drawPictureStroke",value:function(t,e){if(t){var i=e.colorSubstitutions,r=e.capStyle,n=e.joinStyle,a=e.miterLimit,s=e.tintColor,o=e.url,h=e.width,c=this._resourceManager.getResource(o);if(null!=c){var u;if(Object(O.g)(t))u=t.rings;else if(Object(O.h)(t))u=t.paths;else{if(!Object(O.d)(t))return Object(O.e)(t)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;u=J(t).rings}h||(h=c.width);var f=Object(I.A)(o)||"src"in c&&Object(I.A)(c.src),y="getFrame"in c?S(c):c;i&&(y=this._colorSubstitutionHelper.applyColorSubstituition(y,i)),this._applyAdditionalRenderProps&&(f||s&&(y=this._colorSubstitutionHelper.tintImageData(y,s)));var d,p,_=Math.max(this.transformSize(Object(m.c)(h)),.5),b=_/y.width,g=this._ctx,k=g.createPattern(y,"repeat-y");g.save(),this._setCapStyle(r),this._setJoinStyle(n),void 0!==a&&(g.miterLimit=a),g.lineWidth=_;var P,x=Object(l.a)(u);try{for(x.s();!(P=x.n()).done;){var M=P.value;if(Q(M=Object(v.a)(M)),M&&!(M.length<=1)){d=this.transformPt(M[0]);for(var j=1;j<M.length;j++){var C=W(d,p=this.transformPt(M[j])),w=new DOMMatrix;w.translateSelf(0,d[1]-_/2).scaleSelf(b,b,1).rotateSelf(0,0,90-C),k.setTransform(w),g.strokeStyle=k,g.beginPath(),g.moveTo(d[0],d[1]),g.lineTo(p[0],p[1]),g.stroke(),d=p}}}}catch(L){x.e(L)}finally{x.f()}g.restore()}}}},{key:"_buildPath",value:function(t,e){var i=this._ctx;if(i.beginPath(),t){var r,n=Object(l.a)(t);try{for(n.s();!(r=n.n()).done;){var a=r.value,s=a?a.length:0;if(s>1){var o=this.transformPt(a[0]);i.moveTo(o[0],o[1]);for(var h=1;h<s;h++)o=this.transformPt(a[h]),i.lineTo(o[0],o[1]);e&&i.closePath()}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"_setCapStyle",value:function(t){switch(t){case j.q.Butt:this._ctx.lineCap="butt";break;case j.q.Round:this._ctx.lineCap="round";break;case j.q.Square:this._ctx.lineCap="square"}}},{key:"_setJoinStyle",value:function(t){switch(t){case j.s.Bevel:this._ctx.lineJoin="bevel";break;case j.s.Round:this._ctx.lineJoin="round";break;case j.s.Miter:this._ctx.lineJoin="miter"}}}]),i}(H);function W(t,e){var i=e[0]-t[0],r=e[1]-t[1];return 180/Math.PI*Math.atan2(r,i)}var J=function(t){return t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null},U=function(t){switch(t){case"Left":return L.a.Left;case"Right":return L.a.Right;case"Center":return L.a.Center;case"Justify":return N.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),L.a.Center}},q=function(t){switch(t){case"Top":return L.b.Top;case"Center":return L.b.Center;case"Bottom":return L.b.Bottom;case"Baseline":return L.b.Baseline}},Z=function(t,e,i){switch(t){case"ExtraLeading":return 1+e/i;case"Multiple":return e;case"Exact":return e/i}};function K(t){var e,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Object(I.i)(t),a=Object(I.j)(t.fontStyleName),s=null!==(e=t.fontFamilyName)&&void 0!==e?e:f.a,o=a.weight,l=a.style,h=r*(t.height||5),c=Object(I.k)(t.horizontalAlignment),u=Object(I.l)(t.verticalAlignment),v=Object(I.m)(t),y=Object(I.m)(t.haloSymbol),d=y?r*(0|t.haloSize):0,m="CIMBackgroundCallout"===(null===(i=t.callout)||void 0===i?void 0:i.type)?t.callout.backgroundSymbol:null,p=Object(I.m)(m),_=Object(I.q)(m),b=Object(I.p)(m);return{color:v,size:h,horizontalAlignment:c,verticalAlignment:u,font:{family:s,style:Object(I.n)(l),weight:Object(I.o)(o),decoration:n},halo:{size:d||0,color:y,style:l},backgroundColor:p,borderLine:null!=_&&null!=b?{size:_,color:b}:null,pixelRatio:1,premultiplyColors:!0}}var $=1e-4;function Q(t){for(var e,i,r,n,a,s=t[0],o=1;o<t.length;)e=t[o][0]-s[0],i=t[o][1]-s[1],n=0!==e?i/e:Math.PI/2,void 0!==r&&n-r<=$?(t.splice(o-1,1),s=a):(a=s,s=t[o],o++),r=n}},237:function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return d})),i.d(e,"c",(function(){return m})),i.d(e,"d",(function(){return v}));var r=i(4),n=i(12),a=i(88),s=i(89),o=i(187),l="arial-unicode-ms",h="woff2",c=new Map,u=new Set,f=Object(a.a)((function t(e,i){Object(s.a)(this,t),this.fontFace=e,this.promise=i}));function v(t){return y.apply(this,arguments)}function y(){return y=Object(n.a)(Object(r.a)().mark((function t(e){var i,n,a,s,l;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=m(e),!(n=c.get(i))){t.next=3;break}return t.abrupt("return",n.promise);case 3:if(a=new FontFace(e.family,"url('".concat(o.a.fontsUrl,"/woff2/").concat(i,".").concat(h,"') format('").concat(h,"')"),{style:e.style,weight:e.weight}),!(s=document.fonts).has(a)||"loading"!==a.status){t.next=6;break}return t.abrupt("return",a.loaded);case 6:return l=a.load().then((function(){return s.add(a),a})),t.abrupt("return",(c.set(i,new f(a,l)),u.add(a),l));case 8:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function d(t){if(!t)return l;var e=t.toLowerCase().split(" ").join("-");switch(e){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return e}}function m(t){var e=function(t){if(!t.weight)return"";switch(t.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(t)+function(t){if(!t.style)return"";switch(t.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(t);return d(t.family)+(e.length>0?e:"-regular")}},265:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a}));var r=i(141);function n(t,e){for(var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=Object(r.e)(t,0,l),o=0;o<4;o++)e[n+o]=Math.floor(256*((i=a*s[o])-Math.floor(i)))}function a(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0,r=0;r<4;r++)i+=t[e+r]*o[r];return i}var s=[1,256,65536,16777216],o=[1/256,1/65536,1/16777216,1/4294967296],l=a(new Uint8ClampedArray([255,255,255,255]))},276:function(t,e,i){"use strict";i.d(e,"a",(function(){return A})),i.d(e,"b",(function(){return G}));var r=i(1),n=i(99),a=i(112),s=i(4),o=i(92),l=i(12),h=i(89),c=i(88),u=i(143),f=i(237),v=i(116),y=i(102),d=i(108),m=i(213),p=i(207),_=i(232),b=i(179),g=i(114),O=.05;var k=new Set(["StartTimeOffset","Duration","RepeatDelay"]);function P(t,e){return k.has(e)?(i=t,Math.max(Math.round(i/O),1)*O):t;var i}var x=i(308),M=i(152),j=i(279),S=i(230),C=i(104),w=i(315),I=y.a.getLogger("esri.symbols.cim.cimAnalyzer");function L(t){switch(t){case"Butt":return g.e.BUTT;case"Square":return g.e.SQUARE;default:return g.e.ROUND}}function z(t){switch(t){case"Bevel":return g.p.BEVEL;case"Miter":return g.p.MITER;default:return g.p.ROUND}}function T(t){var e=t.markerPlacement;return e&&e.angleToLine?g.a.MAP:g.a.SCREEN}var A=function(){function t(e,i){Object(h.a)(this,t),this._cimLayers=[],this._poMap={},this._primitiveOverrides=[],this._resourceManager=e,this._info=i}return Object(c.a)(t,[{key:"analyzeSymbolReference",value:function(){var t=Object(l.a)(Object(s.a)().mark((function t(e,i,r){var n,a,l,h,c,u,f,v=this;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._cimLayers=null!==r&&void 0!==r?r:[],e){t.next=2;break}return t.abrupt("return",this._cimLayers);case 2:if(!e.primitiveOverrides){t.next=21;break}this._primitiveOverrides=e.primitiveOverrides,this._poMap={},n=[],a=this._info,l=Object(o.a)(this._primitiveOverrides),t.prev=6,c=Object(s.a)().mark((function t(){var e,i,r,o;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=h.value,(i=e.valueExpressionInfo)&&a?(r=i.expression,o=Object(p.d)(r,a.spatialReference,a.fields).then((function(t){null!=t&&v._setPoMap(e.primitiveName,e.propertyName,t)})),n.push(o)):null!=e.value&&v._setPoMap(e.primitiveName,e.propertyName,e.value),t.t0=n.length>0,!t.t0){t.next=7;break}return t.next=7,Promise.all(n);case 7:case"end":return t.stop()}}),t)})),l.s();case 9:if((h=l.n()).done){t.next=13;break}return t.delegateYield(c(),"t0",11);case 11:t.next=9;break;case 13:t.next=18;break;case 15:t.prev=15,t.t1=t.catch(6),l.e(t.t1);case 18:return t.prev=18,l.f(),t.finish(18);case 21:if(u=e.symbol,f=[],b.a.fetchResources(u,this._resourceManager,f),t.t2=f.length>0,!t.t2){t.next=27;break}return t.next=27,Promise.all(f);case 27:return this._analyzeSymbol(u,i),t.abrupt("return",this._cimLayers);case 29:case"end":return t.stop()}}),t,this,[[6,15,18,21]])})));return function(e,i,r){return t.apply(this,arguments)}}()},{key:"_analyzeSymbol",value:function(t,e){switch(null===t||void 0===t?void 0:t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this._analyzeMultiLayerSymbol(t,e,1,0,0,0)}}},{key:"_analyzeMultiLayerSymbol",value:function(t,e,i,r,n,s){var o,l=null===t||void 0===t?void 0:t.symbolLayers;if(l){var h=t.effects,c=g.a.SCREEN,u=null!==(o=b.a.getSize(t))&&void 0!==o?o:0;"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(c=g.a.MAP);for(var f="CIMPolygonSymbol"===t.type,v=l.length;v--;){var y,d=l[v];if(d&&!1!==d.enable){var m=void 0;h&&h.length&&(m=Object(a.a)(h));var p=d.effects;p&&p.length&&(h?(y=m).push.apply(y,Object(a.a)(p)):m=Object(a.a)(p));var _,O=[];b.c.findEffectOverrides(m,this._primitiveOverrides,O),_=O.length>0?this._createEffectsOverrideFunction(m,O):m;switch(b.c.findApplicableOverrides(d,this._primitiveOverrides,[]),d.type){case"CIMSolidFill":this._analyzeSolidFill(d,_);break;case"CIMPictureFill":this._analyzePictureFill(d,_);break;case"CIMHatchFill":this._analyzeHatchFill(d,_);break;case"CIMGradientFill":this._analyzeGradientFill(d,_);break;case"CIMSolidStroke":this._analyzeSolidStroke(d,_,f,u);break;case"CIMPictureStroke":this._analyzePictureStroke(d,_,f,u);break;case"CIMGradientStroke":this._analyzeGradientStroke(d,_,f,u);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":"CIMLineSymbol"===t.type&&(c=T(d));var k=[],P=d.primitiveName;P&&k.push(P),this._analyzeMarker(d,_,null,k,c,u,1,e,i,r,n,s);break;default:I.error("Cannot analyze CIM layer",d.type)}}}}}},{key:"_analyzeSolidFill",value:function(t,e){var i=t.primitiveName,r=Object(M.h)(t.color),a=this._analyzePrimitiveOverrides(i,e,null,null),s=Object(n.a)(a,2),o=s[0],l=s[1],h=Object(m.b)(JSON.stringify(t)+l).toString();this._cimLayers.push({type:"fill",templateHash:h,materialHash:o?function(){return h}:h,cim:t,materialOverrides:null,colorLocked:!!t.colorLocked,color:this._createOverrideFunction(i,"Color",r,F),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e,applyRandomOffset:!1,sampleAlphaOnly:!0})}},{key:"_analyzePictureFill",value:function(t,e){var i=t.primitiveName,r=Object(M.r)(t),a=this._analyzePrimitiveOverrides(i,e,null,null),s=Object(n.a)(a,2),o=s[0],l=s[1],h=Object(m.b)(JSON.stringify(t)+l).toString(),c=Object(m.b)("".concat(t.url).concat(JSON.stringify(t.colorSubstitutions))).toString(),u=Object(M.s)(t.height,_.d),f=Object(M.s)(t.scaleX,1);if("width"in t&&"number"==typeof t.width){var v=t.width,y=1,d=this._resourceManager.getResource(t.url);null!=d&&(y=d.width/d.height),f/=y*(u/v)}this._cimLayers.push({type:"fill",templateHash:h,materialHash:o?function(){return c}:c,cim:t,materialOverrides:null,colorLocked:!!t.colorLocked,effects:e,color:this._createOverrideFunction(i,"TintColor",r,F),height:this._createOverrideFunction(i,"Height",u),scaleX:this._createOverrideFunction(i,"ScaleX",f),angle:this._createOverrideFunction(i,"Rotation",Object(M.s)(t.rotation)),offsetX:this._createOverrideFunction(i,"OffsetX",Object(M.s)(t.offsetX)),offsetY:this._createOverrideFunction(i,"OffsetY",Object(M.s)(t.offsetY)),url:t.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}},{key:"_analyzeHatchFill",value:function(t,e){var i,r=this,a=t.primitiveName,s=this._analyzeMaterialOverrides(a,["Rotation","OffsetX","OffsetY"]),o=this._analyzePrimitiveOverrides(a,e,null,null),l=Object(n.a)(o,2),h=l[0],c=l[1],u=Object(m.b)(JSON.stringify(t)+c).toString(),f=Object(m.b)("".concat(t.separation).concat(JSON.stringify(t.lineSymbol))).toString(),v={r:255,g:255,b:255,a:1},y=!1,d=null===(i=t.lineSymbol)||void 0===i||null===(i=i.symbolLayers)||void 0===i?void 0:i.find((function(t){var e;return"CIMSolidStroke"===t.type&&null!=(null===(e=r._poMap[t.primitiveName])||void 0===e?void 0:e.Color)}));if(d){v=Object(M.h)(d.color);var p="function"==typeof(v=this._createOverrideFunction(d.primitiveName,"Color",v,F));h=h||p,y=null!=d.color||p}this._cimLayers.push({type:"fill",templateHash:u,materialHash:h&&s?this._createMaterialHashFunction(f,s):f,cim:t,materialOverrides:s,colorLocked:!!t.colorLocked,effects:e,color:v,height:this._createOverrideFunction(a,"Separation",Object(M.s)(t.separation,_.b)),scaleX:1,angle:this._createOverrideFunction(a,"Rotation",Object(M.s)(t.rotation)),offsetX:this._createOverrideFunction(a,"OffsetX",Object(M.s)(t.offsetX)),offsetY:this._createOverrideFunction(a,"OffsetY",Object(M.s)(t.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!y})}},{key:"_analyzeGradientFill",value:function(t,e){var i=t.primitiveName,r=this._analyzePrimitiveOverrides(i,e,null,null),a=Object(n.a)(r,2),s=a[0],o=a[1],l=Object(m.b)(JSON.stringify(t)+o).toString();this._cimLayers.push({type:"fill",templateHash:l,materialHash:s?function(){return l}:l,cim:t,materialOverrides:null,colorLocked:!!t.colorLocked,effects:e,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}},{key:"_analyzeSolidStroke",value:function(t,e,i,r){var s,o,l=t.primitiveName,h=Object(M.h)(t.color),c=Object(M.s)(t.width,_.e),u=L(t.capStyle),f=z(t.joinStyle),v=t.miterLimit,y=this._analyzePrimitiveOverrides(l,e,null,null),d=Object(n.a)(y,2),p=d[0],b=d[1],g=Object(m.b)(JSON.stringify(t)+b).toString();if(e&&e instanceof Array&&e.length>0){var O=e[e.length-1];if("CIMGeometricEffectDashes"===O.type&&"NoConstraint"===O.lineDashEnding&&null===O.offsetAlongLine){var k=(e=Object(a.a)(e)).pop();s=k.dashTemplate,o=k.scaleDash}}this._cimLayers.push({type:"line",templateHash:g,materialHash:p?function(){return g}:g,cim:t,materialOverrides:null,isOutline:i,colorLocked:!!t.colorLocked,effects:e,color:this._createOverrideFunction(l,"Color",h,F),width:this._createOverrideFunction(l,"Width",c),cap:this._createOverrideFunction(l,"CapStyle",u),join:this._createOverrideFunction(l,"JoinStyle",f),miterLimit:v&&this._createOverrideFunction(l,"MiterLimit",v),referenceWidth:r,zOrder:N(t.name),dashTemplate:s,scaleDash:o,sampleAlphaOnly:!0})}},{key:"_analyzePictureStroke",value:function(t,e,i,r){var a=Object(m.b)("".concat(t.url).concat(JSON.stringify(t.colorSubstitutions))).toString(),s=t.primitiveName,o=Object(M.r)(t),l=Object(M.s)(t.width,_.e),h=L(t.capStyle),c=z(t.joinStyle),u=t.miterLimit,f=this._analyzePrimitiveOverrides(s,e,null,null),v=Object(n.a)(f,2),y=v[0],d=v[1],p=Object(m.b)(JSON.stringify(t)+d).toString();this._cimLayers.push({type:"line",templateHash:p,materialHash:y?function(){return a}:a,cim:t,materialOverrides:null,isOutline:i,colorLocked:!!t.colorLocked,effects:e,color:this._createOverrideFunction(s,"TintColor",o,F),width:this._createOverrideFunction(s,"Width",l),cap:this._createOverrideFunction(s,"CapStyle",h),join:this._createOverrideFunction(s,"JoinStyle",c),miterLimit:u&&this._createOverrideFunction(s,"MiterLimit",u),referenceWidth:r,zOrder:N(t.name),dashTemplate:null,scaleDash:!1,url:t.url,sampleAlphaOnly:!1})}},{key:"_analyzeGradientStroke",value:function(t,e,i,r){var a=t.primitiveName,s=Object(M.s)(t.width,_.e),o=L(t.capStyle),l=z(t.joinStyle),h=t.miterLimit,c=this._analyzePrimitiveOverrides(a,e,null,null),u=Object(n.a)(c,2),f=u[0],v=u[1],y=Object(m.b)(JSON.stringify(t)+v).toString();this._cimLayers.push({type:"line",templateHash:y,materialHash:f?function(){return y}:y,cim:t,materialOverrides:null,isOutline:i,colorLocked:!!t.colorLocked,effects:e,color:{r:128,g:128,b:128,a:1},width:this._createOverrideFunction(a,"Width",s),cap:this._createOverrideFunction(a,"CapStyle",o),join:this._createOverrideFunction(a,"JoinStyle",l),miterLimit:h&&this._createOverrideFunction(a,"MiterLimit",h),referenceWidth:r,zOrder:N(t.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}},{key:"_analyzeMarker",value:function(t,e,i,r,n,a,s,o,l,h,c,u){var f=arguments.length>12&&void 0!==arguments[12]&&arguments[12];if(!this._analyzeMarkerInsidePolygon(t,e)){var v=Object(M.s)(t.size,_.c),y=Object(M.s)(t.rotation),d=Object(M.s)(t.offsetX),m=Object(M.s)(t.offsetY),p=this._createOverrideFunction(t.primitiveName,"Size",v),b=this._createOverrideFunction(t.primitiveName,"Rotation",y),g=this._createOverrideFunction(t.primitiveName,"OffsetX",d),O=this._createOverrideFunction(t.primitiveName,"OffsetY",m);p=this._transformSize(p,s),b=this._transformRotation(b,!!t.rotateClockwise,h);var k=this._transformOffsetX(g,O,h,s,c),P=this._transformOffsetY(g,O,h,s,u);switch(g=k,O=P,t.type){case"CIMPictureMarker":this._analyzePictureMarker(t,e,i,r,n,a,p,b,g,O,t.colorLocked||f);break;case"CIMVectorMarker":this._analyzeVectorMarker(t,e,i,r,n,a,s,o,p,b,g,O,t.colorLocked||f)}}}},{key:"_analyzeMarkerInsidePolygon",value:function(t,e){var i=t.markerPlacement,r=t.type;if(!i||"CIMMarkerPlacementInsidePolygon"!==i.type)return!1;if("CIMVectorMarker"===r||"CIMPictureMarker"===r){var a=t.primitiveName;if(a){var s=this._analyzePrimitiveOverrides([a],e,null,null),l=Object(n.a)(s,2),h=l[0];l[1];if(h)return!1}var c=i.primitiveName;if(c){var u=this._analyzePrimitiveOverrides([c],e,null,null),f=Object(n.a)(u,2),v=f[0];f[1];if(v)return!1}if("CIMVectorMarker"===r){var y=t.markerGraphics;if(y){var p,_=Object(o.a)(y);try{for(_.s();!(p=_.n()).done;){var b=p.value.symbol;if("CIMPolygonSymbol"===(null===b||void 0===b?void 0:b.type)&&b.symbolLayers){var g,O=b.symbolLayers,k=Object(o.a)(O);try{for(k.s();!(g=k.n()).done;){if("CIMSolidStroke"===g.value.type)return!1}}catch(R){k.e(R)}finally{k.f()}}}}catch(R){_.e(R)}finally{_.f()}}}else{if(t.animatedSymbolProperties)return!1}}var P=i,x=Math.abs(P.stepX),j=Math.abs(P.stepY);if(0===x||0===j)return!0;var S,w,I=["Rotation","OffsetX","OffsetY"],L=this._primitiveOverrides.filter((function(e){return e.primitiveName!==t.primitiveName||!I.includes(e.propertyName)})),z="url"in t&&"string"==typeof t.url?t.url:void 0,T=Object(m.b)(JSON.stringify(t)).toString(),A=null;if("Random"===i.gridType){var N=Object(d.d)(C.K),F=Math.max(Math.floor(N/x),1),E=Math.max(Math.floor(N/j),1);A=function(t){return t?t*E:0},w=F*x/(S=j*E)}else i.shiftOddRows?(S=2*j,A=function(t){return t?2*t:0},w=x/j*.5):(S=j,A=null,w=x/j);var G=Object(M.r)(t);return this._cimLayers.push({type:"fill",templateHash:T,materialHash:T,cim:t,materialOverrides:L,colorLocked:!!t.colorLocked,effects:e,color:G,height:this._createOverrideFunction(P.primitiveName,"StepY",S,A),scaleX:w,angle:P.gridAngle,offsetX:Object(M.s)(P.offsetX),offsetY:Object(M.s)(P.offsetY),url:z,applyRandomOffset:"Random"===i.gridType,sampleAlphaOnly:!z,hasUnresolvedReplacementColor:!0}),!0}},{key:"_analyzePictureMarker",value:function(t,e,i,r,a,s,o,l,h,c,u){var f,v=Object(M.s)(t.scaleX,1),y=Object(M.r)(t),d=Object(m.b)("".concat(t.url).concat(JSON.stringify(t.colorSubstitutions)).concat(JSON.stringify(t.animatedSymbolProperties))).toString();i||(i=this._createMarkerPlacementOverrideFunction(t.markerPlacement));var p=this._createAnimatedSymbolPropertiesOverrideFunction(t.animatedSymbolProperties),_=this._analyzePrimitiveOverrides(r,e,i,p),b=Object(n.a)(_,2),g=b[0],O=b[1],k=Object(m.b)(JSON.stringify(t)+O).toString(),P=null!==(f=t.anchorPoint)&&void 0!==f?f:{x:0,y:0};if("width"in t&&"number"==typeof t.width){var x=t.width,j=1,S=this._resourceManager.getResource(t.url);null!=S&&(j=S.width/S.height),v/=j*(Object(M.s)(t.size)/x)}function C(t,e){return null!=p?Object(M.g)(p,t,e):null}var I=t.animatedSymbolProperties&&!0===t.animatedSymbolProperties.randomizeStartTime?function(t,e,i,r){var n=Object(w.a)(null!==r&&void 0!==r?r:0),a=C(t,e);return d+"-MATERIALGROUP(".concat(n,")")+"-ASP(".concat(JSON.stringify(a),")")}:g?function(t,e){var i=C(t,e);return d+"-ASP(".concat(JSON.stringify(i),")")}:d;this._cimLayers.push({type:"marker",templateHash:k,materialHash:I,cim:t,materialOverrides:null,colorLocked:!!t.colorLocked||!!u,effects:e,scaleSymbolsProportionally:!1,alignment:a,size:o,scaleX:this._createOverrideFunction(t.primitiveName,"ScaleX",v),rotation:l,offsetX:h,offsetY:c,color:this._createOverrideFunction(t.primitiveName,"TintColor",y,F),anchorPoint:{x:P.x,y:P.y},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:!1,referenceSize:s,sizeRatio:1,markerPlacement:i,url:t.url,animatedSymbolProperties:p})}},{key:"_analyzeVectorMarker",value:function(t,e,i,r,n,a,s,l,h,c,u,f,v){var y=t.markerGraphics;if(y){var d=t.frame,m=0,p=1;t.scaleSymbolsProportionally&&d&&(m=d.ymax-d.ymin,p=this._transformSize(h,1/m)),p=this._transformSize(p,s),i||(i=this._createMarkerPlacementOverrideFunction(t.markerPlacement));var _,b=Object(o.a)(y);try{for(b.s();!(_=b.n()).done;){var g=_.value;if(g){var O=g.symbol;if(!O)continue;var k=g.primitiveName;k&&r.push(k);var P=u,x=f;if(("CIMPointSymbol"===O.type||"CIMTextSymbol"===O.type)&&d){var M=0,j=0,S=g.geometry;"x"in S&&"y"in S&&(M+=S.x-.5*(d.xmin+d.xmax),j+=S.y-.5*(d.ymin+d.ymax));var C=t.anchorPoint;C&&("Absolute"===t.anchorPointUnits?(M-=C.x,j-=C.y):d&&(M-=(d.xmax-d.xmin)*C.x,j-=(d.ymax-d.ymin)*C.y)),P=this._transformOffsetX(M,j,c,p,u),x=this._transformOffsetY(M,j,c,p,f)}switch(O.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":l?this._analyzeMultiLayerGraphicNonSDF(t,e,i,null,g,r,n,a,m,!!v||!!t.colorLocked):this._analyzeMultiLayerGraphic(t,e,i,null,g,r,n,a,m,p,h,c,P,x,!!v||!!t.colorLocked);break;case"CIMTextSymbol":this._analyzeTextGraphic(t,e,i,g,r,n,a,m,p,h,c,P,x,v)}k&&r.pop()}}}catch(w){b.e(w)}finally{b.f()}}}},{key:"_analyzeMultiLayerGraphic",value:function(t,e,i,a,s,l,h,c,u,f,v,y,d,p,_){var b=this,g=s.symbol,O=g.symbolLayers;if(O){var k=O.length;if(R(O))this._analyzeCompositeMarkerGraphic(t,e,i,a,s,O,l,h,c,u,v,y,d,p,!!_||!!t.colorLocked);else{var P=this._resourceManager.geometryEngine,S=j.a.applyEffects(g.effects,s.geometry,P);if(S)for(var C=function(){var g=O[k];if(!g||!1===g.enable)return 0;var C=g.primitiveName;switch(C&&l.push(C),g.type){case"CIMSolidFill":case"CIMSolidStroke":var w,I=j.a.applyEffects(g.effects,S,P),L=Object(x.b)(I);if(!L)return 0;var z="Relative"!==t.anchorPointUnits,T=Object(x.d)(L,t.frame,t.size,t.anchorPoint,z),A=Object(n.a)(T,3),N=A[0],E=A[1],G=A[2],R="CIMSolidFill"===g.type,X={type:"sdf",geom:I,asFill:R},D=g.path,H=Object(M.h)(R?Object(M.m)(g):Object(M.p)(g)),Y=R?{r:0,g:0,b:0,a:0}:Object(M.h)(Object(M.p)(g)),V=null!==(w=Object(M.q)(g))&&void 0!==w?w:0;if(!R&&!V)break;var B=s.primitiveName,W=null;!R||g.colorLocked||_||(W=b._createOverrideFunction(B,"FillColor",H,F));var J=null;g.colorLocked||_||(J=b._createOverrideFunction(B,"StrokeColor",Y,F));var U,q=b._createOverrideFunction(B,"StrokeWidth",V),Z=!1,K="",$=Object(o.a)(b._primitiveOverrides);try{for($.s();!(U=$.n()).done;){var Q=U.value;l.includes(Q.primitiveName)&&(null!=Q.value?K+="-".concat(Q.primitiveName,"-").concat(Q.propertyName,"-").concat(JSON.stringify(Q.value)):Q.valueExpressionInfo&&(Z=!0))}}catch(rt){$.e(rt)}finally{$.f()}(null!=e&&"function"==typeof e||null!=i&&"function"==typeof i)&&(Z=!0),(Object(M.y)(v)||Object(M.y)(y)||Object(M.y)(d)||Object(M.y)(p))&&(Z=!0);var tt=JSON.stringify(Object(r.a)(Object(r.a)({},t),{},{markerGraphics:null})),et=Object(m.b)(JSON.stringify(X)+D).toString(),it=Object(m.b)(JSON.stringify(s)+JSON.stringify(g)+tt+K).toString();b._cimLayers.push({type:"marker",templateHash:it,materialHash:Z?function(){return et}:et,cim:X,materialOverrides:null,colorLocked:!!g.colorLocked||!!_,effects:e,scaleSymbolsProportionally:!!t.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:E,y:G},isAbsoluteAnchorPoint:z,size:v,rotation:y,offsetX:d,offsetY:p,scaleX:1,frameHeight:u,rotateClockwise:!1,referenceSize:c,sizeRatio:N,color:Object(M.y)(W)?W:b._createOverrideFunction(C,"Color",H,F),outlineColor:Object(M.y)(J)?J:b._createOverrideFunction(C,"Color",Y,F),outlineWidth:Object(M.y)(q)?q:b._createOverrideFunction(C,"Width",V),markerPlacement:i,animatedSymbolProperties:a,path:D});break;case"CIMVectorMarker":g.markerPlacement?b._analyzeMultiLayerGraphicNonSDF(t,e,i,a,s,l,h,c,u,!!_||!!g.colorLocked):b._analyzeMarker(g,e,i,l,h,c,f,!1,v,y,d,p,!!_||!!t.colorLocked);break;default:b._analyzeMultiLayerGraphicNonSDF(t,e,i,a,s,l,h,c,u,!!_||!!t.colorLocked)}C&&l.pop()};k--;)C()}}}},{key:"_analyzeTextGraphic",value:function(t,e,i,a,s,l,h,c,u,v,y,d,p,g){var O,k;b.c.findApplicableOverrides(a,this._primitiveOverrides,[]);var P=a.geometry;if("x"in P&&"y"in P){var x=a.symbol,j=Object(M.i)(x),S=Object(M.j)(x.fontStyleName),C=Object(f.b)(x.fontFamilyName);x.font=Object(r.a)({family:C,decoration:j},S);var w=Object(M.s)(x.height,_.f),I=Object(M.s)(x.angle),L=Object(M.s)(x.offsetX),z=Object(M.s)(x.offsetY);w=this._transformSize(w,u),I=this._transformRotation(I,!1,y);var T=this._transformOffsetX(L,z,y,u,d),A=this._transformOffsetY(L,z,y,u,p);L=T,z=A;var N=Object(M.h)(Object(M.m)(x)),F=Object(M.h)(Object(M.p)(x)),E=null!==(O=Object(M.q)(x))&&void 0!==O?O:0;E||(F=Object(M.h)(Object(M.m)(x.haloSymbol)),E=Object(M.s)(x.haloSize)),E=this._transformSize(E,u);var G=null,R=null,X=0;if(x.callout&&"CIMBackgroundCallout"===x.callout.type){var D=x.callout;if(D.backgroundSymbol){var H=D.backgroundSymbol.symbolLayers;if(H){var Y,V=Object(o.a)(H);try{for(V.s();!(Y=V.n()).done;){var B=Y.value;"CIMSolidFill"===B.type?G=Object(M.h)(B.color):"CIMSolidStroke"===B.type&&(R=Object(M.h)(B.color),X=Object(M.s)(B.width,_.e))}}catch(it){V.e(it)}finally{V.f()}}}}var W=this._analyzePrimitiveOverrides(s,e,i,null),J=Object(n.a)(W,2),U=J[0],q=J[1],Z=JSON.stringify(t.effects)+Number(t.colorLocked||g).toString()+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement)+t.size.toString(),K=Object(m.b)(JSON.stringify(a)+Z+q).toString(),$=this._createOverrideFunction(a.primitiveName,"TextString",null!==(k=a.textString)&&void 0!==k?k:"",M.a,x.textCase);if(null!=$){var Q=x.fontStyleName,tt=C+(Q?"-"+Q.toLowerCase():"-regular"),et=tt;"string"==typeof $&&$.includes("[")&&x.fieldMap&&($=Object(M.f)(x.fieldMap,$,x.textCase)),this._cimLayers.push({type:"text",templateHash:K,materialHash:U||"function"==typeof $||/\[(.*?)\]/.test($)?function(t,e,i){return et+"-"+Object(M.g)($,t,e,i)}:et+"-"+Object(m.b)($),cim:x,materialOverrides:null,colorLocked:!!t.colorLocked||!!g,effects:e,alignment:l,anchorPoint:{x:0,y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:tt,decoration:j,weight:S.weight,style:S.style,size:w,angle:I,offsetX:L,offsetY:z,horizontalAlignment:Object(M.k)(x.horizontalAlignment),verticalAlignment:Object(M.l)(x.verticalAlignment),text:$,color:N,outlineColor:F,outlineSize:E,backgroundColor:G,borderLineColor:R,borderLineWidth:X,referenceSize:h,sizeRatio:1,markerPlacement:i})}}}},{key:"_analyzeMultiLayerGraphicNonSDF",value:function(t,e,i,r,a,s,o,l,h,c){var u=this._buildSimpleMarker(t,a),f=t.primitiveName,v=this._analyzeMaterialOverrides(f,["Rotation","OffsetX","OffsetY"]),y=this._analyzePrimitiveOverrides(s,null,null,null),p=Object(n.a)(y,2),g=(p[0],p[1]),O=b.a.getTextureAnchor(u,this._resourceManager),k=Object(n.a)(O,3),P=k[0],x=k[1],j=k[2],S=Object(M.s)(t.rotation),C=Object(M.s)(t.offsetX),w=Object(M.s)(t.offsetY),I=Object(m.b)(JSON.stringify(u)+g).toString(),L=v&&v.length>0||null!=e&&"function"==typeof e;this._cimLayers.push({type:"marker",templateHash:I,materialHash:L&&v?this._createMaterialHashFunction(I,v):I,cim:u,materialOverrides:v,colorLocked:!!t.colorLocked||!!c,effects:e,scaleSymbolsProportionally:!!t.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:P,y:x},isAbsoluteAnchorPoint:!1,size:Object(M.s)(t.size,_.c),rotation:this._createOverrideFunction(f,"Rotation",S),offsetX:this._createOverrideFunction(f,"OffsetX",C),offsetY:this._createOverrideFunction(f,"OffsetY",w),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:h,rotateClockwise:!!t.rotateClockwise,referenceSize:l,sizeRatio:j/Object(d.c)(t.size),markerPlacement:i,animatedSymbolProperties:r,avoidSDFRasterization:!0})}},{key:"_buildSimpleMarker",value:function(t,e){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[e],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath}}},{key:"_analyzeCompositeMarkerGraphic",value:function(t,e,i,a,s,l,h,c,u,f,v,y,d,p,b){var g=s.geometry,O=l[0],k=l[1],P=Object(x.b)(g);if(P){var j="Relative"!==t.anchorPointUnits,S=Object(x.d)(P,t.frame,t.size,t.anchorPoint,j),C=Object(n.a)(S,3),w=C[0],I=C[1],L=C[2],z={type:"sdf",geom:g,asFill:!0},T=k.path,A=k.primitiveName,N=O.primitiveName,E=Object(M.h)(k.color),G=Object(M.h)(O.color),R=Object(M.s)(O.width,_.e),X=s.primitiveName,D=null;k.colorLocked||b||(D=this._createOverrideFunction(X,"FillColor",E,F));var H=null;O.colorLocked||b||(H=this._createOverrideFunction(X,"StrokeColor",G,F));var Y,V=this._createOverrideFunction(X,"StrokeWidth",R),B=!1,W="",J=Object(o.a)(this._primitiveOverrides);try{for(J.s();!(Y=J.n()).done;){var U=Y.value;(U.primitiveName===A||U.primitiveName===N||h.includes(U.primitiveName))&&(null!=U.value?W+="-".concat(U.primitiveName,"-").concat(U.propertyName,"-").concat(JSON.stringify(U.value)):U.valueExpressionInfo&&(B=!0))}}catch($){J.e($)}finally{J.f()}null!=i&&"function"==typeof i&&(B=!0),(Object(M.y)(v)||Object(M.y)(y)||Object(M.y)(d)||Object(M.y)(p))&&(B=!0);var q=JSON.stringify(Object(r.a)(Object(r.a)({},t),{},{markerGraphics:null})),Z=Object(m.b)(JSON.stringify(z)+T).toString(),K=Object(m.b)(JSON.stringify(s)+JSON.stringify(k)+JSON.stringify(O)+q+W).toString();this._cimLayers.push({type:"marker",templateHash:K,materialHash:B?function(){return Z}:Z,cim:z,materialOverrides:null,colorLocked:!!b,effects:e,scaleSymbolsProportionally:!!t.scaleSymbolsProportionally,alignment:c,anchorPoint:{x:I,y:L},isAbsoluteAnchorPoint:j,size:v,rotation:y,offsetX:d,offsetY:p,scaleX:1,frameHeight:f,rotateClockwise:!1,referenceSize:u,sizeRatio:w,color:Object(M.y)(D)?D:this._createOverrideFunction(A,"Color",E,F),outlineColor:Object(M.y)(H)?H:this._createOverrideFunction(N,"Color",G,F),outlineWidth:Object(M.y)(V)?V:this._createOverrideFunction(N,"Width",R),markerPlacement:i,path:T,animatedSymbolProperties:a})}}},{key:"_createMaterialHashFunction",value:function(t,e){var i,r=null===(i=this._info)||void 0===i?void 0:i.geometryType;if(r){var n,a=this._poMap,s=Object(o.a)(e);try{var l=function(){var t=n.value;if(t.valueExpressionInfo){var e=a[t.primitiveName]&&a[t.primitiveName][t.propertyName];e instanceof p.a&&(t.fn=function(t,i,n){return Object(S.a)(e,t,{$view:n},r,i)})}};for(s.s();!(n=s.n()).done;)l()}catch(h){s.e(h)}finally{s.f()}}return function(i,r,n){var a,s=Object(o.a)(e);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.fn&&(l.value=l.fn(i,r,n))}}catch(h){s.e(h)}finally{s.f()}return Object(m.b)(t+b.c.buildOverrideKey(e)).toString()}}},{key:"_setPoMap",value:function(t,e,i){var r;this._poMap[t]?r=this._poMap[t]:(r={},this._poMap[t]=r),r[e]=i}},{key:"_createOverrideFunction",value:function(t,e,i,r,n){var a;if(null==t)return i;var s=this._poMap[t];if(null==s)return i;var o=s[e];if("string"==typeof o||"number"==typeof o||o instanceof Array)return r?r.call(null,o,n):o;var l=null===(a=this._info)||void 0===a?void 0:a.geometryType;return null!=o&&o instanceof p.a&&null!=l?function(t,e,a){var s=Object(S.a)(o,t,{$view:a},l,e);return null!==s&&r&&(s=r.call(null,s,n)),null!==s?s:i}:i}},{key:"_createEffectsOverrideFunction",value:function(t,e){var i,r,n=this._poMap,a=null===(i=this._info)||void 0===i?void 0:i.geometryType,s=Object(o.a)(e);try{var l=function(){var t=r.value;if(t.valueExpressionInfo&&a){var e=n[t.primitiveName]&&n[t.primitiveName][t.propertyName];e instanceof p.a&&(t.fn=function(t,i,r){return Object(S.a)(e,t,{$view:r},a,i)})}};for(s.s();!(r=s.n()).done;)l()}catch(h){s.e(h)}finally{s.f()}return function(i,r,n){var a,s=Object(o.a)(e);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.fn&&(l.value=l.fn(i,r,n))}}catch(h){s.e(h)}finally{s.f()}var c,u=[],f=Object(o.a)(t);try{for(f.s();!(c=f.n()).done;){var y,d=c.value,m=null===(y=d)||void 0===y?void 0:y.primitiveName;if(m){var p,_=!1,b=Object(o.a)(e);try{for(b.s();!(p=b.n()).done;){var g=p.value;if(g.primitiveName===m){var O=E(g.propertyName);null!=g.value&&g.value!==d[O]&&(_||(d=Object(v.a)(d),_=!0),d[O]=g.value)}}}catch(h){b.e(h)}finally{b.f()}}u.push(d)}}catch(h){f.e(h)}finally{f.f()}return u}}},{key:"_createMarkerPlacementOverrideFunction",value:function(t){var e,i=[];if(b.c.findApplicableOverrides(t,this._primitiveOverrides,i),null==t||0===i.length)return t;for(var r=this._poMap,n=null===(e=this._info)||void 0===e?void 0:e.geometryType,a=function(){var t=o[s];if(t.valueExpressionInfo&&n){var e=r[t.primitiveName]&&r[t.primitiveName][t.propertyName];e instanceof p.a&&(t.fn=function(t,i,r){return Object(S.a)(e,t,{$view:r},n,i)})}},s=0,o=i;s<o.length;s++)a();return function(e,r,n){for(var a=0,s=i;a<s.length;a++){var o=s[a];o.fn&&(o.value=o.fn(e,r,n))}for(var l=Object(v.a)(t),h=t.primitiveName,c=0,u=i;c<u.length;c++){var f=u[c];if(f.primitiveName===h){var y=E(f.propertyName);null!=f.value&&f.value!==l[y]&&(l[y]=f.value)}}return l}}},{key:"_createAnimatedSymbolPropertiesOverrideFunction",value:function(t){var e,i=[];if(b.c.findApplicableOverrides(t,this._primitiveOverrides,i),null==t||0===i.length)return t;var r=null===(e=this._info)||void 0===e?void 0:e.geometryType;if(r){var n,a=this._poMap,s=Object(o.a)(i);try{var l=function(){var t=n.value;if(t.valueExpressionInfo){var e=a[t.primitiveName]&&a[t.primitiveName][t.propertyName];e instanceof p.a&&(t.fn=function(t,i,n){return Object(S.a)(e,t,{$view:n},r,i)})}};for(s.s();!(n=s.n()).done;)l()}catch(h){s.e(h)}finally{s.f()}}return function(e,r,n){for(var a=0,s=i;a<s.length;a++){var o=s[a];o.fn&&(o.value=o.fn(e,r,n))}for(var l=Object(v.a)(t),h=t.primitiveName,c=0,u=i;c<u.length;c++){var f=u[c];if(f.primitiveName===h){var y=E(f.propertyName);if(null!=f.value){var d=P(f.value,f.propertyName);d!==l[y]&&(l[y]=d)}}}return l}}},{key:"_analyzePrimitiveOverrides",value:function(t,e,i,r){var n=!1,a="";"string"==typeof t&&(t=[t]);var s,l=Object(o.a)(this._primitiveOverrides);try{for(l.s();!(s=l.n()).done;){var h,c=s.value;(null===(h=t)||void 0===h?void 0:h.includes(c.primitiveName))&&(null!=c.value?a+="-".concat(c.primitiveName,"-").concat(c.propertyName,"-").concat(JSON.stringify(c.value)):c.valueExpressionInfo&&(n=!0))}}catch(u){l.e(u)}finally{l.f()}return null!=e&&"function"==typeof e&&(n=!0),null!=i&&"function"==typeof i&&(n=!0),null!=r&&"function"==typeof r&&(n=!0),[n,a]}},{key:"_analyzeMaterialOverrides",value:function(t,e){return this._primitiveOverrides.filter((function(i){return i.primitiveName!==t||!e.includes(i.propertyName)}))}},{key:"_transformSize",value:function(t,e){return Object(M.y)(t)||Object(M.y)(e)?function(i,r,n){return(Object(M.y)(t)?t(i,r,n):t)*(Object(M.y)(e)?e(i,r,n):e)}:t*e}},{key:"_transformRotation",value:function(t,e,i){return Object(M.y)(t)||Object(M.y)(i)?function(r,n,a){var s=Object(M.y)(t)?t(r,n,a):t,o=Object(M.y)(i)?i(r,n,a):i;return e?o-s:o+s}:e?i-t:i+t}},{key:"_transformOffsetX",value:function(t,e,i,r,n){if(!(Object(M.y)(t)||Object(M.y)(e)||Object(M.y)(i)||Object(M.y)(r)||Object(M.y)(n))){var a=i*Math.PI/180;if(a){var s=Math.cos(a),o=Math.sin(a);return(s*t-o*e)*r+n}return t*r+n}return function(a,s,o){var l=Object(M.y)(i)?i(a,s,o):i,h=Object(M.y)(r)?r(a,s,o):r,c=Object(M.y)(t)?t(a,s,o):t,u=Object(M.y)(n)?n(a,s,o):n;return l?(l*=Math.PI/180,(Math.cos(l)*c-Math.sin(l)*(Object(M.y)(e)?e(a,s,o):e))*h+u):c*h+u}}},{key:"_transformOffsetY",value:function(t,e,i,r,n){if(!(Object(M.y)(t)||Object(M.y)(e)||Object(M.y)(i)||Object(M.y)(r)||Object(M.y)(n))){var a=i*Math.PI/180;if(a){var s=Math.cos(a);return(Math.sin(a)*t+s*e)*r+n}return e*r+n}return function(a,s,o){var l=Object(M.y)(i)?i(a,s,o):i,h=Object(M.y)(r)?r(a,s,o):r,c=Object(M.y)(e)?e(a,s,o):e,u=Object(M.y)(n)?n(a,s,o):n;if(l){l*=Math.PI/180;var f=Math.cos(l);return(Math.sin(l)*(Object(M.y)(t)?t(a,s,o):t)+f*c)*h+u}return c*h+u}}}]),t}();function N(t){if(t&&0===t.indexOf("Level_")){var e=parseInt(t.substr(6),10);if(!isNaN(e))return e}return 0}function F(t){if(!t||0===t.length)return null;var e=new u.a(t).toRgba();return{r:e[0],g:e[1],b:e[2],a:e[3]}}function E(t){return t?t.charAt(0).toLowerCase()+t.substr(1):t}function G(t,e){if(!e||0===e.length)return t;var i=Object(v.a)(t);return b.c.applyOverrides(i,e),i}var R=function(t){return t&&2===t.length&&t[0].enable&&t[1].enable&&"CIMSolidStroke"===t[0].type&&"CIMSolidFill"===t[1].type&&!t[0].effects&&!t[1].effects}},279:function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var r=i(112),n=i(92),a=i(89),s=i(88),o=i(121),l=i(150),h=i(174),c=i(231),u=i(179),f=function(){function t(){Object(a.a)(this,t)}return Object(s.a)(t,null,[{key:"executeEffects",value:function(t,e,i,r){var a,s=Object(u.d)(t),o=new h.a(e),l=Object(n.a)(t);try{for(l.s();!(a=l.n()).done;){var f=a.value,v=Object(c.a)(f);v&&(o=v.execute(o,f,1.3333333333333333,i,r,s))}}catch(y){l.e(y)}finally{l.f()}return o}},{key:"applyEffects",value:function(t,e,i){if(!t)return e;var a,s,f=Object(u.d)(t),v=new h.a(o.a.fromJSONCIM(e)),y=Object(n.a)(t);try{for(y.s();!(s=y.n()).done;){var d=s.value,m=Object(c.a)(d);m&&(v=m.execute(v,d,1,null,i,f))}}catch(b){y.e(b)}finally{y.f()}for(var p=[],_=null;a=v.next();)p.push.apply(p,Object(r.a)(Object(l.a)(a))),_=a.geometryType;return 0===p.length||null===_?null:"esriGeometryPolygon"===_?{rings:p}:{paths:p}}}]),t}()},308:function(t,e,i){"use strict";i.d(e,"a",(function(){return v})),i.d(e,"b",(function(){return u})),i.d(e,"c",(function(){return h})),i.d(e,"d",(function(){return f}));var r=i(99),n=i(92),a=i(265),s=i(122),o=i(211),l=i(104);function h(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":var e=t.symbolLayers;return e&&1===e.length?h(e[0]):null;case"CIMVectorMarker":var i,r=t.markerGraphics;if(!r||1!==r.length)return null;var n=r[0];if(!n)return null;var a=n.geometry;if(!a)return null;var s=n.symbol;return!s||"CIMPolygonSymbol"!==s.type&&"CIMLineSymbol"!==s.type||null!==(i=s.symbolLayers)&&void 0!==i&&i.some((function(t){return!!t.effects}))?null:{geom:a,asFill:"CIMPolygonSymbol"===s.type};case"sdf":return{geom:t.geom,asFill:t.asFill}}return null}function c(t){var e,i=1/0,r=-1/0,a=1/0,s=-1/0,o=Object(n.a)(t);try{for(o.s();!(e=o.n()).done;){var l,h=e.value,c=Object(n.a)(h);try{for(c.s();!(l=c.n()).done;){var u=l.value;u[0]<i&&(i=u[0]),u[0]>r&&(r=u[0]),u[1]<a&&(a=u[1]),u[1]>s&&(s=u[1])}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return[i,a,r,s]}function u(t){return t?t.rings?c(t.rings):t.paths?c(t.paths):Object(s.d)(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function f(t,e,i,n,a){var s=Object(r.a)(t,4),o=s[0],h=s[1],c=s[2],u=s[3];if(c<o||u<h)return[0,0,0];var f=c-o,v=u-h,y=l.M,d=Math.floor(.5*(64-y)),m=(128-2*(d+y))/Math.max(f,v),p=Math.round(f*m)+2*d,_=Math.round(v*m)+2*d,b=1;e&&(b=_/m/(e.ymax-e.ymin));var g=0,O=0,k=1;n&&(a?e&&i&&e.ymax-e.ymin>0&&(k=(e.xmax-e.xmin)/(e.ymax-e.ymin),g=n.x/(i*k),O=n.y/i):(g=n.x,O=n.y)),e&&(g=.5*(e.xmax+e.xmin)+g*(e.xmax-e.xmin),O=.5*(e.ymax+e.ymin)+O*(e.ymax-e.ymin)),g-=o,O-=h,g*=m,O*=m;var P=(g+=d)/p-.5,x=(O+=d)/_-.5;return a&&i&&(P*=i*k,x*=i),[b,P,x]}function v(t){var e,i=function(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}(t.geom),a=function(t){var e,i=1/0,r=-1/0,a=1/0,s=-1/0,l=Object(n.a)(t);try{for(l.s();!(e=l.n()).done;){var h,c=e.value,u=Object(n.a)(c);try{for(u.s();!(h=u.n()).done;){var f=h.value;f[0]<i&&(i=f[0]),f[0]>r&&(r=f[0]),f[1]<a&&(a=f[1]),f[1]>s&&(s=f[1])}}catch(v){u.e(v)}finally{u.f()}}}catch(v){l.e(v)}finally{l.f()}return new o.a(i,a,r-i,s-a)}(i),s=l.M,h=Math.floor(.5*(64-s)),c=(128-2*(h+s))/Math.max(a.width,a.height),u=Math.round(a.width*c)+2*h,f=Math.round(a.height*c)+2*h,v=[],d=Object(n.a)(i);try{for(d.s();!(e=d.n()).done;){var m=e.value;if(m&&m.length>1){var p,_=[],b=Object(n.a)(m);try{for(b.s();!(p=b.n()).done;){var g=p.value,O=Object(r.a)(g,2),k=O[0],P=O[1];k-=a.x,P-=a.y,k*=c,P*=c,k+=h-.5,P+=h-.5,t.asFill?_.push([k,P]):_.push([Math.round(k),Math.round(P)])}}catch(j){b.e(j)}finally{b.f()}if(t.asFill){var x=_.length-1;_[0][0]===_[x][0]&&_[0][1]===_[x][1]||_.push(_[0])}v.push(_)}}}catch(j){d.e(j)}finally{d.f()}var M=function(t,e,i,r){for(var a=e*i,s=new Array(a),o=r*r+1,l=0;l<a;++l)s[l]=o;var h,c=Object(n.a)(t);try{for(c.s();!(h=c.n()).done;)for(var u=h.value,f=u.length,v=1;v<f;++v){var y=u[v-1],d=u[v],m=void 0,p=void 0,_=void 0,b=void 0;y[0]<d[0]?(m=y[0],p=d[0]):(m=d[0],p=y[0]),y[1]<d[1]?(_=y[1],b=d[1]):(_=d[1],b=y[1]);var g=Math.floor(m)-r,O=Math.floor(p)+r,k=Math.floor(_)-r,P=Math.floor(b)+r;g<0&&(g=0),O>e&&(O=e),k<0&&(k=0),P>i&&(P=i);for(var x=d[0]-y[0],M=d[1]-y[1],S=x*x+M*M,C=g;C<O;C++)for(var w=k;w<P;w++){var I=void 0,L=void 0,z=(C-y[0])*x+(w-y[1])*M;z<0?(I=y[0],L=y[1]):z>S?(I=d[0],L=d[1]):(z/=S,I=y[0]+z*x,L=y[1]+z*M);var T=(C-I)*(C-I)+(w-L)*(w-L),A=(i-w-1)*e+C;T<s[A]&&(s[A]=T)}}}catch(j){c.e(j)}finally{c.f()}for(var N=0;N<a;++N)s[N]=Math.sqrt(s[N]);return s}(v,u,f,h);return t.asFill&&function(t,e,i,r,a){var s,o=Object(n.a)(t);try{for(o.s();!(s=o.n()).done;)for(var l=s.value,h=l.length,c=1;c<h;++c){var u=l[c-1],f=l[c],v=void 0,y=void 0,d=void 0,m=void 0;u[0]<f[0]?(v=u[0],y=f[0]):(v=f[0],y=u[0]),u[1]<f[1]?(d=u[1],m=f[1]):(d=f[1],m=u[1]);var p=Math.floor(v),_=Math.floor(y)+1,b=Math.floor(d),g=Math.floor(m)+1;p<r&&(p=r),_>e-r&&(_=e-r),b<r&&(b=r),g>i-r&&(g=i-r);for(var O=b;O<g;++O)if(u[1]>O!=f[1]>O){for(var k=(i-O-1)*e,P=p;P<_;++P)P<(f[0]-u[0])*(O-u[1])/(f[1]-u[1])+u[0]&&(a[k+P]=-a[k+P]);for(var x=r;x<p;++x)a[k+x]=-a[k+x]}}}catch(j){o.e(j)}finally{o.f()}}(v,u,f,h,M),[y(M,h),u,f]}function y(t,e){for(var i=2*e,r=t.length,n=new Uint8Array(4*r),s=0;s<r;++s){var o=.5-t[s]/i;Object(a.a)(o,n,4*s)}return n}},315:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return n}));var r=i(213);function n(t,e){var i;if("string"==typeof t)i=Object(r.b)(t+"-seed(".concat(e,")"));else{var n=12;i=t^e;do{i=107*(i>>8^i)+n|0}while(0!=--n)}return(1+i/(1<<31))/2}function a(t){return Math.floor(n(t,s)*o)}var s=53290320,o=10},334:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var r=i(92),n=i(89),a=i(88),s=i(108),o=i(393);function l(t){return"rgba(".concat(t.slice(0,3).toString(),",").concat(t[3],")")}var h=function(){function t(e){Object(n.a)(this,t),e&&(this._textRasterizationCanvas=e)}return Object(a.a)(t,[{key:"rasterizeText",value:function(t,e){var i;this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var n=this._textRasterizationCanvas,a=n.getContext("2d");this._setFontProperties(a,e),this._parameters=e,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();var h=e.font,c=h.decoration,u=h.weight;this._lineThroughWidthOffset=c&&"line-through"===c?.1*this._lineHeight:0;var f=null!=e.backgroundColor||null!=e.borderLine,v=f?o.a:0,y=this._computeTextWidth(a,e)+2*v,d=this._lineHeight*this._textLines.length+2*v;if(n.width=y+2*this._lineThroughWidthOffset,n.height=d,0===n.width||0===n.height)return n.width=n.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:n};this._renderedLineHeight=Math.round(this._lineHeight*e.pixelRatio),this._renderedHaloSize=Object(s.c)(e.halo.size)*e.pixelRatio,this._renderedWidth=y*e.pixelRatio,this._renderedHeight=d*e.pixelRatio,this._lineThroughWidthOffset*=e.pixelRatio;var m=null!==(i=e.color)&&void 0!==i?i:[0,0,0,0],p=e.halo&&e.halo.color?e.halo.color:[0,0,0,0];this._fillStyle=l(m),this._haloStyle="rgb(".concat(p.slice(0,3).toString(),")");var _=this._renderedLineHeight,b=this._renderedHaloSize;a.save(),a.clearRect(0,0,n.width,n.height),this._setFontProperties(a,e);var g=v*e.pixelRatio,O=function(t,e){return"center"===t?.5*e:"right"===t?e:0}(a.textAlign,this._renderedWidth-2*g)+b+g,k=b+g,P=b>0,x=this._lineThroughWidthOffset,M=0;if(f){var j,S,C,w,I;a.save();var L=null!==(j=e.backgroundColor)&&void 0!==j?j:[0,0,0,0],z=null!==(S=null===(C=e.borderLine)||void 0===C?void 0:C.color)&&void 0!==S?S:[0,0,0,0],T=2*Object(s.c)(null!==(w=null===(I=e.borderLine)||void 0===I?void 0:I.size)&&void 0!==w?w:0);a.fillStyle=l(L),a.strokeStyle=l(z),a.lineWidth=T,a.fillRect(0,0,n.width,n.height),a.strokeRect(0,0,n.width,n.height),a.restore()}P&&this._renderHalo(a,O,k,x,M,e),M+=k,x+=O;var A,N=Object(r.a)(this._textLines);try{for(N.s();!(A=N.n()).done;){var F=A.value;P?(a.globalCompositeOperation="destination-out",a.fillStyle="rgb(0, 0, 0)",a.fillText(F,x,M),a.globalCompositeOperation="source-over",a.fillStyle=this._fillStyle,a.fillText(F,x,M)):(a.fillStyle=this._fillStyle,a.fillText(F,x,M)),c&&"none"!==c&&this._renderDecoration(a,x,M,c,u),M+=_}}catch(B){N.e(B)}finally{N.f()}a.restore();var E,G,R=this._renderedWidth+2*this._lineThroughWidthOffset,X=this._renderedHeight,D=a.getImageData(0,0,R,X),H=new Uint8Array(D.data);if(e.premultiplyColors)for(var Y,V=0;V<H.length;V+=4)Y=H[V+3]/255,H[V]=H[V]*Y,H[V+1]=H[V+1]*Y,H[V+2]=H[V+2]*Y;switch(e.horizontalAlignment){case"left":E=-.5;break;case"right":E=.5;break;default:E=0}switch(e.verticalAlignment){case"bottom":G=-.5;break;case"top":G=.5;break;default:G=0}return{size:[R,X],image:new Uint32Array(H.buffer),sdf:!1,simplePattern:!1,anchorX:E,anchorY:G,canvas:n}}},{key:"_renderHalo",value:function(t,e,i,r,n,a){var s=this._renderedWidth,o=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=s,this._haloRasterizationCanvas.height=o;var l=this._haloRasterizationCanvas,h=l.getContext("2d");h.clearRect(0,0,s,o),this._setFontProperties(h,a);var c=a.font,u=c.decoration,f=c.weight;h.fillStyle=this._haloStyle,h.strokeStyle=this._haloStyle,h.lineJoin="round",this._renderHaloNative(h,e,i,u,f),t.globalAlpha=this._parameters.halo.color[3],t.drawImage(l,0,0,s,o,r,n,s,o),t.globalAlpha=1}},{key:"_renderHaloNative",value:function(t,e,i,n,a){var s,o=this._renderedLineHeight,l=this._renderedHaloSize,h=Object(r.a)(this._textLines);try{for(h.s();!(s=h.n()).done;){for(var c=s.value,u=2*l,f=0;f<5;f++){var v=(.6+.1*f)*u;t.lineWidth=v,t.strokeText(c,e,i),n&&"none"!==n&&this._renderDecoration(t,e,i,n,a,v)}i+=o}}catch(y){h.e(y)}finally{h.f()}}},{key:"_setFontProperties",value:function(t,e){var i,r=Math.max(e.size,.5),n=e.font,a="".concat(n.style," ").concat(n.weight," ").concat(Object(s.c)(r*e.pixelRatio).toFixed(1),"px ").concat(n.family,", sans-serif");switch(t.font=a,t.textBaseline="top",e.horizontalAlignment){case"left":default:i="left";break;case"right":i="right";break;case"center":i="center"}t.textAlign=i}},{key:"computeTextSize",value:function(t,e){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var i=this._textRasterizationCanvas,r=i.getContext("2d");this._setFontProperties(r,e),this._parameters=e,this._textLines=t.split(/\r?\n/),this._lineHeight=this._computeLineHeight();var n=this._computeTextWidth(r,e),a=this._lineHeight*this._textLines.length;return i.width=n,i.height=a,[n*e.pixelRatio,a*e.pixelRatio]}},{key:"_computeTextWidth",value:function(t,e){var i,n=0,a=Object(r.a)(this._textLines);try{for(a.s();!(i=a.n()).done;){var o=i.value;n=Math.max(n,t.measureText(o).width)}}catch(h){a.e(h)}finally{a.f()}var l=e.font;return("italic"===l.style||"oblique"===l.style||"string"==typeof l.weight&&("bold"===l.weight||"bolder"===l.weight)||"number"==typeof l.weight&&l.weight>600)&&(n+=.3*t.measureText("w").width),n+=2*Object(s.c)(this._parameters.halo.size),Math.round(n)}},{key:"_computeLineHeight",value:function(){var t=1.275*this._parameters.size,e=this._parameters.font.decoration;return e&&"underline"===e&&(t*=1.3),Math.round(t+2*Object(s.c)(this._parameters.halo.size))}},{key:"_renderDecoration",value:function(t,e,i,r,n,a){var s=.9*this._lineHeight,o="bold"===n?.06:"bolder"===n?.09:.04;switch(t.textAlign){case"center":e-=this._renderedWidth/2;break;case"right":e-=this._renderedWidth}var l=t.textBaseline;if("underline"===r)switch(l){case"top":i+=s;break;case"middle":i+=s/2}else if("line-through"===r)switch(l){case"top":i+=s/1.5;break;case"middle":i+=s/3}var h=a?1.5*a:Math.ceil(s*o);t.save(),t.beginPath(),t.strokeStyle=t.fillStyle,t.lineWidth=h,t.moveTo(e-this._lineThroughWidthOffset,i),t.lineTo(e+this._renderedWidth+2*this._lineThroughWidthOffset,i),t.stroke(),t.restore()}}]),t}()}}]);
//# sourceMappingURL=47.45eb85fb.chunk.js.map
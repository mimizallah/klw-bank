{"version":3,"sources":["../node_modules/@arcgis/core/layers/support/RasterWorker.js"],"names":["N","_classCallCheck","_createClass","key","value","r","t","e","fromJSON","pixelBlock","s","u","type","Promise","resolve","toJSON","f","_decode","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","data","options","sent","abrupt","stop","_x","apply","arguments","extent","h","this","symbolizer","symbolize","_updateSymbolizer","_callee2","_this$symbolizer","_context2","y","symbolizerJSON","histograms","rendererJSON","_x2","_updateRasterFunction","_callee3","_context3","rasterFunction","a","rasterFunctionJSON","_x3","_process","_callee4","_r$primaryPixelSizes","_context4","process","primaryPixelBlocks","map","primaryPixelSizes","O","primaryRasterIds","_x4","simpleStretch","srcPixelBlock","stretchParams","p","tileSize","maximumPyramidLevel","forEach","set","_mosaicAndTransform","_callee5","_l","l","_context5","srcPixelBlocks","o","srcMosaicSize","blockWidths","alignmentInfo","clipOffset","clipSize","coefs","i","destDimension","sampleSpacing","interpolation","projectDirections","gcsGrid","n","S","isUV","localNorthDirections","_x5","_createFlowMesh","_callee6","_yield$x","_context6","Float32Array","flowData","buffer","mask","Uint8Array","maskBuffer","width","height","x","meshType","simulationSettings","signal","vertexData","indexData","result","vertexBuffer","indexBuffer","transferList","_x6","_x7","_getProjectionOffsetGrid","_callee7","_context7","projectedExtent","srcBufferExtent","datumTransformationSteps","steps","t0","includeGCSGrid","spatialReference","m","rasterTransform","d","c","_objectSpread","datumTransformation","_x8"],"mappings":"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","file":"static/js/325.ad36e417.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import r from\"../../geometry/support/GeographicTransformation.js\";import e from\"./PixelBlock.js\";import{decode as t}from\"./rasterFormats/RasterCodec.js\";import{split as s,mosaic as o,approximateTransform as i,getLocalArithmeticNorthRotations as n}from\"./rasterFunctions/pixelUtils.js\";import{create as a}from\"./rasterFunctions/rasterFunctionHelper.js\";import{requirePE as l,load as m,getProjectionOffsetGrid as c}from\"./rasterFunctions/rasterProjectionHelper.js\";import{computeStatisticsHistograms as f,estimateStatisticsHistograms as p}from\"./rasterFunctions/stretchUtils.js\";import{convertVectorFieldData as u,convertToLocalDirections as S}from\"./rasterFunctions/vectorFieldUtils.js\";import{readTransform as d}from\"./rasterTransforms/utils.js\";import y from\"../../renderers/support/RasterSymbolizer.js\";import{createFlowMesh as x}from\"../../views/2d/engine/flow/dataUtils.js\";import h from\"../../geometry/Extent.js\";import O from\"../../geometry/Point.js\";class N{convertVectorFieldData(r){const t=e.fromJSON(r.pixelBlock),s=u(t,r.type);return Promise.resolve(null!=s?s.toJSON():null)}computeStatisticsHistograms(r){const t=e.fromJSON(r.pixelBlock),s=f(t);return Promise.resolve(s)}async decode(r){const e=await t(r.data,r.options);return e&&e.toJSON()}symbolize(r){r.pixelBlock=e.fromJSON(r.pixelBlock),r.extent=r.extent?h.fromJSON(r.extent):null;const t=this.symbolizer.symbolize(r);return Promise.resolve(null!=t?t.toJSON():null)}async updateSymbolizer(r){this.symbolizer=y.fromJSON(r.symbolizerJSON),r.histograms&&\"rasterStretch\"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=r.histograms)}async updateRasterFunction(r){this.rasterFunction=a(r.rasterFunctionJSON)}async process(r){const t=this.rasterFunction.process({extent:h.fromJSON(r.extent),primaryPixelBlocks:r.primaryPixelBlocks.map((r=>null!=r?e.fromJSON(r):null)),primaryPixelSizes:r.primaryPixelSizes?.map((r=>null!=r?O.fromJSON(r):null)),primaryRasterIds:r.primaryRasterIds});return null!=t?t.toJSON():null}stretch(r){const t=this.symbolizer.simpleStretch(e.fromJSON(r.srcPixelBlock),r.stretchParams);return Promise.resolve(null!=t&&t.toJSON())}estimateStatisticsHistograms(r){const t=p(e.fromJSON(r.srcPixelBlock));return Promise.resolve(t)}split(r){const t=s(e.fromJSON(r.srcPixelBlock),r.tileSize,r.maximumPyramidLevel);return t&&t.forEach(((r,e)=>{t.set(e,r?.toJSON())})),Promise.resolve(t)}async mosaicAndTransform(r){const t=r.srcPixelBlocks.map((r=>r?new e(r):null)),s=o(t,r.srcMosaicSize,{blockWidths:r.blockWidths,alignmentInfo:r.alignmentInfo,clipOffset:r.clipOffset,clipSize:r.clipSize});let a,l=s;return r.coefs&&(l=i(s,r.destDimension,r.coefs,r.sampleSpacing,r.interpolation)),r.projectDirections&&r.gcsGrid&&(a=n(r.destDimension,r.gcsGrid),l=S(l,r.isUV?\"vector-uv\":\"vector-magdir\",a)),{pixelBlock:l?.toJSON(),localNorthDirections:a}}async createFlowMesh(r,e){const t={data:new Float32Array(r.flowData.buffer),mask:new Uint8Array(r.flowData.maskBuffer),width:r.flowData.width,height:r.flowData.height},{vertexData:s,indexData:o}=await x(r.meshType,r.simulationSettings,t,e.signal);return{result:{vertexBuffer:s.buffer,indexBuffer:o.buffer},transferList:[s.buffer,o.buffer]}}async getProjectionOffsetGrid(e){const t=h.fromJSON(e.projectedExtent),s=h.fromJSON(e.srcBufferExtent);let o=null;e.datumTransformationSteps&&(o=new r({steps:e.datumTransformationSteps})),(e.includeGCSGrid||l(t.spatialReference,s.spatialReference,o))&&await m();const i=e.rasterTransform?d(e.rasterTransform):null;return c({...e,projectedExtent:t,srcBufferExtent:s,datumTransformation:o,rasterTransform:i})}}export{N as default};\n"],"sourceRoot":""}
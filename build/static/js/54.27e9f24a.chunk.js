(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[54],{1031:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return w})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return F})),r.d(t,"f",(function(){return j})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return k}));var a=r(112),n=r(4),s=r(12),u=r(92),i=r(89),o=r(88),c=r(129),l=r(98),d=r(110),p=r(538),f=function(){function e(t,r,a){Object(i.a)(this,e),this.assetName=t,this.assetMimeType=r,this.parts=a}return Object(o.a)(e,[{key:"equals",value:function(e){return this===e||this.assetName===e.assetName&&this.assetMimeType===e.assetMimeType&&Object(l.f)(this.parts,e.parts,(function(e,t){return e.equals(t)}))}},{key:"isOnService",value:function(e){return this.parts.every((function(t){return t.isOnService(e)}))}},{key:"makeHash",value:function(){var e,t="",r=Object(u.a)(this.parts);try{for(r.s();!(e=r.n()).done;){t+=e.value.partHash}}catch(a){r.e(a)}finally{r.f()}return t}},{key:"toBlob",value:function(){var e=Object(s.a)(Object(n.a)().mark((function e(t){var r,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==(r=this.parts).length){e.next=3;break}return e.abrupt("return",r[0].toBlob(t));case 3:return e.next=5,Promise.all(r.map((function(e){return e.toBlob(t)})));case 5:return a=e.sent,e.abrupt("return",(Object(d.n)(t),new Blob(a)));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),h=function(){function e(t,r){Object(i.a)(this,e),this.partUrl=t,this.partHash=r}return Object(o.a)(e,[{key:"equals",value:function(e){return this===e||this.partUrl===e.partUrl&&this.partHash===e.partHash}},{key:"isOnService",value:function(e){return this.partUrl.startsWith("".concat(e.path,"/assets/"))}},{key:"toBlob",value:function(){var e=Object(s.a)(Object(n.a)().mark((function e(t){var r,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.default)(this.partUrl,{responseType:"blob"});case 2:return r=e.sent,a=r.data,e.abrupt("return",(Object(d.n)(t),a));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function b(e){return function(e){if(!e)return!1;if(Array.isArray(e))return e.some(O);return O(e)}(null===e||void 0===e?void 0:e.source)}function y(e){return!!Array.isArray(e)&&e.every((function(e){return e instanceof f}))}var v=/^(model\/gltf\+json)|(model\/gltf-binary)$/,m=/\.(gltf|glb)/i;function O(e){if(e instanceof File){var t=e.type,r=e.name;return v.test(t)||m.test(r)}return v.test(e.assetMimeType)||m.test(e.assetName)}function g(e,t){return!!e&&function(e,t){if(Array.isArray(e))return e.every((function(e){return x(e,t)}));return x(e,t)}(e.source,t)}function j(e,t){if(e===t)return!0;var r=e.source,n=t.source;if(r===n)return!0;if(y(r)&&y(n)){if(r.length!==n.length)return!1;for(var s=function(e,t){return e.assetName<t.assetName?-1:e.assetName>t.assetName?1:0},u=Object(a.a)(r).sort(s),i=Object(a.a)(n).sort(s),o=0;o<u.length;++o)if(!u[o].equals(i[o]))return!1;return!0}return!1}function x(e,t){return e instanceof f&&e.isOnService(t)}function w(e,t){var r,a;return e instanceof File?null!==(r=Object(p.b)(e.name,t))&&void 0!==r?r:Object(p.d)(e.type,t):null!==(a=Object(p.d)(e.assetMimeType,t))&&void 0!==a?a:Object(p.b)(e.assetName,t)}function F(e){return Array.isArray(e)?e:[e]}function k(e){return!!e.original}},2273:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return te}));var a=r(99),n=r(92),s=r(112),u=r(1),i=r(4),o=r(12),c=r(89),l=r(88),d=r(90),p=r(91),f=r(94),h=(r(119),r(172)),b=r(277),y=r(129),v=r(365),m=r(98),O=r(101),g=r(93),j=r(146),x=r(329),w=r(102),F=r(263),k=r(110),A=r(194),S=r(128),R=r(564),I=r(97),E=(r(96),r(95)),q=r(130),_=r(206),T=r(122),M=r(379),N=r(331),U=r(599),B=r(528);function C(e){if(e.vertexSpace.isRelative)return e.clone();var t=e.anchor.clone(),r=Object(M.f)(J,[-t.x,-t.y,-t.z]),a=new U.a({origin:[t.x,t.y,t.z]}),n=e.cloneWithVertexSpace(a),s=n.vertexAttributes.position;return n.vertexAttributes.position=Object(B.h)(new Float64Array(s.length),s,r),n.vertexAttributesChanged(),n}var J=Object(N.d)(),D=r(1031),G=r(912),L=r(449),P=r(1788),Q=r(324),V=r(538),z=r(572),H=r(1147),W=r(210),Z=r(125),$=new j.a({originalAndCurrentFeatures:"original-and-current-features",none:"none"}),X=new Set(["Feature Layer","Oriented Imagery Layer","Table"]),Y=new j.a({Started:"published",Publishing:"publishing",Stopped:"unavailable"}),K=function(e){Object(d.a)(f,e);var t=Object(p.a)(f);function f(){var e;return Object(c.a)(this,f),(e=t.apply(this,arguments)).type="feature-layer",e.refresh=Object(k.d)(Object(o.a)(Object(i.a)().mark((function t(){var r,a,n,s;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.load();case 2:if(null!=(n=null===(r=e.sourceJSON.editingInfo)||void 0===r?void 0:r.lastEditDate)){t.next=5;break}return t.abrupt("return",{dataChanged:!0,updates:{}});case 5:return t.prev=5,t.next=8,e._fetchService(null);case 8:t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(5),t.abrupt("return",{dataChanged:!0,updates:{}});case 13:return s=n!==(null===(a=e.sourceJSON.editingInfo)||void 0===a?void 0:a.lastEditDate),t.abrupt("return",{dataChanged:s,updates:s?{editingInfo:e.sourceJSON.editingInfo,extent:e.sourceJSON.extent}:null});case 15:case"end":return t.stop()}}),t,null,[[5,10]])})))),e._ongoingAssetUploads=new Map,e}return Object(l.a)(f,[{key:"load",value:function(e){var t=null!=e?e.signal:null,r=this.layer.sourceJSON;return this.addResolvingPromise(this._fetchService(r,t)),Promise.resolve(this)}},{key:"queryTask",get:function(){var e,t,r=this.layer,a=r.capabilities,n=r.parsedUrl,s=r.dynamicDataSource,u=r.infoFor3D,i=r.gdbVersion,o=r.spatialReference,c=r.fieldsIndex,l=Object(g.a)("featurelayer-pbf")&&(null===a||void 0===a?void 0:a.query.supportsFormatPBF)&&null==u,d=null!==(e=null===a||void 0===a||null===(t=a.operations)||void 0===t?void 0:t.supportsQueryAttachments)&&void 0!==e&&e;return new P.a({url:n.path,pbfSupported:l,fieldsIndex:c,infoFor3D:u,dynamicDataSource:s,gdbVersion:i,sourceSpatialReference:o,queryAttachmentsSupported:d})}},{key:"addAttachment",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n,s,u,o;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return a=t.attributes[this.layer.objectIdField],n=this.layer.parsedUrl.path+"/"+a+"/addAttachment",s=this._getLayerRequestOptions(),u=this._getFormDataForAttachment(r,s.query),e.prev=3,e.next=6,Object(y.default)(n,{body:u});case 6:return o=e.sent,e.abrupt("return",this._createFeatureEditResult(o.data.addAttachmentResult));case 10:throw e.prev=10,e.t0=e.catch(3),this._createAttachmentErrorResult(a,e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r,a){var n,s,u,o,c;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return n=t.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+"/"+n+"/updateAttachment",u=this._getLayerRequestOptions({query:{attachmentId:r}}),o=this._getFormDataForAttachment(a,u.query),e.prev=3,e.next=6,Object(y.default)(s,{body:o});case 6:return c=e.sent,e.abrupt("return",this._createFeatureEditResult(c.data.updateAttachmentResult));case 10:throw e.prev=10,e.t0=e.catch(3),this._createAttachmentErrorResult(n,e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n,s,u,o,c,l,d,p,f,h,v,O,g,j,x,w,F,k,A,S,R,I,E,q=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(d=this.layer,p=d.infoFor3D,h=(f=null!=p)||null!==(a=null===r||void 0===r?void 0:r.globalIdUsed)&&void 0!==a&&a,!f){e.next=12;break}return e.next=9,this._uploadMeshesAndGetAssetMapEditsJSON(t);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:return v=e.t0,O=null!==(n=null===(s=t.addFeatures)||void 0===s?void 0:s.map((function(e){return q._getFeatureJSON(e,p)})))&&void 0!==n?n:[],e.next=17,Promise.all(O);case 17:return g=e.sent.filter(m.i),j=null!==(u=null===(o=t.updateFeatures)||void 0===o?void 0:o.map((function(e){return q._getFeatureJSON(e,p)})))&&void 0!==u?u:[],e.next=21,Promise.all(j);case 21:return x=e.sent.filter(m.i),w=this._getFeatureIds(t.deleteFeatures,h),Object(H.a)(g,x,d.spatialReference),e.next=26,this._getAttachmentEditsJSON(t);case 26:if(F=e.sent,k=d.capabilities.editing.supportsAsyncApplyEdits&&f,A={gdbVersion:(null===r||void 0===r?void 0:r.gdbVersion)||d.gdbVersion,rollbackOnFailure:null===r||void 0===r?void 0:r.rollbackOnFailureEnabled,useGlobalIds:h,returnEditMoment:null===r||void 0===r?void 0:r.returnEditMoment,usePreviousEditMoment:null===r||void 0===r?void 0:r.usePreviousEditMoment,sessionId:null===r||void 0===r?void 0:r.sessionId,async:k},null!==r&&void 0!==r&&r.returnServiceEditsOption?(A.edits=JSON.stringify([{id:d.layerId,adds:g,updates:x,deletes:w,attachments:F,assetMaps:v}]),A.returnServiceEditsOption=$.toJSON(null===r||void 0===r?void 0:r.returnServiceEditsOption),A.returnServiceEditsInSourceSR=null===r||void 0===r?void 0:r.returnServiceEditsInSourceSR):(A.adds=g.length?JSON.stringify(g):null,A.updates=x.length?JSON.stringify(x):null,A.deletes=w.length?h?JSON.stringify(w):w.join(","):null,A.attachments=F&&JSON.stringify(F),A.assetMaps=null!=v?JSON.stringify(v):void 0),S=this._getLayerRequestOptions({method:"post",query:A}),R=null!==r&&void 0!==r&&r.returnServiceEditsOption?d.url:d.parsedUrl.path,!k){e.next=38;break}return e.next=35,this._asyncApplyEdits(R+"/applyEdits",S);case 35:e.t1=e.sent,e.next=41;break;case 38:return e.next=40,Object(y.default)(R+"/applyEdits",S);case 40:e.t1=e.sent;case 41:if(I=e.t1,null!==(c=d.capabilities.operations)&&void 0!==c&&c.supportsEditing||null===(l=d.effectiveCapabilities)||void 0===l||null===(l=l.operations)||void 0===l||!l.supportsEditing){e.next=46;break}return E=null===b.c||void 0===b.c?void 0:b.c.findCredential(d.url),e.next=46,null===E||void 0===E?void 0:E.refreshToken();case 46:return e.abrupt("return",this._createEditsResult(I));case 47:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteAttachments",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return a=t.attributes[this.layer.objectIdField],n=this.layer.parsedUrl.path+"/"+a+"/deleteAttachments",e.prev=3,e.next=6,Object(y.default)(n,this._getLayerRequestOptions({query:{attachmentIds:r.join(",")},method:"post"}));case 6:return e.abrupt("return",e.sent.data.deleteAttachmentResults.map(this._createFeatureEditResult));case 9:throw e.prev=9,e.t0=e.catch(3),this._createAttachmentErrorResult(a,e.t0);case 12:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchRecomputedExtents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.signal;return this.load({signal:r}).then(Object(o.a)(Object(i.a)().mark((function r(){var a,n,s,o,c,l,d,p,f,h,b;return Object(i.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e._getLayerRequestOptions(Object(u.a)(Object(u.a)({},t),{},{query:{returnUpdates:!0}})),n=e.layer,s=n.layerId,o=n.url,r.next=6,Object(y.default)("".concat(o,"/").concat(s),a);case 6:return c=r.sent,l=c.data,d=l.id,p=l.extent,f=l.fullExtent,h=l.timeExtent,b=p||f,r.abrupt("return",{id:d,fullExtent:b&&q.a.fromJSON(b),timeExtent:h&&v.a.fromJSON({start:h[0],end:h[1]})});case 14:case"end":return r.stop()}}),r)}))))}},{key:"queryAttachments",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var r,a,n=arguments;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=3,this.load();case 3:return a=this._getLayerRequestOptions(r),e.abrupt("return",this.queryTask.executeAttachmentQuery(t,a));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatures",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.execute(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeJSON(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryObjectIds",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForIds(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForCount(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryExtent",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForExtent(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeatures",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeRelationshipQuery(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeaturesCount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeRelationshipQueryForCount(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopFeatures",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeTopFeaturesQuery(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopObjectIds",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForTopIds(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopExtents",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForTopExtents(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryTopCount",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForTopCount(t,Object(u.a)(Object(u.a)({},r),{},{query:this._createRequestQueryOptions(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchPublishingStatus",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(){var t,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(Q.c)(this.layer.url)){e.next=2;break}return e.abrupt("return","unavailable");case 2:return t=Object(S.D)(this.layer.url,"status"),e.next=5,Object(y.default)(t,{query:{f:"json"}});case 5:return r=e.sent,e.abrupt("return",Y.fromJSON(r.data.status));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadAssets",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,a){var n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(323).then(r.bind(null,2280));case 2:return n=e.sent,s=n.uploadAssets,e.abrupt("return",s(t,{layer:this.layer,ongoingUploads:this._ongoingAssetUploads},a));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_asyncApplyEdits",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.default)(t,r);case 2:a=e.sent.data.statusUrl;case 3:return e.next=5,Object(y.default)(a,{query:{f:"json"},responseType:"json"});case 5:n=e.sent.data,e.t0=n.status,e.next="Completed"===e.t0?9:"CompletedWithErrors"===e.t0?10:"Failed ImportChanges"===e.t0||"InProgress"===e.t0||"Pending"===e.t0||"ExportAttachments"===e.t0||"ExportChanges"===e.t0||"ExportingData"===e.t0||"ExportingSnapshot"===e.t0||"ImportAttachments"===e.t0||"ProvisioningReplica"===e.t0||"UnRegisteringReplica"===e.t0?11:12;break;case 9:return e.abrupt("return",Object(y.default)(n.resultUrl,{query:{f:"json"},responseType:"json"}));case 10:throw new O.a("async-applyEdits-failed","asynchronous applyEdits call failed.");case 11:return e.abrupt("break",13);case 12:throw new O.a("async-applyEdits-failed","asynchronous applyEdits call failed (undefined response status)");case 13:return e.next=15,Object(k.a)(ee);case 15:e.next=3;break;case 17:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createRequestQueryOptions",value:function(e){var t=Object(u.a)(Object(u.a)({},this.layer.customParameters),{},{token:this.layer.apiKey},null===e||void 0===e?void 0:e.query);return this.layer.datesInUnknownTimezone&&(t.timeReferenceUnknownClient=!0),t}},{key:"_fetchService",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n,s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return e.next=3,Object(y.default)(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:Object(g.a)("featurelayer-advanced-symbols")?{returnAdvancedSymbols:!0}:{},signal:r}));case 3:a=e.sent,n=a.data,t=n;case 6:return e.next=8,this._patchServiceJSON(t,r);case 8:if(this.sourceJSON=e.sent,s=t.type,X.has(s)){e.next=12;break}throw new O.a("feature-layer-source:unsupported-type",'Source type "'.concat(s,'" is not supported'));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_patchServiceJSON",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n,s,u;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Table"===t.type||!t.geometryType||null!==t&&void 0!==t&&null!==(a=t.drawingInfo)&&void 0!==a&&a.renderer||t.defaultSymbol||(n=Object(L.d)(t.geometryType).renderer,Object(F.c)("drawingInfo.renderer",n,t)),"esriGeometryMultiPatch"===t.geometryType&&t.infoFor3D&&(t.geometryType="mesh"),null!=t.extent){e.next=13;break}return e.prev=2,e.next=5,Object(y.default)(this.layer.url,this._getLayerRequestOptions({signal:r}));case 5:s=e.sent,(u=s.data).spatialReference&&(t.extent={xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:u.spatialReference}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),Object(k.m)(e.t0);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getFeatureJSON",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t,r){var a,n,s,o,c,l,d,p,f,h,b,y,v,m;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.geometry,n=Object(u.a)({},t.attributes),null==r||"mesh"!==(null===a||void 0===a?void 0:a.type)){e.next=8;break}return o=r.transformFieldRoles,c=a.origin,l=a.spatialReference,d=a.transform,p=this.layer.spatialReference,e.next=5,Object(_.initializeProjection)(l,p);case 5:return f=Object(_.project)(c,p),n[o.originX]=f.x,n[o.originY]=f.y,n[o.originZ]=null!==(s=f.z)&&void 0!==s?s:0,null!=d&&(h=d.translation,b=d.scale,y=d.rotation,v=a.vertexSpace,m=v.isGeoreferenced?1:Object(A.d)(l)/Object(A.d)(p),n[o.translationX]=h[0]*m,n[o.translationY]=-h[2]*m,n[o.translationZ]=h[1]*m,n[o.scaleX]=b[0],n[o.scaleY]=b[2],n[o.scaleZ]=b[1],n[o.rotationX]=y[0],n[o.rotationY]=y[2],n[o.rotationZ]=y[1],n[o.rotationDeg]=y[3]),e.abrupt("return",{geometry:null,attributes:n});case 8:return e.abrupt("return",null==a?{attributes:n}:"mesh"===a.type||"extent"===a.type?null:{geometry:a.toJSON(),attributes:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getAttachmentEditsJSON",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var r,a,n,u,o,c,l=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all((null!==(r=t.addAttachments)&&void 0!==r?r:[]).map((function(e){return l._getAttachmentEditJSON(e)})));case 2:return u=e.sent,e.next=5,Promise.all((null!==(a=t.updateAttachments)&&void 0!==a?a:[]).map((function(e){return l._getAttachmentEditJSON(e)})));case 5:return o=e.sent,c=null!==(n=t.deleteAttachments)&&void 0!==n?n:[],e.abrupt("return",u.length||o.length||c.length?{adds:u,updates:o,deletes:Object(s.a)(c)}:null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getAttachmentEditJSON",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var r,a,n,s,u,o,c,l,d;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.feature,a=t.attachment,n=a.globalId,s=a.name,u=a.contentType,o=a.data,c=a.uploadId,l={globalId:n,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null},r&&(l.parentGlobalId="attributes"in r?r.attributes&&r.attributes[this.layer.globalIdField]:r.globalId),!c){e.next=5;break}l.uploadId=c,e.next=10;break;case 5:if(!o){e.next=10;break}return e.next=8,Object(S.J)(o);case 8:(d=e.sent)&&(l.contentType=d.mediaType,l.data=d.data),o instanceof File&&(l.name=o.name);case 10:return e.abrupt("return",(s&&(l.name=s),u&&(l.contentType=u),l));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_uploadMeshesAndGetAssetMapEditsJSON",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var r,s,u,o,c,l,d,p,f,h,b,y,v;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=t.addAssetFeatures)&&void 0!==r&&r.length){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this._filterRedundantAssetMaps(r);case 5:if(s=e.sent,null!==r&&void 0!==r&&r.length){e.next=8;break}return e.abrupt("return",null);case 8:u=new Array,o=new Map,c=Object(n.a)(s);try{for(c.s();!(l=c.n()).done;)d=l.value,p=d.geometry,p.vertexSpace.isRelative?u.push(p):(f=C(p),o.set(f,p),d.geometry=f,u.push(f))}catch(i){c.e(i)}finally{c.f()}return e.next=13,this.uploadAssets(u);case 13:h=Object(n.a)(o);try{for(h.s();!(b=h.n()).done;)y=Object(a.a)(b.value,2),v=y[0],y[1].addExternalSources(v.metadata.externalSources.items)}catch(i){h.e(i)}finally{h.f()}return e.abrupt("return",{adds:this._getAssetMapEditsJSON(s),updates:[],deletes:[]});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getAssetMapEditsJSON",value:function(e){var t,r=new Array,a=this.layer.globalIdField,s=this.layer.parsedUrl,u=Object(n.a)(e);try{for(u.s();!(t=u.n()).done;){var i,o=t.value,c=o.geometry,l=c.metadata.getExternalSourcesOnService(s),d=o.getAttribute(a);if(0!==l.length){var p,f=(null!==(i=l.find(D.h))&&void 0!==i?i:l[0]).source,h=c.vertexSpace.isGeoreferenced?["PROJECT_VERTICES"]:[],b=Object(n.a)(f);try{for(b.s();!(p=b.n()).done;){var y=p.value;1===y.parts.length?r.push({globalId:Object(R.a)(),parentGlobalId:d,assetName:y.assetName,assetHash:y.parts[0].partHash,flags:h}):w.a.getLogger(this).error("Skipping asset ".concat(y.assetName,". It does not have exactly one part, so we cannot map it to a feature."))}}catch(v){b.e(v)}finally{b.f()}}else w.a.getLogger(this).error("Skipping feature ".concat(d,". The mesh it is associated with has not been uploaded to the service and cannot be mapped to it."))}}catch(v){u.e(v)}finally{u.f()}return r}},{key:"_getFeatureIds",value:function(e,t){if(!e||0===e.length)return[];if(t&&Object(G.isFeatureIdentifierArrayWithGlobalId)(e))return e.map((function(e){return e.globalId}));if(Object(G.isFeatureIdentifierArrayWithObjectId)(e))return e.map((function(e){return e.objectId}));var r=this.layer,a=t?r.globalIdField:r.objectIdField;return a?e.map((function(e){return e.getAttribute(a)})):[]}},{key:"_createEditsResult",value:function(e){var t,r,a,s,u,i,o,c,l,d=this,p=e.data,f=this.layer.layerId,h=[],b=null;if(Array.isArray(p)){var y,v=Object(n.a)(p);try{for(v.s();!(y=v.n()).done;){var m,O,g,j=y.value;h.push({id:j.id,editedFeatures:j.editedFeatures}),j.id===f&&(b={addResults:null!==(m=j.addResults)&&void 0!==m?m:[],updateResults:null!==(O=j.updateResults)&&void 0!==O?O:[],deleteResults:null!==(g=j.deleteResults)&&void 0!==g?g:[],attachments:j.attachments,editMoment:j.editMoment})}}catch(N){v.e(N)}finally{v.f()}}else b=p;var x=null===(t=b)||void 0===t?void 0:t.assetMaps;if(x){var F,k=Object(n.a)(x.addResults);try{for(k.s();!(F=k.n()).done;){var A=F.value;A.success||w.a.getLogger(this).error("Failed to map asset to feature with globalId ".concat(A.globalId,"."))}}catch(N){k.e(N)}finally{k.f()}var S,R=Object(n.a)(x.updateResults);try{for(R.s();!(S=R.n()).done;){var I=S.value;I.success||w.a.getLogger(this).error("Failed to map asset to feature with globalId ".concat(I.globalId,"."))}}catch(N){R.e(N)}finally{R.f()}}var E=null===(r=b)||void 0===r?void 0:r.attachments,q={addFeatureResults:null!==(a=null===(s=b)||void 0===s||null===(s=s.addResults)||void 0===s?void 0:s.map(this._createFeatureEditResult,this))&&void 0!==a?a:[],updateFeatureResults:null!==(u=null===(i=b)||void 0===i||null===(i=i.updateResults)||void 0===i?void 0:i.map(this._createFeatureEditResult,this))&&void 0!==u?u:[],deleteFeatureResults:null!==(o=null===(c=b)||void 0===c||null===(c=c.deleteResults)||void 0===c?void 0:c.map(this._createFeatureEditResult,this))&&void 0!==o?o:[],addAttachmentResults:E&&E.addResults?E.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:E&&E.updateResults?E.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:E&&E.deleteResults?E.deleteResults.map(this._createFeatureEditResult,this):[]};if(null!==(l=b)&&void 0!==l&&l.editMoment&&(q.editMoment=b.editMoment),h.length>0){q.editedFeatureResults=[];var _,T=Object(n.a)(h);try{var M=function(){var e,t,r,a=_.value,n=a.editedFeatures,s=null!==n&&void 0!==n&&n.spatialReference?new Z.a(n.spatialReference):null;q.editedFeatureResults.push({layerId:a.id,editedFeatures:{adds:(null===n||void 0===n||null===(e=n.adds)||void 0===e?void 0:e.map((function(e){return d._createEditedFeature(e,s)})))||[],updates:(null===n||void 0===n||null===(t=n.updates)||void 0===t?void 0:t.map((function(e){return{original:d._createEditedFeature(e[0],s),current:d._createEditedFeature(e[1],s)}})))||[],deletes:(null===n||void 0===n||null===(r=n.deletes)||void 0===r?void 0:r.map((function(e){return d._createEditedFeature(e,s)})))||[],spatialReference:s}})};for(T.s();!(_=T.n()).done;)M()}catch(N){T.e(N)}finally{T.f()}}return q}},{key:"_createEditedFeature",value:function(e,t){return new h.a({attributes:e.attributes,geometry:Object(T.a)(Object(u.a)(Object(u.a)({},e.geometry),{},{spatialReference:t}))})}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new O.a("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_createAttachmentErrorResult",value:function(e,t){var r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new O.a("feature-layer-source:attachment-failure",r,{code:a})}}},{key:"_getFormDataForAttachment",value:function(e,t){var r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(var a in t){var n=t[a];null!=n&&(r.set?r.set(a,n):r.append(a,n))}return r}},{key:"_getLayerRequestOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.layer,r=t.parsedUrl,a=t.gdbVersion,n=t.dynamicDataSource;return Object(u.a)(Object(u.a)({},e),{},{query:Object(u.a)(Object(u.a)({gdbVersion:a,layer:n?JSON.stringify({source:n}):void 0},r.query),{},{f:"json"},this._createRequestQueryOptions(e)),responseType:"json"})}},{key:"_filterRedundantAssetMaps",value:function(){var e=Object(o.a)(Object(i.a)().mark((function e(t){var r,a,u,o,c,l,d,p,f,h,b,y,v,O,g,j,x,w;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.layer,a=r.globalIdField,u=r.infoFor3D,o=r.parsedUrl,null!=u&&null!=a){e.next=3;break}return e.abrupt("return",t);case 3:if(null!=(c=Object(V.a)(u))){e.next=6;break}return e.abrupt("return",t);case 6:l=Object(S.D)(o.path,"../".concat(c.id)),d=new Array,p=new Array,f=Object(n.a)(t);try{for(f.s();!(h=f.n()).done;)(b=h.value).geometry.metadata.getExternalSourcesOnService(o).length>0?p.push(b):d.push(b)}catch(i){f.e(i)}finally{f.f()}if(y=p.map((function(e){return e.getAttribute(a)})).filter(m.i),0!==y.length){e.next=12;break}return e.abrupt("return",t);case 12:return v=u.assetMapFieldRoles,O=v.parentGlobalId,g=v.assetHash,(j=new W.a).where="".concat(O," IN (").concat(y.map((function(e){return"'".concat(e,"'")})),")"),j.outFields=[g,O],j.returnGeometry=!1,e.next=16,Object(z.a)(l,j);case 16:return x=e.sent,w=x.features,e.abrupt("return",0===w.length?t:[].concat(d,Object(s.a)(p.filter((function(e){var t=e.getAttribute(a);if(!t)return!0;var r=e.geometry.metadata,n=w.filter((function(e){return e.getAttribute(O)===t}));if(0===n.length)return!0;var s=n.map((function(e){return e.getAttribute(g)}));return r.getExternalSourcesOnService(o).flatMap((function(e){return e.source.flatMap((function(e){return e.parts.map((function(e){return e.partHash}))}))})).some((function(e){return s.every((function(t){return e!==t}))}))})))));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),f}(x.a);Object(f.a)([Object(I.b)()],K.prototype,"type",void 0),Object(f.a)([Object(I.b)({constructOnly:!0})],K.prototype,"layer",void 0),Object(f.a)([Object(I.b)({readOnly:!0})],K.prototype,"queryTask",null),K=Object(f.a)([Object(E.a)("esri.layers.graphics.sources.FeatureLayerSource")],K);var ee=1e3,te=K},449:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return c}));var a=r(34),n=r(1),s=r(93),u=r(116),i=r(488),o=r(382);function c(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.a:"esriGeometryPolyline"===e?o.c:o.b}}}var l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,d=1;function p(e,t){if(Object(s.a)("esri-csp-restrictions"))return function(){return Object(n.a)(Object(a.a)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var u in e)r+="this".concat(l.test(u)?".".concat(u):'["'.concat(u,'"]')," = ").concat(JSON.stringify(e[u]),";");var i=new Function("\n      return class AttributesClass$".concat(d++," {\n        constructor() {\n          ").concat(r,";\n        }\n      }\n    "))();return function(){return new i}}catch(o){return function(){return Object(n.a)(Object(a.a)({},t,null),e)}}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:Object(u.a)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:i.a,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1}}}},488:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},528:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return c})),r.d(t,"h",(function(){return s}));var a=r(636);function n(e,t,r){s(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function s(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;if(e.length/n!==Math.ceil(t.length/s))return a.a.error("source and destination buffers need to have the same number of elements"),e;for(var u=e.length/n,i=r[0],o=r[1],c=r[2],l=r[4],d=r[5],p=r[6],f=r[8],h=r[9],b=r[10],y=r[12],v=r[13],m=r[14],O=0,g=0,j=0;j<u;j++){var x=t[O],w=t[O+1],F=t[O+2];e[g]=i*x+l*w+f*F+y,e[g+1]=o*x+d*w+h*F+v,e[g+2]=c*x+p*w+b*F+m,O+=s,g+=n}return e}function u(e,t,r){i(e.typedBuffer,t.typedBuffer,r,e.typedBufferStride,t.typedBufferStride)}function i(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;if(e.length/n===Math.ceil(t.length/s))for(var u=e.length/n,i=r[0],o=r[1],c=r[2],l=r[3],d=r[4],p=r[5],f=r[6],h=r[7],b=r[8],y=0,v=0,m=0;m<u;m++){var O=t[y],g=t[y+1],j=t[y+2];e[v]=i*O+l*g+f*j,e[v+1]=o*O+d*g+h*j,e[v+2]=c*O+p*g+b*j,y+=s,v+=n}else a.a.error("source and destination buffers need to have the same number of elements")}function o(e,t,r){c(e.typedBuffer,t,r,e.typedBufferStride)}function c(e,t,r){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,n=Math.min(e.length/a,t.count),s=t.typedBuffer,u=t.typedBufferStride,i=0,o=0,c=0;c<n;c++)e[o]=r*s[i],e[o+1]=r*s[i+1],e[o+2]=r*s[i+2],i+=u,o+=a}function l(e,t){d(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function d(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,n=Math.min(e.length/r,t.length/a),s=0,u=0,i=0;i<n;i++){var o=t[s],c=t[s+1],l=t[s+2],d=o*o+c*c+l*l;if(d>0){var p=1/Math.sqrt(d);e[u]=p*o,e[u+1]=p*c,e[u+2]=p*l}s+=a,u+=r}}Object.freeze(Object.defineProperty({__proto__:null,normalize:d,normalizeView:l,scale:c,scaleView:o,shiftRight:function(e,t,r){for(var a=Math.min(e.count,t.count),n=e.typedBuffer,s=e.typedBufferStride,u=t.typedBuffer,i=t.typedBufferStride,o=0,c=0,l=0;l<a;l++)n[c]=u[o]>>r,n[c+1]=u[o+1]>>r,n[c+2]=u[o+2]>>r,o+=i,c+=s},transformMat3:i,transformMat3View:u,transformMat4:s,transformMat4View:n},Symbol.toStringTag,{value:"Module"}))},599:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var a=r(99),n=r(89),s=r(88),u=r(90),i=r(91),o=r(94),c=r(165),l=r(105),d=r(97),p=(r(96),r(98),r(93),r(138)),f=r(95),h=r(157),b=r(135),y=function(e){Object(u.a)(r,e);var t=Object(i.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).type="georeferenced-relative",a.isRelative=!0,a.isGeoreferenced=!0,a.origin=Object(h.f)(),a}return Object(s.a)(r,[{key:"getOriginPoint",value:function(e){var t=Object(a.a)(this.origin,3),r=t[0],n=t[1],s=t[2];return new b.a({x:r,y:n,z:s,spatialReference:e})}},{key:"setOriginFormPoint",value:function(e){var t=e.x,r=e.y,a=e.z;this.origin=Object(h.i)(t,r,null!==a&&void 0!==a?a:0)}}]),r}(Object(c.b)(l.a));Object(o.a)([Object(p.a)({georeferencedRelative:"georeferenced-relative"},{readOnly:!0})],y.prototype,"type",void 0),Object(o.a)([Object(d.b)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"origin",void 0);var v=y=Object(o.a)([Object(f.a)("esri.geometry.support.MeshGeoreferencedRelativeVertexSpace")],y)},636:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a=r(102).a.getLogger("esri.views.3d.support.buffer.math")},912:function(e,t,r){"use strict";r.r(t),r.d(t,"applyEdits",(function(){return w})),r.d(t,"isFeatureIdentifierArrayWithGlobalId",(function(){return x})),r.d(t,"isFeatureIdentifierArrayWithObjectId",(function(){return g})),r.d(t,"isFeatureIdentifierWithGlobalId",(function(){return j})),r.d(t,"isFeatureIdentifierWithObjectId",(function(){return O})),r.d(t,"uploadAssets",(function(){return G}));var a=r(92),n=r(1),s=r(4),u=r(12),i=r(172),o=r(145),c=r(101),l=r(116),d=r(102),p=r(110),f=r(128),h=r(217),b=r(783),y=r(538),v=r(395);function m(e){return e&&null!=e.applyEdits}function O(e){return"object"==typeof e&&null!=e&&"objectId"in e&&!!e.objectId}function g(e){return e.every(O)}function j(e){return"object"==typeof e&&null!=e&&"globalId"in e&&!!e.globalId}function x(e){return e.every(j)}function w(e,t,r){return F.apply(this,arguments)}function F(){return F=Object(u.a)(Object(s.a)().mark((function e(t,r,a){var n,u,i,o,c,d,f,h,y,v=arguments;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.length>3&&void 0!==v[3]?v[3]:{},Object(b.c)(t)&&t.url?u=Object(b.b)(t.url,t.layerId,"original-and-current-features"===n.returnServiceEditsOption):((u=Object(p.c)()).promise.then((function(e){(e.addedFeatures.length||e.updatedFeatures.length||e.deletedFeatures.length||e.addedAttachments.length||e.updatedAttachments.length||e.deletedAttachments.length)&&t.emit("edits",e)})),i={result:u.promise},t.emit("apply-edits",i)),e.prev=2,e.next=5,k(t,r,a,n);case 5:return c=e.sent,d=c.results,f=c.edits,h=function(e){return e.filter((function(e){return!e.error})).map(l.a)},y={edits:f,addedFeatures:h(d.addFeatureResults),updatedFeatures:h(d.updateFeatureResults),deletedFeatures:h(d.deleteFeatureResults),addedAttachments:h(d.addAttachmentResults),updatedAttachments:h(d.updateAttachmentResults),deletedAttachments:h(d.deleteAttachmentResults),exceededTransferLimit:!1},e.abrupt("return",(null!==(o=d.editedFeatureResults)&&void 0!==o&&o.length&&(y.editedFeatures=d.editedFeatureResults),u.resolve(y),d));case 13:throw e.prev=13,e.t0=e.catch(2),u.reject(e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,13]])}))),F.apply(this,arguments)}function k(e,t,r,a){return A.apply(this,arguments)}function A(){return(A=Object(u.a)(Object(s.a)().mark((function e(t,r,a,n){var u,i,o,l,d,p,f,h,b;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load();case 2:if(m(r)){e.next=4;break}throw new c.a("".concat(t.type,"-layer:no-editing-support"),"Layer source does not support applyEdits capability",{layer:t});case 4:if(Object(v.a)(t)){e.next=6;break}throw new c.a("".concat(t.type,"-layer:editing-disabled"),"Editing is disabled for layer",{layer:t});case 6:return e.next=8,S(t,a,n);case 8:if(f=e.sent,h=f.edits,b=f.options,!(null!==(u=h.addFeatures)&&void 0!==u&&u.length||null!==(i=h.updateFeatures)&&void 0!==i&&i.length||null!==(o=h.deleteFeatures)&&void 0!==o&&o.length||null!==(l=h.addAttachments)&&void 0!==l&&l.length||null!==(d=h.updateAttachments)&&void 0!==d&&d.length||null!==(p=h.deleteAttachments)&&void 0!==p&&p.length)){e.next=19;break}return e.t1=h,e.next=15,r.applyEdits(h,b);case 15:e.t2=e.sent,e.t0={edits:e.t1,results:e.t2},e.next=20;break;case 19:e.t0={edits:h,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}};case 20:return e.abrupt("return",e.t0);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(Object(s.a)().mark((function e(t,r,a){var u,i,l,p,f,h,b;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=r&&(r.addFeatures||r.updateFeatures||r.deleteFeatures),i=r&&(r.addAttachments||r.updateAttachments||r.deleteAttachments),l=null!=t.infoFor3D,r&&(u||i)){e.next=3;break}throw new c.a("".concat(t.type,"-layer:missing-parameters"),"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");case 3:if((p=Object(v.b)(t)).data.isVersioned||null===a||void 0===a||!a.gdbVersion){e.next=6;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");case 6:if(p.editing.supportsRollbackOnFailure||null===a||void 0===a||!a.rollbackOnFailureEnabled){e.next=8;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");case 8:if(p.editing.supportsGlobalId||null===a||void 0===a||!a.globalIdUsed){e.next=10;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");case 10:if(p.editing.supportsGlobalId||!i){e.next=12;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");case 12:if(null!==a&&void 0!==a&&a.globalIdUsed||!i){e.next=14;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true");case 14:if(null!=(f=Object(n.a)({},a)).rollbackOnFailureEnabled||p.editing.supportsRollbackOnFailure||(f.rollbackOnFailureEnabled=!0),f.rollbackOnFailureEnabled||"original-and-current-features"!==f.returnServiceEditsOption||(!1===f.rollbackOnFailureEnabled&&d.a.getLogger("esri.layers.graphics.editingSupport").warn("".concat(t.type,"-layer:invalid-parameter"),"'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true, but 'rollBackOnFailure' was set to false. 'rollBackOnFailure' has been overwrritten and set to true."),f.rollbackOnFailureEnabled=!0),p.editing.supportsReturnServiceEditsInSourceSpatialReference||!f.returnServiceEditsInSourceSR){e.next=17;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'");case 17:if(!f.returnServiceEditsInSourceSR||"original-and-current-features"===f.returnServiceEditsOption){e.next=19;break}throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"'returnServiceEditsInSourceSR' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'");case 19:if((h=Object(n.a)({},r)).addFeatures=r&&o.a.isCollection(r.addFeatures)?r.addFeatures.toArray():h.addFeatures||[],h.updateFeatures=r&&o.a.isCollection(r.updateFeatures)?r.updateFeatures.toArray():h.updateFeatures||[],h.deleteFeatures=r&&o.a.isCollection(r.deleteFeatures)?r.deleteFeatures.toArray():h.deleteFeatures||[],!h.addFeatures.length||p.operations.supportsAdd){e.next=22;break}throw new c.a("".concat(t.type,"-layer:unsupported-operation"),"Layer does not support adding features.");case 22:if(!h.updateFeatures.length||p.operations.supportsUpdate){e.next=24;break}throw new c.a("".concat(t.type,"-layer:unsupported-operation"),"Layer does not support updating features.");case 24:if(!h.deleteFeatures.length||p.operations.supportsDelete){e.next=26;break}throw new c.a("".concat(t.type,"-layer:unsupported-operation"),"Layer does not support deleting features.");case 26:if(h.addAttachments=h.addAttachments||[],h.updateAttachments=h.updateAttachments||[],h.deleteAttachments=h.deleteAttachments||[],h.addFeatures=h.addFeatures.map(B),h.updateFeatures=h.updateFeatures.map(B),h.addAssetFeatures=[],b=(null===a||void 0===a?void 0:a.globalIdUsed)||l,h.addFeatures.forEach((function(e){return q(e,t,b)})),h.updateFeatures.forEach((function(e){return T(e,t,b)})),h.deleteFeatures.forEach((function(e){return _(e,t,b)})),h.addAttachments.forEach((function(e){return M(e,t)})),h.updateAttachments.forEach((function(e){return M(e,t)})),e.t0=l,!e.t0){e.next=37;break}return e.next=37,C(h,t);case 37:return e.next=39,N(h);case 39:return e.t1=e.sent,e.t2=f,e.abrupt("return",{edits:e.t1,options:e.t2});case 42:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r){if(r){if("attributes"in e&&!e.attributes[t.globalIdField])throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"Feature should have 'globalId' when 'globalIdUsed' is true");if(!("attributes"in e)&&!e.globalId)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"'globalId' of the feature should be passed when 'globalIdUsed' is true")}if("geometry"in e&&null!=e.geometry){var a,n;if(e.geometry.hasZ&&!1===(null===(a=t.capabilities)||void 0===a?void 0:a.data.supportsZ))throw new c.a("".concat(t.type,"-layer:z-unsupported"),"Layer does not support z values while feature has z values.");if(e.geometry.hasM&&!1===(null===(n=t.capabilities)||void 0===n?void 0:n.data.supportsM))throw new c.a("".concat(t.type,"-layer:m-unsupported"),"Layer does not support m values while feature has m values.")}}function E(e,t){var r;if("geometry"in e&&"mesh"===(null===(r=e.geometry)||void 0===r?void 0:r.type)&&e.geometry.vertexSpace.isGeoreferenced)throw new c.a("".concat(t.type,"-layer:georeferenced-mesh-unsupported"),"Uploading georeferenced meshes to a layer is not supported.")}function q(e,t,r){I(e,t,r),E(e,t)}function _(e,t,r){I(e,t,r)}function T(e,t,r){I(e,t,r),E(e,t);var a=Object(v.b)(t);if("geometry"in e&&null!=e.geometry&&(null===a||void 0===a||!a.editing.supportsGeometryUpdate))throw new c.a("".concat(t.type,"-layer:unsupported-operation"),"Layer does not support geometry updates.")}function M(e,t){var r,a=e.feature,n=e.attachment;if(!a||"attributes"in a&&!a.attributes[t.globalIdField])throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"Attachment should have reference to a feature with 'globalId'");if(!("attributes"in a)&&!a.globalId)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"Attachment should have reference to 'globalId' of the parent feature");if(!n.globalId)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"Attachment should have 'globalId'");if(!n.data&&!n.uploadId)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"Attachment should have 'data' or 'uploadId'");if(!(n.data instanceof File&&n.data.name)&&!n.name)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"'name' is required when attachment is specified as Base64 encoded string using 'data'");if((null===(r=t.capabilities)||void 0===r||!r.editing.supportsUploadWithItemId)&&n.uploadId)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");if("string"==typeof n.data){var s=Object(f.h)(n.data);if(s&&!s.isBase64)throw new c.a("".concat(t.type,"-layer:invalid-parameter"),"Attachment 'data' should be a Blob, File or Base64 encoded string")}}function N(e){return U.apply(this,arguments)}function U(){return(U=Object(u.a)(Object(s.a)().mark((function e(t){var r,a,n,u,i,o,c,l;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null!==(r=t.addFeatures)&&void 0!==r?r:[],u=null!==(a=t.updateFeatures)&&void 0!==a?a:[],i=n.concat(u).map((function(e){return e.geometry})),e.next=5,Object(h.a)(i);case 5:return o=e.sent,c=n.length,l=u.length,e.abrupt("return",(o.slice(0,c).forEach((function(e,t){return n[t].geometry=e})),o.slice(c,c+l).forEach((function(e,t){return u[t].geometry=e})),t));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){var t=new i.a;return e.attributes||(e.attributes={}),t.geometry=e.geometry,t.attributes=e.attributes,t}function C(e,t){return J.apply(this,arguments)}function J(){return(J=Object(u.a)(Object(s.a)().mark((function e(t,r){var n,u,i,o,l,d,p,f,h,b,v,m,O;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r.infoFor3D){e.next=2;break}return e.abrupt("return");case 2:if(l=r.infoFor3D,(d=null!==(n=Object(y.d)("model/gltf-binary",l.supportedFormats))&&void 0!==n?n:Object(y.b)("glb",l.supportedFormats))&&l.editFormats.includes(d)){e.next=5;break}throw new c.a("".concat(r.type,"-layer:binary-gltf-asset-not-supported"),"3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.");case 5:null!==(u=t.addAssetFeatures)&&void 0!==u||(t.addAssetFeatures=[]),p=t.addAssetFeatures,f=Object(a.a)(null!==(i=t.addFeatures)&&void 0!==i?i:[]);try{for(f.s();!(h=f.n()).done;)D(b=h.value)&&p.push(b)}catch(s){f.e(s)}finally{f.f()}v=Object(a.a)(null!==(o=t.updateFeatures)&&void 0!==o?o:[]);try{for(v.s();!(m=v.n()).done;)D(O=m.value)&&p.push(O)}catch(s){v.e(s)}finally{v.f()}case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){var t;return"mesh"===(null===e||void 0===e||null===(t=e.geometry)||void 0===t?void 0:t.type)}function G(e,t,r,a){if(!m(t))throw new c.a("".concat(e.type,"-layer:no-editing-support"),"Layer source does not support applyEdits capability",{layer:e});if(!t.uploadAssets)throw new c.a("".concat(e.type,"-layer:no-asset-upload-support"),"Layer source does not support uploadAssets capability",{layer:e});return t.uploadAssets(r,a)}}}]);
//# sourceMappingURL=54.27e9f24a.chunk.js.map
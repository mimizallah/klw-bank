{"version":3,"sources":["../node_modules/@arcgis/core/portal/support/layersLoader.js","../node_modules/@arcgis/core/support/requestPresets.js","../node_modules/@arcgis/core/layers/support/fetchService.js","../node_modules/@arcgis/core/portal/support/jsonContext.js"],"names":["p","_x","_x2","_p","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","t","r","wrap","_context","prev","next","instance","portalItem","id","load","c","abrupt","y","stop","type","supportedTypes","includes","expectedType","join","_x3","_x4","_y","_callee2","_s$readResourcePaths","a","n","o","s","u","_context2","url","title","l","read","f","h","sent","resourceReferences","paths","readResourcePaths","i","_x5","_x6","_f","_callee3","_s","_yield$Promise$all","_yield$Promise$all2","_e3","_t3","_context3","layerModuleTypeMap","t0","OrientedImageryLayer","FeatureLayer","StreamLayer","SceneLayer","concat","Promise","all","_slicedToArray","w","t1","j","length","SubtypeGroupLayer","layerType","t2","b","t3","t4","t5","P","t6","v","d","_x7","_x8","_d","_callee4","_a$layers","_a$tables","_context4","layers","map","m","tables","name","_e$portalItem","forEach","_e$layerDefinition","layerDefinition","push","filter","_e$layerDefinition2","coverage","URL","toLowerCase","searchParams","get","origin","fromPortalItem","fromArcGISServerUrl","T","add","reverse","g","clone","layerId","sourceJSON","sublayerTitleMode","portal","getDefault","showLegend","_x9","_x10","_h","_callee5","_e4","_t4","_e5","_context5","supportsData","fetchData","S","I","L","_x11","_x12","_w","_callee6","_e6","_e7","_r2","_context6","_e$layers","_e$tables","find","F","_e$layers$length","_e$layers2","_e$tables$length","_e$tables2","_e$layers3","_x13","_P","_callee7","_yield$a","_context7","layersJSON","_toConsumableArray","_t","_yield$e","responseType","query","_objectSpread","customParameters","token","apiKey","data","_r","_a$currentVersion","serviceJSON","currentVersion","itemUrl","messages","writtenProperties"],"mappings":"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","file":"static/js/227.fd28dd77.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import t from\"../../layers/Layer.js\";import{isArcGISUrl as r}from\"../../layers/support/arcgisLayerUrl.js\";import{fetchFeatureService as a}from\"../../layers/support/fetchService.js\";import n from\"../Portal.js\";import o from\"../PortalItem.js\";import{createForItemRead as l}from\"./jsonContext.js\";import{hasTypeKeyword as s}from\"./portalItemUtils.js\";import{loadStyleRenderer as i}from\"../../renderers/support/styleUtils.js\";import{fetchArcGISServiceJSON as u}from\"../../support/requestPresets.js\";async function p(e,t){const r=e.instance.portalItem;if(r&&r.id)return await r.load(t),c(e),y(e,t)}function c(t){const r=t.instance.portalItem;if(!r?.type||!t.supportedTypes.includes(r.type))throw new e(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}'\",{type:r?.type,expectedType:t.supportedTypes.join(\", \")})}async function y(e,t){const r=e.instance,a=r.portalItem;if(!a)return;const{url:n,title:o}=a,s=l(a);if(\"group\"===r.type)return r.read({title:o},s),f(r,e);n&&r.read({url:n},s);const u=await h(e,t);return u&&r.read(u,s),r.resourceReferences={portalItem:a,paths:s.readResourcePaths??[]},\"subtype-group\"!==r.type&&r.read({title:o},s),i(r,s)}async function f(t,r){let a;const{portalItem:n}=t;if(!n)return;const o=n.type,l=r.layerModuleTypeMap,i=s(n,\"Oriented Imagery Layer\")??!1;switch(o){case\"Feature Service\":a=i?l.OrientedImageryLayer:l.FeatureLayer;break;case\"Stream Service\":a=l.StreamLayer;break;case\"Scene Service\":a=l.SceneLayer;break;case\"Feature Collection\":a=l.FeatureLayer;break;default:throw new e(\"portal:unsupported-item-type-as-group\",`The item type '${o}' is not supported as a 'IGroupLayer'`)}let[u,p]=await Promise.all([a(),h(r)]),c=()=>u;if(\"Feature Service\"===o){p=n.url?await w(p,n.url):{};if(j(p).length){const e=l.SubtypeGroupLayer,t=await e();c=e=>\"SubtypeGroupLayer\"===e.layerType?t:u}return b(t,c,p,await P(n.url))}return v(p)>0?b(t,c,p):d(t,c)}async function d(e,t){const{portalItem:r}=e;if(!r?.url)return;const a=await u(r.url);a&&b(e,t,{layers:a.layers?.map(m),tables:a.tables?.map(m)})}function m(e){return{id:e.id,name:e.name}}function b(e,t,r,a){let n=r.layers||[];const o=r.tables||[];if(\"Feature Collection\"===e.portalItem?.type&&(n.forEach((e=>{\"Table\"===e?.layerDefinition?.type&&o.push(e)})),n=n.filter((e=>\"Table\"!==e?.layerDefinition?.type))),\"coverage\"in r){const t=T(r);t&&e.add(t)}n.reverse().forEach((n=>{const o=a?.(n);if(o||!a){const a=g(e,t(n),r,n,o);e.add(a)}})),o.reverse().forEach((n=>{const o=a?.(n);if(o||!a){const a=g(e,t(n),r,n,o);e.tables.add(a)}}))}function g(e,t,r,a,o){const l=e.portalItem,s=new t({portalItem:l.clone(),layerId:a.id});if(\"sourceJSON\"in s&&(s.sourceJSON=o),\"subtype-group\"!==s.type&&(s.sublayerTitleMode=\"service-name\"),\"Feature Collection\"===l.type){const e={origin:\"portal-item\",portal:l.portal||n.getDefault()};s.read(a,e);const t=r.showLegend;null!=t&&s.read({showLegend:t},e)}return s}async function h(e,t){if(!1===e.supportsData)return;const r=e.instance,a=r.portalItem;if(!a)return;let n=null;try{n=await a.fetchData(\"json\",t)}catch(o){}if(S(r)){let e=null,t=!0;if(n&&v(n)>0){if(null==r.layerId){const e=j(n);r.layerId=\"subtype-group\"===r.type?e?.[0]:I(n)}e=L(n,r),e&&(1===v(n)&&(t=!1),null!=n.showLegend&&(e.showLegend=n.showLegend))}return t&&\"sublayerTitleMode\"in r&&\"service-name\"!==r.sublayerTitleMode&&(r.sublayerTitleMode=\"item-title-and-service-name\"),e}return n}async function w(e,t){if(null==e?.layers||null==e?.tables){const r=await u(t);(e=e||{}).layers=e.layers||r?.layers,e.tables=e.tables||r?.tables}return e}function I(e){const t=e.layers;if(t&&t.length)return t[0].id;const r=e.tables;return r&&r.length?r[0].id:null}function L(e,t){const{layerId:r}=t,a=e.layers?.find((e=>e.id===r))||e.tables?.find((e=>e.id===r));return a&&F(a,t)?a:null}function v(e){return(e?.layers?.length??0)+(e?.tables?.length??0)}function S(e){return\"stream\"!==e.type&&\"oriented-imagery\"!==e.type&&\"layerId\"in e}function T(a){const{coverage:n}=a;if(!n)return null;const l=new URL(n);if(n.toLowerCase().includes(\"item.html\")){const e=l.searchParams.get(\"id\"),r=l.origin;return t.fromPortalItem({portalItem:new o({id:e,url:r})})}if(r(n))return t.fromArcGISServerUrl({url:n});throw new e(\"portal:oriented-imagery-layer-coverage\",\"the provided coverage url couldn't be loaded as a layer\")}function j(e){const t=[];return e?.layers?.forEach((e=>{\"SubtypeGroupLayer\"===e.layerType&&t.push(e.id)})),t}function F(e,t){return!(\"feature\"===t.type&&\"layerType\"in e&&\"SubtypeGroupLayer\"===e.layerType||\"subtype-group\"===t.type&&!(\"layerType\"in e))}async function P(e){const{layersJSON:t}=await a(e);if(!t)return null;const r=[...t.layers,...t.tables];return e=>r.find((t=>t.id===e.id))}export{I as getFirstLayerOrTableId,v as getNumLayersAndTables,j as getSubtypeGroupLayerIds,p as load,w as preprocessFSItemData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";async function t(t,o){const{data:r}=await e(t,{responseType:\"json\",query:{f:\"json\",...o?.customParameters,token:o?.apiKey}});return r}export{t as fetchArcGISServiceJSON};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as e}from\"../../support/requestPresets.js\";async function r(r,s){const a=await e(r,s);a.layers=a.layers.filter(t);const n={serviceJSON:a};if((a.currentVersion??0)<10.5)return n;const i=await e(r+\"/layers\",s);return n.layersJSON={layers:i.layers.filter(t),tables:i.tables},n}function t(e){return!e.type||\"Feature Layer\"===e.type}export{r as fetchFeatureService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{urlToObject as r}from\"../../core/urlUtils.js\";import t from\"../Portal.js\";function e(e){return{origin:\"portal-item\",url:r(e.itemUrl),portal:e.portal||t.getDefault(),portalItem:e,readResourcePaths:[]}}function o(e){return{origin:\"portal-item\",messages:[],writtenProperties:[],url:e.itemUrl?r(e.itemUrl):null,portal:e.portal||t.getDefault(),portalItem:e}}export{e as createForItemRead,o as createForItemWrite};\n"],"sourceRoot":""}
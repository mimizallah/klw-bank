(this["webpackJsonpklw-bank"]=this["webpackJsonpklw-bank"]||[]).push([[57],{1176:function(t,e,r){"use strict";r.d(e,"a",(function(){return x}));var n,a=r(112),i=r(89),o=r(88),s=r(90),u=r(91),c=r(99),l=r(94),p=(r(119),r(97)),f=(r(96),r(98),r(93),r(138)),v=r(136),h=r(95),b=r(137),d=r(1329),m=r(135),y=r(130);function g(t,e,r){var n=e.x,a=e.y;if(r<2)return{x:t[0]+n*t[2]+a*t[4],y:t[1]+n*t[3]+a*t[5]};if(2===r){var i=n*n,o=a*a,s=n*a;return{x:t[0]+n*t[2]+a*t[4]+i*t[6]+s*t[8]+o*t[10],y:t[1]+n*t[3]+a*t[5]+i*t[7]+s*t[9]+o*t[11]}}var u=n*n,c=a*a,l=n*a,p=u*n,f=u*a,v=n*c,h=a*c;return{x:t[0]+n*t[2]+a*t[4]+u*t[6]+l*t[8]+c*t[10]+p*t[12]+f*t[14]+v*t[16]+h*t[18],y:t[1]+n*t[3]+a*t[5]+u*t[7]+l*t[9]+c*t[11]+p*t[13]+f*t[15]+v*t[17]+h*t[19]}}function j(t,e,r){var n=e.xmin,a=e.ymin,i=e.xmax,o=e.ymax,s=e.spatialReference,u=[];if(r<2)u.push({x:n,y:o}),u.push({x:i,y:o}),u.push({x:n,y:a}),u.push({x:i,y:a});else{for(var c=10,l=0;l<c;l++)u.push({x:n,y:a+(o-a)*l/(c-1)}),u.push({x:i,y:a+(o-a)*l/(c-1)});c=8;for(var p=1;p<=c;p++)u.push({x:n+(i-n)*p/c,y:a}),u.push({x:n+(i-n)*p/c,y:o})}u=u.map((function(e){return g(t,e,r)}));var f=u.map((function(t){return t.x})),v=u.map((function(t){return t.y}));return new y.a({xmin:Math.min.apply(null,f),xmax:Math.max.apply(null,f),ymin:Math.min.apply(null,v),ymax:Math.max.apply(null,v),spatialReference:s})}var O=n=function(t){Object(s.a)(r,t);var e=Object(u.a)(r);function r(){var t;return Object(i.a)(this,r),(t=e.apply(this,arguments)).polynomialOrder=1,t.type="polynomial",t}return Object(o.a)(r,[{key:"readForwardCoefficients",value:function(t,e){var r=e.coeffX,n=e.coeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var a=[],i=0;i<r.length;i++)a.push(r[i]),a.push(n[i]);return a}},{key:"writeForwardCoefficients",value:function(t,e,r){for(var n=[],a=[],i=0;i<(null===t||void 0===t?void 0:t.length);i++)i%2==0?n.push(t[i]):a.push(t[i]);e.coeffX=n,e.coeffY=a}},{key:"inverseCoefficients",get:function(){var t=this._get("inverseCoefficients"),e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=function(t){var e=Object(c.a)(t,6),r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=a*s-o*i,l=o*i-a*s;return[(o*n-r*s)/u,(a*n-r*i)/l,s/u,i/l,-o/u,-a/l]}(e)),t},set:function(t){this._set("inverseCoefficients",t)}},{key:"readInverseCoefficients",value:function(t,e){var r=e.inverseCoeffX,n=e.inverseCoeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var a=[],i=0;i<r.length;i++)a.push(r[i]),a.push(n[i]);return a}},{key:"writeInverseCoefficients",value:function(t,e,r){for(var n=[],a=[],i=0;i<(null===t||void 0===t?void 0:t.length);i++)i%2==0?n.push(t[i]):a.push(t[i]);e.inverseCoeffX=n,e.inverseCoeffY=a}},{key:"affectsPixelSize",get:function(){return this.polynomialOrder>0}},{key:"forwardTransform",value:function(t){if("point"===t.type){var e=g(this.forwardCoefficients,t,this.polynomialOrder);return new m.a({x:e.x,y:e.y,spatialReference:t.spatialReference})}return j(this.forwardCoefficients,t,this.polynomialOrder)}},{key:"inverseTransform",value:function(t){if("point"===t.type){var e=g(this.inverseCoefficients,t,this.polynomialOrder);return new m.a({x:e.x,y:e.y,spatialReference:t.spatialReference})}return j(this.inverseCoefficients,t,this.polynomialOrder)}},{key:"clone",value:function(){return new n({polynomialOrder:this.polynomialOrder,forwardCoefficients:this.forwardCoefficients?Object(a.a)(this.forwardCoefficients):null,inverseCoefficients:this.inverseCoefficients?Object(a.a)(this.inverseCoefficients):null})}}]),r}(d.a);Object(l.a)([Object(p.b)({json:{write:!0}})],O.prototype,"polynomialOrder",void 0),Object(l.a)([Object(p.b)()],O.prototype,"forwardCoefficients",void 0),Object(l.a)([Object(v.a)("forwardCoefficients",["coeffX","coeffY"])],O.prototype,"readForwardCoefficients",null),Object(l.a)([Object(b.a)("forwardCoefficients")],O.prototype,"writeForwardCoefficients",null),Object(l.a)([Object(p.b)({json:{write:!0}})],O.prototype,"inverseCoefficients",null),Object(l.a)([Object(v.a)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],O.prototype,"readInverseCoefficients",null),Object(l.a)([Object(b.a)("inverseCoefficients")],O.prototype,"writeInverseCoefficients",null),Object(l.a)([Object(p.b)()],O.prototype,"affectsPixelSize",null),Object(l.a)([Object(f.a)({PolynomialXform:"polynomial"})],O.prototype,"type",void 0);var x=O=n=Object(l.a)([Object(h.a)("esri.layers.support.rasterTransforms.PolynomialTransform")],O)},1329:function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r(89),a=r(88),i=r(90),o=r(91),s=r(94),u=r(105),c=r(97),l=(r(96),r(98),r(93),r(95)),p=function(t){Object(i.a)(r,t);var e=Object(o.a)(r);function r(){return Object(n.a)(this,r),e.apply(this,arguments)}return Object(a.a)(r,[{key:"affectsPixelSize",get:function(){return!1}},{key:"forwardTransform",value:function(t){return t}},{key:"inverseTransform",value:function(t){return t}}]),r}(u.a);Object(s.a)([Object(c.b)()],p.prototype,"affectsPixelSize",null),Object(s.a)([Object(c.b)({json:{write:!0}})],p.prototype,"spatialReference",void 0);var f=p=Object(s.a)([Object(l.a)("esri.layers.support.rasterTransforms.BaseRasterTransform")],p)},1574:function(t,e,r){"use strict";r.d(e,"a",(function(){return Sr})),r.d(e,"b",(function(){return Mr}));var n=r(1),a=r(600),i=r(101),o=r(116),s=r(89),u=r(88),c=r(90),l=r(91),p=r(94),f=r(97),v=(r(96),r(98),r(93),r(95)),h=(r(102),r(105)),b=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).raster=void 0,t}return Object(u.a)(r)}(h.a);Object(p.a)([Object(f.b)({json:{write:!0}})],b.prototype,"raster",void 0);var d,m=b=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],b),y=d=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){return Object(s.a)(this,r),e.apply(this,arguments)}return Object(u.a)(r,[{key:"clone",value:function(){return new d({raster:this.raster})}}]),r}(m),g=y=d=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],y),j=r(112),O=r(191),x=r(414),w=r(557),A=new Set(["slope","aspect","curvature","hillshade","shadedrelief"]),k=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionArguments=null,t.readingBufferSize=0,t.id=-1,t.isNoopProcess=!1,t.rawInputBandIds=[],t.isInputBandIdsSwizzled=!1,t.swizzledBandSelection=[],t.isBranch=!1,t._bindingResult=null,t}return Object(u.a)(r,[{key:"supportsGPU",get:function(){return this._bindingResult.supportsGPU}},{key:"flatWebGLFunctionChain",get:function(){var t=this.getWebGLProcessorDefinition();if(!t)return null;for(var e=[t],r=t.parameters,n=r.rasters||r.raster&&[r.raster];null!==(a=n)&&void 0!==a&&a.length;){var a;e.unshift.apply(e,Object(j.a)(n));for(var i=[],o=0;o<n.length;o++){var s=n[o].parameters,u=s.rasters||s.raster&&[s.raster];(null===u||void 0===u?void 0:u.length)&&i.push.apply(i,Object(j.a)(u))}n=i}for(var c=e.length-1;c>=0;c--)e[c].isNoopProcess&&e.splice(c,1);for(var l=!1,p=0;p<e.length;p++){var f=e[p];f.id=e.length-p-1;var v=f.parameters.rasters;l=l||null!=v&&v.length>1}var h=e.some((function(t){var e=t.name;return A.has(e.toLowerCase())}));return{functions:e,hasBranches:l,hasSurfaceFunction:h}}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this.id=r+1;for(var n=this._getRasterValues(),a=!0,i=0;i<n.length;i++){var o=n[i];if(null!=o&&this._isRasterFunctionValue(o)){var s=o.bind(t,e,this.id+i);if(!s.success)return this._bindingResult=s,s;a=a&&s.supportsGPU}}return!this.rasterInfo||e?(this.sourceRasterInfos=this._getSourceRasterInfos(t),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=a&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult):(this._bindingResult={success:!0,supportsGPU:!0},this.processInputBandIds(),this._bindingResult)}},{key:"process",value:function(t){var e,r=this,a=this._getRasterValues(),i=0===a.length?null!==(e=t.pixelBlocks)&&void 0!==e?e:t.primaryPixelBlocks:a.map((function(e){return r._readRasterValue(e,t)}));return this._processPixels(Object(n.a)(Object(n.a)({},t),{},{pixelBlocks:i}))}},{key:"processInputBandIds",value:function(){var t,e=this._getRasterValues().filter(this._isRasterFunctionValue);if(e.length>1){var r=e.map((function(t){return t.processInputBandIds()[0]}));this.rawInputBandIds=r,this.isInputBandIdsSwizzled=this.rawInputBandIds.some((function(t,e){return t!==e}));var n=e.filter((function(t){return"ExtractBand"===t.functionName}));return n.length&&n.forEach((function(t,e){t.isInputBandIdsSwizzled=!0,t.swizzledBandSelection=[e,e,e]})),this.rawInputBandIds}var a=e[0];if(a){if(t=a.processInputBandIds(),a.isInputBandIdsSwizzled)return this.rawInputBandIds=t,t}else{t=[];for(var i=this.sourceRasterInfos[0].bandCount,o=0;o<i;o++)t.push(o)}var s=this._getInputBandIds(t);return this.isInputBandIdsSwizzled=s.some((function(t,e){return t!==e})),this.rawInputBandIds=s,this.rawInputBandIds}},{key:"getPrimaryRasters",value:function(){var t=[],e=[];return this._getPrimaryRasters(this,t,e),{rasters:t,rasterIds:e}}},{key:"getWebGLProcessorDefinition",value:function(){var t=this,e=this._getWebGLParameters(),r=this.functionArguments,n=r.raster,a=r.rasters;return a&&Array.isArray(a)&&a.length?(e.rasters=a.map((function(e){return t._isRasterFunctionValue(e)?e.getWebGLProcessorDefinition():"number"==typeof e?{name:"Constant",parameters:{value:e},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:e},pixelType:"f32",id:-1,isNoopProcess:!1}})),e.rasters.some((function(t){return null!=t}))||(e.rasters=null)):this._isRasterFunctionValue(n)&&(e.raster=n.getWebGLProcessorDefinition()),{name:this.functionName,parameters:e,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}},{key:"_getOutputPixelType",value:function(t){var e;return"unknown"===this.outputPixelType?t:null!==(e=this.outputPixelType)&&void 0!==e?e:t}},{key:"_getWebGLParameters",value:function(){return{}}},{key:"_getInputBandIds",value:function(t){return t}},{key:"_isOutputRoundingNeeded",value:function(){var t,e=this.outputPixelType;return null!==(t=(null===e||void 0===e?void 0:e.startsWith("u"))||(null===e||void 0===e?void 0:e.startsWith("s")))&&void 0!==t&&t}},{key:"_getRasterValues",value:function(){var t,e=this,r=this.rasterArgumentNames;return"rasters"===r[0]?null!==(t=this.functionArguments.rasters)&&void 0!==t?t:[]:r.map((function(t){return e.functionArguments[t]})).flat()}},{key:"_getSourceRasterInfos",value:function(t){var e,r=this._getRasterValues(),n=t.rasterInfos,a=t.rasterIds;if(0===r.length)return n;var i=r.map((function(t){return t&&"object"==typeof t&&"bind"in t&&t.rasterInfo?t.rasterInfo:"string"==typeof t&&a.includes(t)?n[a.indexOf(t)]:"number"!=typeof t?n[0]:void 0})),o=null!==(e=i.find((function(t){return t})))&&void 0!==e?e:n[0];return i.forEach((function(t,e){void 0===t&&(i[e]=o)})),i}},{key:"_getPrimaryRasterId",value:function(t){return null===t||void 0===t?void 0:t.url}},{key:"_getPrimaryRasters",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=0;n<t.sourceRasters.length;n++){var a=t.sourceRasters[n];if("number"!=typeof a)if("bind"in a)this._getPrimaryRasters(a,e,r);else{var i=a,o=this._getPrimaryRasterId(i);if(null==o)continue;r.includes(o)||(this.mainPrimaryRasterId===o?(e.unshift(i),r.unshift(o)):(e.push(i),r.push(o)))}}}},{key:"_isRasterFunctionValue",value:function(t){return null!=t&&"object"==typeof t&&"getWebGLProcessorDefinition"in t}},{key:"_readRasterValue",value:function(t,e){var r=e.primaryPixelBlocks;if(null==t||"$$"===t){var n=r[0];return null==n?null:n.clone()}if("string"==typeof t){var a=e.primaryRasterIds.indexOf(t);return-1===a?null:r[a]}if("number"==typeof t){var i=r[0];if(null==i)return null;var o=i.width,s=i.height,u=i.pixelType,c=i.mask,l=c?new Uint8Array(c):null,p=new Float32Array(o*s);p.fill(t);var f=this.sourceRasterInfos[0].bandCount,v=new Array(f).fill(p);return new x.a({width:o,height:s,pixelType:u,pixels:v,mask:l})}return t.process(e)}},{key:"_patchRasterInfo",value:function(){var t=this.rasterInfo;if(null!==t&&void 0!==t&&t.keyProperties){var e=t.bandCount,r=t.keyProperties,a=t.statistics,i=t.histograms,o=r.BandProperties;o&&o.length!==e&&(t.keyProperties=Object(n.a)(Object(n.a)({},r),{},{BandProperties:void 0})),a&&a.length!==e&&(t.statistics=a.length>e?a.slice(0,e):null),i&&i.length!==e&&(t.histograms=i.length>e?i.slice(0,e):null),r.BAND_COUNT&&Number(r.BAND_COUNT)!==e&&(t.keyProperties=Object(n.a)(Object(n.a)({},r),{},{BAND_COUNT:"string"==typeof r.BAND_COUNT?String(e):e}))}}}]),r}(h.a);Object(p.a)([Object(f.b)({json:{write:!0}})],k.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],k.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],k.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}}),Object(O.a)((function(t){return null===t||void 0===t?void 0:t.toLowerCase()}))],k.prototype,"outputPixelType",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],k.prototype,"mainPrimaryRasterId",void 0),Object(p.a)([Object(f.b)()],k.prototype,"sourceRasters",void 0),Object(p.a)([Object(f.b)({type:[w.a],json:{write:!0}})],k.prototype,"sourceRasterInfos",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],k.prototype,"rasterInfo",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],k.prototype,"readingBufferSize",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],k.prototype,"id",void 0),Object(p.a)([Object(f.b)()],k.prototype,"isNoopProcess",void 0),Object(p.a)([Object(f.b)()],k.prototype,"supportsGPU",null),Object(p.a)([Object(f.b)()],k.prototype,"rawInputBandIds",void 0),Object(p.a)([Object(f.b)()],k.prototype,"isInputBandIdsSwizzled",void 0),Object(p.a)([Object(f.b)()],k.prototype,"swizzledBandSelection",void 0),Object(p.a)([Object(f.b)()],k.prototype,"isBranch",void 0),Object(p.a)([Object(f.b)()],k.prototype,"flatWebGLFunctionChain",null),Object(p.a)([Object(f.b)()],k.prototype,"_bindingResult",void 0);var P=k=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.BaseRasterFunction")],k),R=r(1174),N=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Aspect",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,this.outputPixelType=this._getOutputPixelType("f32");var n=r.clone();return n.pixelType=this.outputPixelType,n.statistics=[{min:-1,max:360,avg:180,stddev:30}],n.histograms=null,n.colormap=null,n.attributeTable=null,n.bandCount=1,this.rasterInfo=n,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=t.extent,a=t.primaryPixelSizes,i=null===a||void 0===a?void 0:a[0],o=null!==i&&void 0!==i?i:n?{x:n.width/r.width,y:n.height/r.height}:{x:1,y:1};return Object(R.b)(r,{resolution:o})}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],N.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:g,json:{write:!0,name:"rasterFunctionArguments"}})],N.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],N.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],N.prototype,"isGCS",void 0);var T=N=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.AspectFunction")],N),I=r(138),F=r(99),M=r(146),S=new Set(["+","-","*","/","(",")"]);function C(t,e,r,n){if("number"==typeof r&&"number"==typeof n)return r+n;var a,i,o;"number"==typeof r?(a=(o=n).length,(i=new Float32Array(a)).fill(r)):(a=r.length,i=r,n.constructor===Number?(o=new Float32Array(a)).fill(n):o=n);var s=new Float32Array(a);switch(e){case"+":for(var u=0;u<a;u++)(null==t||t[u])&&(s[u]=i[u]+o[u]);break;case"-":for(var c=0;c<a;c++)(null==t||t[c])&&(s[c]=i[c]-o[c]);break;case"*":for(var l=0;l<a;l++)(null==t||t[l])&&(s[l]=i[l]*o[l]);break;case"/":for(var p=0;p<a;p++)(null==t||t[p])&&o[p]&&(s[p]=i[p]/o[p]);break;case"(":case")":throw new Error("encountered error with custom band index equation")}return s}function _(t,e){t.splice(e,1);var r=0,n=0;do{r=0,n=0;for(var a=0;a<t.length;a++)if("("===t[a])r=a;else if(")"===t[a]){n=a;break}n===r+1&&t.splice(r,2)}while(n===r+1);return t}function B(t){if(1===t.length)return{opIndex:0,numIndex:0};for(var e=0,r=0,n=0;n<t.length;n++)if("("===t[n])e=n;else if(")"===t[n]){r=n;break}for(var a=0===r?t:t.slice(e+1,r),i=-1,o=0;o<a.length;o++)if("*"===a[o]||"/"===a[o]){i=o;break}if(i>-1)r>0&&(i+=e+1);else{for(var s=0;s<a.length;s++)if("+"===a[s]||"-"===a[s]){i=s;break}r>0&&(i+=e+1)}for(var u=0,c=0;c<i;c++)"("===t[c]&&u++;return{opIndex:i,numIndex:i-u}}function G(t,e,r){var n,a=function(t,e){(t=t.replaceAll(" ","")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));for(var r=t.split(""),n=[],a=[],i="",o=0;o<r.length;o++){var s=r[o];if(S.has(s))""!==i&&a.push(parseFloat(i)),n.push(s),i="";else{if("b"===s.toLowerCase()){o++,i=s.concat(r[o]),a.push(e[parseInt(i[1],10)-1]),i="";continue}i=i.concat(s),o===r.length-1&&a.push(parseFloat(i))}}return{ops:n,nums:a}}(r,e),i=a.ops,o=a.nums;if(0===i.length){var s=1===o.length?o[0]:e[0];if(s instanceof Float32Array)return[s];var u=new Float32Array(e[0].length);return"number"==typeof s?u.fill(s):u.set(s),[u]}for(;i.length>0;){var c=B(i),l=c.numIndex,p=c.opIndex;if(n=C(t,i[p],o[l],o[l+1]),1===i.length)break;i=_(i,p),o.splice(l,2,n)}return[n]}var E,D=r(420),z=new M.a({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function L(t,e){if(!Object(D.k)(t))return t;var r,n=e.equation,a=e.method,i=e.bandIndexes.map((function(t){return t-1})),o=t.pixels,s=t.mask;switch(a){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":r=V(s,o[i[0]],o[i[1]]);break;case"ndwi":r=V(s,o[i[1]],o[i[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":r=function(t,e,r){for(var n=r.length,a=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var o=e[i],s=r[i];s&&(a[i]=o/s)}return[a]}(s,o[i[0]],o[i[1]]);break;case"ci-g":case"ci-re":r=function(t,e,r){for(var n=e.length,a=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var o=e[i],s=r[i];s&&(a[i]=o/s-1)}return[a]}(s,o[i[0]],o[i[1]]);break;case"savi":r=function(t,e,r,n){for(var a=r.length,i=new Float32Array(a),o=0;o<a;o++)if(null==t||t[o]){var s=r[o],u=e[o],c=u+s+n;c&&(i[o]=(u-s)/c*(1+n))}return[i]}(s,o[i[0]],o[i[1]],i[2]+1);break;case"tsavi":r=function(t,e,r,n,a,i){for(var o=r.length,s=new Float32Array(o),u=-a*n+i*(1+n*n),c=0;c<o;c++)if(null==t||t[c]){var l=r[c],p=e[c],f=a*p+l+u;f&&(s[c]=n*(p-n*l-a)/f)}return[s]}(s,o[i[0]],o[i[1]],i[2]+1,i[3]+1,i[4]+1);break;case"msavi":r=function(t,e,r){for(var n=r.length,a=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var o=r[i],s=e[i];a[i]=.5*(2*(s+1)-Math.sqrt(Math.pow(2*s+1,2)-8*(s-o)))}return[a]}(s,o[i[0]],o[i[1]]);break;case"gemi":r=function(t,e,r){for(var n=r.length,a=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var o=r[i],s=e[i];if(1!==o){var u=(2*(s*s-o*o)+1.5*s+.5*o)/(s+o+.5);a[i]=u*(1-.25*u)-(o-.125)/(1-o)}}return[a]}(s,o[i[0]],o[i[1]]);break;case"pvi":r=function(t,e,r,n,a){for(var i=r.length,o=new Float32Array(i),s=Math.sqrt(1+n*n),u=0;u<i;u++)if(null==t||t[u]){var c=r[u],l=e[u];o[u]=(l-n*c-a)/s}return[o]}(s,o[i[0]],o[i[1]],i[2]+1,i[3]+1);break;case"gvitm":r=function(t,e){for(var r=Object(F.a)(e,6),n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],c=n.length,l=new Float32Array(c),p=0;p<c;p++)(null==t||t[p])&&(l[p]=-.2848*n[p]-.2435*a[p]-.5436*i[p]+.7243*o[p]+.084*s[p]-1.18*u[p]);return[l]}(s,[o[i[0]],o[i[1]],o[i[2]],o[i[3]],o[i[4]],o[i[5]]]);break;case"sultan":r=function(t,e){for(var r=Object(F.a)(e,6),n=r[0],a=r[2],i=r[3],o=r[4],s=r[5],u=n.length,c=new Float32Array(u),l=new Float32Array(u),p=new Float32Array(u),f=0;f<u;f++)(null==t||t[f])&&(c[f]=s[f]?o[f]/s[f]*100:0,l[f]=n[f]?o[f]/n[f]*100:0,p[f]=i[f]?a[f]/i[f]*(o[f]/i[f])*100:0);return[c,l,p]}(s,[o[i[0]],o[i[1]],o[i[2]],o[i[3]],o[i[4]],o[i[5]]]);break;case"vari":r=function(t,e){for(var r=Object(F.a)(e,3),n=r[0],a=r[1],i=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var c=n[u],l=a[u],p=l+c-i[u];p&&(s[u]=(l-c)/p)}return[s]}(s,[o[i[0]],o[i[1]],o[i[2]]]);break;case"mtvi2":r=function(t,e){for(var r=Object(F.a)(e,3),n=r[0],a=r[1],i=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var c=n[u],l=a[u],p=i[u],f=Math.sqrt(Math.pow(2*c+1,2)-6*c-5*Math.sqrt(l)-.5);s[u]=1.5*(1.2*(c-p)-2.5*(l-p))*f}return[s]}(s,[o[i[0]],o[i[1]],o[i[2]]]);break;case"rtvi-core":r=function(t,e){for(var r=Object(F.a)(e,3),n=r[0],a=r[1],i=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var c=n[u],l=a[u],p=i[u];s[u]=100*(c-l)-10*(c-p)}return[s]}(s,[o[i[0]],o[i[1]],o[i[2]]]);break;case"evi":r=function(t,e){for(var r=Object(F.a)(e,3),n=r[0],a=r[1],i=r[2],o=n.length,s=new Float32Array(o),u=0;u<o;u++)if(null==t||t[u])for(u=0;u<o;u++){var c=n[u],l=a[u],p=c+6*l-7.5*i[u]+1;p&&(s[u]=2.5*(c-l)/p)}return[s]}(s,[o[i[0]],o[i[1]],o[i[2]]]);break;case"wndwi":r=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=Object(F.a)(e,3),a=n[0],i=n[1],o=n[2],s=i.length,u=new Float32Array(s),c=0;c<s;c++)if(null==t||t[c])for(c=0;c<s;c++){var l=a[c],p=i[c],f=o[c],v=l+r*p+(1-r)*f;v&&(u[c]=(l-r*p-(1-r)*f)/v)}return[u]}(s,[o[i[0]],o[i[1]],o[i[2]]],i[3]?i[3]+1:.5);break;case"bai":r=function(t,e,r){for(var n=r.length,a=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i])for(i=0;i<n;i++){var o=Math.pow(.1-e[i],2)+Math.pow(.06-r[i],2);o&&(a[i]=1/o)}return[a]}(s,o[i[0]],o[i[1]]);break;case"custom":r=G(s,o,n);break;default:return t}var u=null!=s?new Uint8Array(s.length):null;null!=s&&null!=u&&u.set(s);var c=new x.a({width:t.width,height:t.height,pixelType:"f32",pixels:r,mask:u});return c.updateStatistics(),c}function W(t){var e=new Float32Array(9);return e[3*t[0]]=1,e[3*t[1]+1]=1,e[3*t[2]+2]=1,e}function V(t,e,r){for(var n=r.length,a=new Float32Array(n),i=0;i<n;i++)if(null==t||t[i]){var o=e[i],s=r[i],u=o+s;u&&(a[i]=(o-s)/u)}return[a]}var U=E=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).method="custom",t}return Object(u.a)(r,[{key:"clone",value:function(){return new E({method:this.method,bandIndexes:this.bandIndexes,raster:Object(o.a)(this.raster)})}}]),r}(m);Object(p.a)([Object(f.b)({json:{type:String,write:!0}})],U.prototype,"bandIndexes",void 0),Object(p.a)([Object(I.a)(z)],U.prototype,"method",void 0);var q=U=E=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],U),X=new Set(["vari","mtvi2","rtvi-core","evi"]),H=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="BandArithmetic",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var t=this.sourceRasterInfos[0];if(t.bandCount<2)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};var e=t.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,e.bandCount="sultan"===this.functionArguments.method?3:1,e.keyProperties=Object(n.a)(Object(n.a)({},e.keyProperties),{},{BandProperties:void 0}),this.rasterInfo=e,{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return r;var n=this.functionArguments,a=n.method,i=n.bandIndexes,o=i.split(" ").map((function(t){return parseFloat(t)}));return L(r,{method:a,bandIndexes:o,equation:i})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments.bandIndexes.split(" ").map((function(t){return parseFloat(t)-1}));2===t.length&&t.push(0);var e,r,n=this.isInputBandIdsSwizzled?[0,1,2]:t,a=new Float32Array(3);switch(this.functionArguments.method){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":e=W([n[0],n[1],0]),r="ndxi";break;case"ndwi":e=W([n[1],n[0],0]),r="ndxi";break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":e=W([n[0],n[1],0]),r="sr";break;case"ci-g":case"ci-re":e=W([n[0],n[1],0]),r="ci";break;case"savi":e=W([n[0],n[1],0]),r="savi",a[0]=t[2]+1;break;case"tsavi":e=W([n[0],n[1],0]),r="tsavi",a[0]=t[2]+1,a[1]=t[3]+1,a[2]=t[4]+1;break;case"msavi":e=W([n[0],n[1],0]),r="msavi";break;case"gemi":e=W([n[0],n[1],0]),r="gemi";break;case"pvi":e=W([n[0],n[1],0]),r="tsavi",a[0]=t[2]+1,a[1]=t[3]+1;break;case"vari":e=W([n[0],n[1],n[2]]),r="vari";break;case"mtvi2":e=W([n[0],n[1],n[2]]),r="mtvi2";break;case"rtvi-core":e=W([n[0],n[1],n[2]]),r="rtvicore";break;case"evi":e=W([n[0],n[1],n[2]]),r="evi";break;case"wndwi":e=W([n[0],n[1],0]),r="wndwi",a[0]=t[3]?t[3]+1:.5;break;case"bai":e=W([n[1],n[0],0]),r="bai";break;default:e=W([0,1,2]),r="custom"}return{bandIndexMat3:e,indexType:r,adjustments:a}}},{key:"_getInputBandIds",value:function(t){if("custom"===this.functionArguments.method)return t;var e=this.functionArguments.bandIndexes.split(" ").map((function(t){return parseFloat(t)-1})),r=t.length,n=e.map((function(t){return t>=r?r-1:t})),a=X.has(this.functionArguments.method)?3:2,i=n.slice(0,a).map((function(e){return t[e]}));return 2===i.length&&i.push(0),i}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],H.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:q,json:{write:!0,name:"rasterFunctionArguments"}})],H.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],H.prototype,"rasterArgumentNames",void 0);var J,Y=H=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],H),$=r(136),K=r(685),Z=r(720),Q=J=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){return Object(s.a)(this,r),e.apply(this,arguments)}return Object(u.a)(r,[{key:"castColormapName",value:function(t){if(!t)return null;var e=t.toLowerCase();return K.i.includes(e)?e:null}},{key:"readColorRamp",value:function(t){return Object(Z.a)(t)}},{key:"readColorRampName",value:function(t,e){if(!t)return null;var r=K.b.jsonValues.find((function(e){return e.toLowerCase()===t.toLowerCase()}));return r?K.b.fromJSON(r):null}},{key:"clone",value:function(){var t;return new J({colormap:Object(o.a)(this.colormap),colormapName:this.colormapName,colorRamp:null===(t=this.colorRamp)||void 0===t?void 0:t.clone(),colorRampName:this.colorRampName})}}]),r}(m);Object(p.a)([Object(f.b)({type:[[Number]],json:{write:!0}})],Q.prototype,"colormap",void 0),Object(p.a)([Object(f.b)({type:String,json:{write:!0}})],Q.prototype,"colormapName",void 0),Object(p.a)([Object(O.a)("colormapName")],Q.prototype,"castColormapName",null),Object(p.a)([Object(f.b)({types:Z.b,json:{write:!0}})],Q.prototype,"colorRamp",void 0),Object(p.a)([Object($.a)("colorRamp")],Q.prototype,"readColorRamp",null),Object(p.a)([Object(f.b)({type:K.b.apiValues,json:{type:K.b.jsonValues,write:K.b.write}})],Q.prototype,"colorRampName",void 0),Object(p.a)([Object($.a)("colorRampName")],Q.prototype,"readColorRampName",null);var tt=Q=J=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],Q),et=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],rt=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];function nt(t,e){for(var r,n=[],a=[],i=0;i<t.length-1;i++)n.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:t[i].slice(1),toColor:t[i+1].slice(1)}),a.push(t[i+1][0]-t[i][0]);var o=t[t.length-1][0];return Object(K.d)({type:"multipart",colorRamps:n},{numColors:o,weights:e=null!==(r=e)&&void 0!==r?r:a})}function at(t){var e;switch(t){case"elevation":e=nt([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case"gray":e=Object(K.d)({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case"hillshade":e=nt([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case"ndvi":e=et;break;case"ndvi2":e=function(){for(var t=nt([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]),e=t.length;e<256;e++)t.push([6,27,7]);return t}();break;case"ndvi3":e=rt;break;case"random":e=function(){for(var t=[],e=0;e<256;e++){for(var r=[],n=0;n<3;n++)r.push(Math.round(255*Math.random()));t.push(r)}return t}()}return e?(e=e.map((function(t,e){return[e].concat(Object(j.a)(t))})),e):null}var it=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Colormap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];if(r.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};var n=this.functionArguments,a=n.colormap,i=n.colormapName,o=n.colorRamp,s=n.colorRampName;if(null===(t=a)||void 0===t||!t.length)if(o)a=Object(K.c)(o,{interpolateAlpha:!0});else if(s){var u=Object(K.f)(s);u&&(a=Object(K.c)(u))}else i&&(a=at(i));if(null===(e=a)||void 0===e||!e.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");var c=r.clone();return c.pixelType=this.outputPixelType,c.colormap=a,c.bandCount=1,this.rasterInfo=c,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],it.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:tt,json:{write:!0,name:"rasterFunctionArguments"}})],it.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],it.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)()],it.prototype,"isNoopProcess",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],it.prototype,"indexedColormap",void 0);var ot,st=it=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.ColormapFunction")],it),ut=r(137),ct=ot=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).rasters=[],t}return Object(u.a)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new ot({rasters:Object(o.a)(this.rasters)})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],ct.prototype,"rasters",void 0),Object(p.a)([Object(ut.a)("rasters")],ct.prototype,"writeRasters",null);var lt=ct=ot=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],ct),pt=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="CompositeBand",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);var r=e.clone();if(r.attributeTable=null,r.colormap=null,r.pixelType=this.outputPixelType,r.bandCount=t.map((function(t){return t.bandCount})).reduce((function(t,e){return t+e})),t.every((function(t){var e=t.statistics;return null!=e&&e.length}))){var a=[];t.forEach((function(t){var e=t.statistics;return null!=e&&a.push.apply(a,Object(j.a)(e))})),r.statistics=a}if(t.every((function(t){var e=t.histograms;return null!=e&&e.length}))){var i=[];t.forEach((function(t){var e=t.histograms;return null!=e&&i.push.apply(i,Object(j.a)(e))})),r.histograms=i}r.bandCount>1&&(r.colormap=null,r.attributeTable=null);var o=t.every((function(t){var e;return null===(e=t.keyProperties.BandProperties)||void 0===e?void 0:e.length}))?t.flatMap((function(t){return t.keyProperties.BandProperties})):void 0;return r.keyProperties=Object(n.a)(Object(n.a)({},r.keyProperties),{},{BandProperties:o}),this.rasterInfo=r,{success:!0,supportsGPU:r.bandCount<=3}}},{key:"_processPixels",value:function(t){var e=t.pixelBlocks;return e?null==(null===e||void 0===e?void 0:e[0])?null:Object(D.f)(e):null}},{key:"_getWebGLParameters",value:function(){return{bandCount:this.rasterInfo.bandCount}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],pt.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:lt,json:{write:!0,name:"rasterFunctionArguments"}})],pt.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],pt.prototype,"rasterArgumentNames",void 0);var ft,vt=pt=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.CompositeBandFunction")],pt),ht={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255},bt={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},dt={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},mt={setNull:50,conditional:78},yt=Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)({},{plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65}),bt),dt),{majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75}),mt),gt=r(470),jt=new Map;function Ot(t,e,r,n,a,i,o){for(var s=new Float32Array(e*r),u=i.length,c=o?0:n,l=o?n:0,p=o?1:e,f=c;f<r-c;f++)for(var v=f*e,h=l;h<e-l;h++)if(!a||a[v+h]){for(var b=0,d=0;d<u;d++)b+=t[v+h+(d-n)*p]*i[d];s[v+h]=b}return s}function xt(t,e,r,n,a,i,o){for(var s=new Float32Array(e*r),u=Math.floor(n/2),c=Math.floor(a/2),l=u;l<r-u;l++)for(var p=l*e,f=c;f<e-c;f++)if(!i||i[p+f]){for(var v=0,h=0;h<n;h++)for(var b=0;b<a;b++)v+=t[p+f+(h-u)*e+b-c]*o[h*a+b];s[p+f]=v}return s}function wt(t,e,r,n,a){for(var i=Math.floor(n/2),o=0;o<i;o++)for(var s=0;s<e;s++)t[o*e+s]=t[(a-1-o)*e+s],t[(r-1-o)*e+s]=t[(r-a+o)*e+s];for(var u=Math.floor(a/2),c=0;c<r;c++)for(var l=c*e,p=0;p<u;p++)t[l+p]=t[l+a-1-p],t[l+e-p-1]=t[l+e+p-a]}function At(t,e){var r=function(t){for(var e=Math.sqrt(t.length),r=t.slice(0,e),n=[1],a=1;a<e;a++){for(var i=null,o=0;o<e;o++){var s=t[o+a*e],u=t[o];if(null==i)if(0===u){if(s)return{separable:!1,row:null,col:null}}else i=s/u;else if(s/u!==i)return{separable:!1,row:null,col:null}}if(null==i)return{separable:!1,row:null,col:null};n.push(i)}return{separable:!0,row:r,col:n}}(e.kernel),n=!1!==e.mirrorEdges,a=r.separable?function(t,e,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=t.pixels,i=t.width,o=t.height,s=t.pixelType,u=t.mask,c=a.length,l=[],p=e.length,f=r.length,v=Math.floor(p/2),h=Math.floor(f/2),b=0;b<c;b++){var d=Ot(a[b],i,o,v,u,e,!0);d=Ot(d,i,o,h,u,r,!1),n&&wt(d,i,o,p,f),l.push(d)}return new x.a({width:i,height:o,pixelType:s,pixels:l,mask:u})}(t,r.row,r.col,n):function(t,e){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.pixels,a=t.width,i=t.height,o=t.pixelType,s=t.mask,u=n.length,c=[],l=e.kernel,p=e.rows,f=e.cols,v=0;v<u;v++){var h=xt(n[v],a,i,p,f,s,l);r&&wt(h,a,i,p,f),c.push(h)}return new x.a({width:a,height:i,pixelType:o,pixels:c,mask:s})}(t,e,n),i=e.outputPixelType;return i&&a.clamp(i),a}jt.set(ht.none,[0,0,0,0,1,0,0,0,0]),jt.set(ht.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),jt.set(ht.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),jt.set(ht.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),jt.set(ht.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),jt.set(ht.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),jt.set(ht.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),jt.set(ht.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),jt.set(ht.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),jt.set(ht.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),jt.set(ht.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),jt.set(ht.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),jt.set(ht.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),jt.set(ht.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),jt.set(ht.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),jt.set(ht.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),jt.set(ht.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),jt.set(ht.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),jt.set(ht.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),jt.set(ht.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),jt.set(ht.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),jt.set(ht.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),jt.set(ht.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var kt=ft=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).rows=3,t.cols=3,t.kernel=[0,0,0,0,1,0,0,0,0],t}return Object(u.a)(r,[{key:"convolutionType",set:function(t){this._set("convolutionType",t);var e=jt.get(t);if(e&&t!==ht.userDefined&&t!==ht.none){var r=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",r),this._set("rows",r)}}},{key:"clone",value:function(){return new ft({cols:this.cols,rows:this.rows,kernel:Object(j.a)(this.kernel),convolutionType:this.convolutionType,raster:Object(o.a)(this.raster)})}}]),r}(m);Object(p.a)([Object(f.b)({json:{type:Number,write:!0}})],kt.prototype,"rows",void 0),Object(p.a)([Object(f.b)({json:{type:Number,write:!0}})],kt.prototype,"cols",void 0),Object(p.a)([Object(f.b)({json:{name:"type",type:Number,write:!0}})],kt.prototype,"convolutionType",null),Object(p.a)([Object(f.b)({json:{type:[Number],write:!0}})],kt.prototype,"kernel",void 0);var Pt=kt=ft=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],kt),Rt=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Convolution",t.rasterArgumentNames=["raster"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments,e=t.convolutionType,r=t.rows,n=t.cols,a=t.kernel;if(!Object.values(ht).includes(e))return{success:!1,supportsGPU:!1,error:"convolution-function: the specified kernel type is not supported ".concat(e)};if(e!==ht.none&&r*n!==a.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var i=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(i.pixelType);var o=i.clone();o.pixelType=this.outputPixelType;var s=[ht.none,ht.sharpen,ht.sharpen2,ht.sharpening3x3,ht.sharpening5x5];return"u8"===this.outputPixelType||s.includes(e)||(o.statistics=null,o.histograms=null),o.colormap=null,o.attributeTable=null,this.rasterInfo=o,{success:!0,supportsGPU:a.length<=25}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r||this.functionArguments.convolutionType===ht.none)return r;var n=this.functionArguments,a=n.kernel,i=n.rows,o=n.cols,s=a.reduce((function(t,e){return t+e}));return 0!==s&&1!==s&&(a=a.map((function(t){return t/s}))),At(r,{kernel:a,rows:i,cols:o,outputPixelType:this.outputPixelType})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments.kernel,e=t.reduce((function(t,e){return t+e}));0!==e&&1!==e&&(t=t.map((function(t){return t/e})));var r=new Float32Array(25);return r.set(t),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:r,clampRange:Object(gt.b)(this.outputPixelType)}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],Rt.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:Pt,json:{write:!0,name:"rasterFunctionArguments"}})],Rt.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],Rt.prototype,"rasterArgumentNames",void 0);var Nt,Tt=Rt=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.ConvolutionFunction")],Rt),It=new M.a({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0}),Ft=Nt=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).curvatureType="standard",t.zFactor=1,t}return Object(u.a)(r,[{key:"readCurvatureType",value:function(t,e){var r,n;return It.fromJSON(null!==(r=null!==(n=e.type)&&void 0!==n?n:e.curvatureType)&&void 0!==r?r:0)}},{key:"clone",value:function(){return new Nt({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:{target:"type"}}}),Object(I.a)(It)],Ft.prototype,"curvatureType",void 0),Object(p.a)([Object($.a)("curvatureType",["type","curvatureType"])],Ft.prototype,"readCurvatureType",null),Object(p.a)([Object(f.b)({type:Number,json:{write:!0}})],Ft.prototype,"zFactor",void 0);var Mt=Ft=Nt=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],Ft),St=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Curvature",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t,e;this.outputPixelType=this._getOutputPixelType("f32");var r=this.sourceRasterInfos[0].clone();return r.pixelType=this.outputPixelType,r.statistics=null,r.histograms=null,r.colormap=null,r.attributeTable=null,r.bandCount=1,this.rasterInfo=r,this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.functionArguments,a=n.zFactor,i=n.curvatureType,o=t.extent,s=t.primaryPixelSizes,u=null===s||void 0===s?void 0:s[0],c=null!==u&&void 0!==u?u:o?{x:o.width/r.width,y:o.height/r.height}:{x:1,y:1},l=this.isGCS&&a>=1?a*R.a:a;return Object(R.d)(r,{zFactor:l,curvatureType:i,resolution:c})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.zFactor;return{curvatureType:t.curvatureType,zFactor:this.isGCS&&e>=1?e*R.a:e}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],St.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:Mt,json:{write:!0,name:"rasterFunctionArguments"}})],St.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],St.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],St.prototype,"isGCS",void 0);var Ct,_t=St=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.CurvatureFunction")],St),Bt=Ct=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).bandIds=[],t.bandNames=[],t.bandWavelengths=[],t.missingBandAction=D.b.bestMatch,t}return Object(u.a)(r,[{key:"clone",value:function(){return new Ct({bandIds:Object(j.a)(this.bandIds),bandNames:Object(j.a)(this.bandNames),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],Bt.prototype,"bandIds",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Bt.prototype,"bandNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Bt.prototype,"bandWavelengths",void 0),Object(p.a)([Object(I.a)({0:"name",1:"wavelength",2:"id"})],Bt.prototype,"method",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Bt.prototype,"missingBandAction",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Bt.prototype,"wavelengthMatchTolerance",void 0);var Gt=Bt=Ct=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],Bt),Et=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="ExtractBand",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.functionArguments,a=this.sourceRasterInfos[0],i=r.method,o=r.bandNames,s=r.bandWavelengths,u=r.bandIds,c=r.missingBandAction,l=(null===o||void 0===o?void 0:o.length)&&("name"===i||"id"!==i&&!(null!==u&&void 0!==u&&u.length)),p=(null===s||void 0===s?void 0:s.length)&&("wavelength"===i||"id"!==i&&!(null!==u&&void 0!==u&&u.length)),f=c===D.b.fail,v=l?this._matchBandNames(a,o):p?this._matchBandWavelengths(a,s,f):this._matchBandIds(a,u,f);if(null==v)return{success:!1,supportsGPU:!1,error:"extract-band-function: Invalid ".concat(l?"band names":p?"band wavelengths":"band ids"," for the imagery data source")};this.functionArguments.bandIds=v,this.functionArguments.method="id",this.outputPixelType=this._getOutputPixelType("f32");var h=a.clone();h.pixelType=this.outputPixelType,h.bandCount=v.length;var b=h.statistics,d=h.histograms;null!=b&&b.length&&(h.statistics=v.map((function(t){return b[t]||b[b.length-1]}))),null!=d&&d.length&&(h.histograms=v.map((function(t){return d[t]||d[d.length-1]})));var m=null===(t=h.keyProperties)||void 0===t?void 0:t.BandProperties;return null!==(e=m)&&void 0!==e&&e.length&&(m=v.map((function(t){return t>=m.length?m[m.length-1]:m[t]})),h.keyProperties=Object(n.a)(Object(n.a)({},h.keyProperties),{},{BandProperties:m})),this.rasterInfo=h,{success:!0,supportsGPU:h.bandCount<=3}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=r.pixels.length,a=this.functionArguments.bandIds.map((function(t){return t>=n?n-1:t}));return r.extractBands(a)}},{key:"_getWebGLParameters",value:function(){var t;if(this.isInputBandIdsSwizzled)t=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{var e,r;0===(t=Object(j.a)(this.functionArguments.bandIds)).length?t=[0,1,2]:t.length<3&&(t[1]=null!==(e=t[1])&&void 0!==e?e:t[0],t[2]=null!==(r=t[2])&&void 0!==r?r:t[1]);for(var n=0;n<3;n++)t[n]=Math.min(t[n],2)}return{bandIndexMat3:W(t)}}},{key:"_getInputBandIds",value:function(t){var e=t.length;return this.functionArguments.bandIds.map((function(t){return t>=e?e-1:t})).map((function(e){return t[e]}))}},{key:"_matchBandNames",value:function(t,e){for(var r=t.bandInfos.map((function(t){return t.name.toLowerCase()})),n=[],a=0;a<e.length;a++){var i=e[a].toLowerCase(),o=r.indexOf(i);if(-1===o&&"nearinfrared"===i&&(o=r.findIndex((function(t){return t.startsWith("nearinfrared_1")})),-1===o&&(o=r.findIndex((function(t){return t.startsWith("nearinfrared")})))),-1===o)return null;n.push(o)}return n}},{key:"_matchBandIds",value:function(t,e,r){var n=t.bandCount;return null===e||void 0===e||!e.length||r&&e.some((function(t){return t<0||t>=n}))?null:e}},{key:"_matchBandWavelengths",value:function(t,e,r){for(var n=t.bandInfos,a=[],i=0;i<n.length;i++){var o=n[i],s=o.minWavelength,u=o.maxWavelength;if(!s||!u)return null;a.push({minWavelength:s,maxWavelength:u})}for(var c=this.functionArguments.wavelengthMatchTolerance,l=[],p=0;p<e.length;p++){for(var f=e[p],v=!1,h=-1,b=Number.MAX_VALUE,d=0;d<a.length;d++){var m=a[d],y=f>=m.minWavelength&&f<=m.maxWavelength,g=Math.abs(f-(m.minWavelength+m.maxWavelength)/2);y?g<b&&(v=!0,h=d,b=g):!v&&g<b&&(h=d,b=g)}if(!v&&c&&b<c&&(v=!0),!v&&r)return null;l.push(h)}return l}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],Et.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:Gt,json:{write:!0,name:"rasterFunctionArguments"}})],Et.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],Et.prototype,"rasterArgumentNames",void 0);var Dt,zt=Et=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.ExtractBandFunction")],Et),Lt=Dt=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).rasters=[],t.processAsMultiband=!0,t}return Object(u.a)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new Dt({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:Object(o.a)(this.rasters)})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],Lt.prototype,"operation",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Lt.prototype,"rasters",void 0),Object(p.a)([Object(ut.a)("rasters")],Lt.prototype,"writeRasters",null),Object(p.a)([Object(f.b)({json:{write:!0}})],Lt.prototype,"processAsMultiband",void 0);var Wt=Lt=Dt=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],Lt),Vt=r(92),Ut=new Map;Ut.set(dt.acos,[0,Math.PI]),Ut.set(dt.asin,[-Math.PI/2,Math.PI/2]),Ut.set(dt.atan,[-Math.PI/2,Math.PI/2]),Ut.set(dt.cos,[-1,1]),Ut.set(dt.sin,[-1,1]),Ut.set(bt.booleanAnd,[0,1]),Ut.set(bt.booleanNot,[0,1]),Ut.set(bt.booleanOr,[0,1]),Ut.set(bt.booleanXOr,[0,1]),Ut.set(bt.equalTo,[0,1]),Ut.set(bt.notEqual,[0,1]),Ut.set(bt.greaterThan,[0,1]),Ut.set(bt.greaterThanEqual,[0,1]),Ut.set(bt.lessThan,[0,1]),Ut.set(bt.lessThanEqual,[0,1]),Ut.set(bt.isNull,[0,1]);var qt=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];function Xt(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]+i[u]);return s}function Ht(t,e,r){var n=Object(F.a)(t,1)[0],a=n.length,i=x.a.createEmptyBand("f32",a);return i.set(n),i}function Jt(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]-i[u]);return s}function Yt(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]*i[u]);return s}function $t(t,e,r){for(var n=Object(F.a)(t,1)[0],a=n.length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)e&&!e[o]||(i[o]=Math.sign(n[o])*Math.floor(Math.abs(n[o])));return i}function Kt(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]/i[u]);return s}function Zt(t,e,r){return Kt(t,e,"f32")}function Qt(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=Math.floor(a[u]/i[u]));return s}function te(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]&i[u]);return s}function ee(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]<<i[u]);return s}function re(t,e,r){for(var n=Object(F.a)(t,1)[0],a=n.length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)e&&!e[o]||(i[o]=~n[o]);return i}function ne(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]|i[u]);return s}function ae(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]>>i[u]);return s}function ie(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]^i[u]);return s}function oe(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]&&i[u]?1:0);return s}function se(t,e,r){for(var n=Object(F.a)(t,1)[0],a=n.length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)e&&!e[o]||(i[o]=n[o]?0:1);return i}function ue(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]||i[u]?1:0);return s}function ce(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=(a[u]?1:0)^(i[u]?1:0));return s}function le(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]===i[u]?1:0);return s}function pe(t,e,r,n){for(var a=Object(F.a)(t,1)[0],i=a.length,o=x.a.createEmptyBand(r,i),s=n===Math.E,u=0;u<i;u++)e&&!e[u]||(o[u]=s?Math.exp(a[u]):Math.pow(n,a[u]));return o}function fe(t,e,r){return pe(t,e,r,10)}function ve(t,e,r){return pe(t,e,r,2)}function he(t,e,r){return pe(t,e,r,Math.E)}function be(t,e,r,n){for(var a=Object(F.a)(t,1)[0],i=a.length,o=x.a.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(a[s]<=0?e[s]=0:o[s]=n(a[s]));return o}function de(t,e,r){return be(t,e,r,Math.log10)}function me(t,e,r){return be(t,e,r,Math.log2)}function ye(t,e,r){return be(t,e,r,Math.log)}function ge(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]>i[u]?1:0);return s}function je(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]>=i[u]?1:0);return s}function Oe(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]<i[u]?1:0);return s}function xe(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]<=i[u]?1:0);return s}function we(t,e,r){var n=Object(F.a)(t,1)[0].length,a=x.a.createEmptyBand(r,n);if(!e)return a;for(var i=0;i<n;i++)a[i]=e[i]?0:1;return a}function Ae(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]%i[u]);return s}function ke(t,e,r){for(var n=Object(F.a)(t,1)[0],a=n.length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)e&&!e[o]||(i[o]=-n[o]);return i}function Pe(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=a[u]===i[u]?0:1);return s}function Re(t,e,r){for(var n=Object(F.a)(t,3),a=n[0],i=n[1],o=n[2],s=a.length,u=x.a.createEmptyBand(r,s),c=0;c<s;c++)e&&!e[c]||(u[c]=a[c]?i[c]:o[c]);return u}function Ne(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0],i=a.length,o=x.a.createEmptyBand(r,i),s=0;s<i;s++)if(!e||e[s]){for(var u=a[s],c=1;c<n;c++){var l=t[c][s];u<l&&(u=l)}o[s]=u}return o}function Te(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0],i=a.length,o=x.a.createEmptyBand(r,i),s=0;s<i;s++)if(!e||e[s]){for(var u=a[s],c=1;c<n;c++){var l=t[c][s];u>l&&(u=l)}o[s]=u}return o}function Ie(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0],i=a.length,o=x.a.createEmptyBand(r,i),s=0;s<i;s++)if(!e||e[s]){for(var u=a[s],c=u,l=1;l<n;l++){var p=t[l][s];c<p?c=p:u>p&&(u=p)}o[s]=c-u}return o}function Fe(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0].length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)if(!e||e[o]){for(var s=0,u=0;u<n;u++)s+=t[u][o];i[o]=s/n}return i}function Me(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0].length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)if(!e||e[o])for(var s=0;s<n;s++){var u=t[s];i[o]+=u[o]}return i}function Se(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0].length,i=x.a.createEmptyBand(r,a),o=0;o<a;o++)if(!e||e[o]){for(var s=new Float32Array(n),u=0,c=0;c<n;c++){var l=t[c];u+=l[o],s[c]=l[o]}u/=n;for(var p=0,f=0;f<n;f++)p+=Math.pow(s[f]-u,2);i[o]=Math.sqrt(p/n)}return i}function Ce(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Math.floor(n/2),i=Object(F.a)(t,1)[0].length,o=x.a.createEmptyBand(r,i),s=new Float32Array(n),u=n%2==1,c=0;c<i;c++)if(!e||e[c]){for(var l=0;l<n;l++)s[l]=t[l][c];s.sort(),o[c]=u?s[a]:(s[a]+s[a-1])/2}return o}function _e(t,e,r){var n=Object(F.a)(t,2),a=n[0],i=n[1];if(null==i)return a;for(var o=a.length,s=x.a.createEmptyBand(r,o),u=0;u<o;u++)e[u]&&(a[u]===i[u]?s[u]=a[u]:e[u]=0);return s}function Be(t,e,r){var n=t.length;if(n<=2)return _e(t,e,r);for(var a=t[0].length,i=x.a.createEmptyBand(r,a),o=new Map,s=0;s<a;s++)if(!e||e[s]){var u=void 0;o.clear();for(var c=0;c<n;c++)u=t[c][s],o.set(u,o.has(u)?o.get(u)+1:1);var l,p=0,f=0,v=Object(Vt.a)(o.keys());try{for(v.s();!(l=v.n()).done;){var h=l.value;(p=o.get(h))>f&&(f=p,u=h)}}catch(b){v.e(b)}finally{v.f()}i[s]=u}return i}function Ge(t,e,r){var n=t.length;if(n<=2)return _e(t,e,r);for(var a=t[0].length,i=x.a.createEmptyBand(r,a),o=new Map,s=0;s<a;s++)if(!e||e[s]){var u=void 0;o.clear();for(var c=0;c<n;c++)u=t[c][s],o.set(u,o.has(u)?o.get(u)+1:1);var l,p=0,f=t.length,v=Object(Vt.a)(o.keys());try{for(v.s();!(l=v.n()).done;){var h=l.value;(p=o.get(h))<f&&(f=p,u=h)}}catch(b){v.e(b)}finally{v.f()}i[s]=u}return i}function Ee(t,e,r){var n=t.length;if(n<2)return t[0];for(var a=Object(F.a)(t,1)[0].length,i=x.a.createEmptyBand(r,a),o=new Set,s=0;s<a;s++)if(!e||e[s]){var u=void 0;o.clear();for(var c=0;c<n;c++)u=t[c][s],o.add(u);i[s]=o.size}return i}var De=new Map,ze=new Map,Le=new Map,We=new Map;function Ve(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};De.size||(De.set(4,Math.sqrt),De.set(6,Math.acos),De.set(7,Math.asin),De.set(8,Math.atan),De.set(9,Math.atanh),De.set(10,Math.abs),De.set(21,Math.cos),De.set(22,Math.cosh),De.set(48,Math.floor),De.set(49,Math.ceil),De.set(51,Math.sin),De.set(52,Math.sinh),De.set(56,Math.tan),De.set(57,Math.tanh),De.set(59,Math.acosh),De.set(60,Math.asinh),De.set(65,Math.floor),ze.set(5,Math.pow),ze.set(61,Math.atan2),Le.set(1,Xt),Le.set(2,Jt),Le.set(3,Yt),Le.set(11,te),Le.set(12,ee),Le.set(12,ee),Le.set(13,re),Le.set(14,ne),Le.set(15,ae),Le.set(16,ie),Le.set(17,oe),Le.set(18,se),Le.set(19,ue),Le.set(20,ce),Le.set(23,Kt),Le.set(24,le),Le.set(25,he),Le.set(26,fe),Le.set(27,ve),Le.set(28,ge),Le.set(29,je),Le.set(30,$t),Le.set(31,we),Le.set(32,Ht),Le.set(33,Oe),Le.set(34,xe),Le.set(35,ye),Le.set(36,de),Le.set(37,me),Le.set(44,Ae),Le.set(45,ke),Le.set(46,Pe),Le.set(64,Zt),Le.set(65,Qt),Le.set(76,Re),Le.set(78,Re),We.set(38,Be),We.set(39,Ne),We.set(40,Fe),We.set(41,Ce),We.set(42,Te),We.set(43,Ge),We.set(47,Ie),We.set(54,Se),We.set(55,Me),We.set(58,Ee),We.set(66,Be),We.set(67,Ne),We.set(68,Fe),We.set(69,Ce),We.set(70,Te),We.set(71,Ge),We.set(72,Ie),We.set(73,Se),We.set(74,Me),We.set(75,Ee));for(var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.map((function(t){return t.mask})),n=r.filter((function(t){return null!=t})),a=t[0].pixels[0].length;if(0===n.length)return new Uint8Array(a).fill(255);var i=n[0],o=new Uint8Array(i);if(1===n.length)return o;if(!e){for(var s=1;s<n.length;s++)for(var u=n[s],c=0;c<o.length;c++)o[c]&&(o[c]=u[c]?255:0);return o}if(n.length!==r.length)return new Uint8Array(a).fill(255);for(var l=1;l<n.length;l++)for(var p=n[l],f=0;f<o.length;f++)0===o[f]&&(o[f]=p[f]?255:0);return o}(t,e>=66&&e<=75),a=r.outputPixelType,i=void 0===a?"f32":a,o=!We.has(e)||r.processAsMultiband,s=o?t[0].pixels.length:1,u=[],c=function(r){var a,s=We.has(e)&&!o?t.flatMap((function(t){return t.pixels})):t.map((function(t){return t.pixels[r]})),c=!0;if(e===mt.setNull){var l=function(t,e,r){for(var n=Object(F.a)(t,2),a=n[0],i=n[1],o=a.length,s=x.a.createEmptyBand(r,o),u=new Uint8Array(o),c=0;c<o;c++)null!=e&&!e[c]||0!==a[c]||(s[c]=i[c],u[c]=255);return{band:s,mask:u}}(s,n,i);a=l.band,n=l.mask,c=!1}else Le.has(e)?a=Le.get(e)(s,n,"f64"):De.has(e)?a=e===dt.asin||e===dt.acos||e===dt.atanh?function(t,e,r,n){var a=t[0],i=a.length,o=x.a.createEmptyBand(r,i);if(n===dt.atanh){for(var s=0;s<i;s++)if(e[s]){var u=a[s];Math.abs(u)>=1?e[s]=0:o[s]=Math.atanh(u)}return o}for(var c=n===dt.asin?Math.asin:Math.acos,l=0;l<i;l++)if(e[l]){var p=a[l];Math.abs(p)>1?e[l]=0:o[l]=c(p)}return o}(s,n,"f64",e):function(t,e,r,n){for(var a=Object(F.a)(t,1)[0],i=a.length,o=x.a.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(o[s]=n(a[s]));return o}(s,n,"f64",De.get(e)):ze.has(e)?a=function(t,e,r,n){for(var a=Object(F.a)(t,2),i=a[0],o=a[1],s=i.length,u=x.a.createEmptyBand(r,s),c=0;c<s;c++)e&&!e[c]||(u[c]=n(i[c],o[c]));return u}(s,n,"f64",ze.get(e)):We.has(e)?a=We.get(e)(s,n,"f64"):(a=s[0],c=!1);if(c&&e!==bt.isNull&&!Ut.has(e)){var p=x.a.createEmptyBand(i,a.length);n||(n=new Uint8Array(a.length).fill(255)),function(t,e,r,n){var a=Object(gt.b)(r),i=Object(F.a)(a,2),o=i[0],s=i[1],u=r.startsWith("u")||r.startsWith("s");u&&(o-=1e-5,s+=1e-5);for(var c=0;c<e.length;c++)if(e[c]){var l=t[c];isNaN(l)||l<o||l>s?e[c]=0:n[c]=u?Math.round(l):l}}(a,n,i,p),a=p}u.push(a)},l=0;l<s;l++)c(l);var p=t[0];return new x.a({width:p.width,height:p.height,pixelType:i,mask:e===bt.isNull?null:n,pixels:u})}var Ue=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Local",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0],r=e.bandCount,n=this.functionArguments.processAsMultiband;if(t.some((function(t){return t.bandCount!==r})))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};var a=this.functionArguments,i=a.operation,o=a.rasters,s=qt[i];if(!(999===s||o.length===s||o.length<=1&&1===s))return{success:!1,supportsGPU:!1,error:"local-function: the length of functionArguments.rasters does not match operation's requirement: ".concat(s)};this.outputPixelType=this._getOutputPixelType("f32");var u=e.clone();u.pixelType=this.outputPixelType,u.statistics=null,u.histograms=null,u.colormap=null,u.attributeTable=null,u.bandCount=999!==s||n?r:1;var c=function(t){return Ut.get(t)}(i);if(c){u.statistics=[];for(var l=0;l<u.bandCount;l++)u.statistics[l]={min:c[0],max:c[1],avg:(c[0]+c[1])/2,stddev:(c[0]+c[1])/10}}return this.rasterInfo=u,{success:!0,supportsGPU:1===u.bandCount&&s<=3&&(i<11||i>16)}}},{key:"_processPixels",value:function(t){var e,r=t.pixelBlocks;return null==r||r.some((function(t){return null==t}))?null:Ve(r,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:null!==(e=this.outputPixelType)&&void 0!==e?e:void 0})}},{key:"_getWebGLParameters",value:function(){var t,e,r,n=this.functionArguments.operation,a=qt[n],i=null!==(t=null===(e=Object.keys(yt).find((function(t){return yt[t]===n})))||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"undefined",o=null!==(r=this.outputPixelType)&&void 0!==r?r:"f32",s=Object(gt.b)(o),u=Object(F.a)(s,2),c=u[0],l=u[1],p=o.startsWith("u")||o.startsWith("s");return p&&(c-=1e-4,l+=1e-4),{imageCount:a,operationName:i,domainRange:[c,l],isOutputRounded:p}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],Ue.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:Wt,json:{write:!0,name:"rasterFunctionArguments"}})],Ue.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],Ue.prototype,"rasterArgumentNames",void 0);var qe,Xe=Ue=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.LocalFunction")],Ue),He=r(141),Je=qe=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).includedRanges=null,t.noDataValues=null,t.noDataInterpretation=D.c.matchAny,t}return Object(u.a)(r,[{key:"normalizedNoDataValues",get:function(){var t=this.noDataValues;if(null===t||void 0===t||!t.length)return null;var e=!1,r=t.map((function(t){if("number"==typeof t)return e=!0,[t];if("string"==typeof t){var r=t.trim().split(" ").filter((function(t){return""!==t.trim()})).map((function(t){return Number(t)}));return e=e||r.length>0,0===r.length?null:r}return null}));return e?r:null}},{key:"clone",value:function(){var t,e,r,n;return new qe({includedRanges:null!==(t=null===(e=this.includedRanges)||void 0===e?void 0:e.slice())&&void 0!==t?t:[],noDataValues:null!==(r=null===(n=this.noDataValues)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],noDataInterpretation:this.noDataInterpretation})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],Je.prototype,"includedRanges",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Je.prototype,"noDataValues",void 0),Object(p.a)([Object(f.b)()],Je.prototype,"normalizedNoDataValues",null),Object(p.a)([Object(f.b)({json:{write:!0}})],Je.prototype,"noDataInterpretation",void 0);var Ye=Je=qe=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],Je),$e=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Mask",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,this.rasterInfo=t;var r=this.functionArguments,n=r.includedRanges,a=r.normalizedNoDataValues;if((null===n||void 0===n||!n.length)&&(null===a||void 0===a||!a.length))return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};for(var i=[],o=0;o<t.bandCount;o++){var s=Object(D.h)(e,null===n||void 0===n?void 0:n.slice(2*o,2*o+2),null===a||void 0===a?void 0:a[o]);if(null==s){i=null;break}i.push(s)}this.lookups=i;var u=null!=a&&a.every((function(t){var e;return(null===t||void 0===t?void 0:t.length)===(null===(e=a[0])||void 0===e?void 0:e.length)}));return{success:!0,supportsGPU:(!n||n.length<=2*D.a)&&(!a||u&&a[0].length<=D.a)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.outputPixelType,a=this.lookups,i=this.functionArguments,o=i.includedRanges,s=i.noDataInterpretation,u=i.normalizedNoDataValues,c=s===D.c.matchAll;return Object(D.n)(r,{includedRanges:o,noDataValues:u,outputPixelType:n,matchAll:c,lookups:a})}},{key:"_getWebGLParameters",value:function(){var t,e=this.functionArguments,r=e.includedRanges,n=e.normalizedNoDataValues,a=new Float32Array(D.a);a.fill(He.a),(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.length)&&a.set(n[0]);for(var i=new Float32Array(D.a),o=0;o<i.length;o+=2){var s,u;i[o]=null!==(s=null===r||void 0===r?void 0:r[o])&&void 0!==s?s:-He.a,i[o+1]=null!==(u=null===r||void 0===r?void 0:r[o+1])&&void 0!==u?u:He.a}return r&&r.length&&i.set(r),{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:a,includedRanges:i}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],$e.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:Ye,json:{write:!0,name:"rasterFunctionArguments"}})],$e.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],$e.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],$e.prototype,"lookups",void 0);var Ke,Ze=$e=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.MaskFunction")],$e),Qe=Ke=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).visibleBandID=0,t.infraredBandID=1,t.scientificOutput=!1,t}return Object(u.a)(r,[{key:"clone",value:function(){var t=this.visibleBandID,e=this.infraredBandID,r=this.scientificOutput;return new Ke({visibleBandID:t,infraredBandID:e,scientificOutput:r})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],Qe.prototype,"visibleBandID",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Qe.prototype,"infraredBandID",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Qe.prototype,"scientificOutput",void 0);var tr=Qe=Ke=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Qe),er=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="NDVI",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments,e=t.scientificOutput,r=t.visibleBandID,a=t.infraredBandID;this.outputPixelType=this._getOutputPixelType(e?"f32":"u8");var i=this.sourceRasterInfos[0],o=Math.max(r,a);if(i.bandCount<2||o>=i.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};var s=i.clone();s.pixelType=this.outputPixelType,s.colormap=null,s.histograms=null,s.bandCount=1,s.keyProperties=Object(n.a)(Object(n.a)({},s.keyProperties),{},{BandProperties:void 0});var u=e?[-1,1,0,.1]:[0,200,100,10],c=Object(F.a)(u,4),l=c[0],p=c[1],f=c[2],v=c[3];return s.statistics=[{min:l,max:p,avg:f,stddev:v}],this.rasterInfo=s,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.functionArguments;return function(t,e,r,n){for(var a=t.mask,i=t.pixels,o=t.width,s=t.height,u=i[r],c=i[e],l=c.length,p=n?new Uint8Array(l):new Float32Array(l),f=n?100:1,v=n?100.5:0,h=0;h<l;h++)if(null==a||a[h]){var b=u[h],d=c[h],m=b+d;m&&(p[h]=(b-d)/m*f+v)}var y=new x.a({width:o,height:s,mask:a,pixelType:n?"u8":"f32",pixels:[p]});return y.updateStatistics(),y}(r,n.visibleBandID,n.infraredBandID,!n.scientificOutput)}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.visibleBandID,r=t.infraredBandID,n=t.scientificOutput;return{bandIndexMat3:W(this.isInputBandIdsSwizzled?[0,1,2]:[r,e,0]),scaled:!n}}},{key:"_getInputBandIds",value:function(t){var e=this.functionArguments,r=e.visibleBandID;return[e.infraredBandID,r,0].map((function(e){return t[e]}))}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],er.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:tr,json:{write:!0,name:"rasterFunctionArguments"}})],er.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],er.prototype,"rasterArgumentNames",void 0);var rr,nr=er=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.NDVIFunction")],er),ar=rr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).inputRanges=null,t.outputValues=null,t.noDataRanges=null,t.allowUnmatched=!1,t.isLastInputRangeInclusive=!1,t}return Object(u.a)(r,[{key:"clone",value:function(){return new rr({inputRanges:Object(j.a)(this.inputRanges),outputValues:Object(j.a)(this.outputValues),noDataRanges:Object(j.a)(this.noDataRanges),allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],ar.prototype,"inputRanges",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],ar.prototype,"outputValues",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],ar.prototype,"noDataRanges",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],ar.prototype,"allowUnmatched",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],ar.prototype,"isLastInputRangeInclusive",void 0);var ir=ar=rr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],ar),or=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Remap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null,t.bandCount=1,t.attributeTable=null;var r=t.statistics,a=this.functionArguments,i=a.allowUnmatched,o=a.outputValues,s=a.inputRanges,u=a.noDataRanges,c=a.isLastInputRangeInclusive;if(null!=r&&r.length&&null!==o&&void 0!==o&&o.length)if(i){var l=Math.min.apply(null,[].concat(Object(j.a)(o),[r[0].min])),p=Math.max.apply(null,[].concat(Object(j.a)(o),[r[0].max]));t.statistics=[Object(n.a)(Object(n.a)({},r[0]),{},{min:l,max:p})]}else{for(var f=o[0],v=f,h=0;h<o.length;h++)f=f>o[h]?o[h]:f,v=v>o[h]?v:o[h];t.statistics=[Object(n.a)(Object(n.a)({},r[0]),{},{min:f,max:v})]}return this.rasterInfo=t,this.lookup=i?null:Object(D.i)({srcPixelType:e,inputRanges:s,outputValues:o,noDataRanges:u,allowUnmatched:i,isLastInputRangeInclusive:c,outputPixelType:this.outputPixelType}),{success:!0,supportsGPU:(!o||o.length<=D.a)&&(!u||u.length<=D.a)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.lookup,a=this.outputPixelType;if(n){var i=Object(D.m)(r,{lut:[n.lut],offset:n.offset,outputPixelType:a});return null!=i&&n.mask&&(i.mask=Object(D.l)(r.pixels[0],r.mask,n.mask,n.offset,"u8")),i}var o=this.functionArguments,s=o.inputRanges,u=o.outputValues,c=o.noDataRanges,l=o.allowUnmatched,p=o.isLastInputRangeInclusive;return Object(D.q)(r,{inputRanges:s,outputValues:u,noDataRanges:c,outputPixelType:a,allowUnmatched:l,isLastInputRangeInclusive:p})}},{key:"_getWebGLParameters",value:function(){for(var t,e,r=this.functionArguments,n=r.allowUnmatched,a=r.noDataRanges,i=r.isLastInputRangeInclusive,o=new Float32Array(3*D.a),s=1e-5,u=null!==(t=this.functionArguments.inputRanges)&&void 0!==t?t:[],c=null!==(e=this.functionArguments.outputValues)&&void 0!==e?e:[],l=c.length,p=0;p<D.a;p++){var f,v,h;o[3*p]=null!==(f=u[2*p])&&void 0!==f?f:He.a-1,o[3*p+1]=null!==(v=u[2*p+1])&&void 0!==v?v:He.a,o[3*p+2]=null!==(h=c[p])&&void 0!==h?h:0,p<l&&(p>0&&(o[3*p]-=s),(p<l-1||!i)&&(o[3*p+1]-=s))}var b=new Float32Array(2*D.a);return b.fill(He.a),(null===a||void 0===a?void 0:a.length)&&b.set(a),{allowUnmatched:n,rangeMaps:o,noDataRanges:b,clampRange:Object(gt.b)(this.outputPixelType)}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],or.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:ir,json:{write:!0,name:"rasterFunctionArguments"}})],or.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],or.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],or.prototype,"lookup",void 0);var sr,ur=or=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.RemapFunction")],or),cr=new M.a({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0}),lr=sr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).slopeType="degree",t.zFactor=1,t.pixelSizePower=.664,t.pixelSizeFactor=.024,t.removeEdgeEffect=!1,t}return Object(u.a)(r,[{key:"clone",value:function(){return new sr({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}}]),r}(m);Object(p.a)([Object(I.a)(cr)],lr.prototype,"slopeType",void 0),Object(p.a)([Object(f.b)({type:Number,json:{write:!0}})],lr.prototype,"zFactor",void 0),Object(p.a)([Object(f.b)({type:Number,json:{name:"psPower",write:!0}})],lr.prototype,"pixelSizePower",void 0),Object(p.a)([Object(f.b)({type:Number,json:{name:"psZFactor",write:!0}})],lr.prototype,"pixelSizeFactor",void 0),Object(p.a)([Object(f.b)({type:Boolean,json:{write:!0}})],lr.prototype,"removeEdgeEffect",void 0);var pr=lr=sr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],lr),fr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Slope",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t,e;this.outputPixelType=this._getOutputPixelType("f32");var r=this.sourceRasterInfos[0].clone();return r.pixelType=this.outputPixelType,r.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null,r.histograms=null,r.colormap=null,r.attributeTable=null,r.bandCount=1,this.rasterInfo=r,this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.functionArguments,a=n.zFactor,i=n.slopeType,o=n.pixelSizePower,s=n.pixelSizeFactor,u=this.isGCS,c=t.extent,l=t.primaryPixelSizes,p=null===l||void 0===l?void 0:l[0],f=null!==p&&void 0!==p?p:c?{x:c.width/r.width,y:c.height/r.height}:{x:1,y:1};return Object(R.f)(r,{zFactor:a,slopeType:i,pixelSizePower:o,pixelSizeFactor:s,isGCS:u,resolution:f})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.zFactor,r=t.slopeType,n=t.pixelSizeFactor,a=t.pixelSizePower;return{zFactor:this.isGCS&&e>=1?e*R.a:e,slopeType:r,pixelSizeFactor:null!==n&&void 0!==n?n:0,pixelSizePower:null!==a&&void 0!==a?a:0}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],fr.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:pr,json:{write:!0,name:"rasterFunctionArguments"}})],fr.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],fr.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],fr.prototype,"isGCS",void 0);var vr,hr=fr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.SlopeFunction")],fr),br=vr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).statistics=null,t.histograms=null,t}return Object(u.a)(r,[{key:"readStatistics",value:function(t,e){if(null===t||void 0===t||!t.length)return null;var r=[];return t.forEach((function(t){var e,n,a={min:t.min,max:t.max,avg:null!==(e=t.avg)&&void 0!==e?e:t.mean,stddev:null!==(n=t.stddev)&&void 0!==n?n:t.standardDeviation};r.push(a)})),r}},{key:"writeStatistics",value:function(t,e,r){if(null!==t&&void 0!==t&&t.length){var a=[];t.forEach((function(t){var e=Object(n.a)(Object(n.a)({},t),{},{mean:t.avg,standardDeviation:t.stddev});delete e.avg,delete e.stddev,a.push(e)})),e[r]=a}}},{key:"clone",value:function(){return new vr({statistics:Object(o.a)(this.statistics),histograms:Object(o.a)(this.histograms)})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],br.prototype,"statistics",void 0),Object(p.a)([Object($.a)("statistics")],br.prototype,"readStatistics",null),Object(p.a)([Object(ut.a)("statistics")],br.prototype,"writeStatistics",null),Object(p.a)([Object(f.b)({json:{write:!0}})],br.prototype,"histograms",void 0);var dr=br=vr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],br),mr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="StatisticsHistogram",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");var e=t.clone(),r=this.functionArguments,n=r.statistics,a=r.histograms;return a&&(e.histograms=a),n&&(e.statistics=n),this.rasterInfo=e,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],mr.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:dr,json:{write:!0,name:"rasterFunctionArguments"}})],mr.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],mr.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],mr.prototype,"indexedColormap",void 0),Object(p.a)([Object(f.b)()],mr.prototype,"isNoopProcess",void 0);var yr,gr=mr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],mr),jr=new M.a({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0}),Or=yr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).computeGamma=!1,t.dynamicRangeAdjustment=!1,t.gamma=[],t.histograms=null,t.statistics=null,t.stretchType="none",t.useGamma=!1,t}return Object(u.a)(r,[{key:"writeStatistics",value:function(t,e,r){var n;(null===(n=t)||void 0===n?void 0:n.length)&&(Array.isArray(t[0])||(t=t.map((function(t){return[t.min,t.max,t.avg,t.stddev]}))),e[r]=t)}},{key:"clone",value:function(){return new yr({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:Object(o.a)(this.statistics),gamma:Object(o.a)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:Object(o.a)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}}]),r}(m);Object(p.a)([Object(f.b)({type:Boolean,json:{write:!0}})],Or.prototype,"computeGamma",void 0),Object(p.a)([Object(f.b)({type:Boolean,json:{name:"dra",write:!0}})],Or.prototype,"dynamicRangeAdjustment",void 0),Object(p.a)([Object(f.b)({type:[Number],json:{write:!0}})],Or.prototype,"gamma",void 0),Object(p.a)([Object(f.b)()],Or.prototype,"histograms",void 0),Object(p.a)([Object(f.b)({type:Number,json:{write:!0}})],Or.prototype,"maxPercent",void 0),Object(p.a)([Object(f.b)({type:Number,json:{write:!0}})],Or.prototype,"minPercent",void 0),Object(p.a)([Object(f.b)({type:Number,json:{write:!0}})],Or.prototype,"numberOfStandardDeviations",void 0),Object(p.a)([Object(f.b)({type:Number,json:{name:"max",write:!0}})],Or.prototype,"outputMax",void 0),Object(p.a)([Object(f.b)({type:Number,json:{name:"min",write:!0}})],Or.prototype,"outputMin",void 0),Object(p.a)([Object(f.b)({type:Number,json:{write:!0}})],Or.prototype,"sigmoidStrengthLevel",void 0),Object(p.a)([Object(f.b)({json:{type:[[Number]],write:!0}})],Or.prototype,"statistics",void 0),Object(p.a)([Object(ut.a)("statistics")],Or.prototype,"writeStatistics",null),Object(p.a)([Object(I.a)(jr)],Or.prototype,"stretchType",void 0),Object(p.a)([Object(f.b)({type:Boolean,json:{write:!0}})],Or.prototype,"useGamma",void 0);var xr=Or=yr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],Or),wr=r(738),Ar=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Stretch",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t.cutOffs=null,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){this.lookup=null,this.cutOffs=null;var t=this.sourceRasterInfos[0],e=t.pixelType,r=this.functionArguments,a=r.dynamicRangeAdjustment,i=r.gamma,o=r.useGamma;if(!a&&["u8","u16","s8","s16"].includes(e)){var s=Object(wr.h)(r.toJSON(),{rasterInfo:t}),u=this._isOutputRoundingNeeded()?"round":"float";this.lookup=Object(wr.e)(Object(n.a)(Object(n.a)({pixelType:e},s),{},{gamma:o?i:null,rounding:u})),this.cutOffs=s}else a||(this.cutOffs=Object(wr.h)(r.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(e);var c=t.clone();return c.pixelType=this.outputPixelType,c.statistics=null,c.histograms=null,c.colormap=null,c.attributeTable=null,"u8"===this.outputPixelType&&(c.keyProperties.DataType="processed"),this.rasterInfo=c,{success:!0,supportsGPU:!a}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return r;var a=this.lookup;if(a)return Object(D.m)(r,Object(n.a)(Object(n.a)({},a),{},{outputPixelType:this.rasterInfo.pixelType}));var i=this.functionArguments,o=this.cutOffs||Object(wr.h)(i.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r}),s=i.useGamma?i.gamma:null;return Object(wr.i)(r,Object(n.a)(Object(n.a)({},o),{},{gamma:s,outputPixelType:this.outputPixelType}))}},{key:"_getWebGLParameters",value:function(){var t,e=this.functionArguments,r=e.outputMin,n=void 0===r?0:r,a=e.outputMax,i=void 0===a?255:a,o=e.gamma,s=e.useGamma,u=this.rasterInfo.bandCount>=2?3:1,c=s&&o&&o.length?Object(wr.a)(u,o):[1,1,1],l=null!==(t=this.cutOffs)&&void 0!==t?t:{minCutOff:[0,0,0],maxCutOff:[255,255,255]},p=l.minCutOff,f=l.maxCutOff;1===p.length&&(p[1]=p[2]=p[0],f[1]=f[2]=f[0]);var v,h=new Float32Array(u);for(v=0;v<u;v++)h[v]=(i-n)/(f[v]-p[v]);var b=this._isOutputRoundingNeeded();return{bandCount:u,outMin:n,outMax:i,minCutOff:p,maxCutOff:f,factor:h,useGamma:s,gamma:s&&o?o:[1,1,1],gammaCorrection:s&&c?c:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:b,type:"stretch"}}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],Ar.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:xr,json:{write:!0,name:"rasterFunctionArguments"}})],Ar.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],Ar.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Ar.prototype,"lookup",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],Ar.prototype,"cutOffs",void 0);var kr,Pr=Ar=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.StretchFunction")],Ar),Rr=kr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).attributeTableAsRecordSet=null,t}return Object(u.a)(r,[{key:"clone",value:function(){return new kr({attributeTableAsRecordSet:Object(o.a)(this.attributeTableAsRecordSet)})}}]),r}(m);Object(p.a)([Object(f.b)({json:{write:!0}})],Rr.prototype,"attributeTableAsRecordSet",void 0);var Nr=Rr=kr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.TableFunctionArguments")],Rr),Tr=function(t){Object(c.a)(r,t);var e=Object(l.a)(r);function r(){var t;return Object(s.a)(this,r),(t=e.apply(this,arguments)).functionName="Table",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return Object(u.a)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];if(t.bandCount>1||t.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};if(!this.functionArguments.attributeTableAsRecordSet)return{success:!1,supportsGPU:!1,error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(t.pixelType);var e=t.clone();return e.pixelType=this.outputPixelType,e.bandCount=1,"thematic"!==e.dataType&&(e.keyProperties=e.keyProperties?Object(n.a)(Object(n.a)({},e.keyProperties),{},{DataType:"thematic"}):{DataType:"thematic"}),this.rasterInfo=e,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(P);Object(p.a)([Object(f.b)({json:{write:!0,name:"rasterFunction"}})],Tr.prototype,"functionName",void 0),Object(p.a)([Object(f.b)({type:Nr,json:{write:!0,name:"rasterFunctionArguments"}})],Tr.prototype,"functionArguments",void 0),Object(p.a)([Object(f.b)()],Tr.prototype,"rasterArgumentNames",void 0),Object(p.a)([Object(f.b)()],Tr.prototype,"isNoopProcess",void 0);var Ir=Tr=Object(p.a)([Object(v.a)("esri.layers.support.rasterFunctions.TableFunction")],Tr),Fr=new Map;function Mr(t,e){var r=t.rasterFunctionArguments;r&&(r.rasters||[r.raster]).forEach((function(t){t&&"number"!=typeof t&&("string"==typeof t?t.startsWith("http")&&(e.includes(t)||e.push(t)):"rasterFunctionArguments"in t&&Mr(t,e))}))}function Sr(t,e){var r;if(e=null!==(r=e)&&void 0!==r?r:{},"function"in(t=Object(o.a)(t))&&"arguments"in t&&t.arguments){var n=zr(t,new Map,e);if(Wr(n),!n.renderingRule)throw new i.a("raster-function-helper","Unsupported raster function json.");t=n.renderingRule}if("rasterFunction"in t)return Br(t=_r(t),e);throw new i.a("raster-function-helper","unsupported raster function json.")}function Cr(t){return!!(t&&"object"==typeof t&&t.rasterFunction&&t.rasterFunctionArguments)}function _r(t){var e,r=t.rasterFunction,a=t.rasterFunctionArguments,i={};for(var o in a){var s=a[o],u=o.toLowerCase();if("rasters"===u&&Array.isArray(s))i.rasters=s.map((function(t){return Cr(t)?_r(t):t}));else switch(Cr(s)&&(s=_r(s)),u){case"dra":i.dra=s;break;case"pspower":i.psPower=s;break;case"pszfactor":i.psZFactor=s;break;case"bandids":i.bandIds=s;break;default:i[o[0].toLowerCase()+o.slice(1)]=s}}return"Local"!==r||null!==(e=i.rasters)&&void 0!==e&&e.length||(i.rasters=["$$"]),Object(n.a)(Object(n.a)({},t),{},{rasterFunctionArguments:i})}function Br(t,e){var r,a=t.rasterFunction,o=t.rasterFunctionArguments,s=null===(r=t.outputPixelType)||void 0===r?void 0:r.toLowerCase();if(null==a||!Fr.has(a))throw new i.a("raster-function-helper","unsupported raster function: ".concat(a));for(var u=Fr.get(a),c=("function"==typeof u.ctor?u.ctor:u.ctor.default).fromJSON(Object(n.a)(Object(n.a)({},t),{},{outputPixelType:s})),l=c.rasterArgumentNames,p=[],f=function(t,e){return"rasters"===e[0]&&Array.isArray(t.rasters)?t.rasters:e.map((function(e){return t[e]}))}(o,l),v="rasters"===l[0],h=[],b=0;b<f.length;b++){var d,m=f[b],y=void 0;null==m||"string"==typeof m&&m.startsWith("$")?p.push(null===e||void 0===e?void 0:e.raster):"string"==typeof m?e[m]&&p.push(e[m]):"number"!=typeof m&&"rasterFunction"in m&&(y=Br(m,e),v||(c.functionArguments[l[b]]=y),p.push(y)),v&&h.push(null!==(d=y)&&void 0!==d?d:m)}if(v&&(c.functionArguments.rasters=h),e){var g;c.sourceRasters=p;var j=null===(g=e.raster)||void 0===g?void 0:g.url;j&&(c.mainPrimaryRasterId=j)}return c}function Gr(t,e){if(t&&e)for(var r in t){var n=t[r];n&&"object"==typeof n&&"type"in n&&("RasterFunctionTemplate"===n.type?Gr(n.arguments,e):"RasterFunctionVariable"===n.type&&null!=e[n.name]&&(n.value=e[n.name]))}}function Er(t,e){var r;if(!t||"object"!=typeof t)return t;var n=t.value;if(!n||"object"!=typeof n)return t.isDataset?"$$":n;if(Array.isArray(n))return 0===n.length?[]:n.map((function(t){return"object"==typeof t&&"RasterFunctionVariable"===t.type?Er(t,e):t}));if("value"in n&&["number","string","boolean"].includes(typeof n.value))return n.value;if(t.isDataset&&"Scalar"!==n.type)return"$$";if(!("type"in n))return n;var a=n;switch(n.type){case"Scalar":a=n.value;break;case"AlgorithmicColorRamp":a=Dr(n);break;case"MultiPartColorRamp":a={type:"multipart",colorRamps:n.ArrayOfColorRamp.map(Dr)};break;case"ArgumentArray":if(null!==(r=n.elements)&&void 0!==r&&r.length&&"RasterStatistics"!==n.elements[0].type){for(var o=[],s=0;s<n.elements.length;s++){var u=n.elements[s],c=u.type;if(c)if("RasterFunctionTemplate"===c){var l=zr(u,e).renderingRule;o.push(l),null!=u._object_id&&e.set(u._object_id,l)}else{if("RasterFunctionVariable"!==c)throw new i.a("raster-function-helper","unsupported raster function json.");var p=Er(u,e);o.push(p),null!=u._object_id&&e.set(u._object_id,p)}else o.push(u)}a=o}else a=n.elements}return null!=n._object_id&&e.set(n._object_id,a),a}function Dr(t){var e,r=null!==(e=t.algorithm)&&void 0!==e?e:"esriHSVAlgorithm",n=t.FromColor,i=t.ToColor;if(!Array.isArray(n)){var o=Object(a.d)({h:n.Hue,s:n.Saturation,v:n.Value});n=[o.r,o.g,o.b,n.AlphaValue]}if(!Array.isArray(i)){var s=Object(a.d)({h:i.Hue,s:i.Saturation,v:i.Value});i=[s.r,s.g,s.b,i.AlphaValue]}return{type:"algorithmic",algorithm:r,fromColor:n,toColor:i}}function zr(t,e,r){r&&Gr(t,r);var n={renderingRule:{},templates:e};return Lr(t,n),n}function Lr(t,e){if(t&&e.renderingRule){var r=e.renderingRule,n=e.templates,a=t.function,i=t.arguments,o=t._object_id;if(a&&i){null!=o&&n.set(o,r),r.rasterFunction=a.type.replace("Function",""),r.outputPixelType=a.pixelType;var s={};for(var u in r.rasterFunctionArguments=s,i)if("type"!==u&&"object_id"!==u&&"_object_ref_id"!==u){var c=i[u];c&&"object"==typeof c&&"type"in c&&("RasterFunctionTemplate"===c.type||"RasterFunctionVariable"===c.type)?("RasterFunctionVariable"===c.type?s[u]=Er(c,n):(r.rasterFunctionArguments[u]={},Lr(c,{renderingRule:r.rasterFunctionArguments[u],templates:n})),null!=c._object_id&&n.set(c._object_id,s[u])):s[u]=c}switch(s.DEM&&!s.Raster&&(s.Raster=s.DEM,delete s.DEM),r.rasterFunction){case"Stretch":!function(t){var e;null!==(e=t.Statistics)&&void 0!==e&&e.length&&"object"==typeof t.Statistics&&(t.Statistics=t.Statistics.map((function(t){return[t.min,t.max,t.mean,t.standardDeviation]}))),null!=t.NumberOfStandardDeviation&&(t.NumberOfStandardDeviations=t.NumberOfStandardDeviation,delete t.NumberOfStandardDeviation)}(s);break;case"Colormap":!function(t){var e;"randomcolorramp"===(null===(e=t.ColorRamp)||void 0===e||null===(e=e.type)||void 0===e?void 0:e.toLowerCase())&&(delete t.ColorRamp,t.ColormapName="Random"),0===t.ColorSchemeType&&delete t.ColorRamp}(s);break;case"Convolution":!function(t){null!=t.ConvolutionType&&(t.Type=t.ConvolutionType,delete t.ConvolutionType)}(s);break;case"Mask":!function(t){var e;(null===(e=t.NoDataValues)||void 0===e?void 0:e.length)&&"string"==typeof t.NoDataValues[0]&&(t.NoDataValues=t.NoDataValues.filter((function(t){return""!==t})).map((function(t){return Number(t)})))}(s)}}}}function Wr(t){var e=t.renderingRule,r=t.templates;if("object"==typeof e&&null!==e&&void 0!==e&&e.rasterFunctionArguments&&r.size){var n=e.rasterFunctionArguments,a=function(){var t=n[o],e="_object_ref_id"===o?t:t&&"object"==typeof t&&"_object_ref_id"in t?t._object_ref_id:null;if(null==e)t&&"object"==typeof t&&(t.rasterFunctionArguments&&Wr({renderingRule:t,templates:r}),Array.isArray(t)&&t.forEach((function(n,a){if("object"==typeof n)if(null!=n._object_ref_id){if(!r.has(n._object_ref_id))throw new i.a("raster-function-helper","unsupported raster function json. _object_ref_id: ".concat(t," does not exist"));var o=r.get(e);o&&"object"==typeof o?Object.assign(n,o):t[a]=o}else Wr({renderingRule:n,templates:r})})));else{if(!r.has(e))throw new i.a("raster-function-helper","unsupported raster function json. _object_ref_id: ".concat(e," does not exist"));var a=r.get(e);"_object_ref_id"!==o?n[o]=a:a&&"object"==typeof a&&Object.assign(n,a)}};for(var o in n)a()}}Fr.set("Aspect",{desc:"Aspect Function",ctor:T,rasterArgumentNames:["raster"]}),Fr.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:Y,rasterArgumentNames:["raster"]}),Fr.set("Colormap",{desc:"Colormap Function",ctor:st,rasterArgumentNames:["raster"]}),Fr.set("CompositeBand",{desc:"CompositeBand Function",ctor:vt,rasterArgumentNames:["rasters"]}),Fr.set("Convolution",{desc:"Convolution Function",ctor:Tt,rasterArgumentNames:["raster"]}),Fr.set("ExtractBand",{desc:"ExtractBand Function",ctor:zt,rasterArgumentNames:["raster"]}),Fr.set("Curvature",{desc:"Curvature Function",ctor:_t,rasterArgumentNames:["raster"]}),Fr.set("Local",{desc:"Local Function",ctor:Xe,rasterArgumentNames:["rasters"]}),Fr.set("Mask",{desc:"Mask Function",ctor:Ze,rasterArgumentNames:["raster"]}),Fr.set("NDVI",{desc:"NDVI Function",ctor:nr,rasterArgumentNames:["raster"]}),Fr.set("Remap",{desc:"Remap Function",ctor:ur,rasterArgumentNames:["raster"]}),Fr.set("Slope",{desc:"Slope Function",ctor:hr,rasterArgumentNames:["raster"]}),Fr.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:gr,rasterArgumentNames:["raster"]}),Fr.set("Stretch",{desc:"Stretch Function",ctor:Pr,rasterArgumentNames:["raster"]}),Fr.set("Table",{desc:"Attribute Table Function",ctor:Ir,rasterArgumentNames:["raster"]})},1663:function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n,a=r(89),i=r(88),o=r(90),s=r(91),u=r(94),c=r(97),l=(r(96),r(98),r(93),r(138)),p=r(95),f=r(1329),v=n=function(t){Object(o.a)(r,t);var e=Object(s.a)(r);function r(){var t;return Object(a.a)(this,r),(t=e.apply(this,arguments)).type="gcs-shift",t.tolerance=1e-8,t}return Object(i.a)(r,[{key:"forwardTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}},{key:"inverseTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}},{key:"clone",value:function(){return new n({tolerance:this.tolerance})}}]),r}(f.a);Object(u.a)([Object(l.a)({GCSShiftXform:"gcs-shift"})],v.prototype,"type",void 0),Object(u.a)([Object(c.b)()],v.prototype,"tolerance",void 0);var h=v=n=Object(u.a)([Object(p.a)("esri.layers.support.rasterTransforms.GCSShiftTransform")],v)},1797:function(t,e,r){"use strict";r.d(e,"a",(function(){return y})),r.d(e,"b",(function(){return g}));var n,a=r(1663),i=r(89),o=r(88),s=r(90),u=r(91),c=r(94),l=(r(102),r(96),r(98),r(93),r(101),r(138)),p=r(95),f=r(1329),v=n=function(t){Object(s.a)(r,t);var e=Object(u.a)(r);function r(){var t;return Object(i.a)(this,r),(t=e.apply(this,arguments)).type="identity",t}return Object(o.a)(r,[{key:"clone",value:function(){return new n}}]),r}(f.a);Object(c.a)([Object(l.a)({IdentityXform:"identity"})],v.prototype,"type",void 0);var h=v=n=Object(c.a)([Object(p.a)("esri.layers.support.rasterTransforms.IdentityTransform")],v),b=r(1176),d={GCSShiftXform:a.a,IdentityXform:h,PolynomialXform:b.a},m=Object.keys(d);function y(t){var e=null===t||void 0===t?void 0:t.type;return!t||m.includes(e)}function g(t){if(!(null===t||void 0===t?void 0:t.type))return null;var e=d[null===t||void 0===t?void 0:t.type];if(e){var r=new e;return r.read(t),r}return null}},570:function(t,e,r){"use strict";r.d(e,"a",(function(){return tt})),r.d(e,"b",(function(){return I})),r.d(e,"c",(function(){return Y})),r.d(e,"d",(function(){return J})),r.d(e,"e",(function(){return U})),r.d(e,"f",(function(){return H})),r.d(e,"g",(function(){return N})),r.d(e,"h",(function(){return L})),r.d(e,"i",(function(){return S})),r.d(e,"j",(function(){return W})),r.d(e,"k",(function(){return F})),r.d(e,"l",(function(){return y})),r.d(e,"m",(function(){return Z})),r.d(e,"n",(function(){return Q}));var n,a,i=r(4),o=r(1),s=r(99),u=r(12),c=(r(119),r(98)),l=r(101),p=r(194),f=r(665),v=r(206),h=r(130),b=r(135),d=r(164),m=r(125);function y(t,e,r){return!Object(v.canProjectWithoutEngine)(t,e,r)}function g(t,e,r){var n=y(t,e,r);if(n&&!Object(v.isLoaded)())throw new l.a("rasterprojectionhelper-project","projection engine is not loaded");return n}(a=n||(n={}))[a.None=0]="None",a[a.North=1]="North",a[a.South=2]="South",a[a.Both=3]="Both";var j=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(1===r[0])return[0,0];for(var a=1,i=-1,o=1,s=-1,u=0;u<t.length;u+=2)isNaN(t[u])||(a=a>t[u]?t[u]:a,i=i>t[u]?i:t[u],o=o>t[u+1]?t[u+1]:o,s=s>t[u+1]?s:t[u+1]);for(var c=e.cols,l=e.rows,p=(i-a)/c/r[0],f=(s-o)/l/r[1],v=2*n,h=0,b=!1,d=[0,0],m=0;m<c-3;m++){for(var y=0;y<l-3;y++){var g=m*l*2+2*y,j=(t[g]+t[g+4]+t[g+4*l]+t[g+4*l+4])/4,O=(t[g+1]+t[g+5]+t[g+4*l+1]+t[g+4*l+5])/4,x=Math.abs((j-t[g+2*l+2])/p),w=Math.abs((O-t[g+2*l+3])/f);if(x+w>h&&(h=x+w,d=[x,w]),v&&h>v){b=!0;break}}if(b)break}return d},O={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},x=32,w=4,A=w,k=new Map,P=new Map,R=500;function N(){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=Object(v.isLoaded)(),t.t0){t.next=4;break}return t.next=4,Object(v.load)();case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t,e,r){return g(t.spatialReference,e),r?Object(v.getTransformation)(e,t.spatialReference,t):Object(v.getTransformation)(t.spatialReference,e,t)}function F(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.spatialReference;if(a.equals(e))return t;g(a,e,n);var i,o=r.center,s=new h.a({xmin:o.x-t.x/2,xmax:o.x+t.x/2,ymin:o.y-t.y/2,ymax:o.y+t.y/2,spatialReference:a}),u=Object(v.project)(s,e,n),c=U(e);if(null==u||null!=c&&u.width>=c){var l=Object(p.e)(a)/Object(p.e)(e);i={x:t.x*l,y:t.y*l}}else i={x:u.width,y:u.height};return i}function M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return Object(p.e)(t)?e/Object(p.e)(t):0}function S(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=t.spatialReference;if(a.equals(e))return t;g(a,e,r);var i=Object(v.project)(t,e,r);return n&&i?(C([t],[i],a,e),i):i}function C(t,e,r,n){var a=q(r,!0),i=q(n,!0),o=M(r,R),s=M(n,R);if(o&&null!=a&&null!=i)for(var u=0;u<t.length;u++){var c=e[u];if(c){var l=t[u].x,p=c.x;p>=i[1]-s&&Math.abs(l-a[0])<o?c.x-=i[1]-i[0]:p<=i[0]+s&&Math.abs(l-a[1])<o&&(c.x+=i[1]-i[0])}}}function _(t){var e=t.inSR,r=t.outSR,n=t.datumTransformation,a=t.preferPE;if(e.equals(r))return D(t,null).points;if(e.isWebMercator&&r.isWGS84||e.isWGS84&&r.isWebMercator)return function(t){var e=t.cols,r=t.rows,n=t.xres,a=t.yres,i=t.usePixelCenter,o=t.inSR,s=t.outSR,u=t.xmin,c=t.ymax;i&&(u+=n/2,c-=a/2);for(var l=[],p=[],f=Math.max(e,r),h=0;h<f;h++){var d=u+n*Math.min(e,h),m=c-a*Math.min(r,h),y=Object(v.project)(new b.a({x:d,y:m,spatialReference:o}),s);h<=e&&l.push(y.x),h<=r&&p.push(y.y)}for(var g=[],j=0;j<e;j++)for(var O=0;O<r;O++)g.push([l[j],p[O]]);return g}(t);if(g(e,r,n)&&a){if(e.isGeographic)return B(t);if(null!=G(e))return B(t)}return function(t){var e=D(t,null),r=e.points,n=t.inSR,a=t.outSR,i=t.datumTransformation,o=r.map((function(t){return new b.a(t[0],t[1],n)})),s=Object(v.project)(o,a,i);return i&&C(o,s,n,a),s.map((function(t){return t?[t.x,t.y]:[NaN,NaN]}))}(t)}function B(t){var e=t.inSR,r=t.outSR,n=t.datumTransformation,a=D(t,G(e)),i=a.points,o=a.mask;if(!e.isGeographic){var u=e.wkid?f.a.coordsys(e.wkid):f.a.fromString(e.isGeographic?f.b.PE_TYPE_GEOGCS:f.b.PE_TYPE_PROJCS,e.wkt);f.c.projToGeog(u,i.length,i)}if(null!=n&&n.steps.length){var c,l=179.9955;if(r.isGeographic&&(c=i.map((function(t){var e=Object(s.a)(t,1)[0];return e>l?1:e<-l?-1:0}))),n.steps.forEach((function(t){var e=t.wkid?f.a.geogtran(t.wkid):f.a.fromString(f.b.PE_TYPE_GEOGTRAN,t.wkt);f.d.geogToGeog(e,i.length,i,null,t.isInverse?f.b.PE_TRANSFORM_2_TO_1:f.b.PE_TRANSFORM_1_TO_2)})),c)for(var p=0;p<i.length;p++){var v=c[p],h=i[p][0],b=h>l?1:h<-l?-1:0;v&&b&&v!==b&&(i[p][0]=v>0?h+360:h-360)}}if(!r.isGeographic){var d=G(r,!0),m=null!=d&&d.isEnvelope?[d.bbox[1],d.bbox[3]]:[-90,90];!function(t,e){for(var r=Object(s.a)(e,2),n=r[0],a=r[1],i=0;i<t.length;i++){var o=t[i][1];(o<n||o>a)&&(t[i]=[NaN,NaN])}}(i,m);var y=r.wkid?f.a.coordsys(r.wkid):f.a.fromString(r.isGeographic?f.b.PE_TYPE_GEOGCS:f.b.PE_TYPE_PROJCS,r.wkt);f.c.geogToProj(y,i.length,i)}var g=i;if(o&&i.length!==o.length){g=[];for(var j=0,O=0;j<o.length;j++)o[j]?g.push(i[O++]):g.push([NaN,NaN])}return g}function G(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.wkid||t.wkt;if(!r||t.isGeographic)return null;if(r=String(r),k.has(r)){var n=k.get(r);return e?null===n||void 0===n?void 0:n.gcs:null===n||void 0===n?void 0:n.pcs}var a=t.wkid?f.a.coordsys(t.wkid):f.a.fromString(t.isGeographic?f.b.PE_TYPE_GEOGCS:f.b.PE_TYPE_PROJCS,t.wkt),i=E(a,M(t,1e-4)),o=E(a,0,!0);return k.set(r,{pcs:i,gcs:o}),e?o:i}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=f.f.generate(t),a=r?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!n||null===a||void 0===a||!a.length)return null;var i=!1,o=a.find((function(t){return 1===t.getInclusive()&&1===t.getKind()}));if(!o){if(o=a.find((function(t){return 1===t.getInclusive()&&0===t.getKind()})),!o)return null;i=!0}var u=r?0:(2===n.getNorthPoleLocation()?1:0)|(2===n.getSouthPoleLocation()?2:0),c=n.isPannableRectangle(),l=o.getCoord();if(i)return{isEnvelope:i,isPannable:c,vertices:l,coef:null,bbox:[l[0][0]-e,l[0][1]-e,l[1][0]+e,l[1][1]+e],poleLocation:u};for(var p=0,v=[],h=Object(s.a)(l[0],2),b=h[0],d=h[1],m=Object(s.a)(l[0],2),y=m[0],g=m[1],j=0,O=l.length;j<O;j++){++p===O&&(p=0);var x=Object(s.a)(l[j],2),w=x[0],A=x[1],k=Object(s.a)(l[p],2),P=k[0],R=k[1];if(R===A)v.push([w,P,A,R,2]);else{var N=(P-w)/(R-A||1e-4),T=w-N*A;A<R?v.push([N,T,A,R,0]):v.push([N,T,R,A,1])}b=b<w?b:w,d=d<A?d:A,y=y>w?y:w,g=g>A?g:A}return{isEnvelope:!1,isPannable:c,vertices:l,coef:v,bbox:[b,d,y,g],poleLocation:u}}function D(t,e){var r=[],n=t.cols,a=t.rows,i=t.xres,o=t.yres,u=t.usePixelCenter,c=t.xmin,l=t.ymax;if(u&&(c+=i/2,l-=o/2),null==e){for(var p=0;p<n;p++)for(var f=0;f<a;f++)r.push([c+i*p,l-o*f]);return{points:r}}var v=new Uint8Array(n*a);if(e.isEnvelope){for(var h=Object(s.a)(e.bbox,4),b=h[0],d=h[1],m=h[2],y=h[3],g=0,j=0;g<n;g++)for(var O=c+i*g,x=e.isPannable||O>=b&&O<=m,w=0;w<a;w++,j++){var A=l-o*w;x&&A>=d&&A<=y&&(r.push([O,A]),v[j]=1)}return{points:r,mask:v}}for(var k=e.coef,P=[],R=0;R<a;R++){for(var N=l-o*R,T=[],I=[],F=0;F<k.length;F++){var M=Object(s.a)(k[F],5),S=M[0],C=M[1],_=M[2],B=M[3],G=M[4];if(N===_&&_===B)T.push(S),T.push(C),I.push(2),I.push(2);else if(N>=_&&N<=B){var E=S*N+C;T.push(E),I.push(G)}}var D=T;if(T.length>2){var z=2===I[0]?0:I[0],L=T[0];D=[];for(var W=1;W<I.length;W++)2===I[W]&&W!==I.length-1||(I[W]!==z&&(D.push(0===z?Math.min(L,T[W-1]):Math.max(L,T[W-1])),z=I[W],L=T[W]),W===I.length-1&&D.push(0===I[W]?Math.min(L,T[W]):Math.max(L,T[W])));D.sort((function(t,e){return t-e}))}else T[0]>T[1]&&(D=[T[1],T[0]]);P.push(D)}for(var V=0,U=0;V<n;V++)for(var q=c+i*V,X=0;X<a;X++,U++){var H=l-o*X,J=P[X];if(2===J.length)q>=J[0]&&q<=J[1]&&(r.push([q,H]),v[U]=1);else if(J.length>2){for(var Y=!1,$=0;$<J.length;$+=2)if(q>=J[$]&&q<=J[$+1]){Y=!0;break}Y&&(r.push([q,H]),v[U]=1)}}return{points:r,mask:v}}function z(t){var e=U(t[0].spatialReference);if(t.length<2||null==e)return t[0];var r=M(t[0].spatialReference);if(1===(t=t.filter((function(t){return t.width>r}))).length)return t[0];for(var n=t[0],a=n.xmin,i=n.xmax,o=n.ymin,s=n.ymax,u=1;u<t.length;u++){var c=t[u];i=c.xmax+e*u,o=Math.min(o,c.ymin),s=Math.max(s,c.ymax)}return new h.a({xmin:a,xmax:i,ymin:o,ymax:s,spatialReference:t[0].spatialReference})}function L(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.spatialReference;if(i.equals(e))return t;var o=H(t),s=U(i,!0),u=U(e);if(0===o||null==s||null==u){var l=V(t,e,r,a);if(null==s&&null!=u&&Math.abs(l.width-u)<M(e)&&Object(v.isLoaded)()){var p=G(i);if(null!=p&&p.poleLocation===n.None&&t.width<(p.bbox[2]-p.bbox[0])/2)return function(t,e){var r=U(e);if(null==r)return null;var n=t.xmin,a=t.ymin,i=t.xmax,o=t.ymax,s=t.spatialReference,u=new d.a({spatialReference:s,rings:[[[n,a],[i,a],[i,o],[n,o],[n,a]]]}),c=Object(v.project)(u,e);if(2!==c.rings.length||!c.rings[0].length||!c.rings[1].length)return null;for(var l=c.rings,p=M(s),f=new h.a({spatialReference:e}),b=0;b<2;b++){n=i=l[b][0][0],a=o=l[b][0][1];for(var m=0;m<l[b].length;m++)n=n>l[b][m][0]?l[b][m][0]:n,i=i<l[b][m][0]?l[b][m][0]:i,a=a>l[b][m][1]?l[b][m][1]:a,o=o<l[b][m][1]?l[b][m][1]:o;if(0===b)f.ymin=a,f.ymax=o,f.xmin=n,f.xmax=i;else if(f.ymin=Math.min(f.ymin,a),f.ymax=Math.max(f.ymax,o),Math.abs(i-r/2)<p)f.xmin=n,f.xmax=f.xmax+r;else{if(!(Math.abs(n+r/2)<p))return null;f.xmax=i+r}}return f}(t,e)||l}return l}var f=t.clone().normalize();if(1===f.length&&t.xmax<s&&t.xmax-s/2>M(i))for(var b=t.xmin,m=t.xmax,y=0;y<=o;y++){var g=0===y?b:-s/2,j=y===o?m-s*y:s/2;f[y]=new h.a({xmin:g,xmax:j,ymin:t.ymin,ymax:t.ymax,spatialReference:i})}return z(f.map((function(t){return V(t,e,r,a)})).filter(c.i))}function W(t,e,r){if("extent"===t.type){var n=t,a=n.xmin,i=n.ymin,o=n.xmax,s=n.ymax,u=n.spatialReference;t=new d.a({rings:[[[a,s],[o,s],[o,i],[a,i],[a,s]]],spatialReference:u})}return t.spatialReference.equals(e)?t:(g(t.spatialReference,e,r),Object(v.project)(t,e,r))}function V(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=t.spatialReference;if(i.equals(e)||!e)return t;g(i,e,r);var o=Object(v.project)(t,e,r);if(a&&e.isWebMercator&&o&&(o.ymax=Math.min(20037508.342787,o.ymax),o.ymin=Math.max(-20037508.342787,o.ymin),o.ymin>=o.ymax))return null;if(!n||!o)return o;var s=q(i,!0),u=q(e,!0);if(null==s||null==u)return o;var c=M(i,.001),l=M(i,R),p=M(e,.001);if(Math.abs(o.xmin-u[0])<p&&Math.abs(o.xmax-u[1])<p){var f=Math.abs(t.xmin-s[0]),h=Math.abs(s[1]-t.xmax);if(f<c&&h>l){o.xmin=u[0];var d=[];d.push(new b.a(t.xmax,t.ymin,i)),d.push(new b.a(t.xmax,(t.ymin+t.ymax)/2,i)),d.push(new b.a(t.xmax,t.ymax,i));var m=d.map((function(t){return S(t,e,r)})).filter((function(t){return!isNaN(null===t||void 0===t?void 0:t.x)})).map((function(t){return t.x}));o.xmax=Math.max.apply(null,m)}if(h<c&&f>l){o.xmax=u[1];var y=[];y.push(new b.a(t.xmin,t.ymin,i)),y.push(new b.a(t.xmin,(t.ymin+t.ymax)/2,i)),y.push(new b.a(t.xmin,t.ymax,i));var j=y.map((function(t){return S(t,e,r)})).filter((function(t){return!isNaN(null===t||void 0===t?void 0:t.x)})).map((function(t){return t.x}));o.xmin=Math.min.apply(null,j)}}else{var O=M(e,.001);Math.abs(o.xmin-u[0])<O&&(o.xmin=u[0]),Math.abs(o.xmax-u[1])<O&&(o.xmax=u[1])}return o}function U(t){if(!t)return null;var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?20037508.342787:20037508.342788905;return t.isWebMercator?2*e:t.wkid&&t.isGeographic?360:2*O[t.wkid]||null}function q(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isGeographic)return[-180,180];var r=U(t,e);return null!=r?[-r/2,r/2]:null}function X(t,e,r,n){var a=(t-e)/r;return a-Math.floor(a)!=0?a=Math.floor(a):n&&(a-=1),a}function H(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=U(t.spatialReference);if(null==r)return 0;var n=e?0:-r/2,a=M(t.spatialReference),i=!e&&Math.abs(t.xmax-r/2)<a?r/2:t.xmax,o=!e&&Math.abs(t.xmin+r/2)<a?-r/2:t.xmin;return X(i,n,r,!0)-X(o,n,r,!1)}function J(t){var e=t.storageInfo.origin.x,r=U(t.spatialReference,!0);if(null==r)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};for(var n=r/2,a=t.nativePixelSize,i=t.storageInfo,o=t.extent,s=i.maximumPyramidLevel,u=i.blockWidth,c=i.pyramidScalingFactor,l=a.x,p=[],f=null!=t.transform&&"gcs-shift"===t.transform.type,v=e+(f?0:n),h=f?r-e:n-e,b=0;b<=s;b++){var d=(o.xmax-e)/l/u,m=d-Math.floor(d)==0?d:Math.ceil(d),y=h/l/u,g=y-Math.floor(y)==0?y:Math.ceil(y),j=Math.floor(v/l/u),O=Math.round(v/l)%u,x=(u-Math.round(h/l)%u)%u;p.push({resolutionX:l,blockWidth:u,datsetColumnCount:m,worldColumnCountFromOrigin:g,leftMargin:O,rightPadding:x,originColumnOffset:j}),l*=c}return{originX:e,halfWorldWidth:n,pyramidsInfo:p,hasGCSSShiftTransform:f}}function Y(t){var e=t.isAdaptive&&null==t.spacing,r=t.spacing||[x,x],n=$(t),a={cols:n.size[0]+1,rows:n.size[1]+1},i=n.outofBoundPointCount>0&&n.outofBoundPointCount<n.offsets.length/2,s=n.outofBoundPointCount===n.offsets.length/2||e&&i?[0,0]:j(n.offsets,a,r,A),u=(s[0]+s[1])/2,c=t.projectedExtent.spatialReference,l=t.srcBufferExtent.spatialReference;if(e&&(i||u>A)&&(y(c,l,t.datumTransformation)&&(c.isGeographic||G(c)),r=[w,w],a={cols:(n=$(Object(o.a)(Object(o.a)({},t),{},{spacing:r}))).size[0]+1,rows:n.size[1]+1},s=j(n.offsets,a,r,A)),n.error=s,r[0]>1&&(n.coefficients=K(n.offsets,a,i)),t.includeGCSGrid&&!c.isGeographic&&!c.isWebMercator)if(l.isGeographic)n.gcsGrid={offsets:n.offsets,coefficients:n.coefficients,spacing:r};else{var p=G(c);if(null!=p&&!p.isEnvelope){var v=function(t){if(!t||t.isGeographic)return t;var e,r=String(t.wkid||t.wkt);return P.has(r)?e=P.get(r):(e=(t.wkid?f.a.coordsys(t.wkid):f.a.fromString(f.b.PE_TYPE_PROJCS,t.wkt)).getGeogcs().getCode(),P.set(r,e)),new m.a({wkid:e})}(c),h=L(t.projectedExtent,v),b=$(Object(o.a)(Object(o.a)({},t),{},{srcBufferExtent:h,spacing:r})).offsets,d=K(b,a,i);n.gcsGrid={offsets:b,coefficients:d,spacing:r}}}return n}function $(t){var e,r=t.projectedExtent,n=t.srcBufferExtent,a=t.pixelSize,i=t.datumTransformation,o=t.rasterTransform,s=r.spatialReference,u=n.spatialReference,c=g(s,u),l=r.xmin,p=r.ymin,f=r.xmax,v=r.ymax,h=U(u),d=null!=h&&(t.hasWrapAround||"gcs-shift"===(null===o||void 0===o?void 0:o.type)),m=t.spacing||[x,x],y=m[0]*a.x,j=m[1]*a.y,O=1===m[0],A=Math.ceil((f-l)/y-.1/m[0])+(O?0:1),k=Math.ceil((v-p)/j-.1/m[1])+(O?0:1),P=_({cols:A,rows:k,xmin:l,ymax:v,xres:y,yres:j,inSR:s,outSR:u,datumTransformation:i,preferPE:m[0]<=w,usePixelCenter:O}),N=[],T=0,I=O?-1:NaN,F=n.xmin,S=n.xmax,C=n.ymax,B=n.width,E=n.height,D=M(u,R),z=null!=h&&F>0&&S>h/2,L=!1;if(c){var W=G(s);L=null!=W&&W.poleLocation>0}for(var V=0;V<A;V++){for(var q=[],X=0;X<k;X++){var H=P[V*k+X];if(d&&H[0]>S&&H[0]>h/2-D?H[0]-=h:d&&0===V&&H[0]<0&&z&&!o&&(H[0]+=h),!H||isNaN(H[0])||isNaN(H[1]))N.push(I),N.push(I),q.push(null),T++;else{if(o){var J=o.inverseTransform(new b.a({x:H[0],y:H[1],spatialReference:u}));H=[J.x,J.y]}q.push(H),V>0&&d&&e[X]&&H[0]<e[X][0]&&(H[0]+=h,L&&H[0]>S&&H[0]>h&&(H[0]-=h)),N.push((H[0]-F)/B),N.push((C-H[1])/E)}}e=q}return{offsets:N,error:null,coefficients:null,outofBoundPointCount:T,spacing:m,size:O?[A,k]:[A-1,k-1]}}function K(t,e,r){for(var n=e.cols,a=e.rows,i=new Float32Array((n-1)*(a-1)*2*6),o=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),s=new Float32Array([-1,1,0,0,-1,1,1,0,0]),u=0;u<n-1;u++){for(var c=0;c<a-1;c++){for(var l=u*a*2+2*c,p=t[l],f=t[l+1],v=t[l+2],h=t[l+3],b=t[l+=2*a],d=t[l+1],m=t[l+2],y=t[l+3],g=0,j=12*(c*(n-1)+u),O=0;O<3;O++)i[j++]=o[g++]*p+o[g++]*v+o[g++]*m;g=0;for(var x=0;x<3;x++)i[j++]=o[g++]*f+o[g++]*h+o[g++]*y;g=0;for(var w=0;w<3;w++)i[j++]=s[g++]*p+s[g++]*b+s[g++]*m;g=0;for(var A=0;A<3;A++)i[j++]=s[g++]*f+s[g++]*d+s[g++]*y}if(r)for(var k=0;k<i.length;k++)isNaN(i[k])&&(i[k]=-1)}return i}function Z(t){var e=t.clone().normalize();return 1===e.length?e[0]:z(e)}function Q(t,e,r){var n,a=e.storageInfo,i=e.pixelSize,o=0,s=!1,u=a.pyramidResolutions,c="mixed"===(null===(n=a.tileInfo.format)||void 0===n?void 0:n.toLowerCase())?Math.max(1,Math.min(3,a.tileInfo.dpi/96)):1,l=(t.x+t.y)/2/c;if(null!=u&&u.length){var f=u[u.length-1],v=(f.x+f.y)/2,h=(i.x+i.y)/2;if(l<=h)o=0;else if(l>=v)o=u.length,s=l/v>8;else for(var d,m=h,y=1;y<=u.length;y++){if(l<=(d=(u[y-1].x+u[y-1].y)/2)){l===d?o=y:"down"===r?(o=y-1,s=l/m>8):o="up"===r||l-m>d-l||l/m>2?y:y-1;break}m=d}var g=0===o?i:u[o-1];return s&&Math.min(g.x,g.y)*Object(p.e)(e.spatialReference)>19567&&(s=!1),{pyramidLevel:o,pyramidResolution:new b.a({x:g.x,y:g.y,spatialReference:e.spatialReference}),excessiveReading:s}}var j=Math.log(t.x/i.x)/Math.LN2,O=Math.log(t.y/i.y)/Math.LN2,x=e.storageInfo.maximumPyramidLevel||0;(o="down"===r?Math.floor(Math.min(j,O)):"up"===r?Math.ceil(Math.max(j,O)):Math.round((j+O)/2))<0?o=0:o>x&&(s=o>x+3,o=x);var w=Math.pow(2,o);return{pyramidLevel:o,pyramidResolution:new b.a({x:w*e.nativePixelSize.x,y:w*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:s}}function tt(t,e,r){var n,a,i,o=null!==(n=null===r||void 0===r?void 0:r.tileSize)&&void 0!==n?n:512,s=null===(a=null===r||void 0===r?void 0:r.alignGlobalDatasetWithAGOL)||void 0===a||a,u=!(null===r||void 0===r||!r.limitToSrcResolution),c=t.extent,l=t.spatialReference,f=t.pixelSize,v=F(new b.a({x:f.x,y:f.y,spatialReference:l}),e,c);if(null==v)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};var h=(v.x+v.y)/2,d=Object(p.e)(e),m=h*d*96*39.37,y=e.isGeographic?256/o*295828763.7958547:256/o*591657527.591555,g="vector-magdir"===t.dataType||"vector-uv"===t.dataType,j=L(c,e),O=Math.min(Math.ceil(Math.log(Math.min(t.width,t.height)/32)/Math.LN2),Math.ceil(Math.log(y/2/m)/Math.LN2));if(!g&&s&&(e.isGeographic||e.isWebMercator)&&(!(g=j.xmin*j.xmax<0)&&O<3)){var x=U(e);if(null!=x){var w=Math.pow(2,O)*h*o,A=Math.ceil(x/w);g=1===A||2===A&&x/2-j.xmax<w}}var k,P=m,R=1.001,N=Math.min(2,Math.max(1.414,(null===(i=t.storageInfo)||void 0===i?void 0:i.pyramidScalingFactor)||2));if(g){P=y;var T=e.isGeographic?1341104507446289e-21:.29858214164761665,I=T*(96*d*39.37),M=e.isGeographic?4326:3857;(k=F(new b.a({x:T,y:T,spatialReference:{wkid:M}}),l,j)).x*=P/I,k.y*=P/I}else{k={x:f.x,y:f.y};for(var S=0;P<y*(R/2)&&S<O;)S++,P*=N,k.x*=N,k.y*=N;Math.max(P,y)/Math.min(P,y)<=R&&(P=y)}for(var C=[P],_=[{x:k.x,y:k.y}],B=Math.min(70.5310735,m)/R;P>=B;)P/=N,k.x/=N,k.y/=N,C.push(P),_.push({x:k.x,y:k.y});if(u){var G=.001*f.x,E=_.findIndex((function(t){return t.x>=f.x-G&&t.x<=f.x+G}));E>-1?(_.length=E+1,C.length=E+1):(E=_.findIndex((function(t){return t.x<=f.x+G})),E>0&&(_.length=E,C.length=E))}return{projectedPixelSize:v,scales:C,srcResolutions:_,isCustomTilingScheme:!g}}}}]);
//# sourceMappingURL=57.cbd687d1.chunk.js.map